<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="266.138" tests="49" errors="18" skipped="2" failures="0">
  <properties>
    <property name="build.test.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="test.tmp.dir.uri" value="file:///home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="qfile" value=""/>
    <property name="test.warehouse.dir" value="pfile:///home/alex/Repositories/hive/ql/target/warehouse"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="run_disabled" value=""/>
    <property name="nondexPrintstack" value="false"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="http://java.oracle.com/"/>
    <property name="user.country.format" value="PT"/>
    <property name="test.tmp.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/alex/Repositories/hive/ql/target/surefire/surefirebooter4153401334187458943.jar /home/alex/Repositories/hive/ql/target/surefire 2024-04-23T21-59-46_173-jvmRun1 surefire1690157838454251151tmp surefire_1828846650806151989236tmp"/>
    <property name="nondexExecid" value="P8gC2Wt6DD1QwiZ4NJDRegC4uh59IgmR4jnrq+hRsc="/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/java-8-openjdk-amd64/jre"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/alex/Repositories/hive/ql"/>
    <property name="line.separator" value="&#10;"/>
    <property name="nondexEnd" value="9223372036854775807"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="derby.stream.error.file" value="/home/alex/Repositories/hive/ql/target/tmp/derby.log"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="sun.boot.class.path" value="/home/alex/Repositories/hive/ql/.nondex/nondex-instr.jar:/home/alex/.m2/repository/edu/illinois/nondex-common/2.1.7/nondex-common-2.1.7.jar:/home/alex/.m2/repository/edu/illinois/nondex-annotations/2.1.7/nondex-annotations-2.1.7.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes"/>
    <property name="log4j.debug" value="true"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="spark.home" value=""/>
    <property name="java.runtime.version" value="1.8.0_402-8u402-ga-2ubuntu1~22.04-b06"/>
    <property name="user.name" value="alex"/>
    <property name="test.src.tables" value=""/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="qfile_regex" value=""/>
    <property name="hadoop.bin.path" value="/home/alex/Repositories/hive/ql/../testutils/hadoop"/>
    <property name="localRepository" value="/home/alex/.m2/repository"/>
    <property name="build.dir" value="/home/alex/Repositories/hive/ql/target"/>
    <property name="nondexDir" value="/home/alex/Repositories/hive/ql/.nondex"/>
    <property name="nondexJarDir" value="/home/alex/Repositories/hive/ql/.nondex"/>
    <property name="mapred.job.tracker" value="local"/>
    <property name="java.io.tmpdir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="com.zaxxer.hikari.pool_number" value="3"/>
    <property name="java.version" value="1.8.0_402"/>
    <property name="hive.version" value="4.0.0-SNAPSHOT"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="test.data.dir" value="/home/alex/Repositories/hive/ql/../data/files"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib"/>
    <property name="java.vendor" value="Private Build"/>
    <property name="java.specification.maintenance.version" value="5"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="initScript" value=""/>
    <property name="sun.desktop" value="gnome"/>
    <property name="calcite.enable.rexnode.digest.normalize" value="false"/>
    <property name="nondexStart" value="0"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="log4j.configurationFile" value="file:///home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties"/>
    <property name="java.class.path" value="/home/alex/Repositories/hive/ql/target/test-classes:/home/alex/Repositories/hive/ql/target/classes:/home/alex/.m2/repository/org/apache/atlas/atlas-client-v2/2.1.0/atlas-client-v2-2.1.0.jar:/home/alex/.m2/repository/cglib/cglib/2.2.2/cglib-2.2.2.jar:/home/alex/.m2/repository/asm/asm/3.3.1/asm-3.3.1.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-client-common/2.1.0/atlas-client-common-2.1.0.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-intg/2.1.0/atlas-intg-2.1.0.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/alex/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/org/springframework/spring-context/4.3.20.RELEASE/spring-context-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-aop/4.3.20.RELEASE/spring-aop-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-beans/4.3.20.RELEASE/spring-beans-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-core/4.3.20.RELEASE/spring-core-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-expression/4.3.20.RELEASE/spring-expression-4.3.20.RELEASE.jar:/home/alex/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/alex/Repositories/hive/vector-code-gen/target/classes:/home/alex/.m2/repository/org/apache/velocity/velocity/1.5/velocity-1.5.jar:/home/alex/Repositories/hive/common/target/classes:/home/alex/Repositories/hive/classification/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/commons-cli/commons-cli/1.4/commons-cli-1.4.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.27.v20190418/jetty-http-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-rewrite/9.3.27.v20190418/jetty-rewrite-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-client/9.3.27.v20190418/jetty-client-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.27.v20190418/jetty-server-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.27.v20190418/jetty-io-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.27.v20190418/jetty-servlet-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.27.v20190418/jetty-security-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.27.v20190418/jetty-webapp-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.27.v20190418/jetty-xml-9.3.27.v20190418.jar:/home/alex/.m2/repository/joda-time/joda-time/2.9.9/joda-time-2.9.9.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-web/2.13.2/log4j-web-2.13.2.jar:/home/alex/.m2/repository/net/sf/jpam/jpam/1.1/jpam-1.1.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/Repositories/hive/metastore/target/classes:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/Repositories/hive/serde/target/classes:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-vector/0.15.1/arrow-vector-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-format/0.15.1/arrow-format-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-memory/0.15.1/arrow-memory-0.15.1.jar:/home/alex/.m2/repository/com/google/flatbuffers/flatbuffers-java/1.9.0/flatbuffers-java-1.9.0.jar:/home/alex/.m2/repository/com/carrotsearch/hppc/0.7.2/hppc-0.7.2.jar:/home/alex/.m2/repository/com/github/davidmoten/flatbuffers-java/1.6.0.1/flatbuffers-java-1.6.0.1.jar:/home/alex/Repositories/hive/parser/target/classes:/home/alex/Repositories/hive/udf/target/classes:/home/alex/Repositories/hive/service-rpc/target/classes:/home/alex/Repositories/hive/llap-client/target/classes:/home/alex/Repositories/hive/llap-common/target/classes:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-api/0.10.5/jjwt-api-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-impl/0.10.5/jjwt-impl-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.10.5/jjwt-jackson-0.10.5.jar:/home/alex/Repositories/hive/llap-tez/target/classes:/home/alex/Repositories/hive/shims/aggregator/target/classes:/home/alex/Repositories/hive/shims/common/target/classes:/home/alex/Repositories/hive/shims/0.23/target/classes:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-resourcemanager/3.1.0/hadoop-yarn-server-resourcemanager-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-applicationhistoryservice/3.1.0/hadoop-yarn-server-applicationhistoryservice-3.1.0.jar:/home/alex/.m2/repository/de/ruedigermoeller/fst/2.50/fst-2.50.jar:/home/alex/.m2/repository/com/cedarsoftware/java-util/1.9.0/java-util-1.9.0.jar:/home/alex/.m2/repository/com/cedarsoftware/json-io/2.5.1/json-io-2.5.1.jar:/home/alex/Repositories/hive/shims/scheduler/target/classes:/home/alex/Repositories/hive/spark-client/target/classes:/home/alex/.m2/repository/io/netty/netty-all/4.1.65.Final/netty-all-4.1.65.Final.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-scala_2.12/2.12.0/jackson-module-scala_2.12-2.12.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-yarn_2.12/2.4.5/spark-yarn_2.12-2.4.5.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/com/amazonaws/aws-java-sdk-bundle/1.11.901/aws-java-sdk-bundle-1.11.901.jar:/home/alex/.m2/repository/com/amazonaws/secretsmanager/aws-secretsmanager-caching-java/1.0.1/aws-secretsmanager-caching-java-1.0.1.jar:/home/alex/.m2/repository/com/esotericsoftware/kryo/5.0.3/kryo-5.0.3.jar:/home/alex/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/minlog/1.3.1/minlog-1.3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/reflectasm/1.11.9/reflectasm-1.11.9.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/alex/.m2/repository/org/apache/hbase/hbase-common/2.0.0-alpha4/hbase-common-2.0.0-alpha4.jar:/home/alex/.m2/repository/org/apache/hbase/thirdparty/hbase-shaded-miscellaneous/1.0.1/hbase-shaded-miscellaneous-1.0.1.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core/3.2.0-incubating/htrace-core-3.2.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-crypto/1.0.0/commons-crypto-1.0.0.jar:/home/alex/.m2/repository/com/github/stephenc/findbugs/findbugs-annotations/1.3.9-1/findbugs-annotations-1.3.9-1.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-hadoop-bundle/1.11.1/parquet-hadoop-bundle-1.11.1.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/alex/.m2/repository/commons-io/commons-io/2.6/commons-io-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/commons/commons-text/1.8/commons-text-1.8.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.8.2/avro-1.8.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.8/paranamer-2.8.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.1.4/snappy-java-1.1.4.jar:/home/alex/.m2/repository/org/tukaani/xz/1.5/xz-1.5.jar:/home/alex/.m2/repository/org/apache/avro/avro-mapred/1.8.2/avro-mapred-1.8.2-hadoop2.jar:/home/alex/.m2/repository/org/apache/avro/avro-ipc/1.8.2/avro-ipc-1.8.2.jar:/home/alex/.m2/repository/org/mortbay/jetty/jetty/6.1.26/jetty-6.1.26.jar:/home/alex/.m2/repository/org/apache/ant/ant/1.9.1/ant-1.9.1.jar:/home/alex/.m2/repository/org/apache/ant/ant-launcher/1.9.1/ant-launcher-1.9.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.27.v20190418/jetty-util-9.3.27.v20190418.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-archives/3.1.0/hadoop-archives-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-registry/3.1.0/hadoop-yarn-registry-3.1.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-common/3.1.0/hadoop-mapreduce-client-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/orc/orc-tools/1.6.9/orc-tools-1.6.9.jar:/home/alex/.m2/repository/com/opencsv/opencsv/3.9/opencsv-3.9.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/org/threeten/threetenbp/1.3.5/threetenbp-1.3.5.jar:/home/alex/.m2/repository/org/apache/ivy/ivy/2.4.0/ivy-2.4.0.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-hive/1.1.0-incubating/datasketches-hive-1.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-java/1.3.0-incubating/datasketches-java-1.3.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-memory/1.2.0-incubating/datasketches-memory-1.2.0-incubating.jar:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar:/home/alex/.m2/repository/com/lmax/disruptor/3.3.7/disruptor-3.3.7.jar:/home/alex/.m2/repository/org/codehaus/groovy/groovy-all/2.4.11/groovy-all-2.4.11.jar:/home/alex/.m2/repository/org/jodd/jodd-util/6.0.0/jodd-util-6.0.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.12.0/jackson-dataformat-yaml-2.12.0.jar:/home/alex/.m2/repository/org/yaml/snakeyaml/1.27/snakeyaml-1.27.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-core/1.25.0/calcite-core-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-linq4j/1.25.0/calcite-linq4j-1.25.0.jar:/home/alex/.m2/repository/org/apiguardian/apiguardian-api/1.1.0/apiguardian-api-1.1.0.jar:/home/alex/.m2/repository/com/esri/geometry/esri-geometry-api/2.2.0/esri-geometry-api-2.2.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/sketches-core/0.9.0/sketches-core-0.9.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/memory/0.9.0/memory-0.9.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-druid/1.25.0/calcite-druid-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/avatica/avatica/1.12.0/avatica-1.12.0.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/googlecode/javaewah/JavaEWAH/0.3.2/JavaEWAH-0.3.2.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/com/tdunning/json/1.8/json-1.8.jar:/home/alex/.m2/repository/stax/stax-api/1.0.1/stax-api-1.0.1.jar:/home/alex/.m2/repository/net/sf/opencsv/opencsv/2.3/opencsv-2.3.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/Repositories/hive/common/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/test-classes:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/.m2/repository/org/apache/parquet/parquet-column/1.11.1/parquet-column-1.11.1-tests.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-common/1.11.1/parquet-common-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-format-structures/1.11.1/parquet-format-structures-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-encoding/1.11.1/parquet-encoding-1.11.1.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.6.2/junit-jupiter-engine-5.6.2.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-engine/1.6.2/junit-platform-engine-1.6.2.jar:/home/alex/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-commons/1.6.2/junit-platform-commons-1.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.6.2/junit-jupiter-api-5.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.6.2/junit-jupiter-params-5.6.2.jar:/home/alex/.m2/repository/org/junit/vintage/junit-vintage-engine/5.6.2/junit-vintage-engine-5.6.2.jar:/home/alex/.m2/repository/org/apache/tez/tez-api/0.10.1/tez-api-0.10.1.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-library/0.10.1/tez-runtime-library-0.10.1.jar:/home/alex/.m2/repository/org/roaringbitmap/RoaringBitmap/0.5.21/RoaringBitmap-0.5.21.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/alex/.m2/repository/io/netty/netty-buffer/4.1.48.Final/netty-buffer-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-http/4.1.48.Final/netty-codec-http-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-common/4.1.48.Final/netty-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport/4.1.48.Final/netty-transport-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec/4.1.48.Final/netty-codec-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler/4.1.48.Final/netty-handler-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-resolver/4.1.48.Final/netty-resolver-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-socks/4.1.48.Final/netty-codec-socks-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler-proxy/4.1.48.Final/netty-handler-proxy-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-epoll/4.1.48.Final/netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.48.Final/netty-transport-native-unix-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-kqueue/4.1.48.Final/netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/alex/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/alex/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.4/netty-reactive-streams-2.0.4.jar:/home/alex/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/alex/.m2/repository/org/apache/tez/tez-common/0.10.1/tez-common-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-internals/0.10.1/tez-runtime-internals-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/hadoop-shim/0.10.1/hadoop-shim-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-mapreduce/0.10.1/tez-mapreduce-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-dag/0.10.1/tez-dag-0.10.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-web-proxy/3.1.0/hadoop-yarn-server-web-proxy-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-common/3.1.0/hadoop-yarn-server-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/geronimo/specs/geronimo-jcache_1.0_spec/1.0-alpha-1/geronimo-jcache_1.0_spec-1.0-alpha-1.jar:/home/alex/.m2/repository/org/ehcache/ehcache/3.3.1/ehcache-3.3.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP-java7/2.4.12/HikariCP-java7-2.4.12.jar:/home/alex/.m2/repository/org/apache/spark/spark-core_2.12/2.4.5/spark-core_2.12-2.4.5.jar:/home/alex/.m2/repository/com/twitter/chill_2.12/0.9.3/chill_2.12-0.9.3.jar:/home/alex/.m2/repository/com/twitter/chill-java/0.9.3/chill-java-0.9.3.jar:/home/alex/.m2/repository/org/apache/xbean/xbean-asm6-shaded/4.8/xbean-asm6-shaded-4.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-client/3.1.0/hadoop-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-jobclient/3.1.0/hadoop-mapreduce-client-jobclient-3.1.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-launcher_2.12/2.4.5/spark-launcher_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-kvstore_2.12/2.4.5/spark-kvstore_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-common_2.12/2.4.5/spark-network-common_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-shuffle_2.12/2.4.5/spark-network-shuffle_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-unsafe_2.12/2.4.5/spark-unsafe_2.12-2.4.5.jar:/home/alex/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/alex/.m2/repository/org/slf4j/jul-to-slf4j/1.7.16/jul-to-slf4j-1.7.16.jar:/home/alex/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.16/jcl-over-slf4j-1.7.16.jar:/home/alex/.m2/repository/com/ning/compress-lzf/1.0.3/compress-lzf-1.0.3.jar:/home/alex/.m2/repository/org/lz4/lz4-java/1.4.0/lz4-java-1.4.0.jar:/home/alex/.m2/repository/com/github/luben/zstd-jni/1.3.2-2/zstd-jni-1.3.2-2.jar:/home/alex/.m2/repository/org/scala-lang/scala-library/2.12.10/scala-library-2.12.10.jar:/home/alex/.m2/repository/org/json4s/json4s-jackson_2.12/3.5.3/json4s-jackson_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-core_2.12/3.5.3/json4s-core_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-ast_2.12/3.5.3/json4s-ast_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-scalap_2.12/3.5.3/json4s-scalap_2.12-3.5.3.jar:/home/alex/.m2/repository/org/scala-lang/modules/scala-xml_2.12/1.0.6/scala-xml_2.12-1.0.6.jar:/home/alex/.m2/repository/com/clearspring/analytics/stream/2.7.0/stream-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-graphite/3.1.5/metrics-graphite-3.1.5.jar:/home/alex/.m2/repository/oro/oro/2.0.8/oro-2.0.8.jar:/home/alex/.m2/repository/net/razorvine/pyrolite/4.13/pyrolite-4.13.jar:/home/alex/.m2/repository/net/sf/py4j/py4j/0.10.7/py4j-0.10.7.jar:/home/alex/.m2/repository/org/apache/spark/spark-tags_2.12/2.4.5/spark-tags_2.12-2.4.5.jar:/home/alex/.m2/repository/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-server/2.22.2/jersey-server-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-common/2.22.2/jersey-common-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/bundles/repackaged/jersey-guava/2.22.2/jersey-guava-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-client/2.22.2/jersey-client-2.22.2.jar:/home/alex/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.22.2/jersey-media-jaxb-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-api/2.4.0-b34/hk2-api-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-utils/2.4.0-b34/hk2-utils-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.4.0-b34/aopalliance-repackaged-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/javax.inject/2.4.0-b34/javax.inject-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-locator/2.4.0-b34/hk2-locator-2.4.0-b34.jar:/home/alex/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/alex/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.22.2/jersey-container-servlet-core-2.22.2.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4/2.0.2/powermock-module-junit4-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4-common/2.0.2/powermock-module-junit4-common-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-reflect/2.0.2/powermock-reflect-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-core/2.0.2/powermock-core-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-mockito2/2.0.2/powermock-api-mockito2-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-support/2.0.2/powermock-api-support-2.0.2.jar:/home/alex/.m2/repository/com/google/guava/guava-testlib/19.0/guava-testlib-19.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.0.2/error_prone_annotations-2.0.2.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.2/re2j-1.2.jar:/home/alex/.m2/repository/org/reflections/reflections/0.9.10/reflections-0.9.10.jar:/home/alex/.m2/repository/org/javassist/javassist/3.19.0-GA/javassist-3.19.0-GA.jar:/home/alex/.m2/repository/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/org/codehaus/janino/commons-compiler/3.0.11/commons-compiler-3.0.11.jar:/home/alex/.m2/repository/org/codehaus/janino/janino/3.0.11/janino-3.0.11.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-multipart/1.19/jersey-multipart-1.19.jar:/home/alex/.m2/repository/org/jvnet/mimepull/mimepull/1.9.3/mimepull-1.9.3.jar:/home/alex/.m2/repository/org/apache/kafka/kafka-clients/2.5.0/kafka-clients-2.5.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.4.4/mockito-core-3.4.4.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.13/byte-buddy-1.10.13.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.13/byte-buddy-agent-1.10.13.jar:/home/alex/Repositories/hive/ql/target/testconf:/home/alex/Repositories/hive/ql/../conf:"/>
    <property name="java.vm.vendor" value="Private Build"/>
    <property name="hadoop.version" value="3.1.0"/>
    <property name="user.timezone" value="US/Pacific"/>
    <property name="test.local.warehouse.dir" value="pfile:///home/alex/Repositories/hive/ql/target/localfs/warehouse"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="test.build.data" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="clustermode" value=""/>
    <property name="user.country" value="US"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="test.data.files" value="/home/alex/Repositories/hive/ql/../data/files"/>
    <property name="nondexLogging" value="CONFIG"/>
    <property name="surefire.test.class.path" value="/home/alex/Repositories/hive/ql/target/test-classes:/home/alex/Repositories/hive/ql/target/classes:/home/alex/.m2/repository/org/apache/atlas/atlas-client-v2/2.1.0/atlas-client-v2-2.1.0.jar:/home/alex/.m2/repository/cglib/cglib/2.2.2/cglib-2.2.2.jar:/home/alex/.m2/repository/asm/asm/3.3.1/asm-3.3.1.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-client-common/2.1.0/atlas-client-common-2.1.0.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-intg/2.1.0/atlas-intg-2.1.0.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/alex/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/org/springframework/spring-context/4.3.20.RELEASE/spring-context-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-aop/4.3.20.RELEASE/spring-aop-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-beans/4.3.20.RELEASE/spring-beans-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-core/4.3.20.RELEASE/spring-core-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-expression/4.3.20.RELEASE/spring-expression-4.3.20.RELEASE.jar:/home/alex/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/alex/Repositories/hive/vector-code-gen/target/classes:/home/alex/.m2/repository/org/apache/velocity/velocity/1.5/velocity-1.5.jar:/home/alex/Repositories/hive/common/target/classes:/home/alex/Repositories/hive/classification/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/commons-cli/commons-cli/1.4/commons-cli-1.4.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.27.v20190418/jetty-http-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-rewrite/9.3.27.v20190418/jetty-rewrite-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-client/9.3.27.v20190418/jetty-client-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.27.v20190418/jetty-server-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.27.v20190418/jetty-io-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.27.v20190418/jetty-servlet-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.27.v20190418/jetty-security-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.27.v20190418/jetty-webapp-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.27.v20190418/jetty-xml-9.3.27.v20190418.jar:/home/alex/.m2/repository/joda-time/joda-time/2.9.9/joda-time-2.9.9.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-web/2.13.2/log4j-web-2.13.2.jar:/home/alex/.m2/repository/net/sf/jpam/jpam/1.1/jpam-1.1.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/Repositories/hive/metastore/target/classes:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/Repositories/hive/serde/target/classes:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-vector/0.15.1/arrow-vector-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-format/0.15.1/arrow-format-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-memory/0.15.1/arrow-memory-0.15.1.jar:/home/alex/.m2/repository/com/google/flatbuffers/flatbuffers-java/1.9.0/flatbuffers-java-1.9.0.jar:/home/alex/.m2/repository/com/carrotsearch/hppc/0.7.2/hppc-0.7.2.jar:/home/alex/.m2/repository/com/github/davidmoten/flatbuffers-java/1.6.0.1/flatbuffers-java-1.6.0.1.jar:/home/alex/Repositories/hive/parser/target/classes:/home/alex/Repositories/hive/udf/target/classes:/home/alex/Repositories/hive/service-rpc/target/classes:/home/alex/Repositories/hive/llap-client/target/classes:/home/alex/Repositories/hive/llap-common/target/classes:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-api/0.10.5/jjwt-api-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-impl/0.10.5/jjwt-impl-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.10.5/jjwt-jackson-0.10.5.jar:/home/alex/Repositories/hive/llap-tez/target/classes:/home/alex/Repositories/hive/shims/aggregator/target/classes:/home/alex/Repositories/hive/shims/common/target/classes:/home/alex/Repositories/hive/shims/0.23/target/classes:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-resourcemanager/3.1.0/hadoop-yarn-server-resourcemanager-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-applicationhistoryservice/3.1.0/hadoop-yarn-server-applicationhistoryservice-3.1.0.jar:/home/alex/.m2/repository/de/ruedigermoeller/fst/2.50/fst-2.50.jar:/home/alex/.m2/repository/com/cedarsoftware/java-util/1.9.0/java-util-1.9.0.jar:/home/alex/.m2/repository/com/cedarsoftware/json-io/2.5.1/json-io-2.5.1.jar:/home/alex/Repositories/hive/shims/scheduler/target/classes:/home/alex/Repositories/hive/spark-client/target/classes:/home/alex/.m2/repository/io/netty/netty-all/4.1.65.Final/netty-all-4.1.65.Final.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-scala_2.12/2.12.0/jackson-module-scala_2.12-2.12.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-yarn_2.12/2.4.5/spark-yarn_2.12-2.4.5.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/com/amazonaws/aws-java-sdk-bundle/1.11.901/aws-java-sdk-bundle-1.11.901.jar:/home/alex/.m2/repository/com/amazonaws/secretsmanager/aws-secretsmanager-caching-java/1.0.1/aws-secretsmanager-caching-java-1.0.1.jar:/home/alex/.m2/repository/com/esotericsoftware/kryo/5.0.3/kryo-5.0.3.jar:/home/alex/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/minlog/1.3.1/minlog-1.3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/reflectasm/1.11.9/reflectasm-1.11.9.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/alex/.m2/repository/org/apache/hbase/hbase-common/2.0.0-alpha4/hbase-common-2.0.0-alpha4.jar:/home/alex/.m2/repository/org/apache/hbase/thirdparty/hbase-shaded-miscellaneous/1.0.1/hbase-shaded-miscellaneous-1.0.1.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core/3.2.0-incubating/htrace-core-3.2.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-crypto/1.0.0/commons-crypto-1.0.0.jar:/home/alex/.m2/repository/com/github/stephenc/findbugs/findbugs-annotations/1.3.9-1/findbugs-annotations-1.3.9-1.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-hadoop-bundle/1.11.1/parquet-hadoop-bundle-1.11.1.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/alex/.m2/repository/commons-io/commons-io/2.6/commons-io-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/commons/commons-text/1.8/commons-text-1.8.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.8.2/avro-1.8.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.8/paranamer-2.8.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.1.4/snappy-java-1.1.4.jar:/home/alex/.m2/repository/org/tukaani/xz/1.5/xz-1.5.jar:/home/alex/.m2/repository/org/apache/avro/avro-mapred/1.8.2/avro-mapred-1.8.2-hadoop2.jar:/home/alex/.m2/repository/org/apache/avro/avro-ipc/1.8.2/avro-ipc-1.8.2.jar:/home/alex/.m2/repository/org/mortbay/jetty/jetty/6.1.26/jetty-6.1.26.jar:/home/alex/.m2/repository/org/apache/ant/ant/1.9.1/ant-1.9.1.jar:/home/alex/.m2/repository/org/apache/ant/ant-launcher/1.9.1/ant-launcher-1.9.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.27.v20190418/jetty-util-9.3.27.v20190418.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-archives/3.1.0/hadoop-archives-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-registry/3.1.0/hadoop-yarn-registry-3.1.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-common/3.1.0/hadoop-mapreduce-client-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/orc/orc-tools/1.6.9/orc-tools-1.6.9.jar:/home/alex/.m2/repository/com/opencsv/opencsv/3.9/opencsv-3.9.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/org/threeten/threetenbp/1.3.5/threetenbp-1.3.5.jar:/home/alex/.m2/repository/org/apache/ivy/ivy/2.4.0/ivy-2.4.0.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-hive/1.1.0-incubating/datasketches-hive-1.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-java/1.3.0-incubating/datasketches-java-1.3.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-memory/1.2.0-incubating/datasketches-memory-1.2.0-incubating.jar:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar:/home/alex/.m2/repository/com/lmax/disruptor/3.3.7/disruptor-3.3.7.jar:/home/alex/.m2/repository/org/codehaus/groovy/groovy-all/2.4.11/groovy-all-2.4.11.jar:/home/alex/.m2/repository/org/jodd/jodd-util/6.0.0/jodd-util-6.0.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.12.0/jackson-dataformat-yaml-2.12.0.jar:/home/alex/.m2/repository/org/yaml/snakeyaml/1.27/snakeyaml-1.27.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-core/1.25.0/calcite-core-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-linq4j/1.25.0/calcite-linq4j-1.25.0.jar:/home/alex/.m2/repository/org/apiguardian/apiguardian-api/1.1.0/apiguardian-api-1.1.0.jar:/home/alex/.m2/repository/com/esri/geometry/esri-geometry-api/2.2.0/esri-geometry-api-2.2.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/sketches-core/0.9.0/sketches-core-0.9.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/memory/0.9.0/memory-0.9.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-druid/1.25.0/calcite-druid-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/avatica/avatica/1.12.0/avatica-1.12.0.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/googlecode/javaewah/JavaEWAH/0.3.2/JavaEWAH-0.3.2.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/com/tdunning/json/1.8/json-1.8.jar:/home/alex/.m2/repository/stax/stax-api/1.0.1/stax-api-1.0.1.jar:/home/alex/.m2/repository/net/sf/opencsv/opencsv/2.3/opencsv-2.3.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/Repositories/hive/common/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/test-classes:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/.m2/repository/org/apache/parquet/parquet-column/1.11.1/parquet-column-1.11.1-tests.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-common/1.11.1/parquet-common-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-format-structures/1.11.1/parquet-format-structures-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-encoding/1.11.1/parquet-encoding-1.11.1.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.6.2/junit-jupiter-engine-5.6.2.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-engine/1.6.2/junit-platform-engine-1.6.2.jar:/home/alex/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-commons/1.6.2/junit-platform-commons-1.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.6.2/junit-jupiter-api-5.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.6.2/junit-jupiter-params-5.6.2.jar:/home/alex/.m2/repository/org/junit/vintage/junit-vintage-engine/5.6.2/junit-vintage-engine-5.6.2.jar:/home/alex/.m2/repository/org/apache/tez/tez-api/0.10.1/tez-api-0.10.1.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-library/0.10.1/tez-runtime-library-0.10.1.jar:/home/alex/.m2/repository/org/roaringbitmap/RoaringBitmap/0.5.21/RoaringBitmap-0.5.21.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/alex/.m2/repository/io/netty/netty-buffer/4.1.48.Final/netty-buffer-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-http/4.1.48.Final/netty-codec-http-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-common/4.1.48.Final/netty-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport/4.1.48.Final/netty-transport-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec/4.1.48.Final/netty-codec-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler/4.1.48.Final/netty-handler-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-resolver/4.1.48.Final/netty-resolver-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-socks/4.1.48.Final/netty-codec-socks-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler-proxy/4.1.48.Final/netty-handler-proxy-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-epoll/4.1.48.Final/netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.48.Final/netty-transport-native-unix-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-kqueue/4.1.48.Final/netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/alex/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/alex/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.4/netty-reactive-streams-2.0.4.jar:/home/alex/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/alex/.m2/repository/org/apache/tez/tez-common/0.10.1/tez-common-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-internals/0.10.1/tez-runtime-internals-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/hadoop-shim/0.10.1/hadoop-shim-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-mapreduce/0.10.1/tez-mapreduce-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-dag/0.10.1/tez-dag-0.10.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-web-proxy/3.1.0/hadoop-yarn-server-web-proxy-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-common/3.1.0/hadoop-yarn-server-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/geronimo/specs/geronimo-jcache_1.0_spec/1.0-alpha-1/geronimo-jcache_1.0_spec-1.0-alpha-1.jar:/home/alex/.m2/repository/org/ehcache/ehcache/3.3.1/ehcache-3.3.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP-java7/2.4.12/HikariCP-java7-2.4.12.jar:/home/alex/.m2/repository/org/apache/spark/spark-core_2.12/2.4.5/spark-core_2.12-2.4.5.jar:/home/alex/.m2/repository/com/twitter/chill_2.12/0.9.3/chill_2.12-0.9.3.jar:/home/alex/.m2/repository/com/twitter/chill-java/0.9.3/chill-java-0.9.3.jar:/home/alex/.m2/repository/org/apache/xbean/xbean-asm6-shaded/4.8/xbean-asm6-shaded-4.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-client/3.1.0/hadoop-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-jobclient/3.1.0/hadoop-mapreduce-client-jobclient-3.1.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-launcher_2.12/2.4.5/spark-launcher_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-kvstore_2.12/2.4.5/spark-kvstore_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-common_2.12/2.4.5/spark-network-common_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-shuffle_2.12/2.4.5/spark-network-shuffle_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-unsafe_2.12/2.4.5/spark-unsafe_2.12-2.4.5.jar:/home/alex/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/alex/.m2/repository/org/slf4j/jul-to-slf4j/1.7.16/jul-to-slf4j-1.7.16.jar:/home/alex/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.16/jcl-over-slf4j-1.7.16.jar:/home/alex/.m2/repository/com/ning/compress-lzf/1.0.3/compress-lzf-1.0.3.jar:/home/alex/.m2/repository/org/lz4/lz4-java/1.4.0/lz4-java-1.4.0.jar:/home/alex/.m2/repository/com/github/luben/zstd-jni/1.3.2-2/zstd-jni-1.3.2-2.jar:/home/alex/.m2/repository/org/scala-lang/scala-library/2.12.10/scala-library-2.12.10.jar:/home/alex/.m2/repository/org/json4s/json4s-jackson_2.12/3.5.3/json4s-jackson_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-core_2.12/3.5.3/json4s-core_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-ast_2.12/3.5.3/json4s-ast_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-scalap_2.12/3.5.3/json4s-scalap_2.12-3.5.3.jar:/home/alex/.m2/repository/org/scala-lang/modules/scala-xml_2.12/1.0.6/scala-xml_2.12-1.0.6.jar:/home/alex/.m2/repository/com/clearspring/analytics/stream/2.7.0/stream-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-graphite/3.1.5/metrics-graphite-3.1.5.jar:/home/alex/.m2/repository/oro/oro/2.0.8/oro-2.0.8.jar:/home/alex/.m2/repository/net/razorvine/pyrolite/4.13/pyrolite-4.13.jar:/home/alex/.m2/repository/net/sf/py4j/py4j/0.10.7/py4j-0.10.7.jar:/home/alex/.m2/repository/org/apache/spark/spark-tags_2.12/2.4.5/spark-tags_2.12-2.4.5.jar:/home/alex/.m2/repository/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-server/2.22.2/jersey-server-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-common/2.22.2/jersey-common-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/bundles/repackaged/jersey-guava/2.22.2/jersey-guava-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-client/2.22.2/jersey-client-2.22.2.jar:/home/alex/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.22.2/jersey-media-jaxb-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-api/2.4.0-b34/hk2-api-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-utils/2.4.0-b34/hk2-utils-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.4.0-b34/aopalliance-repackaged-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/javax.inject/2.4.0-b34/javax.inject-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-locator/2.4.0-b34/hk2-locator-2.4.0-b34.jar:/home/alex/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/alex/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.22.2/jersey-container-servlet-core-2.22.2.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4/2.0.2/powermock-module-junit4-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4-common/2.0.2/powermock-module-junit4-common-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-reflect/2.0.2/powermock-reflect-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-core/2.0.2/powermock-core-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-mockito2/2.0.2/powermock-api-mockito2-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-support/2.0.2/powermock-api-support-2.0.2.jar:/home/alex/.m2/repository/com/google/guava/guava-testlib/19.0/guava-testlib-19.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.0.2/error_prone_annotations-2.0.2.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.2/re2j-1.2.jar:/home/alex/.m2/repository/org/reflections/reflections/0.9.10/reflections-0.9.10.jar:/home/alex/.m2/repository/org/javassist/javassist/3.19.0-GA/javassist-3.19.0-GA.jar:/home/alex/.m2/repository/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/org/codehaus/janino/commons-compiler/3.0.11/commons-compiler-3.0.11.jar:/home/alex/.m2/repository/org/codehaus/janino/janino/3.0.11/janino-3.0.11.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-multipart/1.19/jersey-multipart-1.19.jar:/home/alex/.m2/repository/org/jvnet/mimepull/mimepull/1.9.3/mimepull-1.9.3.jar:/home/alex/.m2/repository/org/apache/kafka/kafka-clients/2.5.0/kafka-clients-2.5.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.4.4/mockito-core-3.4.4.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.13/byte-buddy-1.10.13.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.13/byte-buddy-agent-1.10.13.jar:/home/alex/Repositories/hive/ql/target/testconf:/home/alex/Repositories/hive/ql/../conf:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/alex"/>
    <property name="user.language" value="en"/>
    <property name="java.security.krb5.conf" value="/home/alex/Repositories/hive/ql/target/testconf/krb5.conf"/>
    <property name="test.dfs.mkdir" value=""/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="nondexFilter" value=".*"/>
    <property name="nondexSeed" value="933178"/>
    <property name="surefire.real.class.path" value="/home/alex/Repositories/hive/ql/target/surefire/surefirebooter4153401334187458943.jar"/>
    <property name="hadoop.log.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="6.5.0-28-generic"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="hive.test.console.log.level" value="INFO"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="java.vendor.url.bug" value="http://bugreport.sun.com/bugreport/"/>
    <property name="maven.local.repository" value="/home/alex/.m2/repository"/>
    <property name="user.dir" value="/home/alex/Repositories/hive/ql"/>
    <property name="os.arch" value="amd64"/>
    <property name="nondexMode" value="FULL"/>
    <property name="user.language.format" value="pt"/>
    <property name="antlr.version" value="3.5.2"/>
    <property name="derby.version" value="10.14.1.0"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vm.version" value="25.402-b06"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="java.class.version" value="52.0"/>
    <property name="test.output.overwrite" value=""/>
    <property name="hive.root" value="/home/alex/Repositories/hive/ql/../"/>
  </properties>
  <testcase name="testMergeUpdateDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="17.752">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-out><![CDATA[log4j: Trying to find [log4j.xml] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@65c86db8.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@65c86db8.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
]]></system-out>
    <system-err><![CDATA[SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,087818 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@2a693f59]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@2a693f59) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@65f8f5ae
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@4dc27487
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,022737 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(disableAnsi="null", header="null", noConsoleNoAnsi="null", footer="null", Replace=null, charset="null", Configuration(HiveLog4j2Test), alwaysWriteExceptions="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null)
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(follow="null", direct="null", target="SYSTEM_ERR", immediateFlush="null", bufferedIo="null", bufferSize="null", Configuration(HiveLog4j2Test), name="console", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ignoreExceptions="null", ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(disableAnsi="null", footer="null", PatternSelector=null, pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", noConsoleNoAnsi="null", alwaysWriteExceptions="null", Replace=null, charset="null", Configuration(HiveLog4j2Test), header="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(modulate="true", maxRandomDelay="null", interval="1")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(compressionLevel="null", ={}, Configuration(HiveLog4j2Test), fileIndex="null", min="null", max="30", tempCompressedFilePattern="null", stopCustomActionsOnError="null")
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(append="null", advertiseURI="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", advertise="null", filePermissions="null", fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", fileOwner="null", fileGroup="null", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), immediateFlush="null", bufferSize="null", bufferedIo="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), Configuration(HiveLog4j2Test), ignoreExceptions="null", name="DRFA", ={}, Filter=null)
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 2100575748
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T21:05:39.051-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-21:05:40.820, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-21:05:40.821, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@4dc27487 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@4dc27487
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@4dc27487 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@6236eb5f...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@6236eb5f OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@5066d65f
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@2a693f59
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@2a693f59) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@2a693f59] started OK.
2024-04-23T21:05:40,920  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T21:05:41,286  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-23T21:05:41,343  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:05:41,343  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:05:41,343  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:05:41,343  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:05:41,344  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:05:41,344  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:05:41,344  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:05:41,344  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:05:41,345  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:05:41,345  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:05:41,345  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:05:41,423  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T21:05:41,428  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-23T21:05:41,980  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T21:05:41,986  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
2024-04-23T21:05:41,990  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T21:05:41,996  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-23T21:05:42,000  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T21:05:42,000  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-23T21:05:42,202  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
2024-04-23T21:05:42,210  INFO [main] utils.TestTxnDbUtil: Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/ql/target/tmp/junit_metastore_db;create=true
Hive Session ID = 99401a5d-931a-408e-b62e-3a1d1ef2d495
2024-04-23T21:05:43,248  INFO [main] SessionState: Hive Session ID = 99401a5d-931a-408e-b62e-3a1d1ef2d495
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:05:43,259  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
log4j:WARN No appenders could be found for logger (org.apache.htrace.core.Tracer).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-23T21:05:43,624  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/99401a5d-931a-408e-b62e-3a1d1ef2d495
2024-04-23T21:05:43,628  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495
2024-04-23T21:05:43,632  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/99401a5d-931a-408e-b62e-3a1d1ef2d495/_tmp_space.db
2024-04-23T21:05:43,664  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=99401a5d-931a-408e-b62e-3a1d1ef2d495, clientType=HIVECLI]
2024-04-23T21:05:43,699  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T21:05:43,825  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:05:43,857  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T21:05:43,860  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-23T21:05:43,861  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-23T21:05:43,863  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T21:05:43,867  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-23T21:05:43,869  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T21:05:43,869  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-23T21:05:44,292  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-23T21:05:44,292  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ace284d, with PersistenceManager: null will be shutdown
2024-04-23T21:05:44,316  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ace284d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@22c53d82 created in the thread with id: 1
2024-04-23T21:05:46,364  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4ace284d from thread id: 1
2024-04-23T21:05:46,378  INFO [main] metastore.HMSHandler: Setting location of default catalog, as it hasn't been done after upgrade
2024-04-23T21:05:46,405  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-23T21:05:46,450  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-23T21:05:46,471  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-23T21:05:46,475  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-23T21:05:46,558  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-23T21:05:46,563  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-23T21:05:46,564  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-23T21:05:46,569  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-23T21:05:46,570  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-23T21:05:46,571  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-23T21:05:46,573  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-23T21:05:46,576  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T21:05:46,697  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T21:05:46,741  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:05:46,770  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210546_494a03c2-e1d3-4494-a071-a7ffeb5b3e8c): drop table if exists acidTbl
2024-04-23T21:05:47,635  INFO [main] reflections.Reflections: Reflections took 206 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:05:47,795  INFO [main] reflections.Reflections: Reflections took 130 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:05:47,925  INFO [main] reflections.Reflections: Reflections took 122 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:05:47,959  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:05:47,981  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:05:47,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:48,139  INFO [main] reflections.Reflections: Reflections took 122 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:05:48,175  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,177  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,179  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,180  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, flushCache_()=0, getValidTxns_(long)=9, openTxn_(String, TxnType)=46}
2024-04-23T21:05:48,180  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210546_494a03c2-e1d3-4494-a071-a7ffeb5b3e8c); Time taken: 1.411 seconds
2024-04-23T21:05:48,182  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210546_494a03c2-e1d3-4494-a071-a7ffeb5b3e8c
2024-04-23T21:05:48,183  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:05:48,185  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210546_494a03c2-e1d3-4494-a071-a7ffeb5b3e8c): drop table if exists acidTbl
2024-04-23T21:05:48,188  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:48,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:48,208  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:48,209  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210546_494a03c2-e1d3-4494-a071-a7ffeb5b3e8c); Time taken: 0.023 seconds
2024-04-23T21:05:48,209  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210546_494a03c2-e1d3-4494-a071-a7ffeb5b3e8c
2024-04-23T21:05:48,220  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:05:48,237  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:48,240  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:05:48,242  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:05:48,243  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210548_e52ad065-e1f6-4c7f-9597-e5c6f71f0595): drop table if exists acidTblPart
2024-04-23T21:05:48,248  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:05:48,249  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:05:48,251  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:05:48,255  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,255  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,255  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,256  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=32, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=4}
2024-04-23T21:05:48,256  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210548_e52ad065-e1f6-4c7f-9597-e5c6f71f0595); Time taken: 0.012 seconds
2024-04-23T21:05:48,256  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210548_e52ad065-e1f6-4c7f-9597-e5c6f71f0595
2024-04-23T21:05:48,257  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:05:48,257  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210548_e52ad065-e1f6-4c7f-9597-e5c6f71f0595): drop table if exists acidTblPart
2024-04-23T21:05:48,257  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,258  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:05:48,264  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:48,264  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:48,264  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210548_e52ad065-e1f6-4c7f-9597-e5c6f71f0595); Time taken: 0.007 seconds
2024-04-23T21:05:48,264  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210548_e52ad065-e1f6-4c7f-9597-e5c6f71f0595
2024-04-23T21:05:48,272  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:05:48,284  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:48,285  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:05:48,286  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:05:48,287  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210548_d67056bc-bf8b-423c-93c2-744f94f3d001): drop table if exists acidTbl2
2024-04-23T21:05:48,293  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:05:48,294  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:05:48,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:05:48,303  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,303  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,303  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,303  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=5, commitTxn_(CommitTxnRequest)=21, isCompatibleWith_(Configuration)=3, getValidTxns_(long)=1}
2024-04-23T21:05:48,304  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210548_d67056bc-bf8b-423c-93c2-744f94f3d001); Time taken: 0.016 seconds
2024-04-23T21:05:48,304  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210548_d67056bc-bf8b-423c-93c2-744f94f3d001
2024-04-23T21:05:48,304  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:05:48,304  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210548_d67056bc-bf8b-423c-93c2-744f94f3d001): drop table if exists acidTbl2
2024-04-23T21:05:48,305  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:05:48,310  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:48,310  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:48,310  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210548_d67056bc-bf8b-423c-93c2-744f94f3d001); Time taken: 0.006 seconds
2024-04-23T21:05:48,311  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210548_d67056bc-bf8b-423c-93c2-744f94f3d001
2024-04-23T21:05:48,318  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:05:48,329  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:48,329  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:05:48,330  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:05:48,331  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210548_f4b48912-4089-4564-9b72-783856ed7e90): drop table if exists nonAcidOrcTbl
2024-04-23T21:05:48,335  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:05:48,336  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:05:48,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:48,342  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,342  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,342  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,342  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=19, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:48,343  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210548_f4b48912-4089-4564-9b72-783856ed7e90); Time taken: 0.011 seconds
2024-04-23T21:05:48,343  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210548_f4b48912-4089-4564-9b72-783856ed7e90
2024-04-23T21:05:48,343  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:05:48,343  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210548_f4b48912-4089-4564-9b72-783856ed7e90): drop table if exists nonAcidOrcTbl
2024-04-23T21:05:48,343  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:48,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:48,348  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:05:48,349  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210548_f4b48912-4089-4564-9b72-783856ed7e90); Time taken: 0.005 seconds
2024-04-23T21:05:48,349  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210548_f4b48912-4089-4564-9b72-783856ed7e90
2024-04-23T21:05:48,359  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:05:48,371  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:48,371  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:05:48,372  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:05:48,373  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210548_96ce1f79-2039-4c67-b530-530a5c44ed1f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:05:48,378  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:05:48,378  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:05:48,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:05:48,387  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,387  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,387  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,387  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=23, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=1}
2024-04-23T21:05:48,388  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210548_96ce1f79-2039-4c67-b530-530a5c44ed1f); Time taken: 0.014 seconds
2024-04-23T21:05:48,388  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210548_96ce1f79-2039-4c67-b530-530a5c44ed1f
2024-04-23T21:05:48,388  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:05:48,388  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210548_96ce1f79-2039-4c67-b530-530a5c44ed1f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:05:48,389  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:05:48,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:48,396  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:48,396  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210548_96ce1f79-2039-4c67-b530-530a5c44ed1f); Time taken: 0.007 seconds
2024-04-23T21:05:48,396  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210548_96ce1f79-2039-4c67-b530-530a5c44ed1f
2024-04-23T21:05:48,405  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:05:48,417  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:48,417  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:05:48,418  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:05:48,419  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210548_d76d1bf4-c843-458b-a104-c5ebd2a1ed87): drop table if exists nonAcidNonBucket
2024-04-23T21:05:48,423  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:05:48,423  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:05:48,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:05:48,429  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,430  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=22, openTxn_(String, TxnType)=3}
2024-04-23T21:05:48,430  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210548_d76d1bf4-c843-458b-a104-c5ebd2a1ed87); Time taken: 0.011 seconds
2024-04-23T21:05:48,430  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210548_d76d1bf4-c843-458b-a104-c5ebd2a1ed87
2024-04-23T21:05:48,430  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:05:48,430  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210548_d76d1bf4-c843-458b-a104-c5ebd2a1ed87): drop table if exists nonAcidNonBucket
2024-04-23T21:05:48,431  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,431  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:05:48,436  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:48,436  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:48,436  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210548_d76d1bf4-c843-458b-a104-c5ebd2a1ed87); Time taken: 0.006 seconds
2024-04-23T21:05:48,436  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210548_d76d1bf4-c843-458b-a104-c5ebd2a1ed87
2024-04-23T21:05:48,446  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:05:48,458  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:48,458  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:05:48,460  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:48,461  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:48,531  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:05:48,532  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:05:48,533  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:48,536  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:48,554  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:05:48,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:05:48,609  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:48,609  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,610  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,610  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,610  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=4, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=12, flushCache_()=0, commitTxn_(CommitTxnRequest)=22, getValidTxns_(long)=1, openTxn_(String, TxnType)=5}
2024-04-23T21:05:48,610  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54); Time taken: 0.149 seconds
2024-04-23T21:05:48,611  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54
2024-04-23T21:05:48,618  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54
2024-04-23T21:05:48,681  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:05:48,681  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:05:48,683  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:48,684  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,780  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931548, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, totalSize=0, bucketing_version=2, rawDataSize=0, numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:05:48,792  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:05:48,914  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:48,914  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=134, isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:48,914  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54); Time taken: 0.231 seconds
2024-04-23T21:05:48,915  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210548_3583c12d-7849-4eb4-be43-f1219c4acf54
2024-04-23T21:05:48,922  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:05:48,933  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:48,933  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:05:48,934  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:48,935  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:48,942  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:05:48,942  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:05:48,944  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:48,945  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:48,950  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:05:48,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:05:48,954  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:48,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:48,954  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:48,954  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:48,954  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, getValidTxns_(long)=1, flushCache_()=0, getDatabase_(String)=4, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=19, openTxn_(String, TxnType)=4}
2024-04-23T21:05:48,954  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba); Time taken: 0.019 seconds
2024-04-23T21:05:48,955  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba
2024-04-23T21:05:48,955  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba
2024-04-23T21:05:48,982  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:05:48,982  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:05:48,983  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:48,984  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:48,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931548, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:05:48,996  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:05:49,024  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:49,024  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=39}
2024-04-23T21:05:49,024  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba); Time taken: 0.041 seconds
2024-04-23T21:05:49,025  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210548_35f152c0-1461-4760-996b-3b50f7648eba
2024-04-23T21:05:49,030  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:05:49,039  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:49,041  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:05:49,042  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,043  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,047  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 2
2024-04-23T21:05:49,047  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:05:49,048  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:49,048  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:49,051  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:05:49,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:05:49,054  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:49,054  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:49,054  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:49,054  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:49,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=17, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=3, getDatabase_(String)=2, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:05:49,055  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643); Time taken: 0.011 seconds
2024-04-23T21:05:49,055  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643
2024-04-23T21:05:49,055  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643
2024-04-23T21:05:49,080  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:05:49,080  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:05:49,080  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,080  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:49,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931549, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, rawDataSize=0, bucketing_version=2, numRows=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:05:49,089  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:05:49,121  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:49,121  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=40}
2024-04-23T21:05:49,121  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643); Time taken: 0.041 seconds
2024-04-23T21:05:49,121  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210549_5d9dac03-a74b-4ba1-89d5-fb52644d1643
2024-04-23T21:05:49,126  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:05:49,135  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:49,135  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:05:49,136  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,136  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,141  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 2
2024-04-23T21:05:49,141  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:05:49,142  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:49,142  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:49,146  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:05:49,146  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:05:49,149  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:49,149  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:49,149  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:49,149  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:49,150  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=3, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, flushCache_()=1, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:05:49,150  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc); Time taken: 0.013 seconds
2024-04-23T21:05:49,151  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc
2024-04-23T21:05:49,151  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc
2024-04-23T21:05:49,176  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:05:49,176  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:05:49,176  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,176  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:49,178  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931549, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, bucketing_version=2, numRows=0, numFiles=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:05:49,185  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:05:49,216  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:49,216  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=38}
2024-04-23T21:05:49,216  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc); Time taken: 0.04 seconds
2024-04-23T21:05:49,216  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210549_71dac7a1-a08c-4079-89a0-99366f226afc
2024-04-23T21:05:49,221  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:05:49,229  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:49,229  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:05:49,230  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:49,231  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:49,235  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 2
2024-04-23T21:05:49,235  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:05:49,237  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:49,237  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:49,240  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:05:49,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:05:49,242  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:49,242  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:49,242  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:49,243  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:49,243  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0}
2024-04-23T21:05:49,243  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7); Time taken: 0.012 seconds
2024-04-23T21:05:49,243  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7
2024-04-23T21:05:49,244  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7
2024-04-23T21:05:49,266  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:05:49,266  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:05:49,268  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:05:49,268  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:49,270  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/99401a5d-931a-408e-b62e-3a1d1ef2d495/_tmp_space.db/d30297cf-ed76-431d-a67e-9ae885fd2714
2024-04-23T21:05:49,274  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:49,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=4}
2024-04-23T21:05:49,274  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7); Time taken: 0.006 seconds
2024-04-23T21:05:49,274  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210549_b3a572f9-68e6-4387-9b29-e4f75c1c82c7
2024-04-23T21:05:49,279  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:05:49,287  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:49,287  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:05:49,288  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,289  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,293  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 3
2024-04-23T21:05:49,294  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:05:49,295  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:49,295  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:49,299  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:05:49,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:05:49,302  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:49,302  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:49,302  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:49,303  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:49,303  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=4, getDatabase_(String)=3, getValidTxns_(long)=1, getValidWriteIds_(List, String)=4}
2024-04-23T21:05:49,303  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621); Time taken: 0.014 seconds
2024-04-23T21:05:49,303  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621
2024-04-23T21:05:49,304  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621
2024-04-23T21:05:49,326  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:05:49,326  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:05:49,327  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:05:49,327  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:49,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931549, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false, numFilesErasureCoded=0, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:05:49,337  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:05:49,362  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:49,362  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=34, isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:49,362  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621); Time taken: 0.035 seconds
2024-04-23T21:05:49,362  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210549_57ed48df-cb7f-4155-9593-ef071ec1f621
2024-04-23T21:05:49,368  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:05:49,375  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:49,376  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:05:49,377  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Initializing local cache in HiveMetaStoreClient...
2024-04-23T21:05:49,401  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Local cache initialized in HiveMetaStoreClient: com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedLocalManualCache@498e41a4
2024-04-23T21:05:49,406  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:05:49,407  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:05:49,415  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 6
2024-04-23T21:05:49,415  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:05:49,416  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:49,416  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:49,940  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:05:49,940  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:05:49,941  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:05:49,941  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:05:49,947  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:05:49,950  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:05:49,958  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:05:50,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:50,090  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:50,091  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:05:50,091  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:05:50,091  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:05:50,091  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:05:50,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:50,114  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:50,115  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:05:50,115  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:05:51,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:05:51,998  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:05:51,999  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:05:51,999  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:05:52,000  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:05:52,003  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:05:52,003  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:05:52,005  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:05:52,006  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:52,021  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:52,053  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1
2024-04-23T21:05:52,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:52,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:52,079  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:05:52,139  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:05:52,139  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:05:52,147  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:05:52,159  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:05:52,197  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:52,218  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:52,250  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:05:52,256  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:05:52,257  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:05:52,257  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:52,257  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:52,257  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:05:52,257  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:52,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=143, commitTxn_(CommitTxnRequest)=13, getAllTableConstraints_(AllTableConstraintsRequest)=65, getCheckConstraints_(CheckConstraintsRequest)=4, openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=3}
2024-04-23T21:05:52,258  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b); Time taken: 2.851 seconds
2024-04-23T21:05:52,258  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b
2024-04-23T21:05:52,258  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b
2024-04-23T21:05:52,282  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:05:52,282  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:05:52,283  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:05:52,283  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b
2024-04-23T21:05:52,283  INFO [main] ql.Driver: Query ID = alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b
Total jobs = 1
2024-04-23T21:05:52,283  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:05:52,283  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:05:52,422  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:05:52,423  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:05:52,423  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:05:52,423  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:05:52,423  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:05:52,423  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:05:52,423  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:05:52,423  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:05:52,431  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:05:52,433  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:05:52,433  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-49_406_1364825318318747559-1/dummy_path
2024-04-23T21:05:52,503  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:05:52,525  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,32KB
2024-04-23T21:05:52,532  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:05:52,540  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T21:05:52,650  INFO [main] beanutils.FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2024-04-23T21:05:52,665  WARN [main] impl.MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-jobtracker.properties,hadoop-metrics2.properties
2024-04-23T21:05:52,680  INFO [main] impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-04-23T21:05:52,680  INFO [main] impl.MetricsSystemImpl: JobTracker metrics system started
2024-04-23T21:05:52,692  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-49_406_1364825318318747559-1/-mr-10001
2024-04-23T21:05:52,711  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:05:52,760  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:05:52,768  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:05:52,773  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:05:52,773  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:05:52,773  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-49_406_1364825318318747559-1/dummy_path
2024-04-23T21:05:52,774  INFO [main] io.NullRowsInputFormat$NullRowsRecordReader: Using null rows input format
2024-04-23T21:05:52,778  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:05:52,808  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:05:52,877  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local177957708_0001
2024-04-23T21:05:52,877  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:05:53,008  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:05:53,009  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:05:53,010  INFO [Thread-74] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:05:53,011  INFO [Thread-74] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:05:53,021  INFO [Thread-74] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:05:53,025  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local177957708_0001_m_000000_0
2024-04-23T21:05:53,060  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:05:53,067  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-49_406_1364825318318747559-1/dummy_path/null:0+1
2024-04-23T21:05:53,073  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:05:53,097  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,32KB
2024-04-23T21:05:53,104  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:05:53,125  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:05:53,125  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:05:53,125  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:05:53,125  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:05:53,125  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:05:53,128  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:05:53,132  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:05:53,133  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:05:53,136  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:05:53,136  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:05:53,139  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:05:53,139  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:05:53,140  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:05:53,140  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:05:53,140  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:05:53,140  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:05:53,160  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:05:53,162  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:05:53,162  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:05:53,163  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:05:53,163  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:05:53,163  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:05:53,163  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:05:53,163  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T21:05:53,164  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-23T21:05:53,171  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:05:53,171  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:05:53,171  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:05:53,171  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T21:05:53,171  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T21:05:53,187  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:05:53,198  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local177957708_0001_m_000000_0 is done. And is in the process of committing
2024-04-23T21:05:53,200  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:05:53,200  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local177957708_0001_m_000000_0' done.
2024-04-23T21:05:53,202  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local177957708_0001_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=5781
		FILE: Number of bytes written=1250254
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=882376704
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5376
2024-04-23T21:05:53,202  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local177957708_0001_m_000000_0
2024-04-23T21:05:53,203  INFO [Thread-74] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:05:53,223  INFO [Thread-74] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:05:53,223  INFO [pool-8-thread-1] mapred.LocalJobRunner: Starting task: attempt_local177957708_0001_r_000000_0
2024-04-23T21:05:53,230  INFO [pool-8-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:05:53,233  INFO [pool-8-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@ad74c9f
2024-04-23T21:05:53,234  WARN [pool-8-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:05:53,249  INFO [pool-8-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:05:53,251  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local177957708_0001_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:05:53,273  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local177957708_0001_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:05:53,275  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local177957708_0001_m_000000_0
2024-04-23T21:05:53,277  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:05:53,278  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:05:53,279  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:53,279  INFO [pool-8-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:05:53,290  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:53,290  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:05:53,294  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:05:53,294  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:05:53,295  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:05:53,295  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:53,295  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:05:53,296  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:53,298  INFO [pool-8-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:05:53,301  INFO [pool-8-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T21:05:53,303  INFO [pool-8-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:05:53,303  INFO [pool-8-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:05:53,303  INFO [pool-8-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:05:53,303  INFO [pool-8-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:05:53,304  INFO [pool-8-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local177957708_0001/job_local177957708_0001.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2550ab32
2024-04-23T21:05:53,308  INFO [pool-8-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_tmp.-ext-10000/000000_0
2024-04-23T21:05:53,308  INFO [pool-8-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T21:05:53,309  INFO [pool-8-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_tmp.-ext-10000/000000_0
2024-04-23T21:05:53,322  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:05:53,334  INFO [pool-8-thread-1] impl.HadoopShimsPre2_7: Can't get KeyProvider for ORC encryption from hadoop.security.key.provider.path.
2024-04-23T21:05:53,339  INFO [pool-8-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:05:53,384  INFO [pool-8-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:05:53,390  INFO [pool-8-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:05:53,390  INFO [pool-8-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:05:53,390  INFO [pool-8-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:05:53,390  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:05:53,430  INFO [pool-8-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.nonacidorctbl:1, 
2024-04-23T21:05:53,431  INFO [pool-8-thread-1] mapred.Task: Task:attempt_local177957708_0001_r_000000_0 is done. And is in the process of committing
2024-04-23T21:05:53,431  INFO [pool-8-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:05:53,431  INFO [pool-8-thread-1] mapred.Task: Task 'attempt_local177957708_0001_r_000000_0' done.
2024-04-23T21:05:53,432  INFO [pool-8-thread-1] mapred.Task: Final Counters for attempt_local177957708_0001_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=12359
		FILE: Number of bytes written=1250620
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=883425280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:05:53,432  INFO [pool-8-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local177957708_0001_r_000000_0
2024-04-23T21:05:53,432  INFO [pool-8-thread-1] mapred.LocalJobRunner: Starting task: attempt_local177957708_0001_r_000001_0
2024-04-23T21:05:53,433  INFO [pool-8-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:05:53,433  INFO [pool-8-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1f4e7121
2024-04-23T21:05:53,433  WARN [pool-8-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:05:53,434  INFO [pool-8-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:05:53,435  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local177957708_0001_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:05:53,438  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local177957708_0001_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-23T21:05:53,438  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local177957708_0001_m_000000_0
2024-04-23T21:05:53,438  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-23T21:05:53,439  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:05:53,439  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:53,439  INFO [pool-8-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:05:53,446  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:53,446  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T21:05:53,449  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-23T21:05:53,449  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-23T21:05:53,449  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:05:53,449  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:53,449  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T21:05:53,450  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:53,450  INFO [pool-8-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:05:53,452  INFO [pool-8-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T21:05:53,453  INFO [pool-8-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:05:53,453  INFO [pool-8-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:05:53,453  INFO [pool-8-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:05:53,454  INFO [pool-8-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:05:53,454  INFO [pool-8-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local177957708_0001/job_local177957708_0001.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@14a0bb32
2024-04-23T21:05:53,455  INFO [pool-8-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_tmp.-ext-10000/000001_0
2024-04-23T21:05:53,455  INFO [pool-8-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T21:05:53,455  INFO [pool-8-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_tmp.-ext-10000/000001_0
2024-04-23T21:05:53,455  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:05:53,456  INFO [pool-8-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:05:53,461  INFO [pool-8-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:05:53,461  INFO [pool-8-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:05:53,461  INFO [pool-8-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:3, 
2024-04-23T21:05:53,461  INFO [pool-8-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:05:53,462  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-23T21:05:53,469  INFO [pool-8-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_OPERATOR_FS_6:3, RECORDS_OUT_1_default.nonacidorctbl:3, 
2024-04-23T21:05:53,469  INFO [pool-8-thread-1] mapred.Task: Task:attempt_local177957708_0001_r_000001_0 is done. And is in the process of committing
2024-04-23T21:05:53,470  INFO [pool-8-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:05:53,470  INFO [pool-8-thread-1] mapred.Task: Task 'attempt_local177957708_0001_r_000001_0' done.
2024-04-23T21:05:53,470  INFO [pool-8-thread-1] mapred.Task: Final Counters for attempt_local177957708_0001_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=18949
		FILE: Number of bytes written=1251039
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=883425280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:05:53,470  INFO [pool-8-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local177957708_0001_r_000001_0
2024-04-23T21:05:53,470  INFO [Thread-74] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:05:54,023 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:05:54,023  INFO [main] exec.Task: 2024-04-23 21:05:54,023 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local177957708_0001
2024-04-23T21:05:54,026  INFO [main] exec.Task: Ended Job = job_local177957708_0001
2024-04-23T21:05:54,060  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-23T21:05:54,061  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1/-ext-10000
2024-04-23T21:05:54,061  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:54,076  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:54,091  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,101  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T21:05:54,101  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T21:05:54,159  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:05:54,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:54,176  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,176  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:05:54,177  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-49_406_1364825318318747559-1/-mr-10001
2024-04-23T21:05:54,182  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:54,197  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,200  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-23T21:05:54,200  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-23T21:05:54,201  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T21:05:54,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T21:05:54,240  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-23T21:05:54,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:54,242  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=62, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=94}
MapReduce Jobs Launched: 
2024-04-23T21:05:54,242  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:05:54,250  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:05:54,250  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:05:54,250  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b); Time taken: 1.959 seconds
2024-04-23T21:05:54,250  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210549_c1f547c1-ceb6-493e-b9eb-c7f6c6e8eb3b
2024-04-23T21:05:54,255  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:05:54,264  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:54,266  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:05:54,267  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:05:54,268  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1
2024-04-23T21:05:54,268  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-05-49_406_1364825318318747559-1 on fs with scheme file
2024-04-23T21:05:54,268  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-49_406_1364825318318747559-1
2024-04-23T21:05:54,269  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-49_406_1364825318318747559-1 on fs with scheme file
2024-04-23T21:05:54,270  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:05:54,282  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:05:54,282  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:05:54,286  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:05:54,286  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:05:54,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:54,302  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,302  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:05:54,302  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:05:54,302  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:05:54,302  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:05:54,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:54,313  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,314  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:05:54,314  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:05:54,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:05:54,506  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:05:54,506  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:05:54,506  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:05:54,507  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:05:54,517  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:05:54,517  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:05:54,517  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:05:54,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:54,534  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:05:54,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:05:54,565  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-23T21:05:54,566  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T21:05:54,569  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:05:54,575  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:05:54,575  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:05:54,577  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:05:54,579  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:05:54,590  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:54,607  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:54,608  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:05:54,609  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:05:54,609  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:05:54,609  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:05:54,610  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:54,610  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:05:54,610  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:54,610  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=11, getCheckConstraints_(CheckConstraintsRequest)=2, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=11, flushCache_()=0, getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=16, getTable_(GetTableRequest)=58, allocateTableWriteId_(long, String, String)=23, getNotNullConstraints_(NotNullConstraintsRequest)=3, getValidWriteIds_(List, String)=7}
2024-04-23T21:05:54,610  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521); Time taken: 0.34 seconds
2024-04-23T21:05:54,612  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521
2024-04-23T21:05:54,612  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521
2024-04-23T21:05:54,639  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:05:54,639  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:05:54,643  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:05:54,643  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521
2024-04-23T21:05:54,643  INFO [main] ql.Driver: Query ID = alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521
Total jobs = 1
2024-04-23T21:05:54,643  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:05:54,644  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:05:54,777  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:05:54,778  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:05:54,778  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:05:54,778  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:05:54,778  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:05:54,778  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:05:54,778  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:05:54,778  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:05:54,780  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:05:54,781  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:05:54,781  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-54_269_8465319995032622388-1/dummy_path
2024-04-23T21:05:54,791  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:05:54,792  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:05:54,797  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:05:54,812  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:05:54,814  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:05:54,818  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-54_269_8465319995032622388-1/-mr-10000
2024-04-23T21:05:54,821  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:05:54,829  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:05:54,834  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:05:54,835  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:05:54,835  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:05:54,835  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-54_269_8465319995032622388-1/dummy_path
2024-04-23T21:05:54,836  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:05:54,855  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:05:54,879  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local351364047_0002
2024-04-23T21:05:54,879  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:05:54,962  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:05:54,963  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:05:54,963  INFO [Thread-139] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:05:54,963  INFO [Thread-139] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:05:54,965  INFO [Thread-139] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:05:54,965  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local351364047_0002_m_000000_0
2024-04-23T21:05:54,966  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:05:54,966  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-54_269_8465319995032622388-1/dummy_path/null:0+1
2024-04-23T21:05:54,967  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:05:54,969  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:05:54,970  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:05:54,974  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:05:54,974  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:05:54,974  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:05:54,974  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:05:54,974  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:05:54,975  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:05:54,975  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:05:54,976  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:05:54,977  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:05:54,977  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:05:54,977  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:05:54,977  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:05:54,977  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:05:54,977  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:05:54,978  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:05:54,978  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:05:54,978  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:05:54,979  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:05:54,979  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:05:54,979  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:05:54,979  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:05:54,979  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:05:54,979  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T21:05:54,980  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T21:05:54,981  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:05:54,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:05:54,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:05:54,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T21:05:54,981  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T21:05:54,992  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:05:54,995  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local351364047_0002_m_000000_0 is done. And is in the process of committing
2024-04-23T21:05:54,996  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:05:54,996  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local351364047_0002_m_000000_0' done.
2024-04-23T21:05:54,997  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local351364047_0002_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=24941
		FILE: Number of bytes written=2502293
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=883425280
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5401
2024-04-23T21:05:54,997  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local351364047_0002_m_000000_0
2024-04-23T21:05:54,997  INFO [Thread-139] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:05:54,999  INFO [Thread-139] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:05:54,999  INFO [pool-13-thread-1] mapred.LocalJobRunner: Starting task: attempt_local351364047_0002_r_000000_0
2024-04-23T21:05:55,000  INFO [pool-13-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:05:55,000  INFO [pool-13-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@fb26fbe
2024-04-23T21:05:55,000  WARN [pool-13-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:05:55,001  INFO [pool-13-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:05:55,001  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local351364047_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:05:55,003  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local351364047_0002_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:05:55,003  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local351364047_0002_m_000000_0
2024-04-23T21:05:55,003  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:05:55,004  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:05:55,004  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:55,004  INFO [pool-13-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:05:55,010  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:55,011  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:05:55,013  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:05:55,014  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:05:55,014  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:05:55,014  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:55,014  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:05:55,014  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:55,015  INFO [pool-13-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:05:55,019  INFO [pool-13-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:05:55,021  INFO [pool-13-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:05:55,021  INFO [pool-13-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:05:55,021  INFO [pool-13-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:05:55,021  INFO [pool-13-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:05:55,022  INFO [pool-13-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local351364047_0002/job_local351364047_0002.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5072dc3d
2024-04-23T21:05:55,023  INFO [pool-13-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:05:55,023  INFO [pool-13-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:05:55,023  INFO [pool-13-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:05:55,029  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:05:55,029  INFO [pool-13-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:05:55,037  INFO [pool-13-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:05:55,043  INFO [pool-13-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:05:55,043  INFO [pool-13-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:05:55,043  INFO [pool-13-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:05:55,043  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:05:55,062  INFO [pool-13-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:05:55,074  INFO [pool-13-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T21:05:55,074  INFO [pool-13-thread-1] mapred.Task: Task:attempt_local351364047_0002_r_000000_0 is done. And is in the process of committing
2024-04-23T21:05:55,075  INFO [pool-13-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:05:55,075  INFO [pool-13-thread-1] mapred.Task: Task 'attempt_local351364047_0002_r_000000_0' done.
2024-04-23T21:05:55,075  INFO [pool-13-thread-1] mapred.Task: Final Counters for attempt_local351364047_0002_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=31145
		FILE: Number of bytes written=2503362
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=11
		Total committed heap usage (bytes)=939524096
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:05:55,075  INFO [pool-13-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local351364047_0002_r_000000_0
2024-04-23T21:05:55,075  INFO [pool-13-thread-1] mapred.LocalJobRunner: Starting task: attempt_local351364047_0002_r_000001_0
2024-04-23T21:05:55,076  INFO [pool-13-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:05:55,076  INFO [pool-13-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@221ca5ba
2024-04-23T21:05:55,077  WARN [pool-13-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:05:55,077  INFO [pool-13-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:05:55,078  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local351364047_0002_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:05:55,081  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local351364047_0002_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:05:55,081  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local351364047_0002_m_000000_0
2024-04-23T21:05:55,081  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:05:55,082  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:05:55,082  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:55,082  INFO [pool-13-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:05:55,089  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:55,089  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:05:55,091  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:05:55,091  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:05:55,091  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:05:55,091  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:05:55,092  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:05:55,092  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:05:55,093  INFO [pool-13-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:05:55,094  INFO [pool-13-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:05:55,095  INFO [pool-13-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:05:55,095  INFO [pool-13-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:05:55,095  INFO [pool-13-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:05:55,095  INFO [pool-13-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:05:55,096  INFO [pool-13-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local351364047_0002/job_local351364047_0002.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@41e422a5
2024-04-23T21:05:55,097  INFO [pool-13-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:05:55,097  INFO [pool-13-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:05:55,097  INFO [pool-13-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:05:55,098  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:05:55,098  INFO [pool-13-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:05:55,103  INFO [pool-13-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:05:55,103  INFO [pool-13-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:05:55,104  INFO [pool-13-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:05:55,104  INFO [pool-13-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:05:55,104  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:05:55,107  INFO [pool-13-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:05:55,117  INFO [pool-13-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T21:05:55,117  INFO [pool-13-thread-1] mapred.Task: Task:attempt_local351364047_0002_r_000001_0 is done. And is in the process of committing
2024-04-23T21:05:55,118  INFO [pool-13-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:05:55,118  INFO [pool-13-thread-1] mapred.Task: Task 'attempt_local351364047_0002_r_000001_0' done.
2024-04-23T21:05:55,118  INFO [pool-13-thread-1] mapred.Task: Final Counters for attempt_local351364047_0002_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=37307
		FILE: Number of bytes written=2504432
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=939524096
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:05:55,118  INFO [pool-13-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local351364047_0002_r_000001_0
2024-04-23T21:05:55,118  INFO [Thread-139] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:05:55,975 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:05:55,975  INFO [main] exec.Task: 2024-04-23 21:05:55,975 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local351364047_0002
2024-04-23T21:05:55,977  INFO [main] exec.Task: Ended Job = job_local351364047_0002
2024-04-23T21:05:55,978  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:05:55,978  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:05:55,979  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:05:55,980  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:05:55,980  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:05:55,983  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:05:55,983  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:05:55,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:55,993  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:55,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:56,004  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:05:56,041  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:05:56,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:56,050  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,051  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:05:56,051  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-54_269_8465319995032622388-1/-mr-10000
2024-04-23T21:05:56,053  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:56,062  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,079  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:05:56,080  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T21:05:56,080  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:05:56,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:05:56,110  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T21:05:56,110  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:05:56,111  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:05:56,113  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:05:56,114  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:56,114  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=40, isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, alter_table_(String, String, String, Table, EnvironmentContext, String)=66}
MapReduce Jobs Launched: 
2024-04-23T21:05:56,114  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:05:56,114  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:05:56,115  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:05:56,115  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521); Time taken: 1.471 seconds
2024-04-23T21:05:56,115  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210554_99b270d2-53bd-4ad3-b6e9-2c1c19e16521
2024-04-23T21:05:56,128  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:56,128  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:05:56,129  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T21:05:56,129  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-54_269_8465319995032622388-1
2024-04-23T21:05:56,130  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-54_269_8465319995032622388-1 on fs with scheme file
2024-04-23T21:05:56,130  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210556_dd640fc5-d447-4b06-8963-d1378990524a): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T21:05:56,139  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:05:56,140  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:05:56,141  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:05:56,142  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,151  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T21:05:56,177  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/99401a5d-931a-408e-b62e-3a1d1ef2d495/_tmp_space.db/merge_tmp_table
2024-04-23T21:05:56,180  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `t`.`a` > 3 and `t`.`a` < 5 AND NOT(`s`.`a` < 3)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:05:56,186  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:05:56,192  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:05:56,192  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:05:56,193  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:56,204  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:56,219  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,219  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:05:56,219  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:05:56,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,231  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,242  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,252  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,263  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,263  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:05:56,263  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:05:56,266  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:05:56,267  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:05:56,267  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:05:56,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:05:56,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:56,453  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:05:56,458  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:56,470  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,471  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:05:56,483  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,484  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:05:56,501  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:05:56,501  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:05:56,502  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:05:56,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:56,518  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:05:56,532  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T21:05:56,550  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a, b
No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T21:05:56,550  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:05:56,787  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:05:56,788  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:05:56,788  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:05:56,788  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:05:56,788  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:05:56,788  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,807  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,817  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,826  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,846 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:05:56,849 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:05:56,849  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:05:56,850 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:05:56,851  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:56,851  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=14, isCompatibleWith_(Configuration)=1, createTable_(Table)=3, getTable_(GetTableRequest)=114, getValidTxns_(long)=1, getTableColumnStatistics_(String, String, List, String)=88, openTxn_(String, TxnType)=4, flushCache_()=0, getValidWriteIds_(List, String)=8, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:05:56,851  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210556_dd640fc5-d447-4b06-8963-d1378990524a); Time taken: 0.721 seconds
2024-04-23T21:05:56,851  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:05:56,856  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:56,865  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:05:56,866  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/99401a5d-931a-408e-b62e-3a1d1ef2d495/hive_2024-04-23_21-05-56_180_8148005828361040009-1
2024-04-23T21:05:56,866  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d): drop table if exists acidTbl
2024-04-23T21:05:56,871  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T21:05:56,871  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:05:56,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,883  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,883  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:56,883  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:56,883  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:56,883  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=12, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, flushCache_()=1, getValidTxns_(long)=1, getTable_(GetTableRequest)=10}
2024-04-23T21:05:56,884  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d); Time taken: 0.017 seconds
2024-04-23T21:05:56,884  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d
2024-04-23T21:05:56,885  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d
2024-04-23T21:05:56,903  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:05:56,904  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:05:56,904  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d): drop table if exists acidTbl
2024-04-23T21:05:56,904  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:56,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,912  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:56,922  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:56,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:05:57,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:57,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=219}
2024-04-23T21:05:57,133  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d); Time taken: 0.229 seconds
2024-04-23T21:05:57,133  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210556_c6b64dad-93fc-4919-8524-aeda6df7d52d
2024-04-23T21:05:57,138  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:05:57,147  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:57,149  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:05:57,150  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:05:57,150  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae): drop table if exists acidTblPart
2024-04-23T21:05:57,161  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T21:05:57,162  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:05:57,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:05:57,191  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,191  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:57,191  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:57,192  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:57,192  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, flushCache_()=0, getTable_(GetTableRequest)=26, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=3, openTxn_(String, TxnType)=11}
2024-04-23T21:05:57,192  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae); Time taken: 0.042 seconds
2024-04-23T21:05:57,192  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae
2024-04-23T21:05:57,193  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae
2024-04-23T21:05:57,214  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:05:57,214  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:05:57,214  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae): drop table if exists acidTblPart
2024-04-23T21:05:57,215  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:57,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:05:57,227  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:05:57,242  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:05:57,314  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:57,314  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12, dropTable_(String, String, boolean, boolean, boolean)=86}
2024-04-23T21:05:57,315  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae); Time taken: 0.1 seconds
2024-04-23T21:05:57,315  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210557_cfba97ad-e2b3-44a3-9ade-99faf74b1cae
2024-04-23T21:05:57,322  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:05:57,337  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:57,337  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:05:57,339  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:05:57,339  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210557_6f5ddebc-4897-442b-842b-6f570e65b517): drop table if exists acidTbl2
2024-04-23T21:05:57,343  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T21:05:57,344  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:05:57,346  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:57,346  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:57,346  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:57,346  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=23}
2024-04-23T21:05:57,347  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210557_6f5ddebc-4897-442b-842b-6f570e65b517); Time taken: 0.007 seconds
2024-04-23T21:05:57,347  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210557_6f5ddebc-4897-442b-842b-6f570e65b517
2024-04-23T21:05:57,347  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:05:57,347  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210557_6f5ddebc-4897-442b-842b-6f570e65b517): drop table if exists acidTbl2
2024-04-23T21:05:57,348  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:57,348  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:05:57,349  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:57,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1}
2024-04-23T21:05:57,350  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210557_6f5ddebc-4897-442b-842b-6f570e65b517); Time taken: 0.002 seconds
2024-04-23T21:05:57,350  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210557_6f5ddebc-4897-442b-842b-6f570e65b517
2024-04-23T21:05:57,357  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:05:57,365  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:57,366  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:05:57,366  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:05:57,367  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5): drop table if exists nonAcidOrcTbl
2024-04-23T21:05:57,372  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T21:05:57,372  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:05:57,374  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:57,410  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,411  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:57,411  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:57,411  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:57,411  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, getTable_(GetTableRequest)=36, getValidTxns_(long)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4}
2024-04-23T21:05:57,412  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5); Time taken: 0.044 seconds
2024-04-23T21:05:57,412  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5
2024-04-23T21:05:57,413  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5
2024-04-23T21:05:57,451  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:05:57,451  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:05:57,451  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5): drop table if exists nonAcidOrcTbl
2024-04-23T21:05:57,451  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:57,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:57,470  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,471  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:57,489  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:05:57,635  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:57,635  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=20, dropTable_(String, String, boolean, boolean, boolean)=164}
2024-04-23T21:05:57,635  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5); Time taken: 0.184 seconds
2024-04-23T21:05:57,636  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210557_6494872b-5a30-49cb-8938-2c91790ad0b5
2024-04-23T21:05:57,641  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:05:57,649  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:57,649  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:05:57,650  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:05:57,650  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71): drop table if exists nonAcidOrcTbl2
2024-04-23T21:05:57,654  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T21:05:57,654  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:05:57,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:05:57,667  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,667  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:57,667  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:57,667  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:57,667  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, flushCache_()=1, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=11}
2024-04-23T21:05:57,668  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71); Time taken: 0.017 seconds
2024-04-23T21:05:57,668  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71
2024-04-23T21:05:57,669  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71
2024-04-23T21:05:57,690  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:05:57,690  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:05:57,690  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71): drop table if exists nonAcidOrcTbl2
2024-04-23T21:05:57,690  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:57,690  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:05:57,701  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,701  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:05:57,714  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:05:57,756  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:57,756  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=54, getTable_(GetTableRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-23T21:05:57,756  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71); Time taken: 0.066 seconds
2024-04-23T21:05:57,756  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210557_456a39fa-d2e8-4aad-8cfe-a32e59840e71
2024-04-23T21:05:57,761  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:05:57,767  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:57,767  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:05:57,768  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:05:57,768  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91): drop table if exists nonAcidNonBucket
2024-04-23T21:05:57,772  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:05:57,772  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:05:57,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:05:57,786  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,786  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:05:57,786  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:05:57,786  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:05:57,787  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=13, openTxn_(String, TxnType)=3, flushCache_()=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T21:05:57,787  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91); Time taken: 0.018 seconds
2024-04-23T21:05:57,787  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91
2024-04-23T21:05:57,788  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91
2024-04-23T21:05:57,815  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:05:57,815  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:05:57,815  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91): drop table if exists nonAcidNonBucket
2024-04-23T21:05:57,815  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:05:57,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:05:57,830  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:05:57,842  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:05:57,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:05:57,883  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:05:57,883  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=53, getTable_(GetTableRequest)=14}
2024-04-23T21:05:57,883  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91); Time taken: 0.068 seconds
2024-04-23T21:05:57,884  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210557_019481d0-680c-4cac-80f9-75dcd8066a91
2024-04-23T21:05:57,888  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:05:57,896  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:05:57,896  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:05:57,897  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeCase" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="5.302"/>
  <testcase name="testSetClauseFakeColumn" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.751"/>
  <testcase name="testBadOnClause" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.444"/>
  <testcase name="testSimpleAcidInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="9.346"/>
  <testcase name="testTxnStatsOnOff" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="6.834"/>
  <testcase name="testMergeUpdateDeleteNoCardCheck" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.908">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:06:22,678  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:06:22,678  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:06:22,678  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:06:22,678  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:06:22,678  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:06:22,678  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:06:22,678  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:06:22,679  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:06:22,679  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:06:22,679  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:06:22,679  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:06:22,685  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 7123eec9-5c71-4ef5-aedf-5b1e9b093c48
2024-04-23T21:06:22,694  INFO [main] SessionState: Hive Session ID = 7123eec9-5c71-4ef5-aedf-5b1e9b093c48
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:06:22,695  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:06:22,700  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7123eec9-5c71-4ef5-aedf-5b1e9b093c48
2024-04-23T21:06:22,703  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48
2024-04-23T21:06:22,705  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/_tmp_space.db
2024-04-23T21:06:22,706  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=7123eec9-5c71-4ef5-aedf-5b1e9b093c48, clientType=HIVECLI]
2024-04-23T21:06:22,706  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:06:22,707  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_685d4f78-4fb0-4162-a0f3-5a7c2f1e39ff): drop table if exists acidTbl
2024-04-23T21:06:22,715  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:06:22,715  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:06:22,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:22,722  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,722  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,722  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,722  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,722  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_685d4f78-4fb0-4162-a0f3-5a7c2f1e39ff); Time taken: 0.015 seconds
2024-04-23T21:06:22,723  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210622_685d4f78-4fb0-4162-a0f3-5a7c2f1e39ff
2024-04-23T21:06:22,723  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:22,723  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_685d4f78-4fb0-4162-a0f3-5a7c2f1e39ff): drop table if exists acidTbl
2024-04-23T21:06:22,723  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,723  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:22,727  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:22,727  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,727  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_685d4f78-4fb0-4162-a0f3-5a7c2f1e39ff); Time taken: 0.004 seconds
2024-04-23T21:06:22,727  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_685d4f78-4fb0-4162-a0f3-5a7c2f1e39ff
2024-04-23T21:06:22,734  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:06:22,743  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:22,744  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:06:22,745  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:06:22,745  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_a7cf0c52-e972-458a-ad50-b79534a37b0b): drop table if exists acidTblPart
2024-04-23T21:06:22,749  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:06:22,749  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:06:22,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:22,755  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,756  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,756  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,756  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=17, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1}
2024-04-23T21:06:22,756  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_a7cf0c52-e972-458a-ad50-b79534a37b0b); Time taken: 0.011 seconds
2024-04-23T21:06:22,756  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210622_a7cf0c52-e972-458a-ad50-b79534a37b0b
2024-04-23T21:06:22,756  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:22,756  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_a7cf0c52-e972-458a-ad50-b79534a37b0b): drop table if exists acidTblPart
2024-04-23T21:06:22,756  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,757  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:22,761  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:22,761  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,761  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_a7cf0c52-e972-458a-ad50-b79534a37b0b); Time taken: 0.005 seconds
2024-04-23T21:06:22,761  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_a7cf0c52-e972-458a-ad50-b79534a37b0b
2024-04-23T21:06:22,768  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:06:22,775  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:22,775  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:06:22,776  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:06:22,776  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_146e3ae4-c2b2-48b8-bb6c-7d74c3bcd3ee): drop table if exists acidTbl2
2024-04-23T21:06:22,779  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:06:22,779  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:06:22,780  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:06:22,783  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,783  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,783  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,783  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,783  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_146e3ae4-c2b2-48b8-bb6c-7d74c3bcd3ee); Time taken: 0.007 seconds
2024-04-23T21:06:22,783  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210622_146e3ae4-c2b2-48b8-bb6c-7d74c3bcd3ee
2024-04-23T21:06:22,783  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:22,783  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_146e3ae4-c2b2-48b8-bb6c-7d74c3bcd3ee): drop table if exists acidTbl2
2024-04-23T21:06:22,784  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:06:22,788  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:22,788  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,788  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_146e3ae4-c2b2-48b8-bb6c-7d74c3bcd3ee); Time taken: 0.005 seconds
2024-04-23T21:06:22,788  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_146e3ae4-c2b2-48b8-bb6c-7d74c3bcd3ee
2024-04-23T21:06:22,793  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:06:22,799  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:22,799  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:06:22,800  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:06:22,800  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_ca4e2d85-d02b-4105-a3ed-25f7fc0abc05): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:22,802  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:06:22,802  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:06:22,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:22,806  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,806  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,806  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,806  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:06:22,806  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_ca4e2d85-d02b-4105-a3ed-25f7fc0abc05); Time taken: 0.006 seconds
2024-04-23T21:06:22,807  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210622_ca4e2d85-d02b-4105-a3ed-25f7fc0abc05
2024-04-23T21:06:22,807  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:22,807  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_ca4e2d85-d02b-4105-a3ed-25f7fc0abc05): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:22,807  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:22,810  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:22,810  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,810  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_ca4e2d85-d02b-4105-a3ed-25f7fc0abc05); Time taken: 0.003 seconds
2024-04-23T21:06:22,810  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_ca4e2d85-d02b-4105-a3ed-25f7fc0abc05
2024-04-23T21:06:22,815  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:06:22,822  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:22,822  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:06:22,823  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:22,824  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_0059ba0c-100e-4daf-b137-b1feffb20c0f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:22,826  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:06:22,827  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:06:22,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:22,830  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,830  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,831  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,831  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3}
2024-04-23T21:06:22,831  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_0059ba0c-100e-4daf-b137-b1feffb20c0f); Time taken: 0.006 seconds
2024-04-23T21:06:22,831  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210622_0059ba0c-100e-4daf-b137-b1feffb20c0f
2024-04-23T21:06:22,831  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:22,831  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_0059ba0c-100e-4daf-b137-b1feffb20c0f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:22,831  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:22,834  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:22,835  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:06:22,835  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_0059ba0c-100e-4daf-b137-b1feffb20c0f); Time taken: 0.003 seconds
2024-04-23T21:06:22,835  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_0059ba0c-100e-4daf-b137-b1feffb20c0f
2024-04-23T21:06:22,840  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:06:22,845  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:22,845  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:06:22,846  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:06:22,846  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_e147022a-4593-48c2-ac68-195219ab27b6): drop table if exists nonAcidNonBucket
2024-04-23T21:06:22,848  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:06:22,849  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:06:22,849  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:22,852  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,852  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,852  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,852  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:06:22,853  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_e147022a-4593-48c2-ac68-195219ab27b6); Time taken: 0.006 seconds
2024-04-23T21:06:22,853  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210622_e147022a-4593-48c2-ac68-195219ab27b6
2024-04-23T21:06:22,853  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:22,853  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_e147022a-4593-48c2-ac68-195219ab27b6): drop table if exists nonAcidNonBucket
2024-04-23T21:06:22,853  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,853  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:22,856  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:22,856  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,857  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_e147022a-4593-48c2-ac68-195219ab27b6); Time taken: 0.003 seconds
2024-04-23T21:06:22,857  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_e147022a-4593-48c2-ac68-195219ab27b6
2024-04-23T21:06:22,862  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:06:22,867  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:22,867  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:06:22,868  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:22,868  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:22,871  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:06:22,871  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:06:22,872  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:22,872  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:22,878  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:06:22,879  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:22,881  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:22,881  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,881  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,881  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,881  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6}
2024-04-23T21:06:22,881  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe); Time taken: 0.013 seconds
2024-04-23T21:06:22,881  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe
2024-04-23T21:06:22,882  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe
2024-04-23T21:06:22,899  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:06:22,899  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:22,900  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:22,900  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,902  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931582, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:06:22,907  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:22,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:22,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:22,945  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe); Time taken: 0.044 seconds
2024-04-23T21:06:22,945  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_500a5f36-1265-4f05-b89b-984666738bfe
2024-04-23T21:06:22,949  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:06:22,955  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:22,955  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:06:22,956  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:22,956  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:22,967  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:06:22,968  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:06:22,970  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:22,970  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:22,974  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:06:22,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:22,976  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:22,976  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:22,976  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:22,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:22,977  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=11, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:06:22,977  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e); Time taken: 0.02 seconds
2024-04-23T21:06:22,977  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e
2024-04-23T21:06:22,977  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e
2024-04-23T21:06:22,993  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:06:22,993  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:22,994  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:22,994  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:22,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931582, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:06:23,001  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:06:23,017  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:23,017  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T21:06:23,017  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e); Time taken: 0.023 seconds
2024-04-23T21:06:23,017  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210622_3b4f1836-c67e-4df0-9fad-9ef3abede21e
2024-04-23T21:06:23,021  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:06:23,030  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:23,030  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:06:23,031  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,031  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,035  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:06:23,035  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:06:23,036  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:23,036  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:23,040  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:06:23,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:23,043  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:23,043  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:23,043  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:23,043  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:23,043  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:06:23,043  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa); Time taken: 0.012 seconds
2024-04-23T21:06:23,044  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa
2024-04-23T21:06:23,044  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa
2024-04-23T21:06:23,066  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:06:23,066  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:23,066  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,066  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:23,068  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931583, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, rawDataSize=0, numFiles=0, numFilesErasureCoded=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:23,074  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:06:23,098  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:23,098  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=30, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:23,098  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa); Time taken: 0.032 seconds
2024-04-23T21:06:23,098  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_a3c79ab0-1042-44b4-9d0f-d7d34964e1aa
2024-04-23T21:06:23,102  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:06:23,110  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:23,110  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:06:23,111  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,111  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,114  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:06:23,114  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:06:23,115  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:23,115  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:23,117  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:06:23,117  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:23,119  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:23,119  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:23,119  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:23,119  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:23,119  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getDatabase_(String)=2, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:23,120  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4); Time taken: 0.008 seconds
2024-04-23T21:06:23,120  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4
2024-04-23T21:06:23,120  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4
2024-04-23T21:06:23,134  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:06:23,134  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:23,134  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,134  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:23,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931583, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, bucketing_version=2, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:23,141  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:06:23,155  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:23,155  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T21:06:23,155  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4); Time taken: 0.021 seconds
2024-04-23T21:06:23,155  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_a25b3983-88cb-4d5e-abfc-697b3ddeb4c4
2024-04-23T21:06:23,159  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:06:23,165  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:23,165  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:06:23,165  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:23,166  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:23,168  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:06:23,169  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:06:23,169  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:23,169  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:23,172  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:06:23,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:23,174  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:23,174  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:23,174  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:23,174  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:23,174  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2}
2024-04-23T21:06:23,175  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251); Time taken: 0.008 seconds
2024-04-23T21:06:23,175  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251
2024-04-23T21:06:23,175  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251
2024-04-23T21:06:23,189  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:06:23,189  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:23,190  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:23,190  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:23,191  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/_tmp_space.db/f63cf8ea-8843-4347-aa5f-8683e3fe86c3
2024-04-23T21:06:23,194  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:23,194  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:23,195  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251); Time taken: 0.004 seconds
2024-04-23T21:06:23,195  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_c4bc6b0f-49aa-4be1-8324-ca0fc95c9251
2024-04-23T21:06:23,199  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:06:23,204  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:23,204  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:06:23,205  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,205  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,208  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:06:23,208  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:06:23,209  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:23,209  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:23,211  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:06:23,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:23,213  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:23,213  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:23,213  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:23,214  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:23,214  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2}
2024-04-23T21:06:23,214  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551); Time taken: 0.009 seconds
2024-04-23T21:06:23,214  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551
2024-04-23T21:06:23,215  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551
2024-04-23T21:06:23,231  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:06:23,232  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:23,232  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:23,232  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:23,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931583, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, totalSize=0, bucketing_version=2, transactional=false, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:23,239  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:06:23,253  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:23,253  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T21:06:23,253  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551); Time taken: 0.021 seconds
2024-04-23T21:06:23,253  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_59079802-248c-408f-9836-42d1dd2e8551
2024-04-23T21:06:23,257  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:06:23,265  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:23,265  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:06:23,267  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:06:23,267  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:06:23,271  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:06:23,271  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:06:23,272  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:23,272  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:23,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:23,311  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:23,311  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:06:23,311  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:23,311  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:23,311  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:23,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:23,320  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:23,320  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:06:23,320  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:06:23,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:23,419  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:23,419  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:23,419  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:23,420  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:23,424  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:23,424  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:23,424  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:23,427  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1
2024-04-23T21:06:23,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:23,432  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:23,436  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:06:23,441  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:06:23,441  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:06:23,442  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:06:23,442  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:06:23,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:23,462  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:06:23,463  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:06:23,463  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:06:23,463  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:23,463  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:23,463  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:06:23,464  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:23,464  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=55, getValidWriteIds_(List, String)=3, getAllTableConstraints_(AllTableConstraintsRequest)=28, getNotNullConstraints_(NotNullConstraintsRequest)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getCheckConstraints_(CheckConstraintsRequest)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:06:23,464  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.196 seconds
2024-04-23T21:06:23,464  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:23,464  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:23,486  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:06:23,486  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:06:23,486  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:06:23,486  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:23,486  INFO [main] ql.Driver: Query ID = alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
Total jobs = 1
2024-04-23T21:06:23,486  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:06:23,486  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:06:23,618  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:06:23,618  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:06:23,618  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:06:23,618  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:06:23,618  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:06:23,618  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:06:23,618  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:06:23,619  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:06:23,621  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:06:23,621  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:06:23,621  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-23_267_4985256169006115003-1/dummy_path
2024-04-23T21:06:23,631  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:06:23,632  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,33KB
2024-04-23T21:06:23,637  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:06:23,638  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,36KB
2024-04-23T21:06:23,639  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:23,643  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-23_267_4985256169006115003-1/-mr-10001
2024-04-23T21:06:23,647  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:23,655  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:06:23,660  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:06:23,661  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:06:23,661  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:06:23,661  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-23_267_4985256169006115003-1/dummy_path
2024-04-23T21:06:23,661  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:06:23,680  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:06:23,703  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1219330795_0013
2024-04-23T21:06:23,703  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:06:23,772  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:06:23,772  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:06:23,773  INFO [Thread-1078] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:23,773  INFO [Thread-1078] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:23,774  INFO [Thread-1078] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:06:23,775  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1219330795_0013_m_000000_0
2024-04-23T21:06:23,778  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:23,778  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-23_267_4985256169006115003-1/dummy_path/null:0+1
2024-04-23T21:06:23,781  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:06:23,781  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,33KB
2024-04-23T21:06:23,781  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:06:23,786  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:06:23,786  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:06:23,786  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:06:23,786  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:06:23,786  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:06:23,787  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:06:23,787  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:06:23,788  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:06:23,788  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:06:23,788  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:06:23,789  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:06:23,789  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:06:23,789  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:06:23,789  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:06:23,789  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:06:23,789  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:06:23,790  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:06:23,790  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:06:23,790  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T21:06:23,791  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:06:23,792  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T21:06:23,792  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-23T21:06:23,795  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:06:23,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:06:23,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:06:23,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T21:06:23,795  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T21:06:23,806  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:06:23,812  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1219330795_0013_m_000000_0 is done. And is in the process of committing
2024-04-23T21:06:23,813  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:06:23,813  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1219330795_0013_m_000000_0' done.
2024-04-23T21:06:23,813  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1219330795_0013_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=320205
		FILE: Number of bytes written=16301447
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1168637952
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5381
2024-04-23T21:06:23,814  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1219330795_0013_m_000000_0
2024-04-23T21:06:23,814  INFO [Thread-1078] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:06:23,815  INFO [Thread-1078] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:06:23,815  INFO [pool-66-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1219330795_0013_r_000000_0
2024-04-23T21:06:23,818  INFO [pool-66-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:23,818  INFO [pool-66-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5e5c9ccc
2024-04-23T21:06:23,818  WARN [pool-66-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:23,819  INFO [pool-66-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:23,819  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1219330795_0013_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:23,823  INFO [localfetcher#18] reduce.LocalFetcher: localfetcher#18 about to shuffle output of map attempt_local1219330795_0013_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:06:23,823  INFO [localfetcher#18] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1219330795_0013_m_000000_0
2024-04-23T21:06:23,823  INFO [localfetcher#18] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:06:23,823  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:23,824  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:23,824  INFO [pool-66-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:23,830  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:23,830  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:06:23,832  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:23,833  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:06:23,833  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:23,833  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:23,833  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:06:23,833  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:23,834  INFO [pool-66-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:23,834  INFO [pool-66-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,36KB
2024-04-23T21:06:23,835  INFO [pool-66-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:23,835  INFO [pool-66-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:23,835  INFO [pool-66-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:23,836  INFO [pool-66-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:23,836  INFO [pool-66-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1219330795_0013/job_local1219330795_0013.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@bc4f572
2024-04-23T21:06:23,837  INFO [pool-66-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_tmp.-ext-10000/000000_0
2024-04-23T21:06:23,837  INFO [pool-66-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T21:06:23,837  INFO [pool-66-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_tmp.-ext-10000/000000_0
2024-04-23T21:06:23,837  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:23,837  INFO [pool-66-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:06:23,845  INFO [pool-66-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:06:23,845  INFO [pool-66-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:23,845  INFO [pool-66-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:06:23,845  INFO [pool-66-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:23,845  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:23,853  INFO [pool-66-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.nonacidorctbl:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T21:06:23,853  INFO [pool-66-thread-1] mapred.Task: Task:attempt_local1219330795_0013_r_000000_0 is done. And is in the process of committing
2024-04-23T21:06:23,853  INFO [pool-66-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:23,853  INFO [pool-66-thread-1] mapred.Task: Task 'attempt_local1219330795_0013_r_000000_0' done.
2024-04-23T21:06:23,853  INFO [pool-66-thread-1] mapred.Task: Final Counters for attempt_local1219330795_0013_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=326788
		FILE: Number of bytes written=16301813
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1168637952
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:23,854  INFO [pool-66-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1219330795_0013_r_000000_0
2024-04-23T21:06:23,854  INFO [pool-66-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1219330795_0013_r_000001_0
2024-04-23T21:06:23,854  INFO [pool-66-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:23,854  INFO [pool-66-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@371228f4
2024-04-23T21:06:23,854  WARN [pool-66-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:23,855  INFO [pool-66-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:23,856  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1219330795_0013_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:23,858  INFO [localfetcher#19] reduce.LocalFetcher: localfetcher#19 about to shuffle output of map attempt_local1219330795_0013_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-23T21:06:23,858  INFO [localfetcher#19] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local1219330795_0013_m_000000_0
2024-04-23T21:06:23,858  INFO [localfetcher#19] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-23T21:06:23,859  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:23,859  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:23,859  INFO [pool-66-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:23,866  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:23,866  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T21:06:23,868  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:23,869  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-23T21:06:23,869  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:23,869  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:23,869  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T21:06:23,869  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:23,869  INFO [pool-66-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:23,870  INFO [pool-66-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,36KB
2024-04-23T21:06:23,871  INFO [pool-66-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:23,871  INFO [pool-66-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:23,871  INFO [pool-66-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:23,871  INFO [pool-66-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:23,871  INFO [pool-66-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1219330795_0013/job_local1219330795_0013.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1d910ca2
2024-04-23T21:06:23,872  INFO [pool-66-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_tmp.-ext-10000/000001_0
2024-04-23T21:06:23,872  INFO [pool-66-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T21:06:23,872  INFO [pool-66-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_tmp.-ext-10000/000001_0
2024-04-23T21:06:23,872  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:23,872  INFO [pool-66-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:06:23,879  INFO [pool-66-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:06:23,879  INFO [pool-66-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:23,879  INFO [pool-66-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:23,879  INFO [pool-66-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:23,879  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-23T21:06:23,887  INFO [pool-66-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:3, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.nonacidorctbl:3, TOTAL_TABLE_ROWS_WRITTEN:3, 
2024-04-23T21:06:23,887  INFO [pool-66-thread-1] mapred.Task: Task:attempt_local1219330795_0013_r_000001_0 is done. And is in the process of committing
2024-04-23T21:06:23,888  INFO [pool-66-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:23,888  INFO [pool-66-thread-1] mapred.Task: Task 'attempt_local1219330795_0013_r_000001_0' done.
2024-04-23T21:06:23,888  INFO [pool-66-thread-1] mapred.Task: Final Counters for attempt_local1219330795_0013_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=333383
		FILE: Number of bytes written=16302232
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1168637952
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:23,888  INFO [pool-66-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1219330795_0013_r_000001_0
2024-04-23T21:06:23,888  INFO [Thread-1078] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:06:24,776 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:06:24,776  INFO [main] exec.Task: 2024-04-23 21:06:24,776 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1219330795_0013
2024-04-23T21:06:24,777  INFO [main] exec.Task: Ended Job = job_local1219330795_0013
2024-04-23T21:06:24,779  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-23T21:06:24,780  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1/-ext-10000
2024-04-23T21:06:24,780  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:24,790  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:24,790  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:24,800  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:24,802  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T21:06:24,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T21:06:24,832  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:06:24,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:24,841  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:24,842  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:06:24,842  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-23_267_4985256169006115003-1/-mr-10001
2024-04-23T21:06:24,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:24,852  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:24,853  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-23T21:06:24,853  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-23T21:06:24,853  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T21:06:24,853  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T21:06:24,877  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-23T21:06:24,878  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:24,878  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=38, isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=54}
MapReduce Jobs Launched: 
2024-04-23T21:06:24,878  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:06:24,878  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:24,879  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:24,879  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 1.392 seconds
2024-04-23T21:06:24,879  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:24,882  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:06:24,887  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:24,888  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:06:24,888  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:06:24,888  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1
2024-04-23T21:06:24,889  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-23_267_4985256169006115003-1 on fs with scheme file
2024-04-23T21:06:24,889  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-23_267_4985256169006115003-1
2024-04-23T21:06:24,889  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-23_267_4985256169006115003-1 on fs with scheme file
2024-04-23T21:06:24,890  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:06:24,892  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:06:24,893  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:06:24,893  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:24,893  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:24,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:24,902  INFO [main] metastore.ObjectStore: Removed COLUMN_STATS_ACCURATE from Table's parameters.
2024-04-23T21:06:24,903  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:24,904  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:06:24,904  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:24,904  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:24,904  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:24,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:24,910  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:24,910  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:06:24,911  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:06:24,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:24,983  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:24,983  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:24,983  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:24,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:24,986  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:24,986  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:24,986  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:24,988  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:06:24,989  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:06:24,997  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-23T21:06:24,997  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T21:06:24,998  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:06:25,002  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:06:25,002  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:06:25,003  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:06:25,003  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:06:25,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:25,019  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:06:25,020  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:06:25,021  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:06:25,021  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:25,021  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:25,021  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:06:25,021  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:25,021  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, getAllTableConstraints_(AllTableConstraintsRequest)=6, flushCache_()=0, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=20, allocateTableWriteId_(long, String, String)=7, getValidTxns_(long)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, openTxn_(String, TxnType)=3, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T21:06:25,021  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.131 seconds
2024-04-23T21:06:25,022  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:25,022  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:25,039  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:06:25,039  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:06:25,042  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:06:25,042  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:25,042  INFO [main] ql.Driver: Query ID = alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
Total jobs = 1
2024-04-23T21:06:25,042  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:06:25,042  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:06:25,167  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:06:25,167  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:06:25,167  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:06:25,167  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:06:25,167  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:06:25,167  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:06:25,167  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:06:25,167  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:06:25,169  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:06:25,170  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:06:25,170  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-24_890_3302105275462075580-1/dummy_path
2024-04-23T21:06:25,179  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:06:25,180  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:06:25,185  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:06:25,185  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:06:25,186  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:25,190  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-24_890_3302105275462075580-1/-mr-10000
2024-04-23T21:06:25,192  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:25,199  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:06:25,203  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:06:25,204  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:06:25,204  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:06:25,204  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-24_890_3302105275462075580-1/dummy_path
2024-04-23T21:06:25,204  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:06:25,229  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:06:25,250  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local334210427_0014
2024-04-23T21:06:25,250  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:06:25,312  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:06:25,312  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:06:25,313  INFO [Thread-1141] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:25,313  INFO [Thread-1141] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:25,314  INFO [Thread-1141] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:06:25,314  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local334210427_0014_m_000000_0
2024-04-23T21:06:25,315  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:25,315  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-24_890_3302105275462075580-1/dummy_path/null:0+1
2024-04-23T21:06:25,316  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:06:25,316  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:06:25,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:06:25,321  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:06:25,321  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:06:25,321  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:06:25,321  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:06:25,321  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:06:25,321  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:06:25,322  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:06:25,322  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:06:25,323  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:06:25,324  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:06:25,324  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:06:25,324  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:06:25,324  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:06:25,324  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:06:25,324  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T21:06:25,325  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T21:06:25,326  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:06:25,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:06:25,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:06:25,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T21:06:25,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T21:06:25,337  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:06:25,340  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local334210427_0014_m_000000_0 is done. And is in the process of committing
2024-04-23T21:06:25,340  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:06:25,340  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local334210427_0014_m_000000_0' done.
2024-04-23T21:06:25,340  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local334210427_0014_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=339375
		FILE: Number of bytes written=17554704
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1168113664
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5401
2024-04-23T21:06:25,340  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local334210427_0014_m_000000_0
2024-04-23T21:06:25,340  INFO [Thread-1141] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:06:25,342  INFO [Thread-1141] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:06:25,342  INFO [pool-71-thread-1] mapred.LocalJobRunner: Starting task: attempt_local334210427_0014_r_000000_0
2024-04-23T21:06:25,342  INFO [pool-71-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:25,342  INFO [pool-71-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4ea6759d
2024-04-23T21:06:25,342  WARN [pool-71-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:25,344  INFO [pool-71-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:25,344  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local334210427_0014_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:25,345  INFO [localfetcher#20] reduce.LocalFetcher: localfetcher#20 about to shuffle output of map attempt_local334210427_0014_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:06:25,345  INFO [localfetcher#20] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local334210427_0014_m_000000_0
2024-04-23T21:06:25,345  INFO [localfetcher#20] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:06:25,346  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:25,346  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:25,347  INFO [pool-71-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:25,353  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:25,353  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:25,356  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:25,356  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:06:25,356  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:25,356  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:25,356  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:25,356  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:25,357  INFO [pool-71-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:25,357  INFO [pool-71-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:06:25,358  INFO [pool-71-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:25,359  INFO [pool-71-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:25,359  INFO [pool-71-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:25,359  INFO [pool-71-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:25,359  INFO [pool-71-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local334210427_0014/job_local334210427_0014.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1f0ebf2c
2024-04-23T21:06:25,360  INFO [pool-71-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:25,360  INFO [pool-71-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:25,360  INFO [pool-71-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:06:25,360  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:25,361  INFO [pool-71-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:06:25,367  INFO [pool-71-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:06:25,372  INFO [pool-71-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:25,372  INFO [pool-71-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:06:25,372  INFO [pool-71-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:25,372  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:06:25,374  INFO [pool-71-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:06:25,385  INFO [pool-71-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T21:06:25,385  INFO [pool-71-thread-1] mapred.Task: Task:attempt_local334210427_0014_r_000000_0 is done. And is in the process of committing
2024-04-23T21:06:25,386  INFO [pool-71-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:25,386  INFO [pool-71-thread-1] mapred.Task: Task 'attempt_local334210427_0014_r_000000_0' done.
2024-04-23T21:06:25,386  INFO [pool-71-thread-1] mapred.Task: Final Counters for attempt_local334210427_0014_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=345579
		FILE: Number of bytes written=17555773
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1168113664
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:25,386  INFO [pool-71-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local334210427_0014_r_000000_0
2024-04-23T21:06:25,386  INFO [pool-71-thread-1] mapred.LocalJobRunner: Starting task: attempt_local334210427_0014_r_000001_0
2024-04-23T21:06:25,386  INFO [pool-71-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:25,386  INFO [pool-71-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@132be280
2024-04-23T21:06:25,386  WARN [pool-71-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:25,387  INFO [pool-71-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:25,388  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local334210427_0014_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:25,390  INFO [localfetcher#21] reduce.LocalFetcher: localfetcher#21 about to shuffle output of map attempt_local334210427_0014_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:06:25,391  INFO [localfetcher#21] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local334210427_0014_m_000000_0
2024-04-23T21:06:25,391  INFO [localfetcher#21] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:06:25,391  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:25,391  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:25,391  INFO [pool-71-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:25,397  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:25,397  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:25,400  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:25,400  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:06:25,400  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:25,400  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:25,400  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:25,400  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:25,401  INFO [pool-71-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:25,401  INFO [pool-71-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:06:25,402  INFO [pool-71-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:25,402  INFO [pool-71-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:25,402  INFO [pool-71-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:25,403  INFO [pool-71-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:25,403  INFO [pool-71-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local334210427_0014/job_local334210427_0014.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@196b38e7
2024-04-23T21:06:25,403  INFO [pool-71-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:25,403  INFO [pool-71-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:25,403  INFO [pool-71-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:06:25,404  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:25,404  INFO [pool-71-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:06:25,409  INFO [pool-71-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:06:25,409  INFO [pool-71-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:25,409  INFO [pool-71-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:06:25,409  INFO [pool-71-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:25,409  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:06:25,412  INFO [pool-71-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:06:25,421  INFO [pool-71-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T21:06:25,422  INFO [pool-71-thread-1] mapred.Task: Task:attempt_local334210427_0014_r_000001_0 is done. And is in the process of committing
2024-04-23T21:06:25,422  INFO [pool-71-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:25,422  INFO [pool-71-thread-1] mapred.Task: Task 'attempt_local334210427_0014_r_000001_0' done.
2024-04-23T21:06:25,422  INFO [pool-71-thread-1] mapred.Task: Final Counters for attempt_local334210427_0014_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=351741
		FILE: Number of bytes written=17556843
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1168113664
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:25,422  INFO [pool-71-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local334210427_0014_r_000001_0
2024-04-23T21:06:25,422  INFO [Thread-1141] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:06:26,314 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:06:26,314  INFO [main] exec.Task: 2024-04-23 21:06:26,314 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local334210427_0014
2024-04-23T21:06:26,315  INFO [main] exec.Task: Ended Job = job_local334210427_0014
2024-04-23T21:06:26,316  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:06:26,316  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:06:26,316  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:06:26,316  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:06:26,316  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:06:26,318  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:06:26,318  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:26,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,325  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,335  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,336  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:06:26,367  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:06:26,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,377  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,377  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:06:26,377  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-24_890_3302105275462075580-1/-mr-10000
2024-04-23T21:06:26,379  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,390  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,402  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:06:26,402  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T21:06:26,402  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:06:26,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:06:26,433  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T21:06:26,433  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:06:26,433  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:06:26,436  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:06:26,437  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:26,437  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=39, alter_table_(String, String, String, Table, EnvironmentContext, String)=61}
MapReduce Jobs Launched: 
2024-04-23T21:06:26,437  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:06:26,437  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:26,437  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:26,437  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 1.395 seconds
2024-04-23T21:06:26,437  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:26,447  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:26,448  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:06:26,448  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE 
2024-04-23T21:06:26,448  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-24_890_3302105275462075580-1
2024-04-23T21:06:26,449  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-24_890_3302105275462075580-1 on fs with scheme file
2024-04-23T21:06:26,449  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE 
2024-04-23T21:06:26,452  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:06:26,452  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:06:26,453  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:26,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:26,460  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,461  INFO [main] parse.RewriteSemanticAnalyzer: Merge statement cardinality violation check is disabled: hive.merge.cardinality.check
2024-04-23T21:06:26,461  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE > as 
<FROM
  `default`.`acidTbl` `t`
  INNER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `t`.`a` > 3 and `t`.`a` < 5 AND NOT(`s`.`a` < 3)
 SORT BY `t`.ROW__ID 
>
2024-04-23T21:06:26,463  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:06:26,466  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:06:26,466  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:26,467  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,472  INFO [main] metastore.ObjectStore: Removed COLUMN_STATS_ACCURATE from Table's parameters.
2024-04-23T21:06:26,474  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,475  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:26,484  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,484  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:26,484  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:26,485  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:06:26,485  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:06:26,486  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:26,486  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:26,486  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:26,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,504  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:26,551  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:06:26,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,566  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,567  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:26,580  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,580  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:06:26,590  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:06:26,590  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:06:26,591  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:06:26,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:26,604  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,604  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:26,622  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,623  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T21:06:26,639  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a
No Stats for default@nonacidorctbl, Columns: a
2024-04-23T21:06:26,640  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a
2024-04-23T21:06:26,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:26,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:26,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:26,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:26,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:26,861  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:26,861  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:26,861  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:26,861  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:26,861  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:26,861  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:26,861  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:26,870 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:06:26,872 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:06:26,872  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:06:26,872 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:06:26,872  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:26,872  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=12, getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=25, getTableColumnStatistics_(String, String, List, String)=87, openTxn_(String, TxnType)=2}
2024-04-23T21:06:26,873  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.423 seconds
2024-04-23T21:06:26,873  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:26,876  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:26,883  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:06:26,883  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7123eec9-5c71-4ef5-aedf-5b1e9b093c48/hive_2024-04-23_21-06-26_461_4750679580279252418-1
2024-04-23T21:06:26,883  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists acidTbl
2024-04-23T21:06:26,886  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T21:06:26,886  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:06:26,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:26,893  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,893  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:26,893  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:26,893  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:26,893  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=10, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T21:06:26,893  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.01 seconds
2024-04-23T21:06:26,893  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:26,894  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:26,907  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:06:26,907  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:26,907  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists acidTbl
2024-04-23T21:06:26,907  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:26,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:26,914  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:26,920  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:26,920  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:27,020  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:27,021  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=106, isCompatibleWith_(Configuration)=1}
2024-04-23T21:06:27,021  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.113 seconds
2024-04-23T21:06:27,021  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,025  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:06:27,032  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:27,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:06:27,035  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:06:27,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists acidTblPart
2024-04-23T21:06:27,045  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T21:06:27,045  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:06:27,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:27,060  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,060  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:27,061  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:27,061  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:27,061  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=13, openTxn_(String, TxnType)=9, getValidTxns_(long)=2}
2024-04-23T21:06:27,061  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.026 seconds
2024-04-23T21:06:27,061  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,062  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,082  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:06:27,082  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:27,082  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists acidTblPart
2024-04-23T21:06:27,082  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:27,082  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:27,089  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:27,096  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:27,143  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:27,143  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=53, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:06:27,143  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.061 seconds
2024-04-23T21:06:27,143  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,147  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:06:27,153  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:27,153  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:06:27,154  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:06:27,154  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists acidTbl2
2024-04-23T21:06:27,157  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T21:06:27,157  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:06:27,158  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:27,158  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:27,158  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:27,158  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, getTable_(GetTableRequest)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:06:27,158  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.004 seconds
2024-04-23T21:06:27,158  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,158  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:27,158  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists acidTbl2
2024-04-23T21:06:27,159  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:27,159  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:06:27,160  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:27,160  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T21:06:27,160  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.002 seconds
2024-04-23T21:06:27,160  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,165  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:06:27,171  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:27,171  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:06:27,172  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:06:27,172  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:27,175  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T21:06:27,175  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:06:27,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:27,197  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,197  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:27,197  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:27,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:27,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=21, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=1}
2024-04-23T21:06:27,197  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.025 seconds
2024-04-23T21:06:27,198  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,198  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,214  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:06:27,214  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:27,214  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:27,214  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:27,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:27,232  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:27,242  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:27,306  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:27,307  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=19, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=73}
2024-04-23T21:06:27,307  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.092 seconds
2024-04-23T21:06:27,307  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,311  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:06:27,317  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:27,317  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:06:27,318  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:27,318  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:27,320  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T21:06:27,321  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:06:27,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:27,330  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,330  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:27,330  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:27,330  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:27,330  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:06:27,331  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.012 seconds
2024-04-23T21:06:27,331  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,331  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,347  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:06:27,347  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:27,347  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:27,347  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:27,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:27,356  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:27,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:27,397  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:27,397  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=9}
2024-04-23T21:06:27,397  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.05 seconds
2024-04-23T21:06:27,397  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,401  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:06:27,407  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:27,408  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:06:27,408  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:06:27,408  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists nonAcidNonBucket
2024-04-23T21:06:27,411  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T21:06:27,411  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:06:27,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:27,421  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,421  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:27,421  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:27,421  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:27,422  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0}
2024-04-23T21:06:27,422  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.013 seconds
2024-04-23T21:06:27,422  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,423  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,438  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:06:27,438  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:27,438  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996): drop table if exists nonAcidNonBucket
2024-04-23T21:06:27,438  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:27,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:27,447  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:27,456  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:27,456  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:27,489  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:27,489  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=42}
2024-04-23T21:06:27,489  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210623_01063f0f-9253-4824-8665-84422b251996); Time taken: 0.051 seconds
2024-04-23T21:06:27,489  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210623_01063f0f-9253-4824-8665-84422b251996
2024-04-23T21:06:27,494  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:06:27,501  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:27,501  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:06:27,501  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testNonAcidToAcidConversion01" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="15.097"/>
  <testcase name="testMoreBucketsThanReducers2" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="0">
    <skipped message="Moved to Tez"/>
  </testcase>
  <testcase name="testMergeDeleteUpdate" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="5.128">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:06:42,669  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:06:42,669  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:06:42,669  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:06:42,669  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:06:42,670  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:06:42,670  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:06:42,670  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:06:42,670  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:06:42,670  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:06:42,670  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:06:42,670  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:06:42,673  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = cef1276b-cb50-4a16-84f8-e9eab3cf3995
2024-04-23T21:06:42,677  INFO [main] SessionState: Hive Session ID = cef1276b-cb50-4a16-84f8-e9eab3cf3995
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:06:42,678  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:06:42,690  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/cef1276b-cb50-4a16-84f8-e9eab3cf3995
2024-04-23T21:06:42,692  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995
2024-04-23T21:06:42,695  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/cef1276b-cb50-4a16-84f8-e9eab3cf3995/_tmp_space.db
2024-04-23T21:06:42,696  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=cef1276b-cb50-4a16-84f8-e9eab3cf3995, clientType=HIVECLI]
2024-04-23T21:06:42,696  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:06:42,696  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_824389f5-953f-4116-a7f8-b515d8e07c59): drop table if exists acidTbl
2024-04-23T21:06:42,709  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:06:42,710  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:06:42,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:42,719  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,719  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,719  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,719  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=13, commitTxn_(CommitTxnRequest)=17, getValidTxns_(long)=4}
2024-04-23T21:06:42,720  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_824389f5-953f-4116-a7f8-b515d8e07c59); Time taken: 0.023 seconds
2024-04-23T21:06:42,720  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210642_824389f5-953f-4116-a7f8-b515d8e07c59
2024-04-23T21:06:42,720  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:42,720  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_824389f5-953f-4116-a7f8-b515d8e07c59): drop table if exists acidTbl
2024-04-23T21:06:42,720  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:42,721  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:42,725  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:42,726  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,726  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_824389f5-953f-4116-a7f8-b515d8e07c59); Time taken: 0.005 seconds
2024-04-23T21:06:42,726  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_824389f5-953f-4116-a7f8-b515d8e07c59
2024-04-23T21:06:42,735  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:06:42,742  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:42,743  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:06:42,743  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:06:42,743  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_17571831-0b6d-4226-a5e8-8e64595aed06): drop table if exists acidTblPart
2024-04-23T21:06:42,746  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:06:42,747  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:06:42,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:42,751  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,751  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,751  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,751  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=17}
2024-04-23T21:06:42,752  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_17571831-0b6d-4226-a5e8-8e64595aed06); Time taken: 0.008 seconds
2024-04-23T21:06:42,752  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210642_17571831-0b6d-4226-a5e8-8e64595aed06
2024-04-23T21:06:42,752  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:42,752  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_17571831-0b6d-4226-a5e8-8e64595aed06): drop table if exists acidTblPart
2024-04-23T21:06:42,752  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:42,752  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:42,757  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:42,757  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,757  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_17571831-0b6d-4226-a5e8-8e64595aed06); Time taken: 0.004 seconds
2024-04-23T21:06:42,757  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_17571831-0b6d-4226-a5e8-8e64595aed06
2024-04-23T21:06:42,763  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:06:42,771  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:42,771  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:06:42,772  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:06:42,772  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_667d4a49-fe06-47b4-9f05-dd0ed22cd26d): drop table if exists acidTbl2
2024-04-23T21:06:42,775  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:06:42,776  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:06:42,776  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:06:42,780  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,780  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,780  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,780  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:06:42,780  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_667d4a49-fe06-47b4-9f05-dd0ed22cd26d); Time taken: 0.008 seconds
2024-04-23T21:06:42,781  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210642_667d4a49-fe06-47b4-9f05-dd0ed22cd26d
2024-04-23T21:06:42,781  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:42,781  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_667d4a49-fe06-47b4-9f05-dd0ed22cd26d): drop table if exists acidTbl2
2024-04-23T21:06:42,781  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:42,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:06:42,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:42,785  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,785  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_667d4a49-fe06-47b4-9f05-dd0ed22cd26d); Time taken: 0.004 seconds
2024-04-23T21:06:42,785  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_667d4a49-fe06-47b4-9f05-dd0ed22cd26d
2024-04-23T21:06:42,791  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:06:42,798  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:42,799  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:06:42,799  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:06:42,799  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_8a1f2f01-cd52-4915-b463-9cea2ea5172c): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:42,802  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:06:42,802  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:06:42,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:42,806  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,806  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,806  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,806  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,806  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_8a1f2f01-cd52-4915-b463-9cea2ea5172c); Time taken: 0.007 seconds
2024-04-23T21:06:42,806  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210642_8a1f2f01-cd52-4915-b463-9cea2ea5172c
2024-04-23T21:06:42,806  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:42,806  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_8a1f2f01-cd52-4915-b463-9cea2ea5172c): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:42,807  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:42,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:42,810  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:42,810  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,810  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_8a1f2f01-cd52-4915-b463-9cea2ea5172c); Time taken: 0.004 seconds
2024-04-23T21:06:42,810  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_8a1f2f01-cd52-4915-b463-9cea2ea5172c
2024-04-23T21:06:42,816  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:06:42,824  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:42,824  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:06:42,825  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:42,825  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_f07d5267-064a-4bf0-a141-ce898b8a8e6d): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:42,828  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:06:42,828  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:06:42,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:42,832  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,832  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,832  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,832  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,833  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_f07d5267-064a-4bf0-a141-ce898b8a8e6d); Time taken: 0.007 seconds
2024-04-23T21:06:42,833  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210642_f07d5267-064a-4bf0-a141-ce898b8a8e6d
2024-04-23T21:06:42,833  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:42,833  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_f07d5267-064a-4bf0-a141-ce898b8a8e6d): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:42,833  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:42,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:42,837  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:42,837  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,837  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_f07d5267-064a-4bf0-a141-ce898b8a8e6d); Time taken: 0.004 seconds
2024-04-23T21:06:42,837  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_f07d5267-064a-4bf0-a141-ce898b8a8e6d
2024-04-23T21:06:42,843  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:06:42,852  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:42,853  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:06:42,853  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:06:42,853  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_6ad6ac16-d4a8-4086-af12-a5e5b9f9d160): drop table if exists nonAcidNonBucket
2024-04-23T21:06:42,856  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:06:42,856  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:06:42,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:42,860  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,861  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:06:42,861  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_6ad6ac16-d4a8-4086-af12-a5e5b9f9d160); Time taken: 0.008 seconds
2024-04-23T21:06:42,861  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210642_6ad6ac16-d4a8-4086-af12-a5e5b9f9d160
2024-04-23T21:06:42,861  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:42,861  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_6ad6ac16-d4a8-4086-af12-a5e5b9f9d160): drop table if exists nonAcidNonBucket
2024-04-23T21:06:42,861  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:42,862  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:42,865  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:42,865  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:06:42,865  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_6ad6ac16-d4a8-4086-af12-a5e5b9f9d160); Time taken: 0.004 seconds
2024-04-23T21:06:42,865  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_6ad6ac16-d4a8-4086-af12-a5e5b9f9d160
2024-04-23T21:06:42,872  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:06:42,879  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:42,880  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:06:42,880  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:42,880  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:42,883  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:06:42,883  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:06:42,884  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:42,884  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:42,891  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:06:42,891  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:42,893  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:42,893  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,893  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,893  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,893  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=7, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,894  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b); Time taken: 0.013 seconds
2024-04-23T21:06:42,894  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b
2024-04-23T21:06:42,894  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b
2024-04-23T21:06:42,915  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:06:42,915  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:42,916  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:42,916  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:42,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931602, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, bucketing_version=2, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=true, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:06:42,924  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:42,967  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:42,967  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=49}
2024-04-23T21:06:42,967  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b); Time taken: 0.051 seconds
2024-04-23T21:06:42,967  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_9fd078a1-8e90-4de9-a25a-792fe383017b
2024-04-23T21:06:42,972  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:06:42,980  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:42,980  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:06:42,980  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:42,981  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:42,983  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:06:42,984  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:06:42,984  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:42,984  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:42,988  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:06:42,988  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:42,990  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:42,990  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:42,990  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:42,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:42,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:42,991  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553); Time taken: 0.009 seconds
2024-04-23T21:06:42,991  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553
2024-04-23T21:06:42,991  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553
2024-04-23T21:06:43,008  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:06:43,008  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:43,009  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:43,009  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:43,010  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931603, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:06:43,016  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:06:43,032  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:43,032  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T21:06:43,032  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553); Time taken: 0.023 seconds
2024-04-23T21:06:43,032  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210642_1a5257bc-bed4-43f8-bf67-414483d0d553
2024-04-23T21:06:43,037  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:06:43,044  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:43,044  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:06:43,045  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,045  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,048  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:06:43,048  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:06:43,048  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:43,048  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:43,051  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:06:43,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:43,054  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:43,054  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:43,054  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:43,054  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:43,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:06:43,054  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f); Time taken: 0.009 seconds
2024-04-23T21:06:43,055  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f
2024-04-23T21:06:43,055  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f
2024-04-23T21:06:43,071  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:06:43,071  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:43,071  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,071  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:43,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931603, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:43,077  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:06:43,097  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:43,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-23T21:06:43,097  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f); Time taken: 0.025 seconds
2024-04-23T21:06:43,097  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210643_b25ab5d8-2651-4ed1-b2e3-38d87e47af9f
2024-04-23T21:06:43,101  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:06:43,108  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:43,108  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:06:43,109  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,109  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,112  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:06:43,112  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:06:43,113  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:43,113  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:43,115  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:06:43,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:43,117  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:43,117  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:43,117  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:43,117  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:43,118  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:06:43,118  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111); Time taken: 0.008 seconds
2024-04-23T21:06:43,118  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111
2024-04-23T21:06:43,118  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111
2024-04-23T21:06:43,137  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:06:43,137  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:43,137  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,137  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:43,138  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931603, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numRows=0, bucketing_version=2, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:43,146  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:06:43,161  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:43,161  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:43,161  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111); Time taken: 0.024 seconds
2024-04-23T21:06:43,161  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210643_a9f2ca0e-c2fe-46d2-af63-ec84057ce111
2024-04-23T21:06:43,166  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:06:43,173  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:43,173  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:06:43,174  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:43,174  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:43,177  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:06:43,177  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:06:43,177  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:43,178  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:43,180  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:06:43,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:43,183  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:43,183  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:43,183  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:43,183  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:43,183  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:43,183  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f); Time taken: 0.009 seconds
2024-04-23T21:06:43,184  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f
2024-04-23T21:06:43,184  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f
2024-04-23T21:06:43,199  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:06:43,199  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:43,199  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:43,200  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:43,201  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/cef1276b-cb50-4a16-84f8-e9eab3cf3995/_tmp_space.db/7b9baac1-df18-4371-9ab3-b23630bf5e3c
2024-04-23T21:06:43,204  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:43,204  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=2}
2024-04-23T21:06:43,204  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f); Time taken: 0.005 seconds
2024-04-23T21:06:43,204  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210643_d4a4f3b8-7b4c-4fe2-8ee2-e61c68127e6f
2024-04-23T21:06:43,209  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:06:43,215  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:43,215  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:06:43,216  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,216  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,219  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:06:43,219  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:06:43,220  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:43,220  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:43,222  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:06:43,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:43,224  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:43,224  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:43,224  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:43,225  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:43,225  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:06:43,225  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573); Time taken: 0.008 seconds
2024-04-23T21:06:43,225  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573
2024-04-23T21:06:43,225  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573
2024-04-23T21:06:43,241  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:06:43,241  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:43,241  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:43,242  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:43,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931603, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numRows=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:43,249  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:06:43,268  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:43,268  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=25, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:43,268  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573); Time taken: 0.027 seconds
2024-04-23T21:06:43,268  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210643_39dcf1a5-2fac-4e71-9f1c-290dc1afd573
2024-04-23T21:06:43,273  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:06:43,280  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:43,280  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:06:43,280  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:06:43,281  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:06:43,284  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:06:43,284  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:06:43,285  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:43,285  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:43,288  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:43,327  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:43,327  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:06:43,327  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:43,327  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:43,327  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:43,327  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:43,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:43,337  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:06:43,337  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:06:43,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:43,439  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:43,439  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:43,439  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:43,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:43,442  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:43,442  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:43,442  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:43,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:43,451  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:43,453  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1
2024-04-23T21:06:43,456  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:43,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:43,459  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:06:43,462  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:06:43,462  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:06:43,463  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:06:43,464  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:06:43,473  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:43,482  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:06:43,483  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:06:43,484  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:06:43,484  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:06:43,484  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:43,484  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:43,484  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:06:43,484  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:43,484  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=67, getAllTableConstraints_(AllTableConstraintsRequest)=29, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-23T21:06:43,484  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410); Time taken: 0.203 seconds
2024-04-23T21:06:43,485  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410
2024-04-23T21:06:43,485  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410
2024-04-23T21:06:43,507  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:06:43,507  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:06:43,507  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T21:06:43,507  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410
2024-04-23T21:06:43,507  INFO [main] ql.Driver: Query ID = alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410
Total jobs = 1
2024-04-23T21:06:43,507  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:06:43,508  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:06:43,643  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:06:43,643  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:06:43,643  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:06:43,643  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:06:43,643  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:06:43,643  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:06:43,643  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:06:43,644  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:06:43,646  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:06:43,646  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:06:43,646  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-43_281_7316031584963650461-1/dummy_path
2024-04-23T21:06:43,656  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:06:43,657  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,33KB
2024-04-23T21:06:43,662  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:06:43,663  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,36KB
2024-04-23T21:06:43,664  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:43,668  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-43_281_7316031584963650461-1/-mr-10001
2024-04-23T21:06:43,672  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:43,680  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:06:43,684  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:06:43,686  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:06:43,686  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:06:43,686  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-43_281_7316031584963650461-1/dummy_path
2024-04-23T21:06:43,686  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:06:43,704  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:06:43,731  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1866818437_0021
2024-04-23T21:06:43,731  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:06:43,813  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:06:43,814  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:06:43,814  INFO [Thread-1673] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:43,814  INFO [Thread-1673] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:43,816  INFO [Thread-1673] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:06:43,816  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1866818437_0021_m_000000_0
2024-04-23T21:06:43,819  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:43,819  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-43_281_7316031584963650461-1/dummy_path/null:0+1
2024-04-23T21:06:43,821  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:06:43,822  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,33KB
2024-04-23T21:06:43,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:06:43,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:06:43,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:06:43,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:06:43,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:06:43,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:06:43,828  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:06:43,828  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:06:43,828  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:06:43,829  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:06:43,830  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:06:43,830  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:06:43,830  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:06:43,830  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T21:06:43,831  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T21:06:43,834  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:06:43,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:06:43,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:06:43,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T21:06:43,834  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T21:06:43,844  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:06:43,849  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1866818437_0021_m_000000_0 is done. And is in the process of committing
2024-04-23T21:06:43,850  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:06:43,850  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1866818437_0021_m_000000_0' done.
2024-04-23T21:06:43,850  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1866818437_0021_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=481940
		FILE: Number of bytes written=26338639
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5381
2024-04-23T21:06:43,850  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1866818437_0021_m_000000_0
2024-04-23T21:06:43,850  INFO [Thread-1673] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:06:43,851  INFO [Thread-1673] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:06:43,851  INFO [pool-102-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1866818437_0021_r_000000_0
2024-04-23T21:06:43,854  INFO [pool-102-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:43,854  INFO [pool-102-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7be720a3
2024-04-23T21:06:43,854  WARN [pool-102-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:43,855  INFO [pool-102-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:43,855  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1866818437_0021_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:43,858  INFO [localfetcher#30] reduce.LocalFetcher: localfetcher#30 about to shuffle output of map attempt_local1866818437_0021_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:06:43,858  INFO [localfetcher#30] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1866818437_0021_m_000000_0
2024-04-23T21:06:43,858  INFO [localfetcher#30] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:06:43,858  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:43,859  INFO [pool-102-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:43,859  INFO [pool-102-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:43,865  INFO [pool-102-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:43,865  INFO [pool-102-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:06:43,867  INFO [pool-102-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:43,868  INFO [pool-102-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:06:43,868  INFO [pool-102-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:43,868  INFO [pool-102-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:43,868  INFO [pool-102-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:06:43,868  INFO [pool-102-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:43,868  INFO [pool-102-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:43,869  INFO [pool-102-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,36KB
2024-04-23T21:06:43,870  INFO [pool-102-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:43,870  INFO [pool-102-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:43,870  INFO [pool-102-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:43,870  INFO [pool-102-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:43,871  INFO [pool-102-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1866818437_0021/job_local1866818437_0021.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1ae43aec
2024-04-23T21:06:43,871  INFO [pool-102-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_tmp.-ext-10000/000000_0
2024-04-23T21:06:43,871  INFO [pool-102-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T21:06:43,871  INFO [pool-102-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_tmp.-ext-10000/000000_0
2024-04-23T21:06:43,871  INFO [pool-102-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:43,872  INFO [pool-102-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:06:43,879  INFO [pool-102-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:06:43,879  INFO [pool-102-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:43,879  INFO [pool-102-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:43,879  INFO [pool-102-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:43,879  INFO [pool-102-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:43,886  INFO [pool-102-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.nonacidorctbl:1, 
2024-04-23T21:06:43,887  INFO [pool-102-thread-1] mapred.Task: Task:attempt_local1866818437_0021_r_000000_0 is done. And is in the process of committing
2024-04-23T21:06:43,887  INFO [pool-102-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:43,887  INFO [pool-102-thread-1] mapred.Task: Task 'attempt_local1866818437_0021_r_000000_0' done.
2024-04-23T21:06:43,887  INFO [pool-102-thread-1] mapred.Task: Final Counters for attempt_local1866818437_0021_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=488523
		FILE: Number of bytes written=26339005
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:43,887  INFO [pool-102-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1866818437_0021_r_000000_0
2024-04-23T21:06:43,887  INFO [pool-102-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1866818437_0021_r_000001_0
2024-04-23T21:06:43,888  INFO [pool-102-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:43,888  INFO [pool-102-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4e1aa8db
2024-04-23T21:06:43,888  WARN [pool-102-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:43,889  INFO [pool-102-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:43,890  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1866818437_0021_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:43,892  INFO [localfetcher#31] reduce.LocalFetcher: localfetcher#31 about to shuffle output of map attempt_local1866818437_0021_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-23T21:06:43,892  INFO [localfetcher#31] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local1866818437_0021_m_000000_0
2024-04-23T21:06:43,892  INFO [localfetcher#31] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-23T21:06:43,893  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:43,893  INFO [pool-102-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:43,893  INFO [pool-102-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:43,899  INFO [pool-102-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:43,899  INFO [pool-102-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T21:06:43,902  INFO [pool-102-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:43,902  INFO [pool-102-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-23T21:06:43,902  INFO [pool-102-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:43,902  INFO [pool-102-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:43,902  INFO [pool-102-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T21:06:43,902  INFO [pool-102-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:43,903  INFO [pool-102-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:43,903  INFO [pool-102-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,36KB
2024-04-23T21:06:43,905  INFO [pool-102-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:43,905  INFO [pool-102-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:43,905  INFO [pool-102-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:43,905  INFO [pool-102-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:43,905  INFO [pool-102-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1866818437_0021/job_local1866818437_0021.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@12fd277c
2024-04-23T21:06:43,906  INFO [pool-102-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_tmp.-ext-10000/000001_0
2024-04-23T21:06:43,906  INFO [pool-102-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T21:06:43,906  INFO [pool-102-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_tmp.-ext-10000/000001_0
2024-04-23T21:06:43,906  INFO [pool-102-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:43,906  INFO [pool-102-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:06:43,911  INFO [pool-102-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:06:43,911  INFO [pool-102-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:43,911  INFO [pool-102-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:3, 
2024-04-23T21:06:43,911  INFO [pool-102-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:43,911  INFO [pool-102-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-23T21:06:43,918  INFO [pool-102-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:3, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_1_default.nonacidorctbl:3, 
2024-04-23T21:06:43,918  INFO [pool-102-thread-1] mapred.Task: Task:attempt_local1866818437_0021_r_000001_0 is done. And is in the process of committing
2024-04-23T21:06:43,919  INFO [pool-102-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:43,919  INFO [pool-102-thread-1] mapred.Task: Task 'attempt_local1866818437_0021_r_000001_0' done.
2024-04-23T21:06:43,919  INFO [pool-102-thread-1] mapred.Task: Final Counters for attempt_local1866818437_0021_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=495118
		FILE: Number of bytes written=26339424
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:43,919  INFO [pool-102-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1866818437_0021_r_000001_0
2024-04-23T21:06:43,919  INFO [Thread-1673] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:06:44,815 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:06:44,815  INFO [main] exec.Task: 2024-04-23 21:06:44,815 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1866818437_0021
2024-04-23T21:06:44,816  INFO [main] exec.Task: Ended Job = job_local1866818437_0021
2024-04-23T21:06:44,818  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-23T21:06:44,818  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1/-ext-10000
2024-04-23T21:06:44,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:44,827  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:44,827  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:44,836  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:44,838  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T21:06:44,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T21:06:44,869  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:06:44,870  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:44,877  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:44,878  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:06:44,878  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-43_281_7316031584963650461-1/-mr-10001
2024-04-23T21:06:44,879  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:44,887  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:44,888  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-23T21:06:44,888  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-23T21:06:44,888  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T21:06:44,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T21:06:44,912  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-23T21:06:44,912  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:44,912  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=34, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=54}
MapReduce Jobs Launched: 
2024-04-23T21:06:44,912  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:06:44,913  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:44,913  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:44,913  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410); Time taken: 1.405 seconds
2024-04-23T21:06:44,913  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210643_ad89b2eb-9c6a-4bef-b701-bf3335a49410
2024-04-23T21:06:44,917  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:06:44,923  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:44,923  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:06:44,924  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:06:44,924  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1
2024-04-23T21:06:44,925  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_21-06-43_281_7316031584963650461-1 on fs with scheme file
2024-04-23T21:06:44,925  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-43_281_7316031584963650461-1
2024-04-23T21:06:44,925  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-43_281_7316031584963650461-1 on fs with scheme file
2024-04-23T21:06:44,926  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:06:44,929  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:06:44,929  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:06:44,930  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:44,930  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:44,933  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:44,939  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:44,940  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:06:44,940  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:44,940  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:44,940  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:44,940  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:44,946  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:44,946  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:06:44,946  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:06:44,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:45,017  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:45,018  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:45,018  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:06:45,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:06:45,020  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:06:45,021  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:45,021  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:06:45,021  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:45,027  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:45,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:06:45,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:06:45,039  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-23T21:06:45,040  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T21:06:45,040  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:06:45,044  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:06:45,044  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:06:45,044  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:06:45,045  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:06:45,053  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:45,061  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:06:45,062  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:06:45,063  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:06:45,063  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:45,063  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:45,063  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:06:45,063  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:45,063  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=28, allocateTableWriteId_(long, String, String)=8, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=2, getAllTableConstraints_(AllTableConstraintsRequest)=6, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-23T21:06:45,063  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6); Time taken: 0.137 seconds
2024-04-23T21:06:45,063  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6
2024-04-23T21:06:45,064  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6
2024-04-23T21:06:45,079  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:06:45,079  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:06:45,082  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T21:06:45,082  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6
2024-04-23T21:06:45,082  INFO [main] ql.Driver: Query ID = alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6
Total jobs = 1
2024-04-23T21:06:45,082  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:06:45,082  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:06:45,204  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:06:45,204  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:06:45,204  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:06:45,204  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:06:45,204  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:06:45,204  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:06:45,204  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:06:45,204  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:06:45,207  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:06:45,207  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:06:45,207  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-44_925_6691628974145364654-1/dummy_path
2024-04-23T21:06:45,216  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:06:45,217  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:06:45,222  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:06:45,223  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:06:45,224  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:45,228  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-44_925_6691628974145364654-1/-mr-10000
2024-04-23T21:06:45,229  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:45,237  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:06:45,241  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:06:45,242  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:06:45,242  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:06:45,242  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-44_925_6691628974145364654-1/dummy_path
2024-04-23T21:06:45,242  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:06:45,260  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:06:45,279  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1339901561_0022
2024-04-23T21:06:45,279  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:06:45,362  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:06:45,363  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:06:45,363  INFO [Thread-1736] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:45,363  INFO [Thread-1736] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:06:45,364  INFO [Thread-1736] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:06:45,364  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1339901561_0022_m_000000_0
2024-04-23T21:06:45,365  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:45,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-44_925_6691628974145364654-1/dummy_path/null:0+1
2024-04-23T21:06:45,366  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:06:45,367  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:06:45,367  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:06:45,382  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:06:45,382  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:06:45,382  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:06:45,382  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:06:45,382  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:06:45,382  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:06:45,383  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:06:45,383  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:06:45,383  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:06:45,384  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:06:45,384  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:06:45,384  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:06:45,384  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:06:45,384  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:06:45,384  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:06:45,384  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:06:45,385  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T21:06:45,386  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T21:06:45,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:06:45,399  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1339901561_0022_m_000000_0 is done. And is in the process of committing
2024-04-23T21:06:45,400  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:06:45,400  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1339901561_0022_m_000000_0' done.
2024-04-23T21:06:45,400  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1339901561_0022_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=501110
		FILE: Number of bytes written=27595073
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=10
		Total committed heap usage (bytes)=1170210816
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5401
2024-04-23T21:06:45,400  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1339901561_0022_m_000000_0
2024-04-23T21:06:45,400  INFO [Thread-1736] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:06:45,401  INFO [Thread-1736] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:06:45,402  INFO [pool-107-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1339901561_0022_r_000000_0
2024-04-23T21:06:45,402  INFO [pool-107-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:45,402  INFO [pool-107-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@742b6cc6
2024-04-23T21:06:45,402  WARN [pool-107-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:45,403  INFO [pool-107-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:45,404  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1339901561_0022_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:45,404  INFO [localfetcher#32] reduce.LocalFetcher: localfetcher#32 about to shuffle output of map attempt_local1339901561_0022_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:06:45,405  INFO [localfetcher#32] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1339901561_0022_m_000000_0
2024-04-23T21:06:45,405  INFO [localfetcher#32] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:06:45,405  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:45,405  INFO [pool-107-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:45,405  INFO [pool-107-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:45,412  INFO [pool-107-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:45,412  INFO [pool-107-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:45,414  INFO [pool-107-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:45,414  INFO [pool-107-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:06:45,414  INFO [pool-107-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:45,414  INFO [pool-107-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:45,414  INFO [pool-107-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:45,414  INFO [pool-107-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:45,415  INFO [pool-107-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:45,415  INFO [pool-107-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:06:45,416  INFO [pool-107-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:45,416  INFO [pool-107-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:45,416  INFO [pool-107-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:45,416  INFO [pool-107-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:45,416  INFO [pool-107-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1339901561_0022/job_local1339901561_0022.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@77acbdeb
2024-04-23T21:06:45,417  INFO [pool-107-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:45,417  INFO [pool-107-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:45,417  INFO [pool-107-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:06:45,417  INFO [pool-107-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:45,417  INFO [pool-107-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:06:45,424  INFO [pool-107-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:06:45,428  INFO [pool-107-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:45,429  INFO [pool-107-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:45,429  INFO [pool-107-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:45,429  INFO [pool-107-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:06:45,431  INFO [pool-107-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:06:45,442  INFO [pool-107-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T21:06:45,442  INFO [pool-107-thread-1] mapred.Task: Task:attempt_local1339901561_0022_r_000000_0 is done. And is in the process of committing
2024-04-23T21:06:45,443  INFO [pool-107-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:45,443  INFO [pool-107-thread-1] mapred.Task: Task 'attempt_local1339901561_0022_r_000000_0' done.
2024-04-23T21:06:45,443  INFO [pool-107-thread-1] mapred.Task: Final Counters for attempt_local1339901561_0022_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=507314
		FILE: Number of bytes written=27596142
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1170210816
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:45,443  INFO [pool-107-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1339901561_0022_r_000000_0
2024-04-23T21:06:45,443  INFO [pool-107-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1339901561_0022_r_000001_0
2024-04-23T21:06:45,443  INFO [pool-107-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:06:45,443  INFO [pool-107-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6720e9ad
2024-04-23T21:06:45,444  WARN [pool-107-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:06:45,444  INFO [pool-107-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:06:45,445  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1339901561_0022_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:06:45,448  INFO [localfetcher#33] reduce.LocalFetcher: localfetcher#33 about to shuffle output of map attempt_local1339901561_0022_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:06:45,448  INFO [localfetcher#33] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1339901561_0022_m_000000_0
2024-04-23T21:06:45,448  INFO [localfetcher#33] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:06:45,448  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:06:45,448  INFO [pool-107-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:45,448  INFO [pool-107-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:06:45,454  INFO [pool-107-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:45,454  INFO [pool-107-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:45,457  INFO [pool-107-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:06:45,457  INFO [pool-107-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:06:45,457  INFO [pool-107-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:06:45,457  INFO [pool-107-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:06:45,457  INFO [pool-107-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:06:45,457  INFO [pool-107-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:06:45,458  INFO [pool-107-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:06:45,458  INFO [pool-107-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:06:45,459  INFO [pool-107-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:06:45,459  INFO [pool-107-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:06:45,459  INFO [pool-107-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:06:45,459  INFO [pool-107-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:06:45,459  INFO [pool-107-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1339901561_0022/job_local1339901561_0022.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6ad2f90
2024-04-23T21:06:45,460  INFO [pool-107-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:45,460  INFO [pool-107-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:45,460  INFO [pool-107-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:06:45,460  INFO [pool-107-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:06:45,460  INFO [pool-107-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:06:45,465  INFO [pool-107-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:06:45,465  INFO [pool-107-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:06:45,465  INFO [pool-107-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:06:45,465  INFO [pool-107-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:06:45,465  INFO [pool-107-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:06:45,467  INFO [pool-107-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:06:45,477  INFO [pool-107-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:06:45,477  INFO [pool-107-thread-1] mapred.Task: Task:attempt_local1339901561_0022_r_000001_0 is done. And is in the process of committing
2024-04-23T21:06:45,478  INFO [pool-107-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:06:45,478  INFO [pool-107-thread-1] mapred.Task: Task 'attempt_local1339901561_0022_r_000001_0' done.
2024-04-23T21:06:45,478  INFO [pool-107-thread-1] mapred.Task: Final Counters for attempt_local1339901561_0022_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=513476
		FILE: Number of bytes written=27597212
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1170210816
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:06:45,478  INFO [pool-107-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1339901561_0022_r_000001_0
2024-04-23T21:06:45,478  INFO [Thread-1736] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:06:46,364 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:06:46,364  INFO [main] exec.Task: 2024-04-23 21:06:46,364 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1339901561_0022
2024-04-23T21:06:46,365  INFO [main] exec.Task: Ended Job = job_local1339901561_0022
2024-04-23T21:06:46,366  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:06:46,366  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:06:46,366  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:06:46,366  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:06:46,366  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:06:46,367  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:06:46,367  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:46,368  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,374  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,381  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,382  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:06:46,409  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:06:46,409  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,415  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,416  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:06:46,416  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-44_925_6691628974145364654-1/-mr-10000
2024-04-23T21:06:46,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,424  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,435  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:06:46,435  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T21:06:46,435  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:06:46,436  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:06:46,460  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T21:06:46,460  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:06:46,460  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:06:46,463  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:06:46,464  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:46,464  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, alter_table_(String, String, String, Table, EnvironmentContext, String)=51}
MapReduce Jobs Launched: 
2024-04-23T21:06:46,464  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:06:46,464  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:46,464  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:06:46,464  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6); Time taken: 1.382 seconds
2024-04-23T21:06:46,464  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210644_fcffe3ac-fd9b-4c26-a8eb-441d979248c6
2024-04-23T21:06:46,475  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:46,475  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:06:46,476  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T21:06:46,476  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-44_925_6691628974145364654-1
2024-04-23T21:06:46,477  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-44_925_6691628974145364654-1 on fs with scheme file
2024-04-23T21:06:46,477  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210646_ff8da076-974b-474e-801a-d82fe6a73342): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T21:06:46,480  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:06:46,481  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:06:46,481  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:06:46,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:46,488  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T21:06:46,493  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/cef1276b-cb50-4a16-84f8-e9eab3cf3995/_tmp_space.db/merge_tmp_table
2024-04-23T21:06:46,496  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 5
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3 AND NOT(`s`.`a` < 5)
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3 AND NOT(`s`.`a` < 5)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:06:46,500  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:06:46,504  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:06:46,504  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:46,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,513  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,514  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:46,524  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,524  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:46,524  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:46,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:46,533  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:46,541  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:46,548  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:46,555  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,556  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:06:46,556  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:06:46,556  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:46,557  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:46,557  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:46,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,572  INFO [Metastore Scheduled Worker 0] metastore.HMSHandler: 2: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:06:46,573  INFO [Metastore Scheduled Worker 0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@17520ca6, with PersistenceManager: null will be shutdown
2024-04-23T21:06:46,573  INFO [Metastore Scheduled Worker 0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@17520ca6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@60c35775 created in the thread with id: 44
2024-04-23T21:06:46,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:46,601  INFO [Metastore Scheduled Worker 0] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@17520ca6 from thread id: 44
2024-04-23T21:06:46,617  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:06:46,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,733  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,734  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:06:46,750  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:06:46,767  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:06:46,767  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:06:46,768  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:06:46,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:46,788  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,789  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:06:46,806  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:46,806  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T21:06:46,823  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: b, a
No Stats for default@nonacidorctbl, Columns: b, a
2024-04-23T21:06:46,823  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: b, a
2024-04-23T21:06:47,021  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:47,021  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:47,021  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:47,021  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:47,021  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:47,022  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:47,022  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:47,022  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:47,022  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:47,022  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:47,022  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:47,022  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:47,022  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,029  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,029  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,036  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,036  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,043  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,043  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,050  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,056 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:06:47,057 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:06:47,057  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:06:47,057 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:06:47,057  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,058  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=86, flushCache_()=0, getTableColumnStatistics_(String, String, List, String)=204, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=3, createTable_(Table)=3, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=14}
2024-04-23T21:06:47,058  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210646_ff8da076-974b-474e-801a-d82fe6a73342); Time taken: 0.58 seconds
2024-04-23T21:06:47,058  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:06:47,062  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,069  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:06:47,069  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/cef1276b-cb50-4a16-84f8-e9eab3cf3995/hive_2024-04-23_21-06-46_496_6901732697015494425-1
2024-04-23T21:06:47,069  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89): drop table if exists acidTbl
2024-04-23T21:06:47,077  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T21:06:47,078  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:06:47,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,086  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,086  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,086  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,086  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,086  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=11, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=8, getValidTxns_(long)=2}
2024-04-23T21:06:47,087  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89); Time taken: 0.017 seconds
2024-04-23T21:06:47,087  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89
2024-04-23T21:06:47,088  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89
2024-04-23T21:06:47,103  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:06:47,103  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:47,103  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89): drop table if exists acidTbl
2024-04-23T21:06:47,103  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,110  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,116  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,228  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,228  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=118, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,228  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89); Time taken: 0.125 seconds
2024-04-23T21:06:47,228  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_633553e6-1a48-4678-9c0e-c65510f41b89
2024-04-23T21:06:47,233  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:06:47,240  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,242  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:06:47,242  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:06:47,242  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1): drop table if exists acidTblPart
2024-04-23T21:06:47,245  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T21:06:47,245  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:06:47,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:47,253  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,253  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,254  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,254  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,254  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,254  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1); Time taken: 0.012 seconds
2024-04-23T21:06:47,254  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1
2024-04-23T21:06:47,255  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1
2024-04-23T21:06:47,270  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:06:47,271  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:47,271  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1): drop table if exists acidTblPart
2024-04-23T21:06:47,271  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,271  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:47,278  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:47,285  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:47,331  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,331  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=52, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:06:47,331  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1); Time taken: 0.06 seconds
2024-04-23T21:06:47,331  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_27068cbb-d287-4e5e-9671-5ac1139e1eb1
2024-04-23T21:06:47,335  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:06:47,343  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,343  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:06:47,344  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:06:47,344  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_6cbfad0d-9190-49e5-a0d4-205bb5469b02): drop table if exists acidTbl2
2024-04-23T21:06:47,346  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T21:06:47,346  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:06:47,347  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,347  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,347  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,347  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=0, getValidTxns_(long)=0}
2024-04-23T21:06:47,348  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_6cbfad0d-9190-49e5-a0d4-205bb5469b02); Time taken: 0.003 seconds
2024-04-23T21:06:47,348  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210647_6cbfad0d-9190-49e5-a0d4-205bb5469b02
2024-04-23T21:06:47,348  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:47,348  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_6cbfad0d-9190-49e5-a0d4-205bb5469b02): drop table if exists acidTbl2
2024-04-23T21:06:47,348  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,348  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:06:47,349  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,349  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:06:47,349  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_6cbfad0d-9190-49e5-a0d4-205bb5469b02); Time taken: 0.001 seconds
2024-04-23T21:06:47,349  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_6cbfad0d-9190-49e5-a0d4-205bb5469b02
2024-04-23T21:06:47,355  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:06:47,362  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,363  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:06:47,363  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:06:47,364  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:47,366  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T21:06:47,367  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:06:47,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:47,391  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,392  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,392  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,392  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,392  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=25, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:06:47,392  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7); Time taken: 0.028 seconds
2024-04-23T21:06:47,392  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7
2024-04-23T21:06:47,393  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7
2024-04-23T21:06:47,414  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:06:47,414  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:47,414  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:47,414  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:47,424  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,424  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:47,432  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,432  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:47,532  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,532  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=108, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,533  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7); Time taken: 0.118 seconds
2024-04-23T21:06:47,533  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_26e1c0d9-ba88-4294-b4a7-33868cc04ba7
2024-04-23T21:06:47,537  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:06:47,545  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,545  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:06:47,545  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:47,546  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:47,551  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T21:06:47,551  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:06:47,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:47,561  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,561  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,561  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,561  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,561  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, getTable_(GetTableRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=5, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,562  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563); Time taken: 0.015 seconds
2024-04-23T21:06:47,562  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563
2024-04-23T21:06:47,562  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563
2024-04-23T21:06:47,578  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:06:47,578  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:47,579  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:47,579  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:47,588  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:47,598  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:47,630  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,630  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=41}
2024-04-23T21:06:47,630  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563); Time taken: 0.051 seconds
2024-04-23T21:06:47,630  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_9b15335a-eb94-4624-8819-9867d3f6c563
2024-04-23T21:06:47,634  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:06:47,641  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,641  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:06:47,641  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:06:47,642  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02): drop table if exists nonAcidNonBucket
2024-04-23T21:06:47,644  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:06:47,644  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:06:47,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:47,653  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,653  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,653  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,653  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,654  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, getValidTxns_(long)=1}
2024-04-23T21:06:47,654  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02); Time taken: 0.011 seconds
2024-04-23T21:06:47,654  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02
2024-04-23T21:06:47,655  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02
2024-04-23T21:06:47,671  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:06:47,672  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:47,672  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02): drop table if exists nonAcidNonBucket
2024-04-23T21:06:47,672  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:47,680  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:47,689  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:47,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:47,718  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,718  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=38, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T21:06:47,718  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02); Time taken: 0.046 seconds
2024-04-23T21:06:47,719  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_23945edc-0efa-4fe6-9aa4-f95b53469d02
2024-04-23T21:06:47,722  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:06:47,728  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,728  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:06:47,729  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testQuotedIdentifier" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="2.18">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: 
merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz') failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:06:47,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:06:47,788  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 0337d995-fb80-4907-b0f7-0b440579ad68
2024-04-23T21:06:47,791  INFO [main] SessionState: Hive Session ID = 0337d995-fb80-4907-b0f7-0b440579ad68
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:06:47,791  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:06:47,797  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0337d995-fb80-4907-b0f7-0b440579ad68
2024-04-23T21:06:47,799  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0337d995-fb80-4907-b0f7-0b440579ad68
2024-04-23T21:06:47,801  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0337d995-fb80-4907-b0f7-0b440579ad68/_tmp_space.db
2024-04-23T21:06:47,802  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=0337d995-fb80-4907-b0f7-0b440579ad68, clientType=HIVECLI]
2024-04-23T21:06:47,802  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:06:47,802  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_051acb17-765a-4b19-bc77-df93d443fea8): drop table if exists acidTbl
2024-04-23T21:06:47,812  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:06:47,812  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:06:47,815  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,817  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,818  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,818  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,818  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=1, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=9, getValidTxns_(long)=2}
2024-04-23T21:06:47,818  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_051acb17-765a-4b19-bc77-df93d443fea8); Time taken: 0.016 seconds
2024-04-23T21:06:47,818  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210647_051acb17-765a-4b19-bc77-df93d443fea8
2024-04-23T21:06:47,818  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:47,818  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_051acb17-765a-4b19-bc77-df93d443fea8): drop table if exists acidTbl
2024-04-23T21:06:47,818  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,819  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:47,822  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,822  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:06:47,822  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_051acb17-765a-4b19-bc77-df93d443fea8); Time taken: 0.004 seconds
2024-04-23T21:06:47,822  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_051acb17-765a-4b19-bc77-df93d443fea8
2024-04-23T21:06:47,828  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:06:47,835  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,835  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:06:47,836  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:06:47,836  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_ed44f2e3-59e2-449c-990c-6c64798ea552): drop table if exists acidTblPart
2024-04-23T21:06:47,838  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:06:47,839  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:06:47,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:47,842  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,842  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,842  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,842  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,843  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_ed44f2e3-59e2-449c-990c-6c64798ea552); Time taken: 0.006 seconds
2024-04-23T21:06:47,843  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210647_ed44f2e3-59e2-449c-990c-6c64798ea552
2024-04-23T21:06:47,843  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:47,843  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_ed44f2e3-59e2-449c-990c-6c64798ea552): drop table if exists acidTblPart
2024-04-23T21:06:47,843  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:47,846  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,846  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,846  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_ed44f2e3-59e2-449c-990c-6c64798ea552); Time taken: 0.003 seconds
2024-04-23T21:06:47,847  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_ed44f2e3-59e2-449c-990c-6c64798ea552
2024-04-23T21:06:47,852  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:06:47,858  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,859  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:06:47,860  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:06:47,860  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_cc0d332e-2f90-4d7a-90b1-70335ec16336): drop table if exists acidTbl2
2024-04-23T21:06:47,862  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:06:47,862  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:06:47,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:06:47,866  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,866  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,866  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:06:47,866  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_cc0d332e-2f90-4d7a-90b1-70335ec16336); Time taken: 0.006 seconds
2024-04-23T21:06:47,867  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210647_cc0d332e-2f90-4d7a-90b1-70335ec16336
2024-04-23T21:06:47,867  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:47,867  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_cc0d332e-2f90-4d7a-90b1-70335ec16336): drop table if exists acidTbl2
2024-04-23T21:06:47,867  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:06:47,870  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,870  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,870  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_cc0d332e-2f90-4d7a-90b1-70335ec16336); Time taken: 0.003 seconds
2024-04-23T21:06:47,870  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_cc0d332e-2f90-4d7a-90b1-70335ec16336
2024-04-23T21:06:47,875  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:06:47,881  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,881  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:06:47,882  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:06:47,882  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_75c260c7-f39e-4747-a0fa-e8f5e052fa75): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:47,884  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:06:47,884  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:06:47,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:47,888  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,888  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,888  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,888  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2}
2024-04-23T21:06:47,888  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_75c260c7-f39e-4747-a0fa-e8f5e052fa75); Time taken: 0.006 seconds
2024-04-23T21:06:47,888  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210647_75c260c7-f39e-4747-a0fa-e8f5e052fa75
2024-04-23T21:06:47,888  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:47,888  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_75c260c7-f39e-4747-a0fa-e8f5e052fa75): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:47,888  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:47,891  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,892  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,892  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_75c260c7-f39e-4747-a0fa-e8f5e052fa75); Time taken: 0.003 seconds
2024-04-23T21:06:47,892  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_75c260c7-f39e-4747-a0fa-e8f5e052fa75
2024-04-23T21:06:47,897  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:06:47,902  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,902  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:06:47,903  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:47,903  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_9483de6a-e6d7-42b3-b80f-8c39d01948ba): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:47,905  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:06:47,906  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:06:47,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:47,909  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,909  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,909  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,909  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:06:47,909  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_9483de6a-e6d7-42b3-b80f-8c39d01948ba); Time taken: 0.006 seconds
2024-04-23T21:06:47,910  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210647_9483de6a-e6d7-42b3-b80f-8c39d01948ba
2024-04-23T21:06:47,910  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:47,910  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_9483de6a-e6d7-42b3-b80f-8c39d01948ba): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:47,910  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:47,913  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,913  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,913  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_9483de6a-e6d7-42b3-b80f-8c39d01948ba); Time taken: 0.003 seconds
2024-04-23T21:06:47,913  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_9483de6a-e6d7-42b3-b80f-8c39d01948ba
2024-04-23T21:06:47,918  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:06:47,923  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,924  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:06:47,924  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:06:47,925  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_d289cae3-4fc2-452e-99dc-8643e7b14826): drop table if exists nonAcidNonBucket
2024-04-23T21:06:47,927  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:06:47,927  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:06:47,928  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:47,930  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,930  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,930  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,930  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:06:47,931  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_d289cae3-4fc2-452e-99dc-8643e7b14826); Time taken: 0.006 seconds
2024-04-23T21:06:47,931  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210647_d289cae3-4fc2-452e-99dc-8643e7b14826
2024-04-23T21:06:47,931  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:47,931  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_d289cae3-4fc2-452e-99dc-8643e7b14826): drop table if exists nonAcidNonBucket
2024-04-23T21:06:47,931  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:47,934  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:47,934  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:47,934  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_d289cae3-4fc2-452e-99dc-8643e7b14826); Time taken: 0.003 seconds
2024-04-23T21:06:47,934  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_d289cae3-4fc2-452e-99dc-8643e7b14826
2024-04-23T21:06:47,939  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:06:47,945  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:47,945  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:06:47,945  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:47,946  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:47,948  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:06:47,948  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:06:47,949  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:47,949  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:47,954  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:06:47,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:47,956  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:47,956  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:47,956  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:47,956  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:47,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=5, flushCache_()=0}
2024-04-23T21:06:47,956  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7); Time taken: 0.011 seconds
2024-04-23T21:06:47,957  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7
2024-04-23T21:06:47,957  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7
2024-04-23T21:06:47,975  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:06:47,975  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:47,975  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:47,975  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:47,976  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931607, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, numRows=0, transactional=true, rawDataSize=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:06:47,982  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:06:48,016  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,017  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=40}
2024-04-23T21:06:48,017  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7); Time taken: 0.041 seconds
2024-04-23T21:06:48,017  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210647_e76ead08-dbe3-40fd-a9c1-9f424ab829d7
2024-04-23T21:06:48,021  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:06:48,026  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,026  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:06:48,027  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,027  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,032  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:06:48,032  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:06:48,033  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:48,033  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:48,035  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:06:48,036  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:48,037  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:48,037  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,037  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,037  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=4, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, flushCache_()=1}
2024-04-23T21:06:48,037  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915); Time taken: 0.01 seconds
2024-04-23T21:06:48,038  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915
2024-04-23T21:06:48,038  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915
2024-04-23T21:06:48,054  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:06:48,054  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:48,055  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,055  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,056  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:06:48,062  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:06:48,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T21:06:48,080  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915); Time taken: 0.025 seconds
2024-04-23T21:06:48,080  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_0684bd27-4c65-4cd9-bb67-8d4f4c8ea915
2024-04-23T21:06:48,085  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:06:48,092  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,092  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:06:48,093  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,093  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,095  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:06:48,096  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:06:48,096  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:48,096  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:48,099  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:06:48,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:48,101  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:48,101  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,101  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=2, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:06:48,102  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468); Time taken: 0.008 seconds
2024-04-23T21:06:48,102  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468
2024-04-23T21:06:48,102  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468
2024-04-23T21:06:48,118  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:06:48,118  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:48,118  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,118  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, transactional=false, totalSize=0, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:48,125  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:06:48,147  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,147  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-23T21:06:48,147  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468); Time taken: 0.029 seconds
2024-04-23T21:06:48,147  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_5f800ace-89a8-4ff7-8fc6-a9d9632c1468
2024-04-23T21:06:48,151  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:06:48,158  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,159  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:06:48,159  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,159  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,162  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:06:48,163  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:06:48,163  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:48,163  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:48,166  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:06:48,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:48,168  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:48,168  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,168  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,168  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,168  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=3, getDatabase_(String)=2, getValidTxns_(long)=0}
2024-04-23T21:06:48,169  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6); Time taken: 0.009 seconds
2024-04-23T21:06:48,169  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6
2024-04-23T21:06:48,169  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6
2024-04-23T21:06:48,185  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:06:48,185  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:48,185  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,185  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, totalSize=0, numRows=0, numFilesErasureCoded=0, transactional=false, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:48,192  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:06:48,207  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,207  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:48,207  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6); Time taken: 0.022 seconds
2024-04-23T21:06:48,207  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_e518770e-c864-4206-9284-4354a972f8f6
2024-04-23T21:06:48,212  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:06:48,219  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,219  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:06:48,219  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,220  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,223  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:06:48,223  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:06:48,223  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:48,224  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:48,227  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:06:48,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:48,229  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:48,229  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,229  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,229  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,229  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0}
2024-04-23T21:06:48,229  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b); Time taken: 0.009 seconds
2024-04-23T21:06:48,229  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b
2024-04-23T21:06:48,230  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b
2024-04-23T21:06:48,247  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:06:48,247  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:48,248  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,248  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,249  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0337d995-fb80-4907-b0f7-0b440579ad68/_tmp_space.db/d0087389-571e-41b2-866e-1f0c883bf4c1
2024-04-23T21:06:48,252  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,252  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:06:48,252  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b); Time taken: 0.004 seconds
2024-04-23T21:06:48,252  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_d009953a-686a-4701-b0c1-cae022653e3b
2024-04-23T21:06:48,257  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:06:48,264  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,264  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:06:48,265  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,265  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,268  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:06:48,268  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:06:48,269  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:48,269  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:48,272  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:06:48,272  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:48,274  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:48,274  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,274  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,274  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=2}
2024-04-23T21:06:48,274  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3); Time taken: 0.009 seconds
2024-04-23T21:06:48,275  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3
2024-04-23T21:06:48,275  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3
2024-04-23T21:06:48,291  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:06:48,291  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:48,291  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:06:48,291  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, transactional=false, numRows=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:48,298  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:06:48,312  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,312  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:48,313  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3); Time taken: 0.021 seconds
2024-04-23T21:06:48,313  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_be39fcce-d28a-499f-94d9-cdde43d658d3
2024-04-23T21:06:48,317  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:06:48,324  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,324  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:06:48,325  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `aci/d_u/ami`
2024-04-23T21:06:48,325  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_c14f1f29-0077-44e4-8e77-a3c923d4d54c): drop table if exists `aci/d_u/ami`
2024-04-23T21:06:48,328  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:06:48,328  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:06:48,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,332  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,332  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,332  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,333  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:06:48,333  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_c14f1f29-0077-44e4-8e77-a3c923d4d54c); Time taken: 0.007 seconds
2024-04-23T21:06:48,333  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210648_c14f1f29-0077-44e4-8e77-a3c923d4d54c
2024-04-23T21:06:48,333  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:48,333  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_c14f1f29-0077-44e4-8e77-a3c923d4d54c): drop table if exists `aci/d_u/ami`
2024-04-23T21:06:48,333  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,337  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,337  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:48,337  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_c14f1f29-0077-44e4-8e77-a3c923d4d54c); Time taken: 0.004 seconds
2024-04-23T21:06:48,337  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_c14f1f29-0077-44e4-8e77-a3c923d4d54c
2024-04-23T21:06:48,344  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:06:48,350  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,350  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:06:48,351  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `src/name`
2024-04-23T21:06:48,351  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_1417709d-a1ac-40eb-b83d-0ad5ad2fd242): drop table if exists `src/name`
2024-04-23T21:06:48,354  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:06:48,354  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:06:48,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:06:48,358  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,358  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,358  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,358  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0}
2024-04-23T21:06:48,358  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_1417709d-a1ac-40eb-b83d-0ad5ad2fd242); Time taken: 0.007 seconds
2024-04-23T21:06:48,358  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210648_1417709d-a1ac-40eb-b83d-0ad5ad2fd242
2024-04-23T21:06:48,358  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:48,358  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_1417709d-a1ac-40eb-b83d-0ad5ad2fd242): drop table if exists `src/name`
2024-04-23T21:06:48,359  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:06:48,362  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,362  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:48,362  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_1417709d-a1ac-40eb-b83d-0ad5ad2fd242); Time taken: 0.004 seconds
2024-04-23T21:06:48,363  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_1417709d-a1ac-40eb-b83d-0ad5ad2fd242
2024-04-23T21:06:48,369  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:06:48,375  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,376  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:06:48,376  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,376  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,380  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:06:48,380  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:06:48,381  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:48,381  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:48,387  INFO [main] parse.CalcitePlanner: Creating table default.aci/d_u/ami position=13
2024-04-23T21:06:48,387  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:48,389  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:48,389  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,389  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,389  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,389  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=6, getDatabase_(String)=2, flushCache_()=0}
2024-04-23T21:06:48,390  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6); Time taken: 0.013 seconds
2024-04-23T21:06:48,390  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6
2024-04-23T21:06:48,390  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6
2024-04-23T21:06:48,411  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:06:48,411  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:48,412  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:06:48,412  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:aci/d_u/ami, dbName:default, owner:alex, createTime:1713931608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i, type:int, comment:null), FieldSchema(name:d?*de e, type:decimal(5,2), comment:null), FieldSchema(name:vc, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[i], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"d?*de e":"true","i":"true","vc":"true"}}, bucketing_version=2, numFiles=0, numRows=0, totalSize=0, transactional=true, numFilesErasureCoded=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:06:48,420  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:06:48,456  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,456  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=43}
2024-04-23T21:06:48,456  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6); Time taken: 0.044 seconds
2024-04-23T21:06:48,456  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_5076aa94-459f-4bea-b96c-5ed163b5f5d6
2024-04-23T21:06:48,462  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:06:48,470  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,470  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:06:48,471  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-23T21:06:48,471  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b): create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-23T21:06:48,475  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T21:06:48,475  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:06:48,476  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:06:48,476  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:06:48,479  INFO [main] parse.CalcitePlanner: Creating table default.src/name position=13
2024-04-23T21:06:48,479  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:06:48,481  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:06:48,481  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:48,481  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:48,481  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:48,481  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, getValidTxns_(long)=1}
2024-04-23T21:06:48,482  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b); Time taken: 0.01 seconds
2024-04-23T21:06:48,482  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b
2024-04-23T21:06:48,482  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b
2024-04-23T21:06:48,498  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:06:48,498  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:06:48,498  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b): create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-23T21:06:48,498  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:48,499  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:src/name, dbName:default, owner:alex, createTime:1713931608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:gh, type:int, comment:null), FieldSchema(name:j, type:decimal(5,2), comment:null), FieldSchema(name:k, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"gh":"true","j":"true","k":"true"}}, numRows=0, rawDataSize=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:06:48,505  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/src-47-name
2024-04-23T21:06:48,521  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:48,521  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:48,521  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b); Time taken: 0.023 seconds
2024-04-23T21:06:48,521  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210648_0ba861f6-e217-4d18-9d5c-eddb6d66257b
2024-04-23T21:06:48,526  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:06:48,534  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:48,534  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:06:48,534  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')
2024-04-23T21:06:48,535  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210648_f54fa67e-0773-439b-88de-49364f0e3f4d): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')
2024-04-23T21:06:48,538  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T21:06:48,538  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:06:48,539  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:06:48,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,561  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T21:06:48,566  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0337d995-fb80-4907-b0f7-0b440579ad68/_tmp_space.db/merge_tmp_table
2024-04-23T21:06:48,569  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')> as 
<FROM
  `default`.`aci/d_u/ami` `d/8`
  RIGHT OUTER JOIN
  `default`.`src/name` `a/b`
  ON `i`=`gh`
INSERT INTO `default`.`aci/d_u/ami`    -- delete clause
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`gh` AND `i` > 5
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- update clause(insert part)
 SELECT `d/8`.`i`, `d/8`.`d?*de e`, 'blah'
   WHERE `i`=`gh` AND NOT(`i` > 5)
INSERT INTO `default`.`aci/d_u/ami`    -- update clause (delete part)
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`gh` AND NOT(`i` > 5)
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- insert clause
  SELECT 1,2.1,'baz'
   WHERE `d/8`.`i` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`d/8`.ROW__ID)
 WHERE `i`=`gh` GROUP BY `d/8`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:06:48,571  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:06:48,575  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:06:48,575  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:48,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,584  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:06:48,613  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,613  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:48,613  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:48,613  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,621  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,628  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,628  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,636  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,643  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,644  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:06:48,644  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:06:48,644  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:48,644  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:48,644  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:48,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.src/name	
2024-04-23T21:06:48,724  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.aci/d_u/ami, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:06:48,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,736  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,753  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.aci/d_u/ami	
2024-04-23T21:06:48,773  WARN [main] calcite.RelOptHiveTable: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T21:06:48,773  INFO [main] SessionState: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T21:06:48,774  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.src/name, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:06:48,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:06:48,795  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,795  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:06:48,814  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:48,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.src/name	
2024-04-23T21:06:48,829  WARN [main] calcite.RelOptHiveTable: No Stats for default@src/name, Columns: gh
No Stats for default@src/name, Columns: gh
2024-04-23T21:06:48,829  INFO [main] SessionState: No Stats for default@src/name, Columns: gh
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:49,036  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:06:49,037  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:06:49,037  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:49,037  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:49,037  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:06:49,037  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:49,044  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:49,051  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:49,060  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,061  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:06:49,071  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,078 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:06:49,079 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:06:49,079  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:06:49,079 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:06:49,079  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:49,079  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=2, createTable_(Table)=3, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=121, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getTableColumnStatistics_(String, String, List, String)=102, getAllTableConstraints_(AllTableConstraintsRequest)=37, getValidTxns_(long)=0}
2024-04-23T21:06:49,080  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210648_f54fa67e-0773-439b-88de-49364f0e3f4d); Time taken: 0.544 seconds
2024-04-23T21:06:49,080  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:06:49,084  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:49,091  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:06:49,091  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0337d995-fb80-4907-b0f7-0b440579ad68/hive_2024-04-23_21-06-48_569_2624118078182247362-1
2024-04-23T21:06:49,092  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20): drop table if exists acidTbl
2024-04-23T21:06:49,094  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 9
2024-04-23T21:06:49,094  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:06:49,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:49,104  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,104  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:49,104  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:49,104  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:49,104  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, rollbackTxn_(long)=11, getTable_(GetTableRequest)=9, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:06:49,104  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20); Time taken: 0.012 seconds
2024-04-23T21:06:49,105  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20
2024-04-23T21:06:49,105  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20
2024-04-23T21:06:49,121  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:06:49,121  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:49,121  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20): drop table if exists acidTbl
2024-04-23T21:06:49,122  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:49,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:49,129  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:49,135  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:06:49,247  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:49,247  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=118}
2024-04-23T21:06:49,247  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20); Time taken: 0.126 seconds
2024-04-23T21:06:49,247  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210649_2278a270-65cc-4adc-b814-724a3192de20
2024-04-23T21:06:49,252  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:06:49,260  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:49,262  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:06:49,263  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:06:49,263  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090): drop table if exists acidTblPart
2024-04-23T21:06:49,265  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 12
2024-04-23T21:06:49,265  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:06:49,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:49,274  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,274  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:49,274  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:49,274  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:49,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:06:49,274  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090); Time taken: 0.011 seconds
2024-04-23T21:06:49,275  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090
2024-04-23T21:06:49,275  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090
2024-04-23T21:06:49,292  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:06:49,292  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:49,292  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090): drop table if exists acidTblPart
2024-04-23T21:06:49,292  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:49,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:49,299  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:49,306  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:06:49,356  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:49,356  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=56}
2024-04-23T21:06:49,356  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090); Time taken: 0.064 seconds
2024-04-23T21:06:49,356  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210649_f6f68d5f-fde8-4d38-b29f-fc93ef539090
2024-04-23T21:06:49,361  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:06:49,368  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:49,368  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:06:49,369  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:06:49,369  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210649_25484a4b-8251-4149-863d-e360e74974e2): drop table if exists acidTbl2
2024-04-23T21:06:49,371  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T21:06:49,372  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:06:49,372  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:49,372  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:49,372  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:49,372  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:06:49,373  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210649_25484a4b-8251-4149-863d-e360e74974e2); Time taken: 0.003 seconds
2024-04-23T21:06:49,373  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210649_25484a4b-8251-4149-863d-e360e74974e2
2024-04-23T21:06:49,373  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:06:49,373  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210649_25484a4b-8251-4149-863d-e360e74974e2): drop table if exists acidTbl2
2024-04-23T21:06:49,373  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:49,373  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:06:49,374  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:49,374  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:49,374  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210649_25484a4b-8251-4149-863d-e360e74974e2); Time taken: 0.001 seconds
2024-04-23T21:06:49,374  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210649_25484a4b-8251-4149-863d-e360e74974e2
2024-04-23T21:06:49,380  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:06:49,388  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:49,388  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:06:49,389  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:06:49,389  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:49,391  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:06:49,391  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:06:49,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:49,417  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,417  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:49,417  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:49,417  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:49,417  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=25, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T21:06:49,418  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4); Time taken: 0.028 seconds
2024-04-23T21:06:49,418  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4
2024-04-23T21:06:49,418  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4
2024-04-23T21:06:49,434  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:06:49,434  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:49,434  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4): drop table if exists nonAcidOrcTbl
2024-04-23T21:06:49,435  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:49,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:49,444  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:49,454  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,454  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:06:49,556  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:49,556  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=111}
2024-04-23T21:06:49,556  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4); Time taken: 0.122 seconds
2024-04-23T21:06:49,556  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210649_c9315f3a-ee59-4e99-9a3e-8d66935bf7d4
2024-04-23T21:06:49,561  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:06:49,717  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:49,717  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:06:49,718  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:49,718  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:49,725  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 18
2024-04-23T21:06:49,725  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:06:49,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:49,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,738  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:49,738  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:49,738  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:49,739  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=6, commitTxn_(CommitTxnRequest)=161, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T21:06:49,739  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33); Time taken: 0.02 seconds
2024-04-23T21:06:49,739  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33
2024-04-23T21:06:49,740  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33
2024-04-23T21:06:49,754  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:06:49,754  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:49,754  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33): drop table if exists nonAcidOrcTbl2
2024-04-23T21:06:49,754  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:49,755  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:49,764  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,764  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:49,774  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:06:49,807  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:49,807  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-23T21:06:49,807  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33); Time taken: 0.053 seconds
2024-04-23T21:06:49,808  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210649_e7e14bb3-f775-4562-83e0-b37fddc37b33
2024-04-23T21:06:49,811  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:06:49,817  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:49,817  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:06:49,818  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:06:49,818  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8): drop table if exists nonAcidNonBucket
2024-04-23T21:06:49,820  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-23T21:06:49,821  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:06:49,821  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:49,830  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,830  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:06:49,830  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:06:49,830  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:06:49,830  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-23T21:06:49,831  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8); Time taken: 0.012 seconds
2024-04-23T21:06:49,831  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8
2024-04-23T21:06:49,831  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8
2024-04-23T21:06:49,844  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:06:49,844  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:06:49,845  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8): drop table if exists nonAcidNonBucket
2024-04-23T21:06:49,845  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:06:49,845  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:49,854  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:49,863  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:06:49,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:06:49,896  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:06:49,896  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=42}
2024-04-23T21:06:49,896  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8); Time taken: 0.051 seconds
2024-04-23T21:06:49,896  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210649_07f8e775-62e4-4d78-878e-3412667b9ea8
2024-04-23T21:06:49,900  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:06:49,906  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:06:49,906  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:06:49,907  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testParallelTruncateAnalyzeStats" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="8.065"/>
  <testcase name="testMergeCardinalityViolation" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="7.269"/>
  <testcase name="testUpdateOfInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="7.459">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = 1 where b != 1 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:07:05,302  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:07:05,302  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:07:05,302  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:07:05,302  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:07:05,302  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:07:05,303  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:07:05,303  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:07:05,303  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:07:05,303  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:07:05,303  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:07:05,303  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:07:05,305  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = bc505d2f-4fe2-4e9f-bd4f-041e972c038a
2024-04-23T21:07:05,307  INFO [main] SessionState: Hive Session ID = bc505d2f-4fe2-4e9f-bd4f-041e972c038a
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:05,307  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:05,313  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bc505d2f-4fe2-4e9f-bd4f-041e972c038a
2024-04-23T21:07:05,315  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a
2024-04-23T21:07:05,317  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/_tmp_space.db
2024-04-23T21:07:05,318  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=bc505d2f-4fe2-4e9f-bd4f-041e972c038a, clientType=HIVECLI]
2024-04-23T21:07:05,318  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:05,318  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_82de702f-1c45-4e43-abb8-d82c44aa1619): drop table if exists acidTbl
2024-04-23T21:07:05,325  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:07:05,325  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:07:05,327  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:05,330  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,330  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,330  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,331  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=6, getValidTxns_(long)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,331  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_82de702f-1c45-4e43-abb8-d82c44aa1619); Time taken: 0.012 seconds
2024-04-23T21:07:05,331  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210705_82de702f-1c45-4e43-abb8-d82c44aa1619
2024-04-23T21:07:05,331  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:05,331  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_82de702f-1c45-4e43-abb8-d82c44aa1619): drop table if exists acidTbl
2024-04-23T21:07:05,331  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:05,334  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,334  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,335  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_82de702f-1c45-4e43-abb8-d82c44aa1619); Time taken: 0.003 seconds
2024-04-23T21:07:05,335  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_82de702f-1c45-4e43-abb8-d82c44aa1619
2024-04-23T21:07:05,340  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:07:05,347  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,347  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:07:05,348  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:05,348  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_2906015d-062c-4510-b192-0f4433e7788f): drop table if exists acidTblPart
2024-04-23T21:07:05,350  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:07:05,350  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:07:05,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:05,354  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,354  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,354  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,354  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:07:05,354  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_2906015d-062c-4510-b192-0f4433e7788f); Time taken: 0.006 seconds
2024-04-23T21:07:05,355  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210705_2906015d-062c-4510-b192-0f4433e7788f
2024-04-23T21:07:05,355  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:05,355  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_2906015d-062c-4510-b192-0f4433e7788f): drop table if exists acidTblPart
2024-04-23T21:07:05,355  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:05,358  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,358  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,358  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_2906015d-062c-4510-b192-0f4433e7788f); Time taken: 0.003 seconds
2024-04-23T21:07:05,359  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_2906015d-062c-4510-b192-0f4433e7788f
2024-04-23T21:07:05,364  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:07:05,369  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,369  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:07:05,370  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:05,370  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_0b6df82e-7b83-4255-97c0-78ad7c6dae10): drop table if exists acidTbl2
2024-04-23T21:07:05,372  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:07:05,372  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:07:05,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:05,376  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,376  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,376  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,376  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:05,376  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_0b6df82e-7b83-4255-97c0-78ad7c6dae10); Time taken: 0.006 seconds
2024-04-23T21:07:05,376  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210705_0b6df82e-7b83-4255-97c0-78ad7c6dae10
2024-04-23T21:07:05,376  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:05,376  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_0b6df82e-7b83-4255-97c0-78ad7c6dae10): drop table if exists acidTbl2
2024-04-23T21:07:05,377  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:05,379  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,380  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,380  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_0b6df82e-7b83-4255-97c0-78ad7c6dae10); Time taken: 0.003 seconds
2024-04-23T21:07:05,380  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_0b6df82e-7b83-4255-97c0-78ad7c6dae10
2024-04-23T21:07:05,384  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:07:05,389  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,389  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:07:05,389  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:05,390  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_e68bacfd-90f2-456b-b361-dd685aecfde3): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:05,391  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:07:05,392  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:07:05,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:05,395  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,395  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,396  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_e68bacfd-90f2-456b-b361-dd685aecfde3); Time taken: 0.005 seconds
2024-04-23T21:07:05,396  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210705_e68bacfd-90f2-456b-b361-dd685aecfde3
2024-04-23T21:07:05,396  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:05,396  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_e68bacfd-90f2-456b-b361-dd685aecfde3): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:05,396  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:05,399  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,399  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,400  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_e68bacfd-90f2-456b-b361-dd685aecfde3); Time taken: 0.003 seconds
2024-04-23T21:07:05,400  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_e68bacfd-90f2-456b-b361-dd685aecfde3
2024-04-23T21:07:05,404  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:07:05,408  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,409  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:07:05,409  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:05,409  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_121bf4f9-efdf-49ac-909c-697242ecc657): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:05,411  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:07:05,411  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:07:05,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:05,415  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,415  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=1, flushCache_()=0}
2024-04-23T21:07:05,415  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_121bf4f9-efdf-49ac-909c-697242ecc657); Time taken: 0.006 seconds
2024-04-23T21:07:05,416  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210705_121bf4f9-efdf-49ac-909c-697242ecc657
2024-04-23T21:07:05,416  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:05,416  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_121bf4f9-efdf-49ac-909c-697242ecc657): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:05,416  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:05,419  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,419  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,419  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_121bf4f9-efdf-49ac-909c-697242ecc657); Time taken: 0.003 seconds
2024-04-23T21:07:05,419  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_121bf4f9-efdf-49ac-909c-697242ecc657
2024-04-23T21:07:05,424  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:07:05,429  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,429  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:07:05,429  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:05,430  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_4bb4a0a6-709f-4025-9d78-222cacd51f4b): drop table if exists nonAcidNonBucket
2024-04-23T21:07:05,432  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:07:05,432  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:07:05,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:05,435  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,435  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,435  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,436  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,436  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_4bb4a0a6-709f-4025-9d78-222cacd51f4b); Time taken: 0.006 seconds
2024-04-23T21:07:05,436  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210705_4bb4a0a6-709f-4025-9d78-222cacd51f4b
2024-04-23T21:07:05,436  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:05,436  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_4bb4a0a6-709f-4025-9d78-222cacd51f4b): drop table if exists nonAcidNonBucket
2024-04-23T21:07:05,436  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,436  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:05,439  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,439  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,439  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_4bb4a0a6-709f-4025-9d78-222cacd51f4b); Time taken: 0.003 seconds
2024-04-23T21:07:05,439  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_4bb4a0a6-709f-4025-9d78-222cacd51f4b
2024-04-23T21:07:05,443  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:07:05,448  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,448  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:07:05,449  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,449  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,451  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:07:05,452  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:07:05,452  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:05,452  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:05,457  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:07:05,458  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:05,459  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:05,459  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,459  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,459  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,459  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:07:05,460  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426); Time taken: 0.01 seconds
2024-04-23T21:07:05,460  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426
2024-04-23T21:07:05,460  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426
2024-04-23T21:07:05,476  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:07:05,476  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:05,477  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,477  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931625, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, totalSize=0, bucketing_version=2, numRows=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:05,483  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:05,513  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,513  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=35, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,513  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426); Time taken: 0.036 seconds
2024-04-23T21:07:05,514  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_0e921197-709a-4c96-b1c1-983be2308426
2024-04-23T21:07:05,517  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:07:05,521  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,522  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:07:05,522  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,523  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,525  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:07:05,526  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:07:05,526  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:05,526  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:05,529  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:07:05,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:05,531  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:05,531  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,531  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,531  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,531  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=8, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3}
2024-04-23T21:07:05,531  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f); Time taken: 0.009 seconds
2024-04-23T21:07:05,532  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f
2024-04-23T21:07:05,532  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f
2024-04-23T21:07:05,545  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:07:05,545  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:05,545  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,546  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931625, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:05,552  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:07:05,571  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,571  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,571  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f); Time taken: 0.026 seconds
2024-04-23T21:07:05,571  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_fc47cbc0-3ee6-4dcb-89a6-c0aaeeadef1f
2024-04-23T21:07:05,575  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:07:05,580  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,580  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:07:05,581  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,581  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,584  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:07:05,584  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:07:05,584  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:05,584  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:05,587  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:07:05,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:05,589  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:05,589  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,589  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,589  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,590  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0}
2024-04-23T21:07:05,590  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb); Time taken: 0.008 seconds
2024-04-23T21:07:05,590  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb
2024-04-23T21:07:05,590  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb
2024-04-23T21:07:05,604  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:07:05,604  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:05,604  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,605  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,606  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931625, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFilesErasureCoded=0, numFiles=0, bucketing_version=2, numRows=0, rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:05,611  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:07:05,627  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,627  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T21:07:05,627  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb); Time taken: 0.023 seconds
2024-04-23T21:07:05,627  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_f7aad06b-f5a0-4ac7-88bc-d9f1c33ce0fb
2024-04-23T21:07:05,632  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:07:05,638  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,638  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:07:05,639  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,639  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,643  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:07:05,643  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:07:05,644  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:05,644  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:05,646  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:07:05,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:05,648  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:05,648  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,648  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,649  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,649  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=1}
2024-04-23T21:07:05,649  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7); Time taken: 0.01 seconds
2024-04-23T21:07:05,649  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7
2024-04-23T21:07:05,650  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7
2024-04-23T21:07:05,663  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:07:05,663  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:05,663  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,663  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,664  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931625, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, totalSize=0, rawDataSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, transactional=false, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:05,670  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:07:05,684  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,684  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,685  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7); Time taken: 0.021 seconds
2024-04-23T21:07:05,685  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_0b096e4f-8e42-4955-bd98-e000d489b3a7
2024-04-23T21:07:05,689  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:07:05,694  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,694  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:07:05,695  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,696  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,698  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:07:05,698  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:07:05,699  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:05,699  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:05,702  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:07:05,702  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:05,704  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:05,704  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,704  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986); Time taken: 0.009 seconds
2024-04-23T21:07:05,705  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986
2024-04-23T21:07:05,705  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986
2024-04-23T21:07:05,719  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:07:05,719  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:05,720  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:05,720  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,721  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/_tmp_space.db/1a5f1df3-25c0-4521-9f57-6ce4c9a42b7c
2024-04-23T21:07:05,724  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,724  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:07:05,725  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986); Time taken: 0.004 seconds
2024-04-23T21:07:05,725  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_8c59f35c-005f-4ad0-a31b-2cdf1668a986
2024-04-23T21:07:05,729  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:07:05,734  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,734  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:07:05,734  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,735  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,737  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:07:05,737  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:07:05,738  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:05,738  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:05,740  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:07:05,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:05,743  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:05,743  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,743  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:05,743  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,743  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0}
2024-04-23T21:07:05,743  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11); Time taken: 0.008 seconds
2024-04-23T21:07:05,744  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11
2024-04-23T21:07:05,744  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11
2024-04-23T21:07:05,757  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:07:05,757  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:05,757  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:05,757  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:05,758  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931625, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, bucketing_version=2, totalSize=0, numFiles=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:05,763  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:07:05,777  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:05,777  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:05,777  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11); Time taken: 0.02 seconds
2024-04-23T21:07:05,777  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_24245ab0-bb07-44e9-8b13-f25a6e1c6c11
2024-04-23T21:07:05,780  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:07:05,785  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:05,785  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:07:05,786  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:05,786  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:05,788  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:07:05,789  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:07:05,789  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:05,789  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:05,795  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:05,812  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:05,813  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:05,813  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:05,813  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:05,813  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:05,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:05,819  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:05,819  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:05,819  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:05,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:05,908  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:05,908  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:05,908  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:05,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:05,911  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:05,911  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:05,911  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:05,911  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:05,918  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:05,920  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:05,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:05,928  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T21:07:05,928  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T21:07:05,929  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:05,932  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:05,933  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:05,934  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:05,935  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:05,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:05,950  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:05,951  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:05,951  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:05,951  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:05,951  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:05,951  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:07:05,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:05,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=8, openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=6, getNotNullConstraints_(NotNullConstraintsRequest)=1, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=37, getAllTableConstraints_(AllTableConstraintsRequest)=28, getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T21:07:05,952  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e); Time taken: 0.166 seconds
2024-04-23T21:07:05,952  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e
2024-04-23T21:07:05,952  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e
2024-04-23T21:07:05,970  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:07:05,970  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:05,972  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:05,973  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e
2024-04-23T21:07:05,973  INFO [main] ql.Driver: Query ID = alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e
Total jobs = 1
2024-04-23T21:07:05,973  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:05,973  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:06,096  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:06,096  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:06,096  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:06,096  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:06,096  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:06,096  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:06,096  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:06,096  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:06,098  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:06,098  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:06,099  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-05_786_646937496360605884-1/dummy_path
2024-04-23T21:07:06,108  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:06,108  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:07:06,113  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:06,113  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:06,114  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:06,118  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-05_786_646937496360605884-1/-mr-10000
2024-04-23T21:07:06,120  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:06,128  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:06,133  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:06,134  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:06,134  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:06,134  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-05_786_646937496360605884-1/dummy_path
2024-04-23T21:07:06,134  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:06,153  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:06,172  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local194840416_0030
2024-04-23T21:07:06,172  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:06,234  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:06,234  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:06,235  INFO [Thread-2417] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:06,235  INFO [Thread-2417] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:06,237  INFO [Thread-2417] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:06,237  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local194840416_0030_m_000000_0
2024-04-23T21:07:06,240  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:06,240  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-05_786_646937496360605884-1/dummy_path/null:0+1
2024-04-23T21:07:06,242  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:07:06,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:06,249  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:06,249  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:06,249  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:07:06,250  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:06,251  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:07:06,252  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T21:07:06,255  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:06,255  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:06,255  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:06,255  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:07:06,255  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:06,265  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:06,270  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local194840416_0030_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:06,270  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:06,271  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local194840416_0030_m_000000_0' done.
2024-04-23T21:07:06,271  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local194840416_0030_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=645564
		FILE: Number of bytes written=37636993
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=360
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5340
2024-04-23T21:07:06,271  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local194840416_0030_m_000000_0
2024-04-23T21:07:06,271  INFO [Thread-2417] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:06,272  INFO [Thread-2417] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:06,272  INFO [pool-152-thread-1] mapred.LocalJobRunner: Starting task: attempt_local194840416_0030_r_000000_0
2024-04-23T21:07:06,274  INFO [pool-152-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:06,274  INFO [pool-152-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1507cc3e
2024-04-23T21:07:06,274  WARN [pool-152-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:06,275  INFO [pool-152-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:06,276  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local194840416_0030_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:06,279  INFO [localfetcher#43] reduce.LocalFetcher: localfetcher#43 about to shuffle output of map attempt_local194840416_0030_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:06,279  INFO [localfetcher#43] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local194840416_0030_m_000000_0
2024-04-23T21:07:06,279  INFO [localfetcher#43] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:06,280  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:06,280  INFO [pool-152-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:06,280  INFO [pool-152-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:06,286  INFO [pool-152-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:06,286  INFO [pool-152-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:06,289  INFO [pool-152-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:06,289  INFO [pool-152-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:06,289  INFO [pool-152-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:06,289  INFO [pool-152-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:06,289  INFO [pool-152-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:06,289  INFO [pool-152-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:06,290  INFO [pool-152-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:06,290  INFO [pool-152-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:06,291  INFO [pool-152-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:06,291  INFO [pool-152-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:06,291  INFO [pool-152-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:06,291  INFO [pool-152-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:06,292  INFO [pool-152-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local194840416_0030/job_local194840416_0030.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7c83daa9
2024-04-23T21:07:06,292  INFO [pool-152-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:06,292  INFO [pool-152-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:06,292  INFO [pool-152-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:06,293  INFO [pool-152-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:06,293  INFO [pool-152-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:06,300  INFO [pool-152-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:06,305  INFO [pool-152-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:06,305  INFO [pool-152-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:06,305  INFO [pool-152-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:06,305  INFO [pool-152-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:06,306  INFO [pool-152-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:07:06,318  INFO [pool-152-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:06,318  INFO [pool-152-thread-1] mapred.Task: Task:attempt_local194840416_0030_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:06,319  INFO [pool-152-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:06,319  INFO [pool-152-thread-1] mapred.Task: Task 'attempt_local194840416_0030_r_000000_0' done.
2024-04-23T21:07:06,319  INFO [pool-152-thread-1] mapred.Task: Final Counters for attempt_local194840416_0030_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=651668
		FILE: Number of bytes written=37638032
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:06,319  INFO [pool-152-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local194840416_0030_r_000000_0
2024-04-23T21:07:06,319  INFO [pool-152-thread-1] mapred.LocalJobRunner: Starting task: attempt_local194840416_0030_r_000001_0
2024-04-23T21:07:06,319  INFO [pool-152-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:06,320  INFO [pool-152-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2471ab
2024-04-23T21:07:06,320  WARN [pool-152-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:06,321  INFO [pool-152-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:06,321  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local194840416_0030_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:06,324  INFO [localfetcher#44] reduce.LocalFetcher: localfetcher#44 about to shuffle output of map attempt_local194840416_0030_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:06,324  INFO [localfetcher#44] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local194840416_0030_m_000000_0
2024-04-23T21:07:06,324  INFO [localfetcher#44] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:06,325  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:06,325  INFO [pool-152-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:06,325  INFO [pool-152-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:06,331  INFO [pool-152-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:06,331  INFO [pool-152-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:06,334  INFO [pool-152-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:06,334  INFO [pool-152-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:06,334  INFO [pool-152-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:06,334  INFO [pool-152-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:06,334  INFO [pool-152-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:06,334  INFO [pool-152-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:06,335  INFO [pool-152-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:06,335  INFO [pool-152-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:06,336  INFO [pool-152-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:06,336  INFO [pool-152-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:06,336  INFO [pool-152-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:06,336  INFO [pool-152-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:06,336  INFO [pool-152-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local194840416_0030/job_local194840416_0030.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@a19d72
2024-04-23T21:07:06,337  INFO [pool-152-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:06,337  INFO [pool-152-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:06,337  INFO [pool-152-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:06,337  INFO [pool-152-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:06,337  INFO [pool-152-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:06,342  INFO [pool-152-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:06,342  INFO [pool-152-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:06,343  INFO [pool-152-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:06,343  INFO [pool-152-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:06,343  INFO [pool-152-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:06,344  INFO [pool-152-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:07:06,354  INFO [pool-152-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:06,354  INFO [pool-152-thread-1] mapred.Task: Task:attempt_local194840416_0030_r_000001_0 is done. And is in the process of committing
2024-04-23T21:07:06,355  INFO [pool-152-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:06,355  INFO [pool-152-thread-1] mapred.Task: Task 'attempt_local194840416_0030_r_000001_0' done.
2024-04-23T21:07:06,355  INFO [pool-152-thread-1] mapred.Task: Final Counters for attempt_local194840416_0030_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=657748
		FILE: Number of bytes written=37639060
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:06,355  INFO [pool-152-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local194840416_0030_r_000001_0
2024-04-23T21:07:06,355  INFO [Thread-2417] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:07,237 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:07,237  INFO [main] exec.Task: 2024-04-23 21:07:07,237 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local194840416_0030
2024-04-23T21:07:07,239  INFO [main] exec.Task: Ended Job = job_local194840416_0030
2024-04-23T21:07:07,241  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:07:07,241  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:07,241  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:07:07,241  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:07:07,242  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:07:07,243  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:07:07,243  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:07,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,249  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:07,250  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:07,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:07,285  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:07,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,291  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:07,291  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:07,292  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-05_786_646937496360605884-1/-mr-10000
2024-04-23T21:07:07,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,300  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:07,311  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:07,311  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:07:07,311  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:07:07,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:07,331  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:07:07,331  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:07:07,331  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:07:07,333  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:07,334  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:07,334  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=26, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, alter_table_(String, String, String, Table, EnvironmentContext, String)=48, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T21:07:07,334  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:07,335  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:07,335  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:07,335  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e); Time taken: 1.362 seconds
2024-04-23T21:07:07,335  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210705_10d6978b-b7fa-4d5a-9c56-3e1abe03d22e
2024-04-23T21:07:07,344  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:07,345  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:07:07,345  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T21:07:07,345  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-05_786_646937496360605884-1
2024-04-23T21:07:07,346  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-05_786_646937496360605884-1 on fs with scheme file
2024-04-23T21:07:07,346  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169): select a,b from acidTbl order by a,b
2024-04-23T21:07:07,349  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:07:07,350  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:07:07,350  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:07,350  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:07,353  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:07,353  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:07,353  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,360  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:07,360  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:07,360  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:07,360  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:07,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,380  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:07:07,381  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,389  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:07,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:07,397  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:07,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:07,408  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T21:07:07,408  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T21:07:07,449  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:07,449  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:07,449  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:07,450  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-07_346_6727149928670283416-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-07_346_6727149928670283416-1
2024-04-23T21:07:07,457  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:07,459  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:07:07,459  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:07:07,461  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:07,469  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:07,470  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:07,470  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:07,471  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:07,471  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:07,471  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:07,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:07,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:07:07,472  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:07:07,472  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:07,472  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=27, getAllTableConstraints_(AllTableConstraintsRequest)=5, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7, openTxn_(String, TxnType)=3}
2024-04-23T21:07:07,473  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169); Time taken: 0.126 seconds
2024-04-23T21:07:07,473  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169
2024-04-23T21:07:07,474  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169
2024-04-23T21:07:07,489  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:07:07,489  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:07,489  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169): select a,b from acidTbl order by a,b
2024-04-23T21:07:07,490  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169
2024-04-23T21:07:07,490  INFO [main] ql.Driver: Query ID = alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169
Total jobs = 1
2024-04-23T21:07:07,490  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:07,490  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:07,626  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:07:07,626  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:07,626  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:07,626  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:07,626  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:07,626  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:07,626  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:07,626  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:07,628  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:07,628  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T21:07:07,628  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:07,638  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:07,639  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:07,644  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:07,645  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:07,646  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:07,653  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:07,660  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:07,665  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:07,667  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:07:07,667  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:07:07,667  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:07,667  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:07:07,667  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:07:07,667  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:07:07,680  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:07:07,680  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 13 ms
2024-04-23T21:07:07,680  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:07:07,700  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:07:07,720  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local253943150_0031
2024-04-23T21:07:07,720  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:07,797  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:07,797  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:07,797  INFO [Thread-2494] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:07,798  INFO [Thread-2494] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:07,799  INFO [Thread-2494] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:07,800  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local253943150_0031_m_000000_0
2024-04-23T21:07:07,800  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:07,801  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:07,801  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:07,802  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:07,802  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:07,803  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:07,804  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:07,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:07,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:07,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:07,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:07,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:07,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:07,810  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:07,810  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:07,811  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_6:1, 
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:07,812  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:07,823  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:07,826  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local253943150_0031_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:07,827  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:07,827  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local253943150_0031_m_000000_0' done.
2024-04-23T21:07:07,827  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local253943150_0031_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=668322
		FILE: Number of bytes written=38888726
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1351090176
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8869
2024-04-23T21:07:07,827  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local253943150_0031_m_000000_0
2024-04-23T21:07:07,827  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local253943150_0031_m_000001_0
2024-04-23T21:07:07,827  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:07,828  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:07,828  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:07,829  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:07,829  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:07,830  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:07,831  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:07,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:07,837  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:07,837  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:07,837  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:07,837  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:07,837  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:07,837  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:07,838  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:07,838  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:07,838  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:07,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:07,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:07,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:07,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:07,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:07,849  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:07,852  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local253943150_0031_m_000001_0 is done. And is in the process of committing
2024-04-23T21:07:07,853  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:07,853  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local253943150_0031_m_000001_0' done.
2024-04-23T21:07:07,853  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local253943150_0031_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=678196
		FILE: Number of bytes written=38888785
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1351090176
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8861
2024-04-23T21:07:07,853  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local253943150_0031_m_000001_0
2024-04-23T21:07:07,853  INFO [Thread-2494] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:07,854  INFO [Thread-2494] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:07,854  INFO [pool-157-thread-1] mapred.LocalJobRunner: Starting task: attempt_local253943150_0031_r_000000_0
2024-04-23T21:07:07,855  INFO [pool-157-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:07,855  INFO [pool-157-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7fa168a1
2024-04-23T21:07:07,855  WARN [pool-157-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:07,856  INFO [pool-157-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:07,856  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local253943150_0031_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:07,857  INFO [localfetcher#45] reduce.LocalFetcher: localfetcher#45 about to shuffle output of map attempt_local253943150_0031_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:07,857  INFO [localfetcher#45] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local253943150_0031_m_000001_0
2024-04-23T21:07:07,857  INFO [localfetcher#45] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T21:07:07,860  INFO [localfetcher#45] reduce.LocalFetcher: localfetcher#45 about to shuffle output of map attempt_local253943150_0031_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:07,860  INFO [localfetcher#45] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local253943150_0031_m_000000_0
2024-04-23T21:07:07,860  INFO [localfetcher#45] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T21:07:07,860  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:07,861  INFO [pool-157-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:07:07,861  INFO [pool-157-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:07,867  INFO [pool-157-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:07:07,867  INFO [pool-157-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-23T21:07:07,870  INFO [pool-157-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:07,870  INFO [pool-157-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-23T21:07:07,870  INFO [pool-157-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:07,870  INFO [pool-157-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:07,870  INFO [pool-157-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-23T21:07:07,870  INFO [pool-157-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:07:07,871  INFO [pool-157-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:07,872  INFO [pool-157-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:07,873  INFO [pool-157-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:07,873  INFO [pool-157-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:07,873  INFO [pool-157-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T21:07:07,873  INFO [pool-157-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:07:07,874  INFO [pool-157-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@4cad822a, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@41bf4b39, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@27dfa6da
2024-04-23T21:07:07,874  INFO [pool-157-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-07_346_6727149928670283416-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-07_346_6727149928670283416-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:07,874  INFO [pool-157-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-07_346_6727149928670283416-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-07_346_6727149928670283416-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:07:07,874  INFO [pool-157-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-07_346_6727149928670283416-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-07_346_6727149928670283416-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:07,882  INFO [pool-157-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:07,883  INFO [pool-157-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:07,883  INFO [pool-157-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T21:07:07,883  INFO [pool-157-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:07:07,883  INFO [pool-157-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:07:07,883  INFO [pool-157-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:2, 
2024-04-23T21:07:07,884  INFO [pool-157-thread-1] mapred.Task: Task:attempt_local253943150_0031_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:07,884  INFO [pool-157-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:07,884  INFO [pool-157-thread-1] mapred.Task: Task 'attempt_local253943150_0031_r_000000_0' done.
2024-04-23T21:07:07,885  INFO [pool-157-thread-1] mapred.Task: Final Counters for attempt_local253943150_0031_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=685440
		FILE: Number of bytes written=38888964
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1351090176
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:07,885  INFO [pool-157-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local253943150_0031_r_000000_0
2024-04-23T21:07:07,885  INFO [Thread-2494] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:08,800 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:08,800  INFO [main] exec.Task: 2024-04-23 21:07:08,800 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local253943150_0031
2024-04-23T21:07:08,801  INFO [main] exec.Task: Ended Job = job_local253943150_0031
2024-04-23T21:07:08,804  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:08,804  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:07:08,804  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:08,804  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:08,804  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:08,804  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169); Time taken: 1.315 seconds
2024-04-23T21:07:08,804  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210707_5a5c1ca4-9837-4b07-9c21-6b9a274fa169
2024-04-23T21:07:08,809  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:07:08,814  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:08,814  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:07:08,819  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:07:08,819  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:07:08,819  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:2, 
2024-04-23T21:07:08,819  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T21:07:08,820  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-07_346_6727149928670283416-1
2024-04-23T21:07:08,820  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-07_346_6727149928670283416-1 on fs with scheme file
2024-04-23T21:07:08,821  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210708_a5074a01-552f-4f54-91e7-c5cd3a6b68aa): START TRANSACTION
2024-04-23T21:07:08,823  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:07:08,823  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:07:08,824  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:08,824  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:08,824  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:08,824  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:08,824  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:08,824  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:08,824  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T21:07:08,824  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210708_a5074a01-552f-4f54-91e7-c5cd3a6b68aa); Time taken: 0.003 seconds
2024-04-23T21:07:08,824  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210708_a5074a01-552f-4f54-91e7-c5cd3a6b68aa
2024-04-23T21:07:08,825  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T21:07:08,825  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210708_a5074a01-552f-4f54-91e7-c5cd3a6b68aa): START TRANSACTION
2024-04-23T21:07:08,825  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:08,825  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:07:08,825  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210708_a5074a01-552f-4f54-91e7-c5cd3a6b68aa); Time taken: 0.0 seconds
2024-04-23T21:07:08,825  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:08,825  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:08,826  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:08,826  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:08,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:08,837  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:08,837  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:08,837  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:08,837  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:08,837  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:08,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:08,844  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:08,844  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:08,844  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:08,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:08,912  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:08,912  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:08,912  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:08,912  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:08,915  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:08,915  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:08,915  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:08,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:08,921  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:08,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:08,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:08,930  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 15
2024-04-23T21:07:08,930  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-23T21:07:08,931  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:08,934  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:08,934  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:08,935  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:08,936  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:08,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:08,950  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:08,951  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:08,952  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:08,952  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:08,952  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:08,952  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:08,952  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:07:08,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:08,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=6, getValidWriteIds_(List, String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, allocateTableWriteId_(long, String, String)=5, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=27, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-23T21:07:08,952  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825); Time taken: 0.127 seconds
2024-04-23T21:07:08,952  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825
2024-04-23T21:07:08,953  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825
2024-04-23T21:07:08,966  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:07:08,966  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:08,969  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:08,969  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825
2024-04-23T21:07:08,969  INFO [main] ql.Driver: Query ID = alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825
Total jobs = 1
2024-04-23T21:07:08,969  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:08,969  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:09,092  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:09,092  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:09,092  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:09,093  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:09,093  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:09,093  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:09,093  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:09,093  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:09,095  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:09,095  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:09,095  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-08_825_6383685598723060278-1/dummy_path
2024-04-23T21:07:09,105  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:09,106  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,29KB
2024-04-23T21:07:09,110  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:09,111  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:09,112  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:09,115  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-08_825_6383685598723060278-1/-mr-10000
2024-04-23T21:07:09,117  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:09,124  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:09,128  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:09,129  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:09,129  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:09,129  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-08_825_6383685598723060278-1/dummy_path
2024-04-23T21:07:09,129  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:09,147  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:09,167  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1521970181_0032
2024-04-23T21:07:09,167  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:09,230  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:09,230  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:09,231  INFO [Thread-2547] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:09,231  INFO [Thread-2547] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:09,232  INFO [Thread-2547] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:09,232  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1521970181_0032_m_000000_0
2024-04-23T21:07:09,233  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:09,233  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-08_825_6383685598723060278-1/dummy_path/null:0+1
2024-04-23T21:07:09,234  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:09,234  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,29KB
2024-04-23T21:07:09,235  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:09,239  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:09,239  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:09,239  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:09,239  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:09,239  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:09,239  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:09,240  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:09,240  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:07:09,241  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:07:09,242  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:09,242  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:07:09,242  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:07:09,243  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:07:09,244  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:09,244  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:09,244  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:09,244  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:07:09,244  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:09,254  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:09,257  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1521970181_0032_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:09,258  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:09,258  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1521970181_0032_m_000000_0' done.
2024-04-23T21:07:09,258  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1521970181_0032_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=691318
		FILE: Number of bytes written=40144439
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1351090176
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5342
2024-04-23T21:07:09,258  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1521970181_0032_m_000000_0
2024-04-23T21:07:09,258  INFO [Thread-2547] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:09,260  INFO [Thread-2547] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:09,260  INFO [pool-160-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1521970181_0032_r_000000_0
2024-04-23T21:07:09,260  INFO [pool-160-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:09,260  INFO [pool-160-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@17b145c3
2024-04-23T21:07:09,260  WARN [pool-160-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:09,262  INFO [pool-160-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:09,262  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1521970181_0032_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:09,263  INFO [localfetcher#46] reduce.LocalFetcher: localfetcher#46 about to shuffle output of map attempt_local1521970181_0032_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:09,263  INFO [localfetcher#46] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1521970181_0032_m_000000_0
2024-04-23T21:07:09,263  INFO [localfetcher#46] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:09,263  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:09,264  INFO [pool-160-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:09,264  INFO [pool-160-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:09,269  INFO [pool-160-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:09,270  INFO [pool-160-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:09,272  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:09,272  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:09,272  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:09,272  INFO [pool-160-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:09,272  INFO [pool-160-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:09,272  INFO [pool-160-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:09,273  INFO [pool-160-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:09,273  INFO [pool-160-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:09,274  INFO [pool-160-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:09,274  INFO [pool-160-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:09,274  INFO [pool-160-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:09,274  INFO [pool-160-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:09,275  INFO [pool-160-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1521970181_0032/job_local1521970181_0032.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2635c5df
2024-04-23T21:07:09,275  INFO [pool-160-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:09,275  INFO [pool-160-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:09,275  INFO [pool-160-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:09,276  INFO [pool-160-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:09,276  INFO [pool-160-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:09,282  INFO [pool-160-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:09,287  INFO [pool-160-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:09,287  INFO [pool-160-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:09,287  INFO [pool-160-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:09,287  INFO [pool-160-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:09,289  INFO [pool-160-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0]
2024-04-23T21:07:09,300  INFO [pool-160-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-23T21:07:09,301  INFO [pool-160-thread-1] mapred.Task: Task:attempt_local1521970181_0032_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:09,301  INFO [pool-160-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:09,301  INFO [pool-160-thread-1] mapred.Task: Task 'attempt_local1521970181_0032_r_000000_0' done.
2024-04-23T21:07:09,301  INFO [pool-160-thread-1] mapred.Task: Final Counters for attempt_local1521970181_0032_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=697425
		FILE: Number of bytes written=40145479
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1351090176
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:09,301  INFO [pool-160-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1521970181_0032_r_000000_0
2024-04-23T21:07:09,301  INFO [pool-160-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1521970181_0032_r_000001_0
2024-04-23T21:07:09,302  INFO [pool-160-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:09,302  INFO [pool-160-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@18a9407b
2024-04-23T21:07:09,302  WARN [pool-160-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:09,303  INFO [pool-160-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:09,304  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1521970181_0032_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:09,307  INFO [localfetcher#47] reduce.LocalFetcher: localfetcher#47 about to shuffle output of map attempt_local1521970181_0032_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:09,307  INFO [localfetcher#47] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1521970181_0032_m_000000_0
2024-04-23T21:07:09,307  INFO [localfetcher#47] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:09,307  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:09,308  INFO [pool-160-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:09,308  INFO [pool-160-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:09,314  INFO [pool-160-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:09,314  INFO [pool-160-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:09,316  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:09,316  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:09,316  INFO [pool-160-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:09,316  INFO [pool-160-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:09,317  INFO [pool-160-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:09,317  INFO [pool-160-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:09,317  INFO [pool-160-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:09,318  INFO [pool-160-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:09,319  INFO [pool-160-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:09,319  INFO [pool-160-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:09,319  INFO [pool-160-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:09,319  INFO [pool-160-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:09,319  INFO [pool-160-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1521970181_0032/job_local1521970181_0032.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@256c99ec
2024-04-23T21:07:09,320  INFO [pool-160-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:09,320  INFO [pool-160-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:09,320  INFO [pool-160-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:09,320  INFO [pool-160-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:09,320  INFO [pool-160-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:09,325  INFO [pool-160-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:09,325  INFO [pool-160-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:09,325  INFO [pool-160-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:09,325  INFO [pool-160-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:09,325  INFO [pool-160-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:09,327  INFO [pool-160-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-23T21:07:09,336  INFO [pool-160-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-23T21:07:09,336  INFO [pool-160-thread-1] mapred.Task: Task:attempt_local1521970181_0032_r_000001_0 is done. And is in the process of committing
2024-04-23T21:07:09,337  INFO [pool-160-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:09,337  INFO [pool-160-thread-1] mapred.Task: Task 'attempt_local1521970181_0032_r_000001_0' done.
2024-04-23T21:07:09,337  INFO [pool-160-thread-1] mapred.Task: Final Counters for attempt_local1521970181_0032_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=703508
		FILE: Number of bytes written=40146513
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1351090176
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:09,337  INFO [pool-160-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1521970181_0032_r_000001_0
2024-04-23T21:07:09,337  INFO [Thread-2547] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:10,231 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:10,231  INFO [main] exec.Task: 2024-04-23 21:07:10,231 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1521970181_0032
2024-04-23T21:07:10,232  INFO [main] exec.Task: Ended Job = job_local1521970181_0032
2024-04-23T21:07:10,233  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:07:10,233  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:10,233  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-23T21:07:10,233  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest
2024-04-23T21:07:10,233  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-23T21:07:10,234  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:07:10,235  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:10,235  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,241  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:10,241  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,247  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:10,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:10,267  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:10,267  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,273  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:10,274  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:10,274  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-08_825_6383685598723060278-1/-mr-10000
2024-04-23T21:07:10,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,282  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:10,304  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:10,304  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:07:10,304  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:07:10,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:10,326  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:07:10,326  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:07:10,326  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:07:10,326  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2695, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:10,327  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:10,327  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=41, getTable_(GetTableRequest)=26}
MapReduce Jobs Launched: 
2024-04-23T21:07:10,327  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:10,327  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:10,327  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:10,327  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210708_70d62200-ba2a-450e-b074-cae5a4f1f825); Time taken: 1.357 seconds
2024-04-23T21:07:10,327  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T21:07:10,327  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-08_825_6383685598723060278-1
2024-04-23T21:07:10,328  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-08_825_6383685598723060278-1 on fs with scheme file
2024-04-23T21:07:10,328  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a): select a,b from acidTbl order by a,b
2024-04-23T21:07:10,329  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:10,329  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:10,329  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:10,329  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:10,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:10,337  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:10,337  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:10,337  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:10,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,360  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:07:10,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,370  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:10,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:10,383  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:10,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:10,395  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:10,395  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:10,443  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:10,443  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:10,443  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:10,444  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-10_328_3808670372602127863-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-10_328_3808670372602127863-1
2024-04-23T21:07:10,453  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:10,456  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:10,456  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:07:10,457  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:10,466  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:10,466  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:10,466  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:10,467  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:10,467  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:10,467  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:10,468  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:10,468  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:07:10,469  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:07:10,469  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:10,469  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTableColumnStatistics_(String, String, List, String)=33, getValidWriteIds_(List, String)=0, flushCache_()=0, getTable_(GetTableRequest)=7}
2024-04-23T21:07:10,469  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a); Time taken: 0.141 seconds
2024-04-23T21:07:10,470  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a
2024-04-23T21:07:10,470  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a
2024-04-23T21:07:10,482  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:07:10,482  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:10,483  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a): select a,b from acidTbl order by a,b
2024-04-23T21:07:10,483  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a
2024-04-23T21:07:10,483  INFO [main] ql.Driver: Query ID = alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a
Total jobs = 1
2024-04-23T21:07:10,483  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:10,483  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:10,616  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:07:10,616  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:10,616  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:10,616  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:10,616  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:10,616  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:10,616  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:10,616  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:10,619  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:10,619  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T21:07:10,619  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:10,628  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:10,629  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:07:10,635  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:10,636  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,02KB
2024-04-23T21:07:10,637  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:10,642  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:10,649  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:10,654  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:10,655  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:07:10,655  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:07:10,655  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:10,655  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:07:10,655  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:2:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:07:10,655  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:07:10,678  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/4
2024-04-23T21:07:10,678  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 4). duration: 23 ms
2024-04-23T21:07:10,678  INFO [main] io.HiveInputFormat: number of splits 4
2024-04-23T21:07:10,704  INFO [main] mapreduce.JobSubmitter: number of splits:4
2024-04-23T21:07:10,745  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1459239883_0033
2024-04-23T21:07:10,745  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:10,828  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:10,828  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:10,828  INFO [Thread-2632] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:10,828  INFO [Thread-2632] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:10,831  INFO [Thread-2632] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:10,832  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1459239883_0033_m_000000_0
2024-04-23T21:07:10,832  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:10,833  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,833  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:10,834  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:07:10,835  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,836  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 679, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:10,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:10,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:10,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:10,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:10,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:10,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:10,842  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:10,843  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:10,843  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:10,843  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:10,844  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:10,844  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:10,844  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:10,844  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:10,844  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_6:1, 
2024-04-23T21:07:10,845  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:10,846  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:10,846  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:10,846  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:10,846  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:10,856  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:10,860  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1459239883_0033_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:10,860  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,860  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1459239883_0033_m_000000_0' done.
2024-04-23T21:07:10,860  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1459239883_0033_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=715224
		FILE: Number of bytes written=41402111
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8979
2024-04-23T21:07:10,860  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1459239883_0033_m_000000_0
2024-04-23T21:07:10,860  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1459239883_0033_m_000001_0
2024-04-23T21:07:10,861  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:10,861  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,862  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:10,863  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:07:10,863  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,864  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:10,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:10,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:10,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:10,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:10,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:10,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:10,872  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:10,872  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:10,872  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:10,873  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:10,873  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:10,873  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:10,873  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:10,874  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:10,874  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:10,874  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:10,874  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:07:10,874  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:10,875  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:10,883  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:10,887  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1459239883_0033_m_000001_0 is done. And is in the process of committing
2024-04-23T21:07:10,887  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,887  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1459239883_0033_m_000001_0' done.
2024-04-23T21:07:10,888  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1459239883_0033_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=726190
		FILE: Number of bytes written=41402170
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8955
2024-04-23T21:07:10,888  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1459239883_0033_m_000001_0
2024-04-23T21:07:10,888  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1459239883_0033_m_000002_0
2024-04-23T21:07:10,888  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:10,889  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,889  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:10,890  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:07:10,890  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,891  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 672, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:10,891  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:10,896  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:10,896  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:10,896  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:10,896  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:10,896  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:10,897  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:10,897  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:10,897  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:10,898  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:10,898  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:10,898  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:10,898  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:10,899  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:10,900  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:07:10,900  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:10,900  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:10,900  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:10,900  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:10,900  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:10,909  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:10,912  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1459239883_0033_m_000002_0 is done. And is in the process of committing
2024-04-23T21:07:10,913  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,913  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1459239883_0033_m_000002_0' done.
2024-04-23T21:07:10,913  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1459239883_0033_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=736640
		FILE: Number of bytes written=41402229
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8951
2024-04-23T21:07:10,913  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1459239883_0033_m_000002_0
2024-04-23T21:07:10,913  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1459239883_0033_m_000003_0
2024-04-23T21:07:10,913  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:10,913  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,914  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:10,915  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:07:10,915  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,916  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:10,917  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:10,922  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:10,922  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:10,922  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:10,922  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:10,922  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:10,922  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:10,923  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:10,923  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:10,923  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:10,923  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:10,923  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:10,923  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:10,924  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:07:10,925  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:10,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:10,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:10,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:10,925  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:10,933  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:10,936  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1459239883_0033_m_000003_0 is done. And is in the process of committing
2024-04-23T21:07:10,936  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:10,936  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1459239883_0033_m_000003_0' done.
2024-04-23T21:07:10,936  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1459239883_0033_m_000003_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=746574
		FILE: Number of bytes written=41402288
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8947
2024-04-23T21:07:10,936  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1459239883_0033_m_000003_0
2024-04-23T21:07:10,937  INFO [Thread-2632] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:10,937  INFO [Thread-2632] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:10,937  INFO [pool-165-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1459239883_0033_r_000000_0
2024-04-23T21:07:10,938  INFO [pool-165-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:10,938  INFO [pool-165-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2c6b31c1
2024-04-23T21:07:10,938  WARN [pool-165-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:10,939  INFO [pool-165-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:10,939  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1459239883_0033_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:10,942  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1459239883_0033_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:10,942  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1459239883_0033_m_000001_0
2024-04-23T21:07:10,942  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T21:07:10,945  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1459239883_0033_m_000003_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:10,945  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1459239883_0033_m_000003_0
2024-04-23T21:07:10,945  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T21:07:10,947  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1459239883_0033_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:10,947  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1459239883_0033_m_000000_0
2024-04-23T21:07:10,947  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 3, commitMemory -> 46, usedMemory ->69
2024-04-23T21:07:10,949  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1459239883_0033_m_000002_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:10,950  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1459239883_0033_m_000002_0
2024-04-23T21:07:10,950  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 4, commitMemory -> 69, usedMemory ->92
2024-04-23T21:07:10,950  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:10,950  INFO [pool-165-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T21:07:10,950  INFO [pool-165-thread-1] reduce.MergeManagerImpl: finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:10,956  INFO [pool-165-thread-1] mapred.Merger: Merging 4 sorted segments
2024-04-23T21:07:10,956  INFO [pool-165-thread-1] mapred.Merger: Down to the last merge-pass, with 4 segments left of total size: 24 bytes
2024-04-23T21:07:10,959  INFO [pool-165-thread-1] reduce.MergeManagerImpl: Merged 4 segments, 92 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:10,959  INFO [pool-165-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-23T21:07:10,959  INFO [pool-165-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:10,959  INFO [pool-165-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:10,959  INFO [pool-165-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-23T21:07:10,959  INFO [pool-165-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T21:07:10,960  INFO [pool-165-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:10,960  INFO [pool-165-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,02KB
2024-04-23T21:07:10,961  INFO [pool-165-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:10,961  INFO [pool-165-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:10,961  INFO [pool-165-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T21:07:10,961  INFO [pool-165-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:07:10,961  INFO [pool-165-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@1d2552da, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@9a34e38, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@754675d0
2024-04-23T21:07:10,962  INFO [pool-165-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-10_328_3808670372602127863-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-10_328_3808670372602127863-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:10,962  INFO [pool-165-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-10_328_3808670372602127863-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-10_328_3808670372602127863-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:07:10,962  INFO [pool-165-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-10_328_3808670372602127863-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-10_328_3808670372602127863-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:10,968  INFO [pool-165-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:10,969  INFO [pool-165-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:10,969  INFO [pool-165-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T21:07:10,969  INFO [pool-165-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:07:10,969  INFO [pool-165-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T21:07:10,969  INFO [pool-165-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:10,970  INFO [pool-165-thread-1] mapred.Task: Task:attempt_local1459239883_0033_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:10,970  INFO [pool-165-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:10,970  INFO [pool-165-thread-1] mapred.Task: Task 'attempt_local1459239883_0033_r_000000_0' done.
2024-04-23T21:07:10,970  INFO [pool-165-thread-1] mapred.Task: Final Counters for attempt_local1459239883_0033_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=753984
		FILE: Number of bytes written=41402541
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=108
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =4
		Failed Shuffles=0
		Merged Map outputs=4
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1350565888
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:10,970  INFO [pool-165-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1459239883_0033_r_000000_0
2024-04-23T21:07:10,970  INFO [Thread-2632] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:11,831 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:11,831  INFO [main] exec.Task: 2024-04-23 21:07:11,831 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1459239883_0033
2024-04-23T21:07:11,834  INFO [main] exec.Task: Ended Job = job_local1459239883_0033
2024-04-23T21:07:11,835  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:11,835  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:07:11,836  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:11,836  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:11,836  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:11,836  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a); Time taken: 1.352 seconds
2024-04-23T21:07:11,839  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:07:11,840  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:07:11,840  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:4, 
2024-04-23T21:07:11,840  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = 1 where b != 1
2024-04-23T21:07:11,840  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-10_328_3808670372602127863-1
2024-04-23T21:07:11,841  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bc505d2f-4fe2-4e9f-bd4f-041e972c038a/hive_2024-04-23_21-07-10_328_3808670372602127863-1 on fs with scheme file
2024-04-23T21:07:11,841  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210711_826f8ee6-f12a-4abc-be53-7cc4a9cc16a9): update acidTbl set b = 1 where b != 1
2024-04-23T21:07:11,842  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:07:11,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:11,850  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:11,850  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = 1 where b != 1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:07:11,851  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:07:11,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:11,861  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:11,861  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:11,861  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:11,862  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:11,870  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:11,870  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:11,870  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:11,870  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:11,877  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:11,877  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:11,877  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:11,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:11,896  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:11,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:11,958  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:07:11,958  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:11,967  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:11,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:11,977  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:11,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:11,986  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:11,987  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:12,047  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:12,047  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:12,047  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:12,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:12,054  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,057 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:07:12,058 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:07:12,058  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:07:12,058 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:07:12,059  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:12,059  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=2, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTable_(GetTableRequest)=40, flushCache_()=0, getTableColumnStatistics_(String, String, List, String)=28, getValidWriteIds_(List, String)=0}
2024-04-23T21:07:12,059  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210711_826f8ee6-f12a-4abc-be53-7cc4a9cc16a9); Time taken: 0.218 seconds
2024-04-23T21:07:12,059  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210710_9346105e-06e3-4c01-b2dc-4f4f01ec021a
2024-04-23T21:07:12,061  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:12,067  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:12,068  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210712_099ab422-108a-410c-adea-c690207374e2): drop table if exists acidTbl
2024-04-23T21:07:12,070  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T21:07:12,070  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:07:12,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:12,078  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,078  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:12,078  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:12,079  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:12,079  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=8, getTable_(GetTableRequest)=7, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:12,079  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210712_099ab422-108a-410c-adea-c690207374e2); Time taken: 0.011 seconds
2024-04-23T21:07:12,079  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210712_099ab422-108a-410c-adea-c690207374e2
2024-04-23T21:07:12,080  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210712_099ab422-108a-410c-adea-c690207374e2
2024-04-23T21:07:12,094  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210712_099ab422-108a-410c-adea-c690207374e2 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:07:12,094  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:12,094  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210712_099ab422-108a-410c-adea-c690207374e2): drop table if exists acidTbl
2024-04-23T21:07:12,094  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:12,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:12,101  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,101  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:12,108  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,108  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:12,212  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:12,212  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=111}
2024-04-23T21:07:12,213  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210712_099ab422-108a-410c-adea-c690207374e2); Time taken: 0.118 seconds
2024-04-23T21:07:12,213  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210712_099ab422-108a-410c-adea-c690207374e2
2024-04-23T21:07:12,216  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:07:12,222  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:12,223  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:07:12,224  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:12,224  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf): drop table if exists acidTblPart
2024-04-23T21:07:12,231  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T21:07:12,231  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:07:12,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:12,243  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,243  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:12,243  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:12,243  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:12,243  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=6, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getTable_(GetTableRequest)=9}
2024-04-23T21:07:12,243  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf); Time taken: 0.019 seconds
2024-04-23T21:07:12,243  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf
2024-04-23T21:07:12,244  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf
2024-04-23T21:07:12,262  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:07:12,262  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:12,262  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf): drop table if exists acidTblPart
2024-04-23T21:07:12,262  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:12,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:12,269  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,269  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:12,275  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:12,313  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:12,313  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=44}
2024-04-23T21:07:12,314  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf); Time taken: 0.051 seconds
2024-04-23T21:07:12,314  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210712_10c304e3-2cda-4749-875f-59a0386b1bcf
2024-04-23T21:07:12,317  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:07:12,322  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:12,322  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:07:12,323  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:12,323  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210712_be266e23-7da7-4eda-854f-79390f662fa5): drop table if exists acidTbl2
2024-04-23T21:07:12,325  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T21:07:12,326  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:07:12,326  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:12,326  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:12,326  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:12,327  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=1, getTable_(GetTableRequest)=0, getValidTxns_(long)=0}
2024-04-23T21:07:12,327  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210712_be266e23-7da7-4eda-854f-79390f662fa5); Time taken: 0.003 seconds
2024-04-23T21:07:12,327  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210712_be266e23-7da7-4eda-854f-79390f662fa5
2024-04-23T21:07:12,327  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:12,327  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210712_be266e23-7da7-4eda-854f-79390f662fa5): drop table if exists acidTbl2
2024-04-23T21:07:12,327  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:12,328  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:07:12,328  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:12,328  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:07:12,328  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210712_be266e23-7da7-4eda-854f-79390f662fa5); Time taken: 0.001 seconds
2024-04-23T21:07:12,328  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210712_be266e23-7da7-4eda-854f-79390f662fa5
2024-04-23T21:07:12,333  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:07:12,337  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:12,338  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:07:12,338  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:12,338  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:12,341  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T21:07:12,341  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:07:12,342  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:12,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,364  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:12,364  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:12,364  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:12,364  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=23, flushCache_()=0}
2024-04-23T21:07:12,364  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e); Time taken: 0.026 seconds
2024-04-23T21:07:12,365  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e
2024-04-23T21:07:12,365  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e
2024-04-23T21:07:12,380  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:07:12,380  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:12,380  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:12,380  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:12,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:12,409  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,409  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:12,423  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,424  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:12,515  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:12,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=106, getTable_(GetTableRequest)=29, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:12,515  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e); Time taken: 0.135 seconds
2024-04-23T21:07:12,516  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210712_e10fa1ca-d450-425d-af58-97afe242559e
2024-04-23T21:07:12,520  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:07:12,525  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:12,526  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:07:12,526  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:12,526  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:12,529  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T21:07:12,529  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:07:12,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:12,540  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,540  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:12,540  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:12,540  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:12,540  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=10, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:07:12,540  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b); Time taken: 0.014 seconds
2024-04-23T21:07:12,541  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b
2024-04-23T21:07:12,541  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b
2024-04-23T21:07:12,555  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:07:12,555  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:12,555  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:12,555  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:12,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:12,564  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:12,572  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:12,604  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:12,605  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=40, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8}
2024-04-23T21:07:12,605  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b); Time taken: 0.049 seconds
2024-04-23T21:07:12,605  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210712_77ef0e0f-6249-4c03-badd-7c6bfda7a38b
2024-04-23T21:07:12,609  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:07:12,616  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:12,616  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:07:12,616  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:12,617  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e): drop table if exists nonAcidNonBucket
2024-04-23T21:07:12,619  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:07:12,619  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:07:12,620  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:12,629  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,629  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:12,629  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:12,629  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:12,629  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=9}
2024-04-23T21:07:12,629  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e); Time taken: 0.012 seconds
2024-04-23T21:07:12,629  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e
2024-04-23T21:07:12,630  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e
2024-04-23T21:07:12,644  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:07:12,644  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:12,644  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e): drop table if exists nonAcidNonBucket
2024-04-23T21:07:12,644  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:12,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:12,654  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,654  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:12,663  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:12,663  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:12,694  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:12,694  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:12,694  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e); Time taken: 0.05 seconds
2024-04-23T21:07:12,695  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210712_3f34ada2-a13e-43ed-88d6-8fc53a06754e
2024-04-23T21:07:12,699  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:07:12,704  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:12,704  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:07:12,704  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="exchangePartitionShouldNotWorkForTransactionalTables" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.499"/>
  <testcase name="testMergeNegative2" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.314"/>
  <testcase name="testCompactionBlocking" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="6.174"/>
  <testcase name="testVersioningVersionFileDisabled" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="2.947">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update T set a=3 where b=2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:07:21,749  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:07:21,749  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:07:21,749  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:07:21,749  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:07:21,750  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:07:21,750  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:07:21,750  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:07:21,750  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:07:21,750  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:07:21,750  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:07:21,750  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:07:21,752  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 053a2e60-65c9-4888-9c80-3103ab7ab9cf
2024-04-23T21:07:21,754  INFO [main] SessionState: Hive Session ID = 053a2e60-65c9-4888-9c80-3103ab7ab9cf
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:21,755  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:21,760  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/053a2e60-65c9-4888-9c80-3103ab7ab9cf
2024-04-23T21:07:21,762  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf
2024-04-23T21:07:21,764  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/053a2e60-65c9-4888-9c80-3103ab7ab9cf/_tmp_space.db
2024-04-23T21:07:21,765  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=053a2e60-65c9-4888-9c80-3103ab7ab9cf, clientType=HIVECLI]
2024-04-23T21:07:21,765  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:21,765  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_58edc185-0cdc-4569-bf80-dbae24664e8b): drop table if exists acidTbl
2024-04-23T21:07:21,772  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:07:21,772  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:07:21,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:21,777  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,777  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,777  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,777  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=6, getValidTxns_(long)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:21,777  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_58edc185-0cdc-4569-bf80-dbae24664e8b); Time taken: 0.012 seconds
2024-04-23T21:07:21,778  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210721_58edc185-0cdc-4569-bf80-dbae24664e8b
2024-04-23T21:07:21,778  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:21,778  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_58edc185-0cdc-4569-bf80-dbae24664e8b): drop table if exists acidTbl
2024-04-23T21:07:21,778  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:21,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:21,781  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:21,781  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:21,781  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_58edc185-0cdc-4569-bf80-dbae24664e8b); Time taken: 0.003 seconds
2024-04-23T21:07:21,781  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_58edc185-0cdc-4569-bf80-dbae24664e8b
2024-04-23T21:07:21,786  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:07:21,791  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:21,791  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:07:21,791  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:21,792  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_0a10975f-941a-4fd1-9185-7ad8bed8766f): drop table if exists acidTblPart
2024-04-23T21:07:21,793  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:07:21,794  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:07:21,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:21,797  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,797  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,797  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:07:21,797  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_0a10975f-941a-4fd1-9185-7ad8bed8766f); Time taken: 0.005 seconds
2024-04-23T21:07:21,798  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210721_0a10975f-941a-4fd1-9185-7ad8bed8766f
2024-04-23T21:07:21,798  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:21,798  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_0a10975f-941a-4fd1-9185-7ad8bed8766f): drop table if exists acidTblPart
2024-04-23T21:07:21,798  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:21,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:21,801  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:21,801  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:21,801  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_0a10975f-941a-4fd1-9185-7ad8bed8766f); Time taken: 0.003 seconds
2024-04-23T21:07:21,801  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_0a10975f-941a-4fd1-9185-7ad8bed8766f
2024-04-23T21:07:21,806  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:07:21,811  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:21,811  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:07:21,812  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:21,812  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_33b692b6-18c4-4e96-b3fe-14492ec99af5): drop table if exists acidTbl2
2024-04-23T21:07:21,814  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:07:21,814  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:07:21,815  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:21,818  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,818  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,818  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,818  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:21,819  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_33b692b6-18c4-4e96-b3fe-14492ec99af5); Time taken: 0.006 seconds
2024-04-23T21:07:21,819  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210721_33b692b6-18c4-4e96-b3fe-14492ec99af5
2024-04-23T21:07:21,819  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:21,819  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_33b692b6-18c4-4e96-b3fe-14492ec99af5): drop table if exists acidTbl2
2024-04-23T21:07:21,819  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:21,819  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:21,822  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:21,822  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:21,822  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_33b692b6-18c4-4e96-b3fe-14492ec99af5); Time taken: 0.003 seconds
2024-04-23T21:07:21,822  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_33b692b6-18c4-4e96-b3fe-14492ec99af5
2024-04-23T21:07:21,827  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:07:21,831  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:21,831  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:07:21,832  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:21,832  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_d49a6be7-d1e1-4664-b871-9f1fbe448ba3): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:21,834  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:07:21,834  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:07:21,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:21,838  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,838  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T21:07:21,838  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_d49a6be7-d1e1-4664-b871-9f1fbe448ba3); Time taken: 0.006 seconds
2024-04-23T21:07:21,838  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210721_d49a6be7-d1e1-4664-b871-9f1fbe448ba3
2024-04-23T21:07:21,838  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:21,838  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_d49a6be7-d1e1-4664-b871-9f1fbe448ba3): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:21,839  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:21,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:21,841  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:21,842  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:21,842  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_d49a6be7-d1e1-4664-b871-9f1fbe448ba3); Time taken: 0.003 seconds
2024-04-23T21:07:21,842  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_d49a6be7-d1e1-4664-b871-9f1fbe448ba3
2024-04-23T21:07:21,846  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:07:21,851  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:21,851  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:07:21,852  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:21,852  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_07327d62-356d-4afa-9427-1a98abd8b7b0): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:21,854  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:07:21,854  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:07:21,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:21,858  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,858  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,858  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,858  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:07:21,858  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_07327d62-356d-4afa-9427-1a98abd8b7b0); Time taken: 0.006 seconds
2024-04-23T21:07:21,858  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210721_07327d62-356d-4afa-9427-1a98abd8b7b0
2024-04-23T21:07:21,858  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:21,858  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_07327d62-356d-4afa-9427-1a98abd8b7b0): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:21,859  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:21,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:21,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:21,862  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:21,862  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_07327d62-356d-4afa-9427-1a98abd8b7b0); Time taken: 0.003 seconds
2024-04-23T21:07:21,862  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_07327d62-356d-4afa-9427-1a98abd8b7b0
2024-04-23T21:07:21,867  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:07:21,873  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:21,873  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:07:21,873  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:21,873  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_d3d4833a-d97b-462d-a521-29e2b8184347): drop table if exists nonAcidNonBucket
2024-04-23T21:07:21,875  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:07:21,876  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:07:21,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:21,879  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,879  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,879  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,879  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:07:21,879  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_d3d4833a-d97b-462d-a521-29e2b8184347); Time taken: 0.006 seconds
2024-04-23T21:07:21,880  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210721_d3d4833a-d97b-462d-a521-29e2b8184347
2024-04-23T21:07:21,880  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:21,880  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_d3d4833a-d97b-462d-a521-29e2b8184347): drop table if exists nonAcidNonBucket
2024-04-23T21:07:21,880  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:21,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:21,883  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:21,883  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:21,883  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_d3d4833a-d97b-462d-a521-29e2b8184347); Time taken: 0.003 seconds
2024-04-23T21:07:21,883  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_d3d4833a-d97b-462d-a521-29e2b8184347
2024-04-23T21:07:21,888  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:07:21,893  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:21,893  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:07:21,894  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:21,894  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:21,896  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:07:21,897  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:07:21,897  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:21,897  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:21,903  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:07:21,903  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:21,905  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:21,905  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,905  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,906  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,906  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=2}
2024-04-23T21:07:21,906  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e); Time taken: 0.012 seconds
2024-04-23T21:07:21,906  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e
2024-04-23T21:07:21,907  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e
2024-04-23T21:07:21,923  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:07:21,923  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:21,924  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:21,924  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:21,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931641, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, totalSize=0, rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numRows=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:21,932  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:21,967  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:21,968  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=42}
2024-04-23T21:07:21,968  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e); Time taken: 0.043 seconds
2024-04-23T21:07:21,968  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_ca6b0c8a-2e21-4872-93ad-f136c700a52e
2024-04-23T21:07:21,972  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:07:21,978  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:21,979  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:07:21,979  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:21,979  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:21,984  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:07:21,984  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:07:21,985  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:21,985  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:21,987  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:07:21,988  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:21,989  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:21,989  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:21,989  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:21,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:21,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3}
2024-04-23T21:07:21,990  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da); Time taken: 0.011 seconds
2024-04-23T21:07:21,990  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da
2024-04-23T21:07:21,990  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da
2024-04-23T21:07:22,003  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:07:22,003  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:22,004  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:22,004  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:22,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931642, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:22,010  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:07:22,023  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:22,024  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T21:07:22,024  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da); Time taken: 0.019 seconds
2024-04-23T21:07:22,024  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210721_d5a8d002-7652-4c49-8a54-d345cfcf72da
2024-04-23T21:07:22,027  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:07:22,032  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:22,032  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:07:22,033  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,033  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,035  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:07:22,036  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:07:22,036  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:22,036  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:22,039  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:07:22,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:22,040  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:22,040  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:22,041  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:22,041  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:22,041  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:07:22,041  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e); Time taken: 0.008 seconds
2024-04-23T21:07:22,041  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e
2024-04-23T21:07:22,041  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e
2024-04-23T21:07:22,054  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:07:22,054  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:22,054  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,054  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:22,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931642, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numRows=0, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, bucketing_version=2, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:22,061  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:07:22,079  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:22,079  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:22,079  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e); Time taken: 0.025 seconds
2024-04-23T21:07:22,079  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210722_e71d0eca-fcf6-432a-ab5b-59d744b4dc4e
2024-04-23T21:07:22,082  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:07:22,088  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:22,088  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:07:22,088  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,089  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,091  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:07:22,091  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:07:22,092  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:22,092  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:22,094  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:07:22,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:22,096  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:22,096  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:22,096  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:22,096  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:22,096  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T21:07:22,096  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e); Time taken: 0.007 seconds
2024-04-23T21:07:22,096  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e
2024-04-23T21:07:22,096  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e
2024-04-23T21:07:22,112  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:07:22,112  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:22,112  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,112  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:22,113  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931642, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, rawDataSize=0, transactional=false, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:22,118  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:07:22,131  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:22,131  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T21:07:22,131  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e); Time taken: 0.019 seconds
2024-04-23T21:07:22,131  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210722_b00ffb73-a5c3-4918-b6f0-2486ff3d1a3e
2024-04-23T21:07:22,135  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:07:22,141  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:22,141  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:07:22,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:22,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:22,144  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:07:22,144  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:07:22,145  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:22,145  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:22,147  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:07:22,147  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:22,149  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:22,149  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:22,149  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:22,149  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:22,149  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:22,149  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3); Time taken: 0.007 seconds
2024-04-23T21:07:22,150  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3
2024-04-23T21:07:22,150  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3
2024-04-23T21:07:22,165  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:07:22,165  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:22,166  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:22,166  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:22,167  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/053a2e60-65c9-4888-9c80-3103ab7ab9cf/_tmp_space.db/7ee8d73a-8dc7-439e-82f9-2e1b49d0c5c3
2024-04-23T21:07:22,170  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:22,170  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:22,170  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3); Time taken: 0.004 seconds
2024-04-23T21:07:22,170  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210722_86bdeddc-2118-4015-86f7-4ea653739ef3
2024-04-23T21:07:22,173  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:07:22,178  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:22,178  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:07:22,179  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,179  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,181  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:07:22,182  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:07:22,182  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:22,182  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:22,185  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:07:22,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:22,187  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:22,187  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:22,187  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:22,187  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:22,187  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, flushCache_()=1}
2024-04-23T21:07:22,187  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c); Time taken: 0.008 seconds
2024-04-23T21:07:22,187  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c
2024-04-23T21:07:22,188  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c
2024-04-23T21:07:22,200  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:07:22,200  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:22,200  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:22,201  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:22,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931642, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2, transactional=false, rawDataSize=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:22,207  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:07:22,220  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:22,220  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-23T21:07:22,221  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c); Time taken: 0.02 seconds
2024-04-23T21:07:22,221  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210722_44624bbe-1902-499b-9083-a68b5af92a5c
2024-04-23T21:07:22,224  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:07:22,229  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:22,229  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:07:22,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T21:07:22,230  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1431bb0a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6f601deb will be shutdown
2024-04-23T21:07:22,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T21:07:22,230  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -8
2024-04-23T21:07:22,230  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:07:22,230  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210722_5bd22d88-d93f-409d-9b49-3f3203a1e77c): drop table if exists T
2024-04-23T21:07:22,231  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T21:07:22,232  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:07:22,232  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T21:07:22,233  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3d9aff8a, with PersistenceManager: null will be shutdown
2024-04-23T21:07:22,233  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3d9aff8a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@67d78645 created in the thread with id: 1
2024-04-23T21:07:22,251  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3d9aff8a from thread id: 1
2024-04-23T21:07:22,251  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T21:07:22,251  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T21:07:22,253  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:07:22,253  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:07:22,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:22,256  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:22,256  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:22,257  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:22,257  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:07:22,257  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210722_5bd22d88-d93f-409d-9b49-3f3203a1e77c); Time taken: 0.027 seconds
2024-04-23T21:07:22,257  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210722_5bd22d88-d93f-409d-9b49-3f3203a1e77c
2024-04-23T21:07:22,257  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:22,257  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210722_5bd22d88-d93f-409d-9b49-3f3203a1e77c): drop table if exists T
2024-04-23T21:07:22,257  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:22,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:22,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:22,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:22,260  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210722_5bd22d88-d93f-409d-9b49-3f3203a1e77c); Time taken: 0.002 seconds
2024-04-23T21:07:22,260  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210722_5bd22d88-d93f-409d-9b49-3f3203a1e77c
2024-04-23T21:07:22,264  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:07:22,269  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:22,270  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:07:22,270  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) stored as orc
2024-04-23T21:07:22,270  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025): create table T (a int, b int) stored as orc
2024-04-23T21:07:22,272  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:07:22,273  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:07:22,273  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:22,273  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:22,278  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:07:22,279  INFO [main] parse.CalcitePlanner: Automatically chose to make default.T acid.
2024-04-23T21:07:22,279  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:22,280  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:22,280  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:22,280  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:22,280  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:22,280  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, getValidWriteIds_(List, String)=5, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:22,280  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025); Time taken: 0.01 seconds
2024-04-23T21:07:22,281  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025
2024-04-23T21:07:22,281  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025
2024-04-23T21:07:22,297  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:07:22,297  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:22,298  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025): create table T (a int, b int) stored as orc
2024-04-23T21:07:22,298  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:22,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931642, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, transactional=true, transactional_properties=default, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:22,302  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:22,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:22,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=29}
2024-04-23T21:07:22,329  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025); Time taken: 0.031 seconds
2024-04-23T21:07:22,329  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210722_cf7cf7c3-e116-446b-a788-512329d37025
2024-04-23T21:07:22,333  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:07:22,338  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:22,338  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:07:22,338  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into T values(1,2)
2024-04-23T21:07:22,339  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5): insert into T values(1,2)
2024-04-23T21:07:22,342  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:07:22,342  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:07:22,343  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:22,343  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:22,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:22,366  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:22,366  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:22,366  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:22,366  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:22,366  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:22,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:22,373  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:22,373  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:22,373  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:22,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:22,491  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:22,491  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:22,491  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:22,491  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:22,494  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:22,494  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:22,494  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:22,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:22,500  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:22,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T21:07:22,503  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T21:07:22,511  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 15
2024-04-23T21:07:22,511  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [15])
2024-04-23T21:07:22,512  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:22,515  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:22,515  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:22,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:22,531  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:22,532  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:22,532  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:22,532  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:22,532  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:22,532  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:22,532  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:22,532  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:22,532  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:22,532  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:22,532  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:22,532  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:07:22,532  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:22,532  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=40, allocateTableWriteId_(long, String, String)=8, flushCache_()=0, getCheckConstraints_(CheckConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2, getAllTableConstraints_(AllTableConstraintsRequest)=30, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-23T21:07:22,533  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5); Time taken: 0.193 seconds
2024-04-23T21:07:22,533  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5
2024-04-23T21:07:22,533  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5
2024-04-23T21:07:22,549  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:07:22,549  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:22,551  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5): insert into T values(1,2)
2024-04-23T21:07:22,552  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5
2024-04-23T21:07:22,552  INFO [main] ql.Driver: Query ID = alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5
Total jobs = 1
2024-04-23T21:07:22,552  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:22,552  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:22,678  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:07:22,678  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:07:22,681  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:22,681  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:22,681  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf/hive_2024-04-23_21-07-22_338_600288223694302714-1/dummy_path
2024-04-23T21:07:22,690  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:22,691  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,66KB
2024-04-23T21:07:22,692  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:22,695  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf/hive_2024-04-23_21-07-22_338_600288223694302714-1/-mr-10000
2024-04-23T21:07:22,697  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:22,704  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:22,708  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:22,709  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:22,709  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:22,709  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf/hive_2024-04-23_21-07-22_338_600288223694302714-1/dummy_path
2024-04-23T21:07:22,710  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:22,727  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:22,745  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1633459989_0034
2024-04-23T21:07:22,745  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:22,818  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:22,818  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:22,819  INFO [Thread-2826] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:22,819  INFO [Thread-2826] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:22,820  INFO [Thread-2826] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:22,821  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1633459989_0034_m_000000_0
2024-04-23T21:07:22,823  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:22,824  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf/hive_2024-04-23_21-07-22_338_600288223694302714-1/dummy_path/null:0+1
2024-04-23T21:07:22,826  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:22,826  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,66KB
2024-04-23T21:07:22,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:07:22,828  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:22,829  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:22,829  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:22,829  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:22,830  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:22,830  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:22,830  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:22,830  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:22,830  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:07:22,830  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1633459989_0034/job_local1633459989_0034.xml], properties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@477ccd25
2024-04-23T21:07:22,831  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:22,831  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:22,831  INFO [LocalJobRunner Map Task Executor #0] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:22,833  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:22,833  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:22,840  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:22,840  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:22,840  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:22,840  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:22,840  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:1, 
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:07:22,841  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:22,842  INFO [LocalJobRunner Map Task Executor #0] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:07:22,853  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.t:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_4:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:22,854  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:22,856  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1633459989_0034_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:22,856  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:22,856  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1633459989_0034_m_000000_0' done.
2024-04-23T21:07:22,856  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1633459989_0034_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=760273
		FILE: Number of bytes written=42652700
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=360
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1353187328
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.t=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	File Input Format Counters 
		Bytes Read=5722
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:22,856  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1633459989_0034_m_000000_0
2024-04-23T21:07:22,856  INFO [Thread-2826] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:07:23,820 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:07:23,820  INFO [main] exec.Task: 2024-04-23 21:07:23,820 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1633459989_0034
2024-04-23T21:07:23,821  INFO [main] exec.Task: Ended Job = job_local1633459989_0034
2024-04-23T21:07:23,822  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:23,822  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:07:23,822  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000
2024-04-23T21:07:23,823  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.t
2024-04-23T21:07:23,823  INFO [main] exec.Task: Loading data to table default.t from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:23,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:23,830  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:23,836  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T21:07:23,863  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:23,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:23,869  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,869  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:23,869  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf/hive_2024-04-23_21-07-22_338_600288223694302714-1/-mr-10000
2024-04-23T21:07:23,870  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:23,876  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,882  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:23,882  INFO [main] FileOperations: Read stats for default.t/, numRows, true, 1, false: 
2024-04-23T21:07:23,882  INFO [main] FileOperations: Read stats for default.t/, rawDataSize, true, 0, false: 
2024-04-23T21:07:23,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T21:07:23,901  INFO [main] FileOperations: Read stats for default.t/, insertCount, true, 1, false: 
2024-04-23T21:07:23,901  INFO [main] FileOperations: Read stats for default.t/, updateCount, true, 0, false: 
2024-04-23T21:07:23,901  INFO [main] FileOperations: Read stats for default.t/, deleteCount, true, 0, false: 
2024-04-23T21:07:23,903  INFO [main] stats.BasicStatsTask: Table default.t stats: [numFiles=1, numRows=1, totalSize=666, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:23,904  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:23,904  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=25, alter_table_(String, String, String, Table, EnvironmentContext, String)=45, isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-23T21:07:23,904  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:23,904  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:23,905  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:23,905  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5); Time taken: 1.353 seconds
2024-04-23T21:07:23,905  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210722_62ccb151-a57b-4826-895f-b63d899f30f5
2024-04-23T21:07:23,913  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:23,914  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:07:23,914  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update T set a=3 where b=2
2024-04-23T21:07:23,914  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf/hive_2024-04-23_21-07-22_338_600288223694302714-1
2024-04-23T21:07:23,915  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/053a2e60-65c9-4888-9c80-3103ab7ab9cf/hive_2024-04-23_21-07-22_338_600288223694302714-1 on fs with scheme file
2024-04-23T21:07:23,915  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210723_92803de9-aaf0-4ce1-8165-c88624e3e835): update T set a=3 where b=2
2024-04-23T21:07:23,918  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T21:07:23,919  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:07:23,919  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:07:23,920  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:23,926  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,926  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update T set a=3 where b=2> as 
<insert into table `default`.`T` select ROW__ID,`a`,`b` from `default`.`T` sort by ROW__ID >
2024-04-23T21:07:23,926  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:07:23,930  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:23,936  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,937  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:23,937  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:23,937  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:23,943  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,944  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:23,944  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:23,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:23,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:23,951  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:23,951  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:23,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:07:23,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T21:07:23,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T21:07:23,994  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [1], allowMissingStats: true
2024-04-23T21:07:23,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:24,004  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:24,013  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.t	
2024-04-23T21:07:24,023  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b
No Stats for default@t, Columns: b
2024-04-23T21:07:24,023  INFO [main] SessionState: No Stats for default@t, Columns: b
2024-04-23T21:07:24,080  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:24,080  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:24,080  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:24,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:24,087  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,090 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:07:24,091 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:07:24,091  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:07:24,091 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:07:24,092  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,092  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=5, getNotNullConstraints_(NotNullConstraintsRequest)=2, getValidTxns_(long)=0, getTableColumnStatistics_(String, String, List, String)=29, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, getCheckConstraints_(CheckConstraintsRequest)=1, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=35, getValidWriteIds_(List, String)=5}
2024-04-23T21:07:24,092  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210723_92803de9-aaf0-4ce1-8165-c88624e3e835); Time taken: 0.177 seconds
2024-04-23T21:07:24,092  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:07:24,095  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,101  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:24,101  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059): drop table if exists acidTbl
2024-04-23T21:07:24,103  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T21:07:24,103  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:07:24,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:24,110  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,110  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,110  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,110  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,110  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, rollbackTxn_(long)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, openTxn_(String, TxnType)=1}
2024-04-23T21:07:24,110  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059); Time taken: 0.009 seconds
2024-04-23T21:07:24,111  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059
2024-04-23T21:07:24,111  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059
2024-04-23T21:07:24,124  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:07:24,124  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:24,124  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059): drop table if exists acidTbl
2024-04-23T21:07:24,124  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:24,130  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,130  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:24,136  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,136  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:24,220  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,220  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=90}
2024-04-23T21:07:24,220  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059); Time taken: 0.096 seconds
2024-04-23T21:07:24,220  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_cd6e7f66-572c-4820-b24f-593427301059
2024-04-23T21:07:24,224  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:07:24,228  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,229  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:07:24,229  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:24,229  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c): drop table if exists acidTblPart
2024-04-23T21:07:24,231  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T21:07:24,232  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:07:24,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:24,238  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,238  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,238  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,239  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,239  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=6, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, flushCache_()=0}
2024-04-23T21:07:24,239  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c); Time taken: 0.009 seconds
2024-04-23T21:07:24,239  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c
2024-04-23T21:07:24,239  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c
2024-04-23T21:07:24,253  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:07:24,253  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:24,253  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c): drop table if exists acidTblPart
2024-04-23T21:07:24,254  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:24,260  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:24,266  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:24,301  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,301  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=41, getTable_(GetTableRequest)=6}
2024-04-23T21:07:24,302  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c); Time taken: 0.048 seconds
2024-04-23T21:07:24,302  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_f7f05c1a-8704-4da6-8cf6-69fe1a19213c
2024-04-23T21:07:24,305  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:07:24,310  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,310  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:07:24,311  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:24,311  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_fc0e3066-172e-4ac7-98a5-065496e64e21): drop table if exists acidTbl2
2024-04-23T21:07:24,313  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T21:07:24,313  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:07:24,314  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,314  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,314  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,314  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-23T21:07:24,314  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_fc0e3066-172e-4ac7-98a5-065496e64e21); Time taken: 0.003 seconds
2024-04-23T21:07:24,314  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210724_fc0e3066-172e-4ac7-98a5-065496e64e21
2024-04-23T21:07:24,314  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:24,314  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_fc0e3066-172e-4ac7-98a5-065496e64e21): drop table if exists acidTbl2
2024-04-23T21:07:24,315  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,315  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:07:24,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,315  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:07:24,316  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_fc0e3066-172e-4ac7-98a5-065496e64e21); Time taken: 0.001 seconds
2024-04-23T21:07:24,316  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_fc0e3066-172e-4ac7-98a5-065496e64e21
2024-04-23T21:07:24,320  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:07:24,325  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,325  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:07:24,326  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:24,326  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:24,328  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T21:07:24,328  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:07:24,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:24,348  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,348  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,348  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,348  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=19, openTxn_(String, TxnType)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-23T21:07:24,348  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2); Time taken: 0.022 seconds
2024-04-23T21:07:24,349  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2
2024-04-23T21:07:24,349  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2
2024-04-23T21:07:24,362  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:07:24,362  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:24,362  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:24,362  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,362  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:24,370  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:24,377  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:24,454  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,454  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=84}
2024-04-23T21:07:24,455  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2); Time taken: 0.092 seconds
2024-04-23T21:07:24,455  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_94a30f65-6329-4e57-8899-96248f51cab2
2024-04-23T21:07:24,458  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:07:24,464  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,464  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:07:24,464  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:24,465  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:24,472  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:07:24,472  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:07:24,475  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:24,482  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,482  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,482  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,482  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,483  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=7, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=7}
2024-04-23T21:07:24,483  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f); Time taken: 0.017 seconds
2024-04-23T21:07:24,483  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f
2024-04-23T21:07:24,484  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f
2024-04-23T21:07:24,496  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:07:24,496  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:24,496  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:24,497  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,497  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:24,504  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:24,512  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:24,541  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,541  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=37, getTable_(GetTableRequest)=7}
2024-04-23T21:07:24,542  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f); Time taken: 0.045 seconds
2024-04-23T21:07:24,542  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_b715b852-9dac-4130-a81a-1a8c7f5ffc0f
2024-04-23T21:07:24,546  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:07:24,552  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,553  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:07:24,553  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:24,553  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191): drop table if exists nonAcidNonBucket
2024-04-23T21:07:24,556  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 16
2024-04-23T21:07:24,556  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:07:24,557  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:24,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,565  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,565  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,565  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:07:24,566  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191); Time taken: 0.012 seconds
2024-04-23T21:07:24,566  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191
2024-04-23T21:07:24,566  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191
2024-04-23T21:07:24,580  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:07:24,580  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:24,580  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191): drop table if exists nonAcidNonBucket
2024-04-23T21:07:24,580  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,580  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:24,588  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:24,597  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:24,597  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:24,626  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,626  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=38}
2024-04-23T21:07:24,626  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191); Time taken: 0.046 seconds
2024-04-23T21:07:24,627  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_2d56048d-da9d-4d31-8ed1-a6378d53a191
2024-04-23T21:07:24,630  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:07:24,636  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,636  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:07:24,637  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMultipleDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.442">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 8 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:07:24,699  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:07:24,701  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 44f10140-127d-459a-8f5c-fa74aa2b887e
2024-04-23T21:07:24,704  INFO [main] SessionState: Hive Session ID = 44f10140-127d-459a-8f5c-fa74aa2b887e
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:24,705  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:24,710  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/44f10140-127d-459a-8f5c-fa74aa2b887e
2024-04-23T21:07:24,712  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e
2024-04-23T21:07:24,714  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/44f10140-127d-459a-8f5c-fa74aa2b887e/_tmp_space.db
2024-04-23T21:07:24,715  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=44f10140-127d-459a-8f5c-fa74aa2b887e, clientType=HIVECLI]
2024-04-23T21:07:24,715  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:24,715  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_4218f859-3ba8-4daa-9a8c-36988f39d7c5): drop table if exists acidTbl
2024-04-23T21:07:24,722  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:07:24,723  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:07:24,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:24,728  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,728  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,728  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,728  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=8}
2024-04-23T21:07:24,728  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_4218f859-3ba8-4daa-9a8c-36988f39d7c5); Time taken: 0.013 seconds
2024-04-23T21:07:24,728  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210724_4218f859-3ba8-4daa-9a8c-36988f39d7c5
2024-04-23T21:07:24,729  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:24,729  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_4218f859-3ba8-4daa-9a8c-36988f39d7c5): drop table if exists acidTbl
2024-04-23T21:07:24,729  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:24,732  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,732  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,732  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_4218f859-3ba8-4daa-9a8c-36988f39d7c5); Time taken: 0.003 seconds
2024-04-23T21:07:24,732  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_4218f859-3ba8-4daa-9a8c-36988f39d7c5
2024-04-23T21:07:24,737  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:07:24,742  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,742  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:07:24,743  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:24,743  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_1e533f85-b6df-4892-a90a-7d83b3780853): drop table if exists acidTblPart
2024-04-23T21:07:24,745  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:07:24,745  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:07:24,746  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:24,748  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,748  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,748  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,748  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2}
2024-04-23T21:07:24,749  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_1e533f85-b6df-4892-a90a-7d83b3780853); Time taken: 0.005 seconds
2024-04-23T21:07:24,749  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210724_1e533f85-b6df-4892-a90a-7d83b3780853
2024-04-23T21:07:24,749  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:24,749  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_1e533f85-b6df-4892-a90a-7d83b3780853): drop table if exists acidTblPart
2024-04-23T21:07:24,749  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:24,752  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,752  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,752  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_1e533f85-b6df-4892-a90a-7d83b3780853); Time taken: 0.003 seconds
2024-04-23T21:07:24,753  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_1e533f85-b6df-4892-a90a-7d83b3780853
2024-04-23T21:07:24,758  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:07:24,762  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,763  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:07:24,763  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:24,763  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_cfa1712d-ee15-43c7-912c-2aca975afcd0): drop table if exists acidTbl2
2024-04-23T21:07:24,765  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:07:24,766  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:07:24,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:24,769  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,769  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,769  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,769  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,769  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_cfa1712d-ee15-43c7-912c-2aca975afcd0); Time taken: 0.006 seconds
2024-04-23T21:07:24,769  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210724_cfa1712d-ee15-43c7-912c-2aca975afcd0
2024-04-23T21:07:24,769  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:24,770  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_cfa1712d-ee15-43c7-912c-2aca975afcd0): drop table if exists acidTbl2
2024-04-23T21:07:24,770  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:24,772  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,773  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,773  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_cfa1712d-ee15-43c7-912c-2aca975afcd0); Time taken: 0.002 seconds
2024-04-23T21:07:24,773  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_cfa1712d-ee15-43c7-912c-2aca975afcd0
2024-04-23T21:07:24,777  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:07:24,783  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,783  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:07:24,783  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:24,784  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_b66055fe-6213-41ae-ba0b-1e276617522e): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:24,785  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:07:24,786  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:07:24,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:24,789  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,789  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,789  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,789  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,789  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_b66055fe-6213-41ae-ba0b-1e276617522e); Time taken: 0.005 seconds
2024-04-23T21:07:24,790  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210724_b66055fe-6213-41ae-ba0b-1e276617522e
2024-04-23T21:07:24,790  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:24,790  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_b66055fe-6213-41ae-ba0b-1e276617522e): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:24,790  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,790  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:24,793  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,793  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,793  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_b66055fe-6213-41ae-ba0b-1e276617522e); Time taken: 0.003 seconds
2024-04-23T21:07:24,793  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_b66055fe-6213-41ae-ba0b-1e276617522e
2024-04-23T21:07:24,798  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:07:24,803  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,803  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:07:24,804  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:24,804  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_5338d56d-1e0a-4e00-bb6e-e8f1932ac06a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:24,806  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:07:24,806  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:07:24,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:24,809  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,809  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,809  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,809  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:24,810  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_5338d56d-1e0a-4e00-bb6e-e8f1932ac06a); Time taken: 0.005 seconds
2024-04-23T21:07:24,810  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210724_5338d56d-1e0a-4e00-bb6e-e8f1932ac06a
2024-04-23T21:07:24,810  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:24,810  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_5338d56d-1e0a-4e00-bb6e-e8f1932ac06a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:24,810  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:24,813  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,813  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,813  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_5338d56d-1e0a-4e00-bb6e-e8f1932ac06a); Time taken: 0.003 seconds
2024-04-23T21:07:24,813  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_5338d56d-1e0a-4e00-bb6e-e8f1932ac06a
2024-04-23T21:07:24,818  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:07:24,822  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,823  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:07:24,823  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:24,824  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_b8e79c82-e516-477e-afee-9b45a45bec4d): drop table if exists nonAcidNonBucket
2024-04-23T21:07:24,826  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:07:24,826  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:07:24,826  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:24,829  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,829  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,829  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,829  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:24,830  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_b8e79c82-e516-477e-afee-9b45a45bec4d); Time taken: 0.006 seconds
2024-04-23T21:07:24,830  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210724_b8e79c82-e516-477e-afee-9b45a45bec4d
2024-04-23T21:07:24,830  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:24,830  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_b8e79c82-e516-477e-afee-9b45a45bec4d): drop table if exists nonAcidNonBucket
2024-04-23T21:07:24,830  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:24,833  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,833  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,833  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_b8e79c82-e516-477e-afee-9b45a45bec4d); Time taken: 0.003 seconds
2024-04-23T21:07:24,833  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_b8e79c82-e516-477e-afee-9b45a45bec4d
2024-04-23T21:07:24,838  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:07:24,843  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,843  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:07:24,844  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:24,844  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:24,846  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:07:24,846  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:07:24,847  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:24,847  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:24,851  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:07:24,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:24,853  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:24,853  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,853  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,853  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,853  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=1, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:07:24,854  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e); Time taken: 0.009 seconds
2024-04-23T21:07:24,854  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e
2024-04-23T21:07:24,854  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e
2024-04-23T21:07:24,871  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:07:24,871  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:24,872  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:24,872  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931644, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, numFiles=0, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:24,878  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:24,907  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,908  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=35}
2024-04-23T21:07:24,908  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e); Time taken: 0.035 seconds
2024-04-23T21:07:24,908  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_1bd23a50-c2f6-464f-ad1a-3add2d56fc4e
2024-04-23T21:07:24,911  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:07:24,916  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,917  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:07:24,918  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:24,918  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:24,920  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:07:24,921  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:07:24,921  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:24,921  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:24,923  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:07:24,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:24,925  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:24,925  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,925  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:24,925  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3); Time taken: 0.007 seconds
2024-04-23T21:07:24,926  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3
2024-04-23T21:07:24,926  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3
2024-04-23T21:07:24,939  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:07:24,939  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:24,940  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:24,940  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931644, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:24,946  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:07:24,964  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:24,964  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:24,964  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3); Time taken: 0.024 seconds
2024-04-23T21:07:24,964  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_5b68e0ec-2061-4254-9ea0-4643651de4b3
2024-04-23T21:07:24,968  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:07:24,974  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:24,974  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:07:24,975  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:24,975  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:24,978  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:07:24,979  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:07:24,979  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:24,979  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:24,982  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:07:24,982  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:24,984  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:24,984  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:24,984  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:24,984  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:24,984  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=3}
2024-04-23T21:07:24,984  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be); Time taken: 0.009 seconds
2024-04-23T21:07:24,985  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be
2024-04-23T21:07:24,985  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be
2024-04-23T21:07:24,998  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:07:24,998  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:24,998  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:24,999  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:24,999  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931644, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numFiles=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, totalSize=0, transactional=false, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:25,005  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:07:25,021  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:25,021  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T21:07:25,021  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be); Time taken: 0.023 seconds
2024-04-23T21:07:25,021  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210724_214523ac-66b7-4b67-ae7a-3be0b73654be
2024-04-23T21:07:25,025  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:07:25,032  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:25,032  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:07:25,033  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:25,033  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:25,035  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:07:25,036  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:07:25,036  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:25,036  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:25,039  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:07:25,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:25,041  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:25,041  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:25,041  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:25,041  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:25,041  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-23T21:07:25,042  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb); Time taken: 0.008 seconds
2024-04-23T21:07:25,042  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb
2024-04-23T21:07:25,042  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb
2024-04-23T21:07:25,057  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:07:25,057  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:25,057  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:25,057  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:25,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931645, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false, rawDataSize=0, numRows=0, numFilesErasureCoded=0, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:25,064  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:07:25,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:25,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:25,080  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb); Time taken: 0.023 seconds
2024-04-23T21:07:25,080  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210725_f00c1793-43a0-43b9-835f-81481fc42dcb
2024-04-23T21:07:25,084  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:07:25,091  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:25,092  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:07:25,092  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:25,092  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:25,095  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:07:25,095  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:07:25,096  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:25,096  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:25,099  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:07:25,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:25,101  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:25,101  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:25,101  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:25,102  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:25,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, flushCache_()=0, getDatabase_(String)=2}
2024-04-23T21:07:25,102  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443); Time taken: 0.01 seconds
2024-04-23T21:07:25,102  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443
2024-04-23T21:07:25,103  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443
2024-04-23T21:07:25,119  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:07:25,119  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:25,120  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:25,120  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:25,121  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/44f10140-127d-459a-8f5c-fa74aa2b887e/_tmp_space.db/fa1dc8c2-d7ad-48ce-af49-1b0635204143
2024-04-23T21:07:25,124  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:25,124  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:25,125  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443); Time taken: 0.004 seconds
2024-04-23T21:07:25,125  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210725_d37fe90e-7365-4f4d-8f3a-a3642d02a443
2024-04-23T21:07:25,129  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:07:25,135  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:25,136  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:07:25,136  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:25,136  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:25,139  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:07:25,139  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:07:25,140  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:25,140  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:25,143  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:07:25,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:25,145  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:25,145  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:25,145  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:25,145  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:25,145  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:25,145  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa); Time taken: 0.009 seconds
2024-04-23T21:07:25,145  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa
2024-04-23T21:07:25,146  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa
2024-04-23T21:07:25,161  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:07:25,161  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:25,161  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:25,161  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:25,162  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931645, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, numFiles=0, transactional=false, bucketing_version=2, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:25,168  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:07:25,181  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:25,181  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:25,182  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa); Time taken: 0.02 seconds
2024-04-23T21:07:25,182  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210725_e30c1601-da14-41ad-915e-bc8849a658aa
2024-04-23T21:07:25,186  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:07:25,193  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:25,193  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:07:25,194  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-23T21:07:25,194  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b): insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-23T21:07:25,196  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:07:25,197  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:07:25,197  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:25,197  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:25,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:25,227  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:25,228  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:25,228  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:25,228  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:25,228  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:25,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:25,239  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:25,239  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:25,239  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:25,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:25,341  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:25,341  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:25,341  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:25,342  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:25,345  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:25,345  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:25,345  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:25,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:25,352  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:25,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:25,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:25,366  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T21:07:25,367  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T21:07:25,367  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:25,372  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:25,372  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:25,373  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:25,374  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:25,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:25,393  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:25,394  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:25,394  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:25,394  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:25,394  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:25,394  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:25,394  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:25,394  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:25,395  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:25,395  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:25,395  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:25,395  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:25,395  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:25,395  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:25,395  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:25,395  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:25,395  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:07:25,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:25,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=33, getTable_(GetTableRequest)=55, allocateTableWriteId_(long, String, String)=9, openTxn_(String, TxnType)=2, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:07:25,395  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b); Time taken: 0.201 seconds
2024-04-23T21:07:25,395  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b
2024-04-23T21:07:25,396  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b
2024-04-23T21:07:25,420  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:07:25,420  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:25,424  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b): insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-23T21:07:25,424  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b
2024-04-23T21:07:25,424  INFO [main] ql.Driver: Query ID = alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b
Total jobs = 1
2024-04-23T21:07:25,424  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:25,424  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:25,563  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:25,563  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:25,563  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:25,563  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:25,563  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:25,563  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:25,563  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:25,563  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:25,566  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:25,566  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:25,566  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-25_194_7371364815220334941-1/dummy_path
2024-04-23T21:07:25,576  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:25,577  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:07:25,581  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:25,582  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:07:25,583  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:25,587  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-25_194_7371364815220334941-1/-mr-10000
2024-04-23T21:07:25,590  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:25,598  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:25,602  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:25,603  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:25,603  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:25,603  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-25_194_7371364815220334941-1/dummy_path
2024-04-23T21:07:25,604  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:25,622  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:25,644  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1479818088_0035
2024-04-23T21:07:25,644  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:25,707  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:25,707  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:25,708  INFO [Thread-2901] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:25,708  INFO [Thread-2901] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:25,710  INFO [Thread-2901] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:25,710  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1479818088_0035_m_000000_0
2024-04-23T21:07:25,713  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:25,713  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-25_194_7371364815220334941-1/dummy_path/null:0+1
2024-04-23T21:07:25,716  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:25,716  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T21:07:25,717  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:25,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:25,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:25,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:25,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:25,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:25,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:25,723  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:25,723  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:07:25,724  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:07:25,725  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:25,725  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:07:25,725  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:07:25,726  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:25,727  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T21:07:25,727  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:25,727  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:25,727  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:07:25,727  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T21:07:25,727  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T21:07:25,729  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:25,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:25,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:25,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T21:07:25,729  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T21:07:25,740  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:25,744  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1479818088_0035_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:25,745  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:25,745  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1479818088_0035_m_000000_0' done.
2024-04-23T21:07:25,745  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1479818088_0035_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=766391
		FILE: Number of bytes written=43908377
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1353187328
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5406
2024-04-23T21:07:25,746  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1479818088_0035_m_000000_0
2024-04-23T21:07:25,746  INFO [Thread-2901] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:25,747  INFO [Thread-2901] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:25,747  INFO [pool-173-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1479818088_0035_r_000000_0
2024-04-23T21:07:25,750  INFO [pool-173-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:25,750  INFO [pool-173-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5d574c14
2024-04-23T21:07:25,750  WARN [pool-173-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:25,751  INFO [pool-173-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:25,751  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1479818088_0035_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:25,754  INFO [localfetcher#49] reduce.LocalFetcher: localfetcher#49 about to shuffle output of map attempt_local1479818088_0035_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:07:25,754  INFO [localfetcher#49] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1479818088_0035_m_000000_0
2024-04-23T21:07:25,754  INFO [localfetcher#49] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:07:25,755  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:25,755  INFO [pool-173-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:25,755  INFO [pool-173-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:25,761  INFO [pool-173-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:25,761  INFO [pool-173-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:07:25,764  INFO [pool-173-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:25,764  INFO [pool-173-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:07:25,764  INFO [pool-173-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:25,764  INFO [pool-173-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:25,764  INFO [pool-173-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:07:25,765  INFO [pool-173-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:25,765  INFO [pool-173-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:25,765  INFO [pool-173-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:07:25,766  INFO [pool-173-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:25,767  INFO [pool-173-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:25,767  INFO [pool-173-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:25,767  INFO [pool-173-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:25,767  INFO [pool-173-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1479818088_0035/job_local1479818088_0035.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6ae1ec2a
2024-04-23T21:07:25,767  INFO [pool-173-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:25,767  INFO [pool-173-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:25,767  INFO [pool-173-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:25,768  INFO [pool-173-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:25,768  INFO [pool-173-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:25,775  INFO [pool-173-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:25,780  INFO [pool-173-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:25,780  INFO [pool-173-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:07:25,780  INFO [pool-173-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:25,780  INFO [pool-173-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:07:25,782  INFO [pool-173-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:07:25,793  INFO [pool-173-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-23T21:07:25,793  INFO [pool-173-thread-1] mapred.Task: Task:attempt_local1479818088_0035_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:25,794  INFO [pool-173-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:25,794  INFO [pool-173-thread-1] mapred.Task: Task 'attempt_local1479818088_0035_r_000000_0' done.
2024-04-23T21:07:25,794  INFO [pool-173-thread-1] mapred.Task: Final Counters for attempt_local1479818088_0035_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=772596
		FILE: Number of bytes written=43909453
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1353187328
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:25,794  INFO [pool-173-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1479818088_0035_r_000000_0
2024-04-23T21:07:25,794  INFO [pool-173-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1479818088_0035_r_000001_0
2024-04-23T21:07:25,794  INFO [pool-173-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:25,794  INFO [pool-173-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@194e721a
2024-04-23T21:07:25,795  WARN [pool-173-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:25,795  INFO [pool-173-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:25,796  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1479818088_0035_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:25,798  INFO [localfetcher#50] reduce.LocalFetcher: localfetcher#50 about to shuffle output of map attempt_local1479818088_0035_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:07:25,798  INFO [localfetcher#50] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1479818088_0035_m_000000_0
2024-04-23T21:07:25,798  INFO [localfetcher#50] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:07:25,799  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:25,799  INFO [pool-173-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:25,799  INFO [pool-173-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:25,805  INFO [pool-173-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:25,805  INFO [pool-173-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:07:25,808  INFO [pool-173-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:25,808  INFO [pool-173-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:07:25,808  INFO [pool-173-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:25,808  INFO [pool-173-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:25,808  INFO [pool-173-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:07:25,808  INFO [pool-173-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:25,809  INFO [pool-173-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:25,809  INFO [pool-173-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1479818088_0035/job_local1479818088_0035.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5b6f4937
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:25,810  INFO [pool-173-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:25,811  INFO [pool-173-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:25,811  INFO [pool-173-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:25,816  INFO [pool-173-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:25,816  INFO [pool-173-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:25,816  INFO [pool-173-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:07:25,816  INFO [pool-173-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:25,816  INFO [pool-173-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:07:25,818  INFO [pool-173-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:07:25,827  INFO [pool-173-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T21:07:25,828  INFO [pool-173-thread-1] mapred.Task: Task:attempt_local1479818088_0035_r_000001_0 is done. And is in the process of committing
2024-04-23T21:07:25,828  INFO [pool-173-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:25,828  INFO [pool-173-thread-1] mapred.Task: Task 'attempt_local1479818088_0035_r_000001_0' done.
2024-04-23T21:07:25,828  INFO [pool-173-thread-1] mapred.Task: Final Counters for attempt_local1479818088_0035_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=778759
		FILE: Number of bytes written=43910525
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1353187328
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:25,828  INFO [pool-173-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1479818088_0035_r_000001_0
2024-04-23T21:07:25,829  INFO [Thread-2901] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:26,711 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:26,711  INFO [main] exec.Task: 2024-04-23 21:07:26,711 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1479818088_0035
2024-04-23T21:07:26,711  INFO [main] exec.Task: Ended Job = job_local1479818088_0035
2024-04-23T21:07:26,712  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:26,712  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:07:26,713  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:07:26,713  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:07:26,713  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:07:26,714  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:07:26,714  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:26,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,721  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:26,721  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,728  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:26,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:26,765  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:26,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,772  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:26,772  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:26,772  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-25_194_7371364815220334941-1/-mr-10000
2024-04-23T21:07:26,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,790  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:26,801  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:26,801  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T21:07:26,801  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:07:26,801  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:26,821  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T21:07:26,821  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:07:26,821  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:07:26,824  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1389, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:26,824  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:26,825  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=56, getTable_(GetTableRequest)=26, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3}
MapReduce Jobs Launched: 
2024-04-23T21:07:26,825  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:26,825  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:26,825  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:26,825  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b); Time taken: 1.4 seconds
2024-04-23T21:07:26,825  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210725_deed88f8-9668-4b21-8461-56a7c047573b
2024-04-23T21:07:26,835  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:26,835  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:07:26,836  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T21:07:26,836  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-25_194_7371364815220334941-1
2024-04-23T21:07:26,837  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-25_194_7371364815220334941-1 on fs with scheme file
2024-04-23T21:07:26,837  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf): select a,b from acidTbl order by a,b
2024-04-23T21:07:26,842  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:07:26,842  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:07:26,843  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:26,843  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:26,846  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:26,846  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:26,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,853  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:26,853  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:26,853  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:26,854  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:26,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,890  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:07:26,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,899  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:26,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:26,908  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:26,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:26,920  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T21:07:26,920  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T21:07:26,960  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:26,960  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:26,960  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:26,961  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-26_837_8682091923767533403-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-26_837_8682091923767533403-1
2024-04-23T21:07:26,968  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:26,971  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:07:26,971  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:07:26,973  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:26,983  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:26,983  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:26,983  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:26,985  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:26,985  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:26,985  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:26,985  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:26,985  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:07:26,986  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:07:26,987  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:26,987  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=6, getTableColumnStatistics_(String, String, List, String)=29, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=6, getValidWriteIds_(List, String)=5}
2024-04-23T21:07:26,987  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf); Time taken: 0.15 seconds
2024-04-23T21:07:26,987  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf
2024-04-23T21:07:26,988  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf
2024-04-23T21:07:27,003  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:07:27,003  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:27,003  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf): select a,b from acidTbl order by a,b
2024-04-23T21:07:27,004  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf
2024-04-23T21:07:27,004  INFO [main] ql.Driver: Query ID = alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf
Total jobs = 1
2024-04-23T21:07:27,004  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:27,004  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:27,131  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:07:27,131  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:27,131  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:27,131  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:27,131  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:27,131  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:27,131  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:27,131  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:27,134  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:27,134  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T21:07:27,134  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:27,143  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:27,144  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:27,149  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:27,150  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:27,151  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:27,156  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:27,163  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:27,168  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:27,169  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:07:27,169  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:07:27,169  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:27,169  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:07:27,169  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:07:27,169  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:07:27,181  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:07:27,181  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 12 ms
2024-04-23T21:07:27,181  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:07:27,199  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:07:27,218  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local768153065_0036
2024-04-23T21:07:27,218  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:27,278  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:27,278  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:27,279  INFO [Thread-2978] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:27,279  INFO [Thread-2978] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:27,281  INFO [Thread-2978] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:27,281  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local768153065_0036_m_000000_0
2024-04-23T21:07:27,281  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:27,282  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=699, isOriginal=false, fileLength=699, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:27,282  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:27,283  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:27,283  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=699, isOriginal=false, fileLength=699, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:27,284  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 699, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:27,285  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:27,290  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:27,290  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:27,290  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:27,290  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:27,290  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:27,291  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:27,291  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:27,292  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:27,292  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:27,292  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:27,292  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:27,293  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 38; bufvoid = 104857600
2024-04-23T21:07:27,294  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:27,305  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:27,308  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local768153065_0036_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:27,309  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=699, isOriginal=false, fileLength=699, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:27,309  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local768153065_0036_m_000000_0' done.
2024-04-23T21:07:27,309  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local768153065_0036_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=789437
		FILE: Number of bytes written=45160212
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=38
		Map output materialized bytes=48
		Input split bytes=495
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1352663040
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8973
2024-04-23T21:07:27,309  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local768153065_0036_m_000000_0
2024-04-23T21:07:27,309  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local768153065_0036_m_000001_0
2024-04-23T21:07:27,310  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:27,310  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=690, isOriginal=false, fileLength=690, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:27,310  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:27,311  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:27,311  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=690, isOriginal=false, fileLength=690, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:27,312  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 690, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:27,313  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:27,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:27,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:27,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:27,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:27,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:27,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:27,319  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:27,319  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:27,320  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:27,320  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:27,320  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:27,320  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:27,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:07:27,322  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:07:27,322  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:27,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:27,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:27,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 38; bufvoid = 104857600
2024-04-23T21:07:27,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:27,330  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:27,334  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local768153065_0036_m_000001_0 is done. And is in the process of committing
2024-04-23T21:07:27,334  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=690, isOriginal=false, fileLength=690, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:27,334  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local768153065_0036_m_000001_0' done.
2024-04-23T21:07:27,334  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local768153065_0036_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=799387
		FILE: Number of bytes written=45160292
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=38
		Map output materialized bytes=48
		Input split bytes=495
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1352663040
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8937
2024-04-23T21:07:27,334  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local768153065_0036_m_000001_0
2024-04-23T21:07:27,334  INFO [Thread-2978] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:27,335  INFO [Thread-2978] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:27,335  INFO [pool-178-thread-1] mapred.LocalJobRunner: Starting task: attempt_local768153065_0036_r_000000_0
2024-04-23T21:07:27,336  INFO [pool-178-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:27,336  INFO [pool-178-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5145e62b
2024-04-23T21:07:27,336  WARN [pool-178-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:27,337  INFO [pool-178-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:27,337  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local768153065_0036_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:27,340  INFO [localfetcher#51] reduce.LocalFetcher: localfetcher#51 about to shuffle output of map attempt_local768153065_0036_m_000000_0 decomp: 44 len: 48 to MEMORY
2024-04-23T21:07:27,340  INFO [localfetcher#51] reduce.InMemoryMapOutput: Read 44 bytes from map-output for attempt_local768153065_0036_m_000000_0
2024-04-23T21:07:27,340  INFO [localfetcher#51] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 44, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->44
2024-04-23T21:07:27,343  INFO [localfetcher#51] reduce.LocalFetcher: localfetcher#51 about to shuffle output of map attempt_local768153065_0036_m_000001_0 decomp: 44 len: 48 to MEMORY
2024-04-23T21:07:27,343  INFO [localfetcher#51] reduce.InMemoryMapOutput: Read 44 bytes from map-output for attempt_local768153065_0036_m_000001_0
2024-04-23T21:07:27,343  INFO [localfetcher#51] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 44, inMemoryMapOutputs.size() -> 2, commitMemory -> 44, usedMemory ->88
2024-04-23T21:07:27,343  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:27,344  INFO [pool-178-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:07:27,344  INFO [pool-178-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:27,350  INFO [pool-178-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:07:27,350  INFO [pool-178-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 54 bytes
2024-04-23T21:07:27,353  INFO [pool-178-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 88 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:27,353  INFO [pool-178-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-23T21:07:27,353  INFO [pool-178-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:27,353  INFO [pool-178-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:27,354  INFO [pool-178-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-23T21:07:27,354  INFO [pool-178-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:07:27,354  INFO [pool-178-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:27,355  INFO [pool-178-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:27,356  INFO [pool-178-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:27,356  INFO [pool-178-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:27,356  INFO [pool-178-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T21:07:27,356  INFO [pool-178-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:07:27,357  INFO [pool-178-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@30e3444e, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@414ef049, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@38f8a87
2024-04-23T21:07:27,357  INFO [pool-178-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-26_837_8682091923767533403-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-26_837_8682091923767533403-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:27,357  INFO [pool-178-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-26_837_8682091923767533403-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-26_837_8682091923767533403-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:07:27,357  INFO [pool-178-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-26_837_8682091923767533403-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-26_837_8682091923767533403-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:27,365  INFO [pool-178-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:27,366  INFO [pool-178-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:27,366  INFO [pool-178-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:27,366  INFO [pool-178-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:07:27,366  INFO [pool-178-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T21:07:27,367  INFO [pool-178-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:27,367  INFO [pool-178-thread-1] mapred.Task: Task:attempt_local768153065_0036_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:27,368  INFO [pool-178-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:27,368  INFO [pool-178-thread-1] mapred.Task: Task 'attempt_local768153065_0036_r_000000_0' done.
2024-04-23T21:07:27,368  INFO [pool-178-thread-1] mapred.Task: Final Counters for attempt_local768153065_0036_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=806715
		FILE: Number of bytes written=45160545
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=96
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1352663040
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:27,368  INFO [pool-178-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local768153065_0036_r_000000_0
2024-04-23T21:07:27,368  INFO [Thread-2978] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:28,281 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:28,281  INFO [main] exec.Task: 2024-04-23 21:07:28,281 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local768153065_0036
2024-04-23T21:07:28,283  INFO [main] exec.Task: Ended Job = job_local768153065_0036
2024-04-23T21:07:28,285  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:28,285  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:07:28,285  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:28,285  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:28,285  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:28,285  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf); Time taken: 1.282 seconds
2024-04-23T21:07:28,285  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210726_0c902fd9-1b91-489d-a10b-adb919040acf
2024-04-23T21:07:28,290  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:07:28,296  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:28,296  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:07:28,300  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:07:28,301  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:07:28,301  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:28,301  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T21:07:28,302  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-26_837_8682091923767533403-1
2024-04-23T21:07:28,302  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/44f10140-127d-459a-8f5c-fa74aa2b887e/hive_2024-04-23_21-07-26_837_8682091923767533403-1 on fs with scheme file
2024-04-23T21:07:28,303  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_f91878ee-53c0-46e0-9b9c-ed4267f98907): START TRANSACTION
2024-04-23T21:07:28,305  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:07:28,305  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:07:28,306  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:28,306  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:28,306  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:28,306  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:28,306  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:28,306  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:28,307  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:07:28,307  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_f91878ee-53c0-46e0-9b9c-ed4267f98907); Time taken: 0.003 seconds
2024-04-23T21:07:28,307  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210728_f91878ee-53c0-46e0-9b9c-ed4267f98907
2024-04-23T21:07:28,307  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T21:07:28,307  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210728_f91878ee-53c0-46e0-9b9c-ed4267f98907): START TRANSACTION
2024-04-23T21:07:28,308  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:28,308  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:07:28,308  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210728_f91878ee-53c0-46e0-9b9c-ed4267f98907); Time taken: 0.001 seconds
2024-04-23T21:07:28,308  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 8
2024-04-23T21:07:28,308  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_0f2315ba-edf8-4cd1-a78a-884acc1be8e7): delete from acidTbl where b = 8
2024-04-23T21:07:28,309  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:07:28,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:28,316  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,316  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 8> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:07:28,316  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:07:28,319  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:28,319  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:28,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:28,326  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,326  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:28,326  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:28,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:28,332  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,332  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:28,332  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:28,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:28,371  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-23T21:07:28,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:28,380  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,381  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:28,389  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:28,399  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-23T21:07:28,399  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-23T21:07:28,453  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:28,454  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:28,454  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:28,454  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:28,461  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,463 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:07:28,464 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:07:28,464  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:07:28,464 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:07:28,465  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:28,465  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=28, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=0, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=4, getTable_(GetTableRequest)=27}
2024-04-23T21:07:28,465  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_0f2315ba-edf8-4cd1-a78a-884acc1be8e7); Time taken: 0.157 seconds
2024-04-23T21:07:28,465  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210728_f91878ee-53c0-46e0-9b9c-ed4267f98907
2024-04-23T21:07:28,468  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:28,474  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:28,475  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e): drop table if exists acidTbl
2024-04-23T21:07:28,477  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T21:07:28,478  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:07:28,479  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:28,485  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,485  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:28,485  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:28,485  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:28,485  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, openTxn_(String, TxnType)=3}
2024-04-23T21:07:28,485  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e); Time taken: 0.01 seconds
2024-04-23T21:07:28,485  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e
2024-04-23T21:07:28,486  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e
2024-04-23T21:07:28,499  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:07:28,499  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:28,499  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e): drop table if exists acidTbl
2024-04-23T21:07:28,499  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:28,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:28,505  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:28,511  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:28,614  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:28,614  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=108, isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:28,614  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e); Time taken: 0.115 seconds
2024-04-23T21:07:28,614  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210728_d6b73265-a6b3-4347-9d4a-9720d83f0c7e
2024-04-23T21:07:28,618  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:07:28,623  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:28,624  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:07:28,625  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:28,625  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831): drop table if exists acidTblPart
2024-04-23T21:07:28,633  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T21:07:28,633  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:07:28,636  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:28,652  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,652  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:28,652  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:28,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:28,652  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=16, flushCache_()=1, openTxn_(String, TxnType)=7, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:07:28,652  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831); Time taken: 0.027 seconds
2024-04-23T21:07:28,653  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831
2024-04-23T21:07:28,653  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831
2024-04-23T21:07:28,671  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:07:28,671  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:28,671  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831): drop table if exists acidTblPart
2024-04-23T21:07:28,671  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:28,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:28,677  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,678  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:28,683  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,683  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:28,739  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:28,740  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=5, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=61}
2024-04-23T21:07:28,740  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831); Time taken: 0.068 seconds
2024-04-23T21:07:28,740  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210728_b1361082-3a4a-4991-a5e3-ceca453a9831
2024-04-23T21:07:28,744  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:07:28,750  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:28,751  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:07:28,751  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:28,751  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_49ed0f47-f6d9-4fe8-af94-bfa4021a53f6): drop table if exists acidTbl2
2024-04-23T21:07:28,754  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T21:07:28,754  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:07:28,755  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:28,755  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:28,755  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:28,755  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:07:28,755  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_49ed0f47-f6d9-4fe8-af94-bfa4021a53f6); Time taken: 0.004 seconds
2024-04-23T21:07:28,756  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210728_49ed0f47-f6d9-4fe8-af94-bfa4021a53f6
2024-04-23T21:07:28,756  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:28,756  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210728_49ed0f47-f6d9-4fe8-af94-bfa4021a53f6): drop table if exists acidTbl2
2024-04-23T21:07:28,756  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:28,757  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:07:28,757  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:28,757  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:07:28,757  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210728_49ed0f47-f6d9-4fe8-af94-bfa4021a53f6); Time taken: 0.001 seconds
2024-04-23T21:07:28,757  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210728_49ed0f47-f6d9-4fe8-af94-bfa4021a53f6
2024-04-23T21:07:28,763  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:07:28,769  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:28,769  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:07:28,770  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:28,770  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:28,773  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T21:07:28,773  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:07:28,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:28,796  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,796  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:28,796  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:28,797  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:28,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=23, flushCache_()=1}
2024-04-23T21:07:28,797  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4); Time taken: 0.026 seconds
2024-04-23T21:07:28,797  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4
2024-04-23T21:07:28,798  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4
2024-04-23T21:07:28,813  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:07:28,813  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:28,813  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:28,813  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:28,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:28,827  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:28,836  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:28,893  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:28,893  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, dropTable_(String, String, boolean, boolean, boolean)=66}
2024-04-23T21:07:28,893  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4); Time taken: 0.08 seconds
2024-04-23T21:07:28,893  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210728_f68c85a6-eecf-45a6-96df-a5f8122c8bc4
2024-04-23T21:07:28,897  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:07:28,903  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:28,903  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:07:28,903  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:28,903  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:28,906  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T21:07:28,906  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:07:28,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:28,914  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,914  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:28,914  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:28,915  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:28,915  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:07:28,915  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa); Time taken: 0.012 seconds
2024-04-23T21:07:28,915  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa
2024-04-23T21:07:28,916  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa
2024-04-23T21:07:28,930  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:07:28,930  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:28,931  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:28,931  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:28,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:28,939  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,939  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:28,947  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:28,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:28,977  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:28,977  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=38}
2024-04-23T21:07:28,977  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa); Time taken: 0.046 seconds
2024-04-23T21:07:28,977  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210728_6d6ca508-6356-4809-b474-3e8adf4ba4fa
2024-04-23T21:07:28,983  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:07:28,990  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:28,990  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:07:28,990  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:28,991  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d): drop table if exists nonAcidNonBucket
2024-04-23T21:07:28,993  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T21:07:28,994  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:07:28,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:29,003  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:29,003  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:29,003  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:29,004  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:29,004  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:07:29,004  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d); Time taken: 0.013 seconds
2024-04-23T21:07:29,004  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d
2024-04-23T21:07:29,005  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d
2024-04-23T21:07:29,019  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:07:29,019  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:29,019  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d): drop table if exists nonAcidNonBucket
2024-04-23T21:07:29,020  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:29,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:29,028  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:29,028  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:29,036  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:29,036  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:29,065  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:29,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=37, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T21:07:29,066  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d); Time taken: 0.046 seconds
2024-04-23T21:07:29,066  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210728_5a3d5f3e-ec6b-405c-a41f-5801b6d6555d
2024-04-23T21:07:29,069  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:07:29,075  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:29,075  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:07:29,076  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="truncateTableAdvancingWriteId" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.584"/>
  <testcase name="testAddAndDropConstraintAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="3.762"/>
  <testcase name="testMultipleInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="7.349"/>
  <testcase name="testDeleteOfMultipleInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.443">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:07:41,832  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:07:41,832  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:07:41,833  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:07:41,835  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 7fea70f2-0a74-40e1-b488-9ba3cf448fe5
2024-04-23T21:07:41,838  INFO [main] SessionState: Hive Session ID = 7fea70f2-0a74-40e1-b488-9ba3cf448fe5
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:41,838  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:41,843  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7fea70f2-0a74-40e1-b488-9ba3cf448fe5
2024-04-23T21:07:41,846  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5
2024-04-23T21:07:41,848  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/_tmp_space.db
2024-04-23T21:07:41,848  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=7fea70f2-0a74-40e1-b488-9ba3cf448fe5, clientType=HIVECLI]
2024-04-23T21:07:41,849  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:41,849  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210741_bd7abf5d-29c5-4964-95fe-dab4d711b428): drop table if exists acidTbl
2024-04-23T21:07:41,858  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:07:41,858  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:07:41,861  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:41,863  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:41,863  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:41,863  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:41,863  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=9}
2024-04-23T21:07:41,864  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210741_bd7abf5d-29c5-4964-95fe-dab4d711b428); Time taken: 0.014 seconds
2024-04-23T21:07:41,864  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210741_bd7abf5d-29c5-4964-95fe-dab4d711b428
2024-04-23T21:07:41,864  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:41,864  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210741_bd7abf5d-29c5-4964-95fe-dab4d711b428): drop table if exists acidTbl
2024-04-23T21:07:41,864  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:41,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:41,867  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:41,867  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:41,867  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210741_bd7abf5d-29c5-4964-95fe-dab4d711b428); Time taken: 0.003 seconds
2024-04-23T21:07:41,868  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210741_bd7abf5d-29c5-4964-95fe-dab4d711b428
2024-04-23T21:07:41,873  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:07:41,880  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:41,880  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:07:41,881  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:41,881  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210741_55ce3836-2c3f-47bf-8289-cdd0b6087f9a): drop table if exists acidTblPart
2024-04-23T21:07:41,883  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:07:41,884  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:07:41,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:41,887  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:41,887  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:41,887  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:41,887  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, flushCache_()=0}
2024-04-23T21:07:41,888  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210741_55ce3836-2c3f-47bf-8289-cdd0b6087f9a); Time taken: 0.006 seconds
2024-04-23T21:07:41,888  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210741_55ce3836-2c3f-47bf-8289-cdd0b6087f9a
2024-04-23T21:07:41,888  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:41,888  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210741_55ce3836-2c3f-47bf-8289-cdd0b6087f9a): drop table if exists acidTblPart
2024-04-23T21:07:41,888  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:41,888  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:41,891  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:41,891  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:41,891  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210741_55ce3836-2c3f-47bf-8289-cdd0b6087f9a); Time taken: 0.003 seconds
2024-04-23T21:07:41,892  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210741_55ce3836-2c3f-47bf-8289-cdd0b6087f9a
2024-04-23T21:07:41,897  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:07:41,903  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:41,904  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:07:41,904  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:41,904  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210741_746a763c-c32a-4d81-8070-571f7e7f21e5): drop table if exists acidTbl2
2024-04-23T21:07:41,906  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:07:41,907  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:07:41,907  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:41,910  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:41,910  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:41,910  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:41,910  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T21:07:41,910  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210741_746a763c-c32a-4d81-8070-571f7e7f21e5); Time taken: 0.006 seconds
2024-04-23T21:07:41,910  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210741_746a763c-c32a-4d81-8070-571f7e7f21e5
2024-04-23T21:07:41,911  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:41,911  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210741_746a763c-c32a-4d81-8070-571f7e7f21e5): drop table if exists acidTbl2
2024-04-23T21:07:41,911  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:41,911  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:41,913  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:41,914  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:41,914  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210741_746a763c-c32a-4d81-8070-571f7e7f21e5); Time taken: 0.002 seconds
2024-04-23T21:07:41,914  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210741_746a763c-c32a-4d81-8070-571f7e7f21e5
2024-04-23T21:07:41,919  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:07:41,925  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:41,925  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:07:41,926  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:41,926  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210741_8022d7ca-0709-45f7-b0c6-43971a2addf6): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:41,928  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:07:41,928  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:07:41,929  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:41,932  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:41,932  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:41,932  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:41,932  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T21:07:41,932  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210741_8022d7ca-0709-45f7-b0c6-43971a2addf6); Time taken: 0.006 seconds
2024-04-23T21:07:41,932  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210741_8022d7ca-0709-45f7-b0c6-43971a2addf6
2024-04-23T21:07:41,932  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:41,932  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210741_8022d7ca-0709-45f7-b0c6-43971a2addf6): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:41,933  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:41,933  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:41,936  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:41,936  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:41,936  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210741_8022d7ca-0709-45f7-b0c6-43971a2addf6); Time taken: 0.003 seconds
2024-04-23T21:07:41,936  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210741_8022d7ca-0709-45f7-b0c6-43971a2addf6
2024-04-23T21:07:41,941  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:07:41,947  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:41,947  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:07:41,948  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:41,948  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210741_f1b84413-b81c-48c7-8b74-ec18e4ee0d0a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:41,950  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:07:41,950  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:07:41,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:41,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:41,954  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:41,954  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:41,954  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:07:41,954  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210741_f1b84413-b81c-48c7-8b74-ec18e4ee0d0a); Time taken: 0.006 seconds
2024-04-23T21:07:41,954  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210741_f1b84413-b81c-48c7-8b74-ec18e4ee0d0a
2024-04-23T21:07:41,954  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:41,954  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210741_f1b84413-b81c-48c7-8b74-ec18e4ee0d0a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:41,954  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:41,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:41,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:41,957  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:41,957  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210741_f1b84413-b81c-48c7-8b74-ec18e4ee0d0a); Time taken: 0.003 seconds
2024-04-23T21:07:41,957  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210741_f1b84413-b81c-48c7-8b74-ec18e4ee0d0a
2024-04-23T21:07:41,963  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:07:41,969  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:41,969  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:07:41,969  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:41,969  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210741_0bbdbbcf-3da5-41fc-996e-9397872bd3d3): drop table if exists nonAcidNonBucket
2024-04-23T21:07:41,971  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:07:41,972  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:07:41,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:41,975  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:41,975  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:41,975  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:41,975  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:07:41,975  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210741_0bbdbbcf-3da5-41fc-996e-9397872bd3d3); Time taken: 0.006 seconds
2024-04-23T21:07:41,976  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210741_0bbdbbcf-3da5-41fc-996e-9397872bd3d3
2024-04-23T21:07:41,976  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:41,976  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210741_0bbdbbcf-3da5-41fc-996e-9397872bd3d3): drop table if exists nonAcidNonBucket
2024-04-23T21:07:41,976  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:41,976  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:41,979  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:41,979  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:41,979  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210741_0bbdbbcf-3da5-41fc-996e-9397872bd3d3); Time taken: 0.003 seconds
2024-04-23T21:07:41,979  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210741_0bbdbbcf-3da5-41fc-996e-9397872bd3d3
2024-04-23T21:07:41,984  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:07:41,990  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:41,991  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:07:41,991  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:41,991  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:41,994  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:07:41,994  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:07:41,994  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:41,994  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,000  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:07:42,000  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:42,002  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,002  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,002  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:42,002  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,002  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=5}
2024-04-23T21:07:42,002  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480); Time taken: 0.011 seconds
2024-04-23T21:07:42,003  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480
2024-04-23T21:07:42,003  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480
2024-04-23T21:07:42,021  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:07:42,021  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:42,021  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:42,022  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:42,022  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931662, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFilesErasureCoded=0, transactional=true, totalSize=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:42,027  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:42,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:42,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=40}
2024-04-23T21:07:42,063  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480); Time taken: 0.041 seconds
2024-04-23T21:07:42,063  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210741_bdeb0ff8-b45c-4d31-a18a-b75cbfbcd480
2024-04-23T21:07:42,067  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:07:42,073  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:42,073  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:07:42,073  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:42,074  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:42,076  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:07:42,076  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:07:42,077  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:42,077  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,079  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:07:42,079  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:42,081  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,081  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,081  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:42,081  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,081  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:42,082  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb); Time taken: 0.007 seconds
2024-04-23T21:07:42,082  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb
2024-04-23T21:07:42,082  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb
2024-04-23T21:07:42,096  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:07:42,096  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:42,097  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:42,097  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:42,098  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931662, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:42,103  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:07:42,121  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:42,121  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T21:07:42,122  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb); Time taken: 0.024 seconds
2024-04-23T21:07:42,122  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210742_fff100e5-0498-4a5f-8801-e946b5c23abb
2024-04-23T21:07:42,126  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:07:42,132  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:42,132  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:07:42,132  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,133  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,135  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:07:42,135  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:07:42,136  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:42,136  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,139  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:07:42,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:42,142  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,142  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,142  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:42,142  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,142  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0}
2024-04-23T21:07:42,142  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29); Time taken: 0.009 seconds
2024-04-23T21:07:42,143  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29
2024-04-23T21:07:42,143  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29
2024-04-23T21:07:42,164  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:07:42,164  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:42,164  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,165  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:42,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931662, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, rawDataSize=0, totalSize=0, numRows=0, bucketing_version=2, numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:42,174  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:07:42,187  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:42,187  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T21:07:42,187  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29); Time taken: 0.023 seconds
2024-04-23T21:07:42,188  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210742_94b3f57e-c1dc-4fa9-9157-ba29a89c9c29
2024-04-23T21:07:42,192  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:07:42,198  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:42,198  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:07:42,199  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,199  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,202  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:07:42,202  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:07:42,203  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:42,203  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,205  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:07:42,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:42,207  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,207  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,207  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:42,207  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,208  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, flushCache_()=0}
2024-04-23T21:07:42,208  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9); Time taken: 0.008 seconds
2024-04-23T21:07:42,208  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9
2024-04-23T21:07:42,208  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9
2024-04-23T21:07:42,224  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:07:42,224  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:42,224  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,225  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:42,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931662, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:42,231  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:07:42,243  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:42,243  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:42,244  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9); Time taken: 0.019 seconds
2024-04-23T21:07:42,244  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210742_c71cadce-52eb-43f9-927c-736a6aa841c9
2024-04-23T21:07:42,248  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:07:42,254  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:42,254  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:07:42,255  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:42,255  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:42,257  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:07:42,258  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:07:42,258  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:42,258  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,261  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:07:42,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:42,263  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,263  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,263  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:42,263  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,263  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=0, getDatabase_(String)=2}
2024-04-23T21:07:42,263  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d); Time taken: 0.008 seconds
2024-04-23T21:07:42,263  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d
2024-04-23T21:07:42,264  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d
2024-04-23T21:07:42,278  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:07:42,278  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:42,278  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:42,279  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:42,279  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/_tmp_space.db/ce980208-a462-4c31-a5d8-abf10fae110c
2024-04-23T21:07:42,282  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:42,282  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:42,283  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d); Time taken: 0.004 seconds
2024-04-23T21:07:42,283  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210742_3f438d71-2466-41d8-86a2-87472a1ce10d
2024-04-23T21:07:42,287  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:07:42,293  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:42,293  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:07:42,293  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,293  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,296  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:07:42,296  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:07:42,296  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:42,297  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,299  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:07:42,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:42,301  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,301  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,301  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:42,301  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,301  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:42,301  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f); Time taken: 0.008 seconds
2024-04-23T21:07:42,301  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f
2024-04-23T21:07:42,302  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f
2024-04-23T21:07:42,316  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:07:42,316  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:42,316  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:42,316  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:42,317  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931662, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, totalSize=0, bucketing_version=2, numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:42,322  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:07:42,335  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:42,335  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T21:07:42,335  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f); Time taken: 0.019 seconds
2024-04-23T21:07:42,335  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210742_a890e4a5-fd1e-40b7-8732-9cebe9c8131f
2024-04-23T21:07:42,339  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:07:42,345  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:42,345  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:07:42,346  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T21:07:42,346  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210742_6b2a13b6-617d-4139-8994-3b247e2115ad): START TRANSACTION
2024-04-23T21:07:42,349  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:07:42,349  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:07:42,349  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:42,349  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,350  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,350  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,350  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:42,350  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:07:42,350  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210742_6b2a13b6-617d-4139-8994-3b247e2115ad); Time taken: 0.004 seconds
2024-04-23T21:07:42,350  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210742_6b2a13b6-617d-4139-8994-3b247e2115ad
2024-04-23T21:07:42,350  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T21:07:42,350  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210742_6b2a13b6-617d-4139-8994-3b247e2115ad): START TRANSACTION
2024-04-23T21:07:42,351  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:42,351  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:07:42,351  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210742_6b2a13b6-617d-4139-8994-3b247e2115ad); Time taken: 0.001 seconds
2024-04-23T21:07:42,351  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:42,351  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:42,353  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:42,353  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:42,357  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:42,376  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:42,377  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:42,377  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:42,377  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:42,377  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:42,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:42,383  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:42,383  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:42,383  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:42,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:42,473  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:42,473  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:42,473  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:42,473  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:42,476  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:42,476  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:42,476  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:42,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:42,483  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:42,484  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:42,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:42,499  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T21:07:42,500  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T21:07:42,500  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:42,504  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:42,505  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:42,505  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:42,506  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:42,514  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:42,521  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:42,522  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:42,522  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:42,522  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:42,522  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:42,522  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:07:42,522  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:42,522  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=1, flushCache_()=1, allocateTableWriteId_(long, String, String)=13, getAllTableConstraints_(AllTableConstraintsRequest)=26, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=40}
2024-04-23T21:07:42,522  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2); Time taken: 0.171 seconds
2024-04-23T21:07:42,523  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2
2024-04-23T21:07:42,523  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2
2024-04-23T21:07:42,544  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:07:42,544  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:42,547  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:42,547  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2
2024-04-23T21:07:42,547  INFO [main] ql.Driver: Query ID = alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2
Total jobs = 1
2024-04-23T21:07:42,547  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:42,547  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:42,671  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:42,671  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:42,671  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:42,671  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:42,671  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:42,671  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:42,671  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:42,671  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:42,673  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:42,673  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:42,673  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-42_351_1353117006129755674-1/dummy_path
2024-04-23T21:07:42,683  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:42,683  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,29KB
2024-04-23T21:07:42,688  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:42,689  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:42,690  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:42,693  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-42_351_1353117006129755674-1/-mr-10000
2024-04-23T21:07:42,695  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:42,702  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:42,706  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:42,707  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:42,707  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:42,707  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-42_351_1353117006129755674-1/dummy_path
2024-04-23T21:07:42,708  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:42,725  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:42,744  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1190081328_0042
2024-04-23T21:07:42,744  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:42,806  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:42,806  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:42,807  INFO [Thread-3523] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:42,807  INFO [Thread-3523] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:42,808  INFO [Thread-3523] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:42,809  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1190081328_0042_m_000000_0
2024-04-23T21:07:42,812  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:42,812  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-42_351_1353117006129755674-1/dummy_path/null:0+1
2024-04-23T21:07:42,814  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:42,815  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,29KB
2024-04-23T21:07:42,815  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:42,819  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:42,819  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:42,819  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:42,819  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:42,819  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:42,820  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:42,820  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:42,821  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:42,821  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:42,821  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:42,821  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:42,821  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:42,822  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:42,822  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:42,822  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:07:42,822  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:07:42,822  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:42,822  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:07:42,822  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:07:42,823  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:07:42,826  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:42,826  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:42,826  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:42,826  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:07:42,826  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:42,837  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:42,841  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1190081328_0042_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:42,842  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:42,842  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1190081328_0042_m_000000_0' done.
2024-04-23T21:07:42,842  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1190081328_0042_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=972066
		FILE: Number of bytes written=52696492
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1342177280
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5342
2024-04-23T21:07:42,842  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1190081328_0042_m_000000_0
2024-04-23T21:07:42,842  INFO [Thread-3523] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:42,843  INFO [Thread-3523] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:42,843  INFO [pool-205-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1190081328_0042_r_000000_0
2024-04-23T21:07:42,846  INFO [pool-205-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:42,846  INFO [pool-205-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1f97eef4
2024-04-23T21:07:42,846  WARN [pool-205-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:42,846  INFO [pool-205-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:42,847  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1190081328_0042_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:42,849  INFO [localfetcher#59] reduce.LocalFetcher: localfetcher#59 about to shuffle output of map attempt_local1190081328_0042_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:42,849  INFO [localfetcher#59] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1190081328_0042_m_000000_0
2024-04-23T21:07:42,849  INFO [localfetcher#59] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:42,850  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:42,850  INFO [pool-205-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:42,850  INFO [pool-205-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:42,857  INFO [pool-205-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:42,857  INFO [pool-205-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:42,860  INFO [pool-205-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:42,860  INFO [pool-205-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:42,860  INFO [pool-205-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:42,860  INFO [pool-205-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:42,860  INFO [pool-205-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:42,860  INFO [pool-205-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:42,860  INFO [pool-205-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:42,861  INFO [pool-205-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1190081328_0042/job_local1190081328_0042.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1d7e462f
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:42,862  INFO [pool-205-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:42,863  INFO [pool-205-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:42,863  INFO [pool-205-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:42,869  INFO [pool-205-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:42,874  INFO [pool-205-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:42,874  INFO [pool-205-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:42,874  INFO [pool-205-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:42,874  INFO [pool-205-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:42,875  INFO [pool-205-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:07:42,886  INFO [pool-205-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-23T21:07:42,886  INFO [pool-205-thread-1] mapred.Task: Task:attempt_local1190081328_0042_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:42,887  INFO [pool-205-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:42,887  INFO [pool-205-thread-1] mapred.Task: Task 'attempt_local1190081328_0042_r_000000_0' done.
2024-04-23T21:07:42,887  INFO [pool-205-thread-1] mapred.Task: Final Counters for attempt_local1190081328_0042_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=978173
		FILE: Number of bytes written=52697531
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1342177280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:42,887  INFO [pool-205-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1190081328_0042_r_000000_0
2024-04-23T21:07:42,887  INFO [pool-205-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1190081328_0042_r_000001_0
2024-04-23T21:07:42,887  INFO [pool-205-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:42,887  INFO [pool-205-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4808b249
2024-04-23T21:07:42,887  WARN [pool-205-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:42,888  INFO [pool-205-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:42,889  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1190081328_0042_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:42,892  INFO [localfetcher#60] reduce.LocalFetcher: localfetcher#60 about to shuffle output of map attempt_local1190081328_0042_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:42,892  INFO [localfetcher#60] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1190081328_0042_m_000000_0
2024-04-23T21:07:42,892  INFO [localfetcher#60] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:42,892  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:42,893  INFO [pool-205-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:42,893  INFO [pool-205-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:42,899  INFO [pool-205-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:42,899  INFO [pool-205-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:42,901  INFO [pool-205-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:42,901  INFO [pool-205-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:42,901  INFO [pool-205-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:42,901  INFO [pool-205-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:42,902  INFO [pool-205-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:42,902  INFO [pool-205-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:42,902  INFO [pool-205-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:42,903  INFO [pool-205-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:42,904  INFO [pool-205-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:42,904  INFO [pool-205-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:42,904  INFO [pool-205-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:42,904  INFO [pool-205-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:42,904  INFO [pool-205-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1190081328_0042/job_local1190081328_0042.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@315238cb
2024-04-23T21:07:42,905  INFO [pool-205-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:42,905  INFO [pool-205-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:42,905  INFO [pool-205-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:42,905  INFO [pool-205-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:42,905  INFO [pool-205-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:42,911  INFO [pool-205-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:42,911  INFO [pool-205-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:42,911  INFO [pool-205-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:42,911  INFO [pool-205-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:42,911  INFO [pool-205-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:42,913  INFO [pool-205-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:07:42,923  INFO [pool-205-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-23T21:07:42,923  INFO [pool-205-thread-1] mapred.Task: Task:attempt_local1190081328_0042_r_000001_0 is done. And is in the process of committing
2024-04-23T21:07:42,923  INFO [pool-205-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:42,923  INFO [pool-205-thread-1] mapred.Task: Task 'attempt_local1190081328_0042_r_000001_0' done.
2024-04-23T21:07:42,924  INFO [pool-205-thread-1] mapred.Task: Final Counters for attempt_local1190081328_0042_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=984256
		FILE: Number of bytes written=52698559
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1342177280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:42,924  INFO [pool-205-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1190081328_0042_r_000001_0
2024-04-23T21:07:42,924  INFO [Thread-3523] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:43,808 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:43,808  INFO [main] exec.Task: 2024-04-23 21:07:43,808 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1190081328_0042
2024-04-23T21:07:43,809  INFO [main] exec.Task: Ended Job = job_local1190081328_0042
2024-04-23T21:07:43,809  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:43,809  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:07:43,810  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:07:43,810  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:07:43,810  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:07:43,811  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:07:43,812  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:43,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:43,818  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:43,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:43,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:43,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:43,863  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:43,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:43,870  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:43,870  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:43,870  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-42_351_1353117006129755674-1/-mr-10000
2024-04-23T21:07:43,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:43,878  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:43,889  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:43,889  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:07:43,889  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:07:43,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:43,909  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:07:43,909  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:07:43,909  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:07:43,912  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:43,912  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:43,913  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=57, getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=1, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3}
MapReduce Jobs Launched: 
2024-04-23T21:07:43,913  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:43,913  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:43,913  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:43,913  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210742_8dbcff58-e0c9-4c9b-a932-80078014d2c2); Time taken: 1.365 seconds
2024-04-23T21:07:43,913  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:43,913  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-42_351_1353117006129755674-1
2024-04-23T21:07:43,914  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-42_351_1353117006129755674-1 on fs with scheme file
2024-04-23T21:07:43,914  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:43,915  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:43,915  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:43,916  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:43,922  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:43,922  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:43,922  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:43,922  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:43,922  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:43,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:43,928  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:43,928  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:43,928  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:43,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:43,994  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:43,994  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:43,994  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:43,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:43,997  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:43,997  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:43,997  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:43,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:44,003  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:44,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:44,006  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:44,008  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:44,011  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:44,011  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:44,012  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:44,012  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:44,021  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:44,029  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:44,030  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:44,030  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:44,031  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:44,031  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:44,031  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:07:44,031  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:44,031  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=27, getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, flushCache_()=0}
2024-04-23T21:07:44,031  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7); Time taken: 0.117 seconds
2024-04-23T21:07:44,031  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7
2024-04-23T21:07:44,031  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7
2024-04-23T21:07:44,045  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:07:44,045  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:44,045  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:44,046  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7
2024-04-23T21:07:44,046  INFO [main] ql.Driver: Query ID = alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7
Total jobs = 1
2024-04-23T21:07:44,046  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:44,046  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:44,168  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:44,169  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:44,169  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:44,169  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:44,169  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:44,169  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:44,169  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:44,169  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:44,171  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:44,171  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:44,172  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-43_914_2567968163882221107-1/dummy_path
2024-04-23T21:07:44,181  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:44,182  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,31KB
2024-04-23T21:07:44,186  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:44,187  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:44,188  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:44,192  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-43_914_2567968163882221107-1/-mr-10000
2024-04-23T21:07:44,194  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:44,201  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:44,205  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:44,207  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:44,207  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:44,207  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-43_914_2567968163882221107-1/dummy_path
2024-04-23T21:07:44,207  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:44,225  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:44,245  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2057164164_0043
2024-04-23T21:07:44,245  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:44,305  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:44,305  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:44,305  INFO [Thread-3597] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:44,305  INFO [Thread-3597] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:44,307  INFO [Thread-3597] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:44,307  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2057164164_0043_m_000000_0
2024-04-23T21:07:44,308  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:44,308  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-43_914_2567968163882221107-1/dummy_path/null:0+1
2024-04-23T21:07:44,309  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:44,309  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,31KB
2024-04-23T21:07:44,309  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:44,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:44,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:44,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:44,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:44,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:44,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:44,326  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:44,326  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:07:44,327  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:07:44,328  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:44,328  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:07:44,328  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:44,328  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:44,328  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:44,328  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:07:44,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:07:44,330  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:44,330  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:44,330  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:44,330  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:07:44,330  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:44,341  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:44,343  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2057164164_0043_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:44,344  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:44,344  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2057164164_0043_m_000000_0' done.
2024-04-23T21:07:44,344  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2057164164_0043_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=990661
		FILE: Number of bytes written=53954054
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=11
		Total committed heap usage (bytes)=1345847296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5362
2024-04-23T21:07:44,344  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2057164164_0043_m_000000_0
2024-04-23T21:07:44,344  INFO [Thread-3597] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:44,345  INFO [Thread-3597] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:44,345  INFO [pool-210-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2057164164_0043_r_000000_0
2024-04-23T21:07:44,346  INFO [pool-210-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:44,346  INFO [pool-210-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6115427e
2024-04-23T21:07:44,346  WARN [pool-210-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:44,347  INFO [pool-210-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:44,347  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2057164164_0043_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:44,348  INFO [localfetcher#61] reduce.LocalFetcher: localfetcher#61 about to shuffle output of map attempt_local2057164164_0043_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:44,348  INFO [localfetcher#61] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local2057164164_0043_m_000000_0
2024-04-23T21:07:44,348  INFO [localfetcher#61] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:44,349  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:44,349  INFO [pool-210-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:44,349  INFO [pool-210-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:44,355  INFO [pool-210-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:44,355  INFO [pool-210-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:44,357  INFO [pool-210-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:44,357  INFO [pool-210-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:44,357  INFO [pool-210-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:44,357  INFO [pool-210-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:44,358  INFO [pool-210-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:44,358  INFO [pool-210-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:44,358  INFO [pool-210-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:44,359  INFO [pool-210-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:44,359  INFO [pool-210-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:44,359  INFO [pool-210-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:44,359  INFO [pool-210-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:44,360  INFO [pool-210-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:44,360  INFO [pool-210-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local2057164164_0043/job_local2057164164_0043.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6280039
2024-04-23T21:07:44,360  INFO [pool-210-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:44,360  INFO [pool-210-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:44,360  INFO [pool-210-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:44,361  INFO [pool-210-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:44,361  INFO [pool-210-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:44,367  INFO [pool-210-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:44,372  INFO [pool-210-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:44,372  INFO [pool-210-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:44,372  INFO [pool-210-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:44,372  INFO [pool-210-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:44,373  INFO [pool-210-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0]
2024-04-23T21:07:44,384  INFO [pool-210-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T21:07:44,385  INFO [pool-210-thread-1] mapred.Task: Task:attempt_local2057164164_0043_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:44,385  INFO [pool-210-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:44,385  INFO [pool-210-thread-1] mapred.Task: Task 'attempt_local2057164164_0043_r_000000_0' done.
2024-04-23T21:07:44,385  INFO [pool-210-thread-1] mapred.Task: Final Counters for attempt_local2057164164_0043_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=996768
		FILE: Number of bytes written=53955100
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:44,385  INFO [pool-210-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2057164164_0043_r_000000_0
2024-04-23T21:07:44,385  INFO [pool-210-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2057164164_0043_r_000001_0
2024-04-23T21:07:44,386  INFO [pool-210-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:44,386  INFO [pool-210-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@501cf125
2024-04-23T21:07:44,386  WARN [pool-210-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:44,387  INFO [pool-210-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:44,387  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2057164164_0043_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:44,390  INFO [localfetcher#62] reduce.LocalFetcher: localfetcher#62 about to shuffle output of map attempt_local2057164164_0043_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:44,390  INFO [localfetcher#62] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local2057164164_0043_m_000000_0
2024-04-23T21:07:44,390  INFO [localfetcher#62] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:44,390  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:44,391  INFO [pool-210-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:44,391  INFO [pool-210-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:44,396  INFO [pool-210-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:44,397  INFO [pool-210-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:44,400  INFO [pool-210-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:44,400  INFO [pool-210-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:44,400  INFO [pool-210-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:44,400  INFO [pool-210-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:44,400  INFO [pool-210-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:44,400  INFO [pool-210-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:44,401  INFO [pool-210-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:44,401  INFO [pool-210-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:44,402  INFO [pool-210-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:44,402  INFO [pool-210-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:44,402  INFO [pool-210-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:44,402  INFO [pool-210-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:44,403  INFO [pool-210-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local2057164164_0043/job_local2057164164_0043.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1cdffeb1
2024-04-23T21:07:44,403  INFO [pool-210-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:44,403  INFO [pool-210-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:44,403  INFO [pool-210-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:44,404  INFO [pool-210-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:44,404  INFO [pool-210-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:44,408  INFO [pool-210-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:44,409  INFO [pool-210-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:44,409  INFO [pool-210-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:44,409  INFO [pool-210-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:44,409  INFO [pool-210-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:44,410  INFO [pool-210-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0]
2024-04-23T21:07:44,419  INFO [pool-210-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T21:07:44,420  INFO [pool-210-thread-1] mapred.Task: Task:attempt_local2057164164_0043_r_000001_0 is done. And is in the process of committing
2024-04-23T21:07:44,420  INFO [pool-210-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:44,420  INFO [pool-210-thread-1] mapred.Task: Task 'attempt_local2057164164_0043_r_000001_0' done.
2024-04-23T21:07:44,420  INFO [pool-210-thread-1] mapred.Task: Final Counters for attempt_local2057164164_0043_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=1002851
		FILE: Number of bytes written=53956134
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:44,420  INFO [pool-210-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2057164164_0043_r_000001_0
2024-04-23T21:07:44,420  INFO [Thread-3597] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:45,306 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:45,306  INFO [main] exec.Task: 2024-04-23 21:07:45,306 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2057164164_0043
2024-04-23T21:07:45,307  INFO [main] exec.Task: Ended Job = job_local2057164164_0043
2024-04-23T21:07:45,307  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest with attemptId 0.
2024-04-23T21:07:45,307  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest with attemptId 0.
2024-04-23T21:07:45,308  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest
2024-04-23T21:07:45,308  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest
2024-04-23T21:07:45,308  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001
2024-04-23T21:07:45,309  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:07:45,309  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:45,310  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,316  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,323  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:45,343  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:45,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,350  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,350  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:45,350  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-43_914_2567968163882221107-1/-mr-10000
2024-04-23T21:07:45,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,359  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,382  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:45,382  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:07:45,382  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:07:45,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:45,402  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:07:45,402  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:07:45,402  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:07:45,403  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2701, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:45,403  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:45,403  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=38, getTable_(GetTableRequest)=29}
MapReduce Jobs Launched: 
2024-04-23T21:07:45,404  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:45,404  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:45,404  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:45,404  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210743_d4f29575-0ebd-4a1f-83e1-72a265ffdfe7); Time taken: 1.358 seconds
2024-04-23T21:07:45,404  INFO [main] ql.TxnCommandsBaseForTests: Running the query: commit
2024-04-23T21:07:45,404  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-43_914_2567968163882221107-1
2024-04-23T21:07:45,405  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7fea70f2-0a74-40e1-b488-9ba3cf448fe5/hive_2024-04-23_21-07-43_914_2567968163882221107-1 on fs with scheme file
2024-04-23T21:07:45,405  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210745_45e5363e-ad77-40df-91a0-f8dd55751ea0): commit
2024-04-23T21:07:45,405  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:45,405  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:45,406  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:45,406  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:45,406  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:45,406  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:45,406  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=0, flushCache_()=0}
2024-04-23T21:07:45,406  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210745_45e5363e-ad77-40df-91a0-f8dd55751ea0); Time taken: 0.001 seconds
2024-04-23T21:07:45,406  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210745_45e5363e-ad77-40df-91a0-f8dd55751ea0
2024-04-23T21:07:45,406  INFO [main] ql.Driver: Operation COMMIT obtained 0 locks
2024-04-23T21:07:45,407  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210745_45e5363e-ad77-40df-91a0-f8dd55751ea0): commit
2024-04-23T21:07:45,407  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:45,407  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:07:45,407  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210745_45e5363e-ad77-40df-91a0-f8dd55751ea0); Time taken: 0.0 seconds
2024-04-23T21:07:45,407  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210745_45e5363e-ad77-40df-91a0-f8dd55751ea0
2024-04-23T21:07:45,420  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:45,420  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:07:45,421  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 2
2024-04-23T21:07:45,421  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210745_9d310c42-fb42-4119-8d82-cd7a37b7c9d3): delete from acidTbl where b = 2
2024-04-23T21:07:45,424  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:07:45,424  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:07:45,425  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:07:45,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:45,432  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,432  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 2> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:07:45,432  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:07:45,435  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:45,436  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:45,436  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,443  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,443  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:45,444  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:45,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:45,452  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:45,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:45,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,495  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-23T21:07:45,495  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,505  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:45,515  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:45,526  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-23T21:07:45,526  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-23T21:07:45,591  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:45,591  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:45,591  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:45,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:45,598  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,601 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:07:45,602 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:07:45,602  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:07:45,602 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:07:45,602  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:45,603  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getAllTableConstraints_(AllTableConstraintsRequest)=6, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, getTable_(GetTableRequest)=29, getTableColumnStatistics_(String, String, List, String)=31}
2024-04-23T21:07:45,603  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210745_9d310c42-fb42-4119-8d82-cd7a37b7c9d3); Time taken: 0.181 seconds
2024-04-23T21:07:45,603  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:07:45,607  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:45,614  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:45,614  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42): drop table if exists acidTbl
2024-04-23T21:07:45,616  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 14
2024-04-23T21:07:45,617  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:07:45,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:45,623  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,623  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:45,623  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:45,623  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:45,623  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=11, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=6}
2024-04-23T21:07:45,623  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42); Time taken: 0.009 seconds
2024-04-23T21:07:45,624  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42
2024-04-23T21:07:45,624  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42
2024-04-23T21:07:45,640  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:07:45,640  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:45,640  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42): drop table if exists acidTbl
2024-04-23T21:07:45,640  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:45,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:45,647  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:45,653  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:45,801  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:45,802  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=154, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:07:45,802  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42); Time taken: 0.161 seconds
2024-04-23T21:07:45,802  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210745_5bb105cb-ff00-4257-86f7-411c14641c42
2024-04-23T21:07:45,808  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:07:45,820  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:45,823  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:07:45,823  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:45,824  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e): drop table if exists acidTblPart
2024-04-23T21:07:45,829  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 14
2024-04-23T21:07:45,829  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:07:45,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:45,848  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,848  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:45,848  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:45,849  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:45,849  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=18, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=5, commitTxn_(CommitTxnRequest)=21}
2024-04-23T21:07:45,849  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e); Time taken: 0.024 seconds
2024-04-23T21:07:45,849  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e
2024-04-23T21:07:45,850  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e
2024-04-23T21:07:45,868  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:07:45,868  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:45,868  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e): drop table if exists acidTblPart
2024-04-23T21:07:45,868  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:45,869  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:45,875  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:45,880  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,881  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:45,918  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:45,918  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:45,918  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e); Time taken: 0.05 seconds
2024-04-23T21:07:45,918  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210745_6e199dc1-aad2-46e9-92fc-90e176ab990e
2024-04-23T21:07:45,922  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:07:45,929  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:45,929  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:07:45,929  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:45,929  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210745_823a52ef-6fe4-4a86-b20d-3233033d8118): drop table if exists acidTbl2
2024-04-23T21:07:45,932  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 14
2024-04-23T21:07:45,932  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:07:45,933  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:45,933  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:45,933  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:45,933  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getTable_(GetTableRequest)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:45,933  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210745_823a52ef-6fe4-4a86-b20d-3233033d8118); Time taken: 0.004 seconds
2024-04-23T21:07:45,933  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210745_823a52ef-6fe4-4a86-b20d-3233033d8118
2024-04-23T21:07:45,933  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:45,934  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210745_823a52ef-6fe4-4a86-b20d-3233033d8118): drop table if exists acidTbl2
2024-04-23T21:07:45,934  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:45,934  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:07:45,934  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:45,934  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T21:07:45,935  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210745_823a52ef-6fe4-4a86-b20d-3233033d8118); Time taken: 0.0 seconds
2024-04-23T21:07:45,935  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210745_823a52ef-6fe4-4a86-b20d-3233033d8118
2024-04-23T21:07:45,940  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:07:45,946  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:45,946  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:07:45,947  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:45,947  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:45,949  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 14
2024-04-23T21:07:45,949  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:07:45,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:45,970  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,970  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:45,970  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:45,970  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:45,970  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getTable_(GetTableRequest)=20, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:07:45,971  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b); Time taken: 0.023 seconds
2024-04-23T21:07:45,971  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b
2024-04-23T21:07:45,971  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b
2024-04-23T21:07:45,986  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:07:45,986  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:45,986  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:45,986  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:45,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:45,994  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:45,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:46,002  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:46,042  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,042  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=48}
2024-04-23T21:07:46,043  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b); Time taken: 0.056 seconds
2024-04-23T21:07:46,043  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210745_766646f4-b05c-420b-88d9-df29437d535b
2024-04-23T21:07:46,046  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:07:46,053  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,053  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:07:46,053  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:46,054  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:46,056  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 14
2024-04-23T21:07:46,056  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:07:46,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:46,064  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,064  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,064  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,064  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:46,065  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965); Time taken: 0.01 seconds
2024-04-23T21:07:46,065  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965
2024-04-23T21:07:46,065  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965
2024-04-23T21:07:46,080  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:07:46,080  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:46,080  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:46,080  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:46,088  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,088  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:46,096  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:46,123  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,123  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=35, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,123  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965); Time taken: 0.043 seconds
2024-04-23T21:07:46,123  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_1c025769-1f82-4baf-a7fa-52e93681b965
2024-04-23T21:07:46,127  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:07:46,133  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,133  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:07:46,134  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:46,134  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b): drop table if exists nonAcidNonBucket
2024-04-23T21:07:46,136  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 14
2024-04-23T21:07:46,137  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:07:46,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:46,145  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,145  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,145  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,145  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,145  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=8, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:07:46,146  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b); Time taken: 0.011 seconds
2024-04-23T21:07:46,146  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b
2024-04-23T21:07:46,146  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b
2024-04-23T21:07:46,161  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:07:46,161  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:46,161  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b): drop table if exists nonAcidNonBucket
2024-04-23T21:07:46,161  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:46,169  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:46,176  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:46,204  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,204  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=35}
2024-04-23T21:07:46,205  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b); Time taken: 0.043 seconds
2024-04-23T21:07:46,205  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_8a8ebc7e-ff6e-4b3d-a70e-cbf92436746b
2024-04-23T21:07:46,209  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:07:46,215  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,215  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:07:46,215  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testUpdateDeleteOfInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="8.661">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = 1 where b != 1 failed: (responseCode = 2, errorMessage = FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask, SQLState = 08S01)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateDeleteOfInserts(TestTxnCommands.java:883)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:07:46,279  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:07:46,282  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 8543c13c-88f7-4996-a15c-3e79ce2f939e
2024-04-23T21:07:46,284  INFO [main] SessionState: Hive Session ID = 8543c13c-88f7-4996-a15c-3e79ce2f939e
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:46,285  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:46,290  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/8543c13c-88f7-4996-a15c-3e79ce2f939e
2024-04-23T21:07:46,292  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e
2024-04-23T21:07:46,294  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/8543c13c-88f7-4996-a15c-3e79ce2f939e/_tmp_space.db
2024-04-23T21:07:46,295  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=8543c13c-88f7-4996-a15c-3e79ce2f939e, clientType=HIVECLI]
2024-04-23T21:07:46,295  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:46,295  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_0b38fc59-4d4e-475d-90cd-10704c934b2e): drop table if exists acidTbl
2024-04-23T21:07:46,303  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:07:46,303  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:07:46,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:46,308  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,308  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,308  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,308  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, openTxn_(String, TxnType)=7, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:07:46,308  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_0b38fc59-4d4e-475d-90cd-10704c934b2e); Time taken: 0.013 seconds
2024-04-23T21:07:46,309  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210746_0b38fc59-4d4e-475d-90cd-10704c934b2e
2024-04-23T21:07:46,309  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:46,309  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_0b38fc59-4d4e-475d-90cd-10704c934b2e): drop table if exists acidTbl
2024-04-23T21:07:46,309  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:46,312  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,312  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,312  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_0b38fc59-4d4e-475d-90cd-10704c934b2e); Time taken: 0.003 seconds
2024-04-23T21:07:46,312  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_0b38fc59-4d4e-475d-90cd-10704c934b2e
2024-04-23T21:07:46,318  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:07:46,324  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,325  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:07:46,325  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:46,325  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_d5048682-1f59-4322-8a0a-cc3a4a8ed655): drop table if exists acidTblPart
2024-04-23T21:07:46,327  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:07:46,328  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:07:46,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:46,331  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,331  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,331  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,331  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:07:46,331  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_d5048682-1f59-4322-8a0a-cc3a4a8ed655); Time taken: 0.006 seconds
2024-04-23T21:07:46,332  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210746_d5048682-1f59-4322-8a0a-cc3a4a8ed655
2024-04-23T21:07:46,332  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:46,332  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_d5048682-1f59-4322-8a0a-cc3a4a8ed655): drop table if exists acidTblPart
2024-04-23T21:07:46,332  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:46,335  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,335  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,335  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_d5048682-1f59-4322-8a0a-cc3a4a8ed655); Time taken: 0.003 seconds
2024-04-23T21:07:46,335  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_d5048682-1f59-4322-8a0a-cc3a4a8ed655
2024-04-23T21:07:46,340  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:07:46,346  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,346  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:07:46,347  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:46,347  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_fbb6d568-9eca-4c4b-adeb-133c2d4cd20e): drop table if exists acidTbl2
2024-04-23T21:07:46,350  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:07:46,350  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:07:46,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:46,353  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,353  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,353  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,353  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:07:46,353  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_fbb6d568-9eca-4c4b-adeb-133c2d4cd20e); Time taken: 0.006 seconds
2024-04-23T21:07:46,354  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210746_fbb6d568-9eca-4c4b-adeb-133c2d4cd20e
2024-04-23T21:07:46,354  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:46,354  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_fbb6d568-9eca-4c4b-adeb-133c2d4cd20e): drop table if exists acidTbl2
2024-04-23T21:07:46,354  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:46,357  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,357  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,357  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_fbb6d568-9eca-4c4b-adeb-133c2d4cd20e); Time taken: 0.003 seconds
2024-04-23T21:07:46,357  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_fbb6d568-9eca-4c4b-adeb-133c2d4cd20e
2024-04-23T21:07:46,363  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:07:46,369  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,369  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:07:46,369  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:46,370  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_9509fdde-ddae-4956-9236-cf646940958f): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:46,372  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:07:46,372  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:07:46,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:46,375  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,375  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,375  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,375  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,376  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_9509fdde-ddae-4956-9236-cf646940958f); Time taken: 0.006 seconds
2024-04-23T21:07:46,376  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210746_9509fdde-ddae-4956-9236-cf646940958f
2024-04-23T21:07:46,376  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:46,376  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_9509fdde-ddae-4956-9236-cf646940958f): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:46,376  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:46,379  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,379  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,379  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_9509fdde-ddae-4956-9236-cf646940958f); Time taken: 0.003 seconds
2024-04-23T21:07:46,379  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_9509fdde-ddae-4956-9236-cf646940958f
2024-04-23T21:07:46,385  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:07:46,391  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,391  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:07:46,392  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:46,392  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_1f68554a-3a22-43bb-8698-b69dbca9637b): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:46,394  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:07:46,394  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:07:46,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:46,397  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,397  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,397  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,397  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:07:46,398  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_1f68554a-3a22-43bb-8698-b69dbca9637b); Time taken: 0.005 seconds
2024-04-23T21:07:46,398  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210746_1f68554a-3a22-43bb-8698-b69dbca9637b
2024-04-23T21:07:46,398  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:46,398  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_1f68554a-3a22-43bb-8698-b69dbca9637b): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:46,398  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:46,402  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,402  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,402  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_1f68554a-3a22-43bb-8698-b69dbca9637b); Time taken: 0.004 seconds
2024-04-23T21:07:46,402  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_1f68554a-3a22-43bb-8698-b69dbca9637b
2024-04-23T21:07:46,408  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:07:46,414  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,414  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:07:46,414  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:46,415  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_df8aafe8-9058-46fa-80e8-3716aea7a0a4): drop table if exists nonAcidNonBucket
2024-04-23T21:07:46,417  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:07:46,417  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:07:46,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:46,420  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,420  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,420  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,420  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:07:46,420  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_df8aafe8-9058-46fa-80e8-3716aea7a0a4); Time taken: 0.006 seconds
2024-04-23T21:07:46,421  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210746_df8aafe8-9058-46fa-80e8-3716aea7a0a4
2024-04-23T21:07:46,421  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:46,421  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_df8aafe8-9058-46fa-80e8-3716aea7a0a4): drop table if exists nonAcidNonBucket
2024-04-23T21:07:46,421  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:46,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,424  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_df8aafe8-9058-46fa-80e8-3716aea7a0a4); Time taken: 0.003 seconds
2024-04-23T21:07:46,424  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_df8aafe8-9058-46fa-80e8-3716aea7a0a4
2024-04-23T21:07:46,429  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:07:46,435  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,436  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:07:46,436  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,436  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,439  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:07:46,439  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:07:46,439  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:46,439  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:46,446  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:07:46,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:46,447  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:46,447  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,447  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,448  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2}
2024-04-23T21:07:46,448  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0); Time taken: 0.011 seconds
2024-04-23T21:07:46,448  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0
2024-04-23T21:07:46,448  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0
2024-04-23T21:07:46,467  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:07:46,467  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:46,467  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,467  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931666, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, totalSize=0, numFiles=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:46,473  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:46,508  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,508  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=39, isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:46,508  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0); Time taken: 0.04 seconds
2024-04-23T21:07:46,508  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_b76d7a50-91f6-42bb-8c21-fd9d7e85c1b0
2024-04-23T21:07:46,512  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:07:46,518  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,518  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:07:46,518  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,519  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,521  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:07:46,521  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:07:46,521  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:46,522  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:46,524  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:07:46,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:46,526  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:46,526  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,526  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,526  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,526  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:07:46,526  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d); Time taken: 0.007 seconds
2024-04-23T21:07:46,526  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d
2024-04-23T21:07:46,526  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d
2024-04-23T21:07:46,540  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:07:46,540  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:46,541  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,541  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931666, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:46,547  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:07:46,564  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,564  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,564  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d); Time taken: 0.023 seconds
2024-04-23T21:07:46,564  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_765aca4b-cd64-49eb-b8ca-b9e28c7ba53d
2024-04-23T21:07:46,568  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:07:46,572  INFO [Metastore Scheduled Worker 2] metastore.HMSHandler: 5: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:07:46,572  INFO [Metastore Scheduled Worker 2] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5baf07bd, with PersistenceManager: null will be shutdown
2024-04-23T21:07:46,573  INFO [Metastore Scheduled Worker 2] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5baf07bd, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@8739e57 created in the thread with id: 46
2024-04-23T21:07:46,576  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,576  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:07:46,577  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,577  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,580  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:07:46,580  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:07:46,581  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:46,581  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:46,584  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:07:46,584  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:46,586  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:46,586  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,586  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,586  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,586  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:07:46,586  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95); Time taken: 0.009 seconds
2024-04-23T21:07:46,587  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95
2024-04-23T21:07:46,587  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95
2024-04-23T21:07:46,598  INFO [Metastore Scheduled Worker 2] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5baf07bd from thread id: 46
2024-04-23T21:07:46,605  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:07:46,605  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:46,605  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,605  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,606  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931666, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFiles=0, bucketing_version=2, totalSize=0, rawDataSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:46,612  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:07:46,626  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,626  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,626  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95); Time taken: 0.021 seconds
2024-04-23T21:07:46,626  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_6688cc2e-7515-4332-91f8-a4ef162d7d95
2024-04-23T21:07:46,630  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:07:46,637  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,637  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:07:46,637  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,638  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,640  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:07:46,640  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:07:46,641  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:46,641  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:46,643  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:07:46,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:46,645  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:46,645  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,645  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,645  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,645  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,645  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0); Time taken: 0.007 seconds
2024-04-23T21:07:46,646  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0
2024-04-23T21:07:46,646  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0
2024-04-23T21:07:46,660  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:07:46,660  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:46,660  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,661  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931666, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, rawDataSize=0, totalSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:46,666  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:07:46,678  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,679  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=17, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,679  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0); Time taken: 0.018 seconds
2024-04-23T21:07:46,679  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_27438ff4-6893-449d-ada3-ef8578a528a0
2024-04-23T21:07:46,683  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:07:46,689  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,689  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:07:46,690  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,690  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,692  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:07:46,693  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:07:46,693  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:46,693  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:46,695  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:07:46,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:46,697  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:46,697  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,697  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,697  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,697  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=3, getValidTxns_(long)=0}
2024-04-23T21:07:46,698  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d); Time taken: 0.007 seconds
2024-04-23T21:07:46,698  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d
2024-04-23T21:07:46,698  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d
2024-04-23T21:07:46,713  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:07:46,713  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:46,713  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:46,714  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,715  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/8543c13c-88f7-4996-a15c-3e79ce2f939e/_tmp_space.db/9abc33f8-ba1b-4d8b-b055-13cde0cbeb3c
2024-04-23T21:07:46,717  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,717  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:07:46,718  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d); Time taken: 0.004 seconds
2024-04-23T21:07:46,718  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_12978e33-7d97-41fb-9dcb-10e3e11c915d
2024-04-23T21:07:46,722  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:07:46,728  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,728  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:07:46,729  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,729  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,731  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:07:46,731  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:07:46,732  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:46,732  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:46,734  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:07:46,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:46,736  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:46,736  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,736  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:46,736  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,736  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:46,737  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868); Time taken: 0.007 seconds
2024-04-23T21:07:46,737  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868
2024-04-23T21:07:46,737  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868
2024-04-23T21:07:46,753  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:07:46,753  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:46,753  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:46,753  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:46,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931666, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numRows=0, transactional=false, rawDataSize=0, numFilesErasureCoded=0, totalSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:46,759  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:07:46,788  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:46,788  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=34}
2024-04-23T21:07:46,788  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868); Time taken: 0.035 seconds
2024-04-23T21:07:46,788  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_21bcada3-b6f4-4516-b82c-1dcb5aa59868
2024-04-23T21:07:46,792  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:07:46,799  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:46,799  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:07:46,799  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:46,800  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:46,802  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:07:46,802  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:07:46,803  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:46,803  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:46,806  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:46,827  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,827  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:46,827  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:46,827  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:46,827  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:46,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:46,833  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,834  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:46,834  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:46,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:46,924  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:46,924  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:46,924  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:46,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:46,927  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:46,927  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:46,927  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:46,927  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:46,934  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:46,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:46,945  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T21:07:46,945  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T21:07:46,946  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:46,949  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:46,949  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:46,950  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:46,950  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:46,958  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:46,965  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:46,965  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:46,966  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:46,966  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:46,966  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:46,966  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:46,966  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:07:46,966  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:46,966  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=3, getAllTableConstraints_(AllTableConstraintsRequest)=26, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=4, getTable_(GetTableRequest)=42, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T21:07:46,966  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141); Time taken: 0.166 seconds
2024-04-23T21:07:46,967  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141
2024-04-23T21:07:46,967  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141
2024-04-23T21:07:46,983  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:07:46,983  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:46,986  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:07:46,986  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141
2024-04-23T21:07:46,986  INFO [main] ql.Driver: Query ID = alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141
Total jobs = 1
2024-04-23T21:07:46,986  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:46,986  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:47,112  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:47,112  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:47,112  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:47,112  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:47,112  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:47,112  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:47,112  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:47,112  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:47,114  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:47,114  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:47,114  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-46_800_8145019808651468451-1/dummy_path
2024-04-23T21:07:47,124  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:47,125  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,31KB
2024-04-23T21:07:47,129  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:47,130  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:47,131  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:47,135  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-46_800_8145019808651468451-1/-mr-10000
2024-04-23T21:07:47,137  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:47,144  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:47,148  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:47,149  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:47,149  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:47,149  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-46_800_8145019808651468451-1/dummy_path
2024-04-23T21:07:47,150  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:47,168  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:47,189  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2129039675_0044
2024-04-23T21:07:47,189  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:47,253  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:47,253  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:47,254  INFO [Thread-3705] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:47,254  INFO [Thread-3705] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:47,255  INFO [Thread-3705] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:47,256  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2129039675_0044_m_000000_0
2024-04-23T21:07:47,259  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:47,259  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-46_800_8145019808651468451-1/dummy_path/null:0+1
2024-04-23T21:07:47,261  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:47,262  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,31KB
2024-04-23T21:07:47,262  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:47,266  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:47,266  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:47,266  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:47,266  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:47,267  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:47,267  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:47,267  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:47,268  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:47,268  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:47,268  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:47,269  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:47,269  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:47,269  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:47,269  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:47,269  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:07:47,269  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:47,270  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:07:47,271  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T21:07:47,273  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:47,273  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:47,274  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:47,274  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:07:47,274  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:47,284  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:47,289  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2129039675_0044_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:47,289  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:47,289  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2129039675_0044_m_000000_0' done.
2024-04-23T21:07:47,290  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2129039675_0044_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=1009256
		FILE: Number of bytes written=55211629
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5362
2024-04-23T21:07:47,290  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2129039675_0044_m_000000_0
2024-04-23T21:07:47,290  INFO [Thread-3705] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:47,291  INFO [Thread-3705] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:47,291  INFO [pool-215-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2129039675_0044_r_000000_0
2024-04-23T21:07:47,293  INFO [pool-215-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:47,294  INFO [pool-215-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1b70d5bd
2024-04-23T21:07:47,294  WARN [pool-215-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:47,294  INFO [pool-215-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:47,295  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2129039675_0044_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:47,311  INFO [localfetcher#63] reduce.LocalFetcher: localfetcher#63 about to shuffle output of map attempt_local2129039675_0044_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:47,312  INFO [localfetcher#63] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local2129039675_0044_m_000000_0
2024-04-23T21:07:47,312  INFO [localfetcher#63] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:47,312  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:47,312  INFO [pool-215-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:47,312  INFO [pool-215-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:47,319  INFO [pool-215-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:47,319  INFO [pool-215-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:47,322  INFO [pool-215-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:47,322  INFO [pool-215-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:47,322  INFO [pool-215-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:47,322  INFO [pool-215-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:47,322  INFO [pool-215-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:47,322  INFO [pool-215-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:47,323  INFO [pool-215-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:47,323  INFO [pool-215-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:47,324  INFO [pool-215-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:47,324  INFO [pool-215-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:47,324  INFO [pool-215-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:47,324  INFO [pool-215-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:47,325  INFO [pool-215-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local2129039675_0044/job_local2129039675_0044.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@53ac2474
2024-04-23T21:07:47,325  INFO [pool-215-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:47,325  INFO [pool-215-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:47,325  INFO [pool-215-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:47,326  INFO [pool-215-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:47,326  INFO [pool-215-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:47,333  INFO [pool-215-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:47,338  INFO [pool-215-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:47,338  INFO [pool-215-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:47,338  INFO [pool-215-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:47,338  INFO [pool-215-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:47,340  INFO [pool-215-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:07:47,352  INFO [pool-215-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-23T21:07:47,353  INFO [pool-215-thread-1] mapred.Task: Task:attempt_local2129039675_0044_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:47,353  INFO [pool-215-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:47,353  INFO [pool-215-thread-1] mapred.Task: Task 'attempt_local2129039675_0044_r_000000_0' done.
2024-04-23T21:07:47,353  INFO [pool-215-thread-1] mapred.Task: Final Counters for attempt_local2129039675_0044_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=1015363
		FILE: Number of bytes written=55212668
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=13
		Total committed heap usage (bytes)=1342177280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:47,353  INFO [pool-215-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2129039675_0044_r_000000_0
2024-04-23T21:07:47,353  INFO [pool-215-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2129039675_0044_r_000001_0
2024-04-23T21:07:47,354  INFO [pool-215-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:47,354  INFO [pool-215-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@57c4fe82
2024-04-23T21:07:47,354  WARN [pool-215-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:47,355  INFO [pool-215-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:47,355  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2129039675_0044_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:47,358  INFO [localfetcher#64] reduce.LocalFetcher: localfetcher#64 about to shuffle output of map attempt_local2129039675_0044_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:47,358  INFO [localfetcher#64] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local2129039675_0044_m_000000_0
2024-04-23T21:07:47,358  INFO [localfetcher#64] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:47,359  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:47,359  INFO [pool-215-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:47,359  INFO [pool-215-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:47,365  INFO [pool-215-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:47,365  INFO [pool-215-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:47,368  INFO [pool-215-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:47,368  INFO [pool-215-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:47,368  INFO [pool-215-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:47,368  INFO [pool-215-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:47,368  INFO [pool-215-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:47,369  INFO [pool-215-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:47,369  INFO [pool-215-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:47,369  INFO [pool-215-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:47,370  INFO [pool-215-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:47,370  INFO [pool-215-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:47,370  INFO [pool-215-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:47,370  INFO [pool-215-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:47,371  INFO [pool-215-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local2129039675_0044/job_local2129039675_0044.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1d683bbd
2024-04-23T21:07:47,371  INFO [pool-215-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:47,372  INFO [pool-215-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:47,372  INFO [pool-215-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:47,372  INFO [pool-215-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:47,372  INFO [pool-215-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:47,377  INFO [pool-215-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:47,377  INFO [pool-215-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:47,377  INFO [pool-215-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:47,377  INFO [pool-215-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:47,377  INFO [pool-215-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:47,379  INFO [pool-215-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:07:47,390  INFO [pool-215-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:47,390  INFO [pool-215-thread-1] mapred.Task: Task:attempt_local2129039675_0044_r_000001_0 is done. And is in the process of committing
2024-04-23T21:07:47,390  INFO [pool-215-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:47,391  INFO [pool-215-thread-1] mapred.Task: Task 'attempt_local2129039675_0044_r_000001_0' done.
2024-04-23T21:07:47,391  INFO [pool-215-thread-1] mapred.Task: Final Counters for attempt_local2129039675_0044_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=1021446
		FILE: Number of bytes written=55213696
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1342177280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:47,391  INFO [pool-215-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2129039675_0044_r_000001_0
2024-04-23T21:07:47,391  INFO [Thread-3705] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:48,256 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:48,257  INFO [main] exec.Task: 2024-04-23 21:07:48,256 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2129039675_0044
2024-04-23T21:07:48,260  INFO [main] exec.Task: Ended Job = job_local2129039675_0044
2024-04-23T21:07:48,261  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:48,261  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:07:48,262  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:07:48,262  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:07:48,262  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:07:48,263  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:07:48,263  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:48,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,270  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:48,270  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:48,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:48,308  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:48,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,314  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:48,314  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:48,314  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-46_800_8145019808651468451-1/-mr-10000
2024-04-23T21:07:48,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,322  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:48,332  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:48,333  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:07:48,333  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:07:48,333  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:48,352  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:07:48,352  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:07:48,353  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:07:48,355  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:48,355  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:48,356  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=50, getTable_(GetTableRequest)=26, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T21:07:48,356  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:48,356  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:48,356  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:48,356  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141); Time taken: 1.369 seconds
2024-04-23T21:07:48,356  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210746_df1ff7c3-ad1c-4c04-bc08-e1cafa288141
2024-04-23T21:07:48,368  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:48,368  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:07:48,368  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T21:07:48,368  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-46_800_8145019808651468451-1
2024-04-23T21:07:48,369  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-46_800_8145019808651468451-1 on fs with scheme file
2024-04-23T21:07:48,369  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116): select a,b from acidTbl order by a,b
2024-04-23T21:07:48,372  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:07:48,372  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:07:48,373  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:48,373  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:48,375  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:48,376  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:48,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,382  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:48,383  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:48,383  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:48,383  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:48,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,402  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:07:48,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,411  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:48,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:48,419  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:48,419  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:48,430  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:48,430  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:48,471  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:48,472  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:48,472  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:48,473  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-48_369_8982846529189175093-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-48_369_8982846529189175093-1
2024-04-23T21:07:48,480  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:48,482  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:48,482  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:48,484  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:48,493  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:48,493  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:48,493  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:07:48,494  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:07:48,494  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:07:48,494  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:48,494  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:48,495  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:48,495  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:48,495  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:48,495  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:48,495  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:48,495  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:48,495  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:48,495  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:48,495  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:48,495  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:07:48,496  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:07:48,496  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:48,496  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=2, getTableColumnStatistics_(String, String, List, String)=27, flushCache_()=0, getTable_(GetTableRequest)=7, getAllTableConstraints_(AllTableConstraintsRequest)=6, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-23T21:07:48,496  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116); Time taken: 0.127 seconds
2024-04-23T21:07:48,497  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116
2024-04-23T21:07:48,497  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116
2024-04-23T21:07:48,511  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:07:48,511  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:48,512  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116): select a,b from acidTbl order by a,b
2024-04-23T21:07:48,512  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116
2024-04-23T21:07:48,512  INFO [main] ql.Driver: Query ID = alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116
Total jobs = 1
2024-04-23T21:07:48,512  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:48,512  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:48,636  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:07:48,636  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:48,636  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:48,636  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:48,636  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:48,636  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:48,636  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:48,636  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:48,638  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:48,638  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T21:07:48,638  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:48,647  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:48,648  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:48,653  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:48,654  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:48,655  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:48,660  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:48,667  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:48,671  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:48,672  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:07:48,672  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:07:48,672  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:48,672  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:07:48,673  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:07:48,673  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:07:48,684  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:07:48,684  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 12 ms
2024-04-23T21:07:48,684  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:07:48,701  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:07:48,720  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2016636348_0045
2024-04-23T21:07:48,720  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:48,782  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:48,782  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:48,782  INFO [Thread-3782] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:48,783  INFO [Thread-3782] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:48,784  INFO [Thread-3782] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:48,784  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2016636348_0045_m_000000_0
2024-04-23T21:07:48,785  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:48,785  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:48,786  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:48,786  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:48,787  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:48,787  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:48,788  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:48,792  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:48,792  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:48,792  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:48,792  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:48,792  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:48,793  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:48,793  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:48,793  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:48,794  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:48,794  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:48,794  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:48,794  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:48,795  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:48,796  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_6:1, 
2024-04-23T21:07:48,796  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:48,796  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:48,796  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:48,796  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:48,796  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:48,807  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:48,809  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2016636348_0045_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:48,810  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:48,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2016636348_0045_m_000000_0' done.
2024-04-23T21:07:48,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2016636348_0045_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1032020
		FILE: Number of bytes written=56468170
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1342177280
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8869
2024-04-23T21:07:48,810  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2016636348_0045_m_000000_0
2024-04-23T21:07:48,810  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2016636348_0045_m_000001_0
2024-04-23T21:07:48,811  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:48,811  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:48,812  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:48,812  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:48,812  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:48,813  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:48,814  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:48,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:48,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:48,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:48,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:48,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:48,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:48,819  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:48,819  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:48,819  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:48,819  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:48,820  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:07:48,821  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:48,821  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:48,821  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:48,821  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:48,821  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:48,829  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:48,832  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2016636348_0045_m_000001_0 is done. And is in the process of committing
2024-04-23T21:07:48,833  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:48,833  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2016636348_0045_m_000001_0' done.
2024-04-23T21:07:48,833  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2016636348_0045_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1041894
		FILE: Number of bytes written=56468229
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1342177280
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8861
2024-04-23T21:07:48,833  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2016636348_0045_m_000001_0
2024-04-23T21:07:48,833  INFO [Thread-3782] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:48,834  INFO [Thread-3782] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:48,834  INFO [pool-220-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2016636348_0045_r_000000_0
2024-04-23T21:07:48,834  INFO [pool-220-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:48,834  INFO [pool-220-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@405452de
2024-04-23T21:07:48,834  WARN [pool-220-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:48,835  INFO [pool-220-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:48,836  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2016636348_0045_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:48,838  INFO [localfetcher#65] reduce.LocalFetcher: localfetcher#65 about to shuffle output of map attempt_local2016636348_0045_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:48,839  INFO [localfetcher#65] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local2016636348_0045_m_000000_0
2024-04-23T21:07:48,839  INFO [localfetcher#65] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T21:07:48,842  INFO [localfetcher#65] reduce.LocalFetcher: localfetcher#65 about to shuffle output of map attempt_local2016636348_0045_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:48,842  INFO [localfetcher#65] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local2016636348_0045_m_000001_0
2024-04-23T21:07:48,842  INFO [localfetcher#65] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T21:07:48,842  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:48,842  INFO [pool-220-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:07:48,842  INFO [pool-220-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:48,850  INFO [pool-220-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:07:48,850  INFO [pool-220-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-23T21:07:48,852  INFO [pool-220-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:48,852  INFO [pool-220-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-23T21:07:48,852  INFO [pool-220-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:48,852  INFO [pool-220-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:48,852  INFO [pool-220-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-23T21:07:48,853  INFO [pool-220-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:07:48,853  INFO [pool-220-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:48,853  INFO [pool-220-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:48,854  INFO [pool-220-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:48,854  INFO [pool-220-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:48,854  INFO [pool-220-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T21:07:48,854  INFO [pool-220-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:07:48,854  INFO [pool-220-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@746cc559, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@11e6fc1b, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@ea5853d
2024-04-23T21:07:48,855  INFO [pool-220-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-48_369_8982846529189175093-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-48_369_8982846529189175093-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:48,855  INFO [pool-220-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-48_369_8982846529189175093-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-48_369_8982846529189175093-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:07:48,855  INFO [pool-220-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-48_369_8982846529189175093-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-48_369_8982846529189175093-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:48,862  INFO [pool-220-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:48,862  INFO [pool-220-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:48,862  INFO [pool-220-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:48,862  INFO [pool-220-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:07:48,862  INFO [pool-220-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:07:48,863  INFO [pool-220-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:48,863  INFO [pool-220-thread-1] mapred.Task: Task:attempt_local2016636348_0045_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:48,863  INFO [pool-220-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:48,863  INFO [pool-220-thread-1] mapred.Task: Task 'attempt_local2016636348_0045_r_000000_0' done.
2024-04-23T21:07:48,863  INFO [pool-220-thread-1] mapred.Task: Final Counters for attempt_local2016636348_0045_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1049138
		FILE: Number of bytes written=56468408
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1342177280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:48,864  INFO [pool-220-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2016636348_0045_r_000000_0
2024-04-23T21:07:48,864  INFO [Thread-3782] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:49,785 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:49,785  INFO [main] exec.Task: 2024-04-23 21:07:49,785 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2016636348_0045
2024-04-23T21:07:49,786  INFO [main] exec.Task: Ended Job = job_local2016636348_0045
2024-04-23T21:07:49,787  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:49,787  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:07:49,788  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:49,788  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:49,788  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:49,788  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116); Time taken: 1.275 seconds
2024-04-23T21:07:49,788  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210748_bbf2fb36-5554-4169-9b82-c5310f57c116
2024-04-23T21:07:49,792  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:07:49,799  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:49,799  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:07:49,803  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:07:49,803  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:07:49,803  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:49,804  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T21:07:49,804  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-48_369_8982846529189175093-1
2024-04-23T21:07:49,805  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-48_369_8982846529189175093-1 on fs with scheme file
2024-04-23T21:07:49,805  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210749_65a6ef6d-e9c8-4506-b71a-bf1a123c8d96): START TRANSACTION
2024-04-23T21:07:49,808  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:07:49,808  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:07:49,809  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:49,809  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:49,809  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:49,809  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:49,809  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:49,809  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:49,809  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, getValidWriteIds_(List, String)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:07:49,809  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210749_65a6ef6d-e9c8-4506-b71a-bf1a123c8d96); Time taken: 0.004 seconds
2024-04-23T21:07:49,809  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210749_65a6ef6d-e9c8-4506-b71a-bf1a123c8d96
2024-04-23T21:07:49,809  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T21:07:49,809  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210749_65a6ef6d-e9c8-4506-b71a-bf1a123c8d96): START TRANSACTION
2024-04-23T21:07:49,810  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:49,810  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:07:49,810  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210749_65a6ef6d-e9c8-4506-b71a-bf1a123c8d96); Time taken: 0.0 seconds
2024-04-23T21:07:49,810  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:49,810  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:49,811  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:49,811  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:49,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:49,821  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:49,821  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:49,821  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:49,821  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:49,821  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:49,822  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:49,828  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:49,828  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:49,828  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:49,850  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:49,901  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:49,901  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:49,901  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:49,901  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:49,904  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:49,904  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:49,904  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:49,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:49,911  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:49,912  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:49,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:49,921  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 15
2024-04-23T21:07:49,921  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-23T21:07:49,922  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:49,925  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:49,925  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:49,926  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:49,927  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:49,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:49,942  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:49,943  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:49,943  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:49,943  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:49,943  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:49,944  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:07:49,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:49,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=6, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, allocateTableWriteId_(long, String, String)=6, getValidWriteIds_(List, String)=4, getTable_(GetTableRequest)=28}
2024-04-23T21:07:49,944  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514); Time taken: 0.134 seconds
2024-04-23T21:07:49,944  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514
2024-04-23T21:07:49,945  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514
2024-04-23T21:07:49,959  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:07:49,959  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:49,962  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T21:07:49,962  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514
2024-04-23T21:07:49,963  INFO [main] ql.Driver: Query ID = alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514
Total jobs = 1
2024-04-23T21:07:49,963  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:49,963  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:50,087  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:50,088  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:50,088  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:50,088  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:50,088  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:50,088  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:50,088  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:50,088  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:50,090  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:50,090  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:50,090  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-49_810_4324949476495612584-1/dummy_path
2024-04-23T21:07:50,099  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:50,100  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,31KB
2024-04-23T21:07:50,105  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:50,105  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:50,106  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:50,110  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-49_810_4324949476495612584-1/-mr-10000
2024-04-23T21:07:50,112  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:50,118  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:50,123  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:50,124  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:50,124  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:50,124  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-49_810_4324949476495612584-1/dummy_path
2024-04-23T21:07:50,124  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:50,141  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:50,160  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local692023789_0046
2024-04-23T21:07:50,160  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:50,223  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:50,223  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:50,224  INFO [Thread-3835] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:50,224  INFO [Thread-3835] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:50,225  INFO [Thread-3835] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:50,225  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local692023789_0046_m_000000_0
2024-04-23T21:07:50,226  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:50,226  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-49_810_4324949476495612584-1/dummy_path/null:0+1
2024-04-23T21:07:50,227  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:50,227  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,31KB
2024-04-23T21:07:50,228  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:50,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:50,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:50,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:50,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:50,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:50,244  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:50,244  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:50,244  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:07:50,245  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, 
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:50,246  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:07:50,247  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:07:50,258  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:50,261  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local692023789_0046_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:50,261  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:50,261  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local692023789_0046_m_000000_0' done.
2024-04-23T21:07:50,261  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local692023789_0046_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=1055036
		FILE: Number of bytes written=57719077
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=10
		Total committed heap usage (bytes)=1345847296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5362
2024-04-23T21:07:50,262  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local692023789_0046_m_000000_0
2024-04-23T21:07:50,262  INFO [Thread-3835] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:50,263  INFO [Thread-3835] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:50,263  INFO [pool-223-thread-1] mapred.LocalJobRunner: Starting task: attempt_local692023789_0046_r_000000_0
2024-04-23T21:07:50,263  INFO [pool-223-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:50,263  INFO [pool-223-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4ceea32
2024-04-23T21:07:50,264  WARN [pool-223-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:50,264  INFO [pool-223-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:50,265  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local692023789_0046_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:50,266  INFO [localfetcher#66] reduce.LocalFetcher: localfetcher#66 about to shuffle output of map attempt_local692023789_0046_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:50,266  INFO [localfetcher#66] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local692023789_0046_m_000000_0
2024-04-23T21:07:50,266  INFO [localfetcher#66] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:50,266  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:50,266  INFO [pool-223-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:50,267  INFO [pool-223-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:50,273  INFO [pool-223-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:50,273  INFO [pool-223-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:50,275  INFO [pool-223-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:50,275  INFO [pool-223-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:50,275  INFO [pool-223-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:50,275  INFO [pool-223-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:50,275  INFO [pool-223-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:50,275  INFO [pool-223-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:50,276  INFO [pool-223-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:50,276  INFO [pool-223-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:50,277  INFO [pool-223-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:50,277  INFO [pool-223-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:50,277  INFO [pool-223-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:50,277  INFO [pool-223-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:50,277  INFO [pool-223-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local692023789_0046/job_local692023789_0046.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5bb73a55
2024-04-23T21:07:50,278  INFO [pool-223-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:50,278  INFO [pool-223-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:50,278  INFO [pool-223-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:50,278  INFO [pool-223-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:50,278  INFO [pool-223-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:50,285  INFO [pool-223-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:50,289  INFO [pool-223-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:50,289  INFO [pool-223-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:50,289  INFO [pool-223-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:50,289  INFO [pool-223-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:50,290  INFO [pool-223-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0]
2024-04-23T21:07:50,301  INFO [pool-223-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-23T21:07:50,302  INFO [pool-223-thread-1] mapred.Task: Task:attempt_local692023789_0046_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:50,302  INFO [pool-223-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:50,302  INFO [pool-223-thread-1] mapred.Task: Task 'attempt_local692023789_0046_r_000000_0' done.
2024-04-23T21:07:50,302  INFO [pool-223-thread-1] mapred.Task: Final Counters for attempt_local692023789_0046_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=1061143
		FILE: Number of bytes written=57720117
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:50,302  INFO [pool-223-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local692023789_0046_r_000000_0
2024-04-23T21:07:50,302  INFO [pool-223-thread-1] mapred.LocalJobRunner: Starting task: attempt_local692023789_0046_r_000001_0
2024-04-23T21:07:50,303  INFO [pool-223-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:50,303  INFO [pool-223-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3e5f2d2
2024-04-23T21:07:50,303  WARN [pool-223-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:50,303  INFO [pool-223-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:50,304  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local692023789_0046_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:50,307  INFO [localfetcher#67] reduce.LocalFetcher: localfetcher#67 about to shuffle output of map attempt_local692023789_0046_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:07:50,307  INFO [localfetcher#67] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local692023789_0046_m_000000_0
2024-04-23T21:07:50,307  INFO [localfetcher#67] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:07:50,307  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:50,308  INFO [pool-223-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:50,308  INFO [pool-223-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:50,315  INFO [pool-223-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:50,315  INFO [pool-223-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:50,323  INFO [pool-223-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:50,324  INFO [pool-223-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:07:50,324  INFO [pool-223-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:50,324  INFO [pool-223-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:50,324  INFO [pool-223-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:07:50,325  INFO [pool-223-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:07:50,326  INFO [pool-223-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:50,327  INFO [pool-223-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:07:50,329  INFO [pool-223-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:50,329  INFO [pool-223-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:50,330  INFO [pool-223-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:07:50,330  INFO [pool-223-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:07:50,331  INFO [pool-223-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local692023789_0046/job_local692023789_0046.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2052a9dd
2024-04-23T21:07:50,332  INFO [pool-223-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:50,332  INFO [pool-223-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:50,332  INFO [pool-223-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:50,333  INFO [pool-223-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:50,333  INFO [pool-223-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:50,347  INFO [pool-223-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:50,347  INFO [pool-223-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:50,348  INFO [pool-223-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:50,348  INFO [pool-223-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:07:50,348  INFO [pool-223-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:07:50,352  INFO [pool-223-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-23T21:07:50,379  INFO [pool-223-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-23T21:07:50,380  INFO [pool-223-thread-1] mapred.Task: Task:attempt_local692023789_0046_r_000001_0 is done. And is in the process of committing
2024-04-23T21:07:50,381  INFO [pool-223-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:50,381  INFO [pool-223-thread-1] mapred.Task: Task 'attempt_local692023789_0046_r_000001_0' done.
2024-04-23T21:07:50,382  INFO [pool-223-thread-1] mapred.Task: Final Counters for attempt_local692023789_0046_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=1067226
		FILE: Number of bytes written=57721151
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:50,382  INFO [pool-223-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local692023789_0046_r_000001_0
2024-04-23T21:07:50,382  INFO [Thread-3835] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:07:51,225 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:51,225  INFO [main] exec.Task: 2024-04-23 21:07:51,225 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local692023789_0046
2024-04-23T21:07:51,225  INFO [main] exec.Task: Ended Job = job_local692023789_0046
2024-04-23T21:07:51,226  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:51,226  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:07:51,226  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-23T21:07:51,226  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest
2024-04-23T21:07:51,227  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-23T21:07:51,228  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:07:51,228  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:51,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,234  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:51,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,240  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:51,241  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:51,260  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:51,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,266  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:51,266  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:51,267  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-49_810_4324949476495612584-1/-mr-10000
2024-04-23T21:07:51,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,274  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:51,297  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:51,297  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:07:51,297  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:07:51,298  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:07:51,317  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:07:51,317  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:07:51,317  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:07:51,318  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2695, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:51,318  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:51,318  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=38, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=25}
MapReduce Jobs Launched: 
2024-04-23T21:07:51,318  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:51,318  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:51,318  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:51,318  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210749_fef3557a-ea69-4368-8b8a-492a6fcb0514); Time taken: 1.356 seconds
2024-04-23T21:07:51,319  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T21:07:51,319  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-49_810_4324949476495612584-1
2024-04-23T21:07:51,319  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-49_810_4324949476495612584-1 on fs with scheme file
2024-04-23T21:07:51,320  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5): select a,b from acidTbl order by a,b
2024-04-23T21:07:51,320  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:51,320  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:51,321  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:51,321  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:51,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,328  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:51,328  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:51,328  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:51,328  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:51,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,347  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:07:51,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,356  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:51,357  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:51,365  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:51,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:51,375  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T21:07:51,375  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T21:07:51,422  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:51,422  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:51,422  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:51,423  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-51_319_8262872747998787052-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-51_319_8262872747998787052-1
2024-04-23T21:07:51,431  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:51,433  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:07:51,433  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:07:51,434  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:51,443  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:51,443  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:51,443  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:51,444  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:51,444  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:51,444  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:51,444  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:51,444  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:07:51,445  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:07:51,445  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:51,446  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, getTableColumnStatistics_(String, String, List, String)=26, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTable_(GetTableRequest)=7}
2024-04-23T21:07:51,446  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5); Time taken: 0.125 seconds
2024-04-23T21:07:51,446  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5
2024-04-23T21:07:51,446  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5
2024-04-23T21:07:51,467  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:07:51,467  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:51,468  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5): select a,b from acidTbl order by a,b
2024-04-23T21:07:51,469  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5
2024-04-23T21:07:51,469  INFO [main] ql.Driver: Query ID = alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5
Total jobs = 1
2024-04-23T21:07:51,469  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:51,469  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:51,624  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:07:51,624  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:51,624  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:51,624  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:51,624  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:51,624  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:51,624  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:51,624  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:51,626  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:51,627  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T21:07:51,627  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:51,636  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:51,638  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:51,643  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:51,644  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:51,645  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:51,650  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:51,658  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:51,663  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:51,664  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:07:51,664  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:07:51,664  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:51,664  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:07:51,664  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:2:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:07:51,664  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:07:51,688  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/4
2024-04-23T21:07:51,688  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 4). duration: 24 ms
2024-04-23T21:07:51,688  INFO [main] io.HiveInputFormat: number of splits 4
2024-04-23T21:07:51,706  INFO [main] mapreduce.JobSubmitter: number of splits:4
2024-04-23T21:07:51,725  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2054520800_0047
2024-04-23T21:07:51,725  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:51,789  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:51,789  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:51,789  INFO [Thread-3920] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:51,789  INFO [Thread-3920] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:51,793  INFO [Thread-3920] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:51,793  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2054520800_0047_m_000000_0
2024-04-23T21:07:51,793  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:51,794  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,794  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:51,795  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:51,795  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,796  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 679, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:51,798  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:51,804  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:51,804  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:51,804  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:51,804  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:51,804  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:51,804  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:51,805  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:51,805  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:51,806  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:51,806  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:51,806  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:51,806  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:51,807  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:51,807  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:51,807  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:51,807  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:51,807  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:51,807  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:51,808  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:51,819  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:51,823  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2054520800_0047_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:51,824  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,824  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2054520800_0047_m_000000_0' done.
2024-04-23T21:07:51,824  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2054520800_0047_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1078856
		FILE: Number of bytes written=58976657
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8893
2024-04-23T21:07:51,824  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2054520800_0047_m_000000_0
2024-04-23T21:07:51,824  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2054520800_0047_m_000001_0
2024-04-23T21:07:51,825  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:51,825  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,826  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:51,827  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:51,827  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,828  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:51,829  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:51,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:51,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:51,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:51,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:51,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:51,836  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:51,837  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:51,837  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:51,838  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:51,838  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:51,838  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:51,838  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:51,839  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:07:51,840  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:51,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:51,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:51,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:51,840  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:51,848  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:51,852  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2054520800_0047_m_000001_0 is done. And is in the process of committing
2024-04-23T21:07:51,853  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,853  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2054520800_0047_m_000001_0' done.
2024-04-23T21:07:51,853  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2054520800_0047_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1089736
		FILE: Number of bytes written=58976716
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8869
2024-04-23T21:07:51,853  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2054520800_0047_m_000001_0
2024-04-23T21:07:51,853  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2054520800_0047_m_000002_0
2024-04-23T21:07:51,853  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:51,854  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,855  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:51,855  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:51,856  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,857  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 672, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:51,858  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:51,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:51,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:51,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:51,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:51,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:51,865  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:51,865  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:51,866  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:51,867  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:51,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:51,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:51,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:51,868  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_6:1, 
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:51,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:51,878  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:51,881  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2054520800_0047_m_000002_0 is done. And is in the process of committing
2024-04-23T21:07:51,882  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,882  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2054520800_0047_m_000002_0' done.
2024-04-23T21:07:51,882  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2054520800_0047_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1100100
		FILE: Number of bytes written=58976775
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8865
2024-04-23T21:07:51,882  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2054520800_0047_m_000002_0
2024-04-23T21:07:51,882  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2054520800_0047_m_000003_0
2024-04-23T21:07:51,883  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:51,884  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,884  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:51,897  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,04KB
2024-04-23T21:07:51,898  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,899  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:07:51,900  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:07:51,904  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:51,905  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:51,905  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:51,905  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:51,905  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:51,905  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:51,905  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:51,906  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:51,906  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:51,906  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:07:51,906  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:07:51,906  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:07:51,907  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_6:1, 
2024-04-23T21:07:51,908  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:51,908  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:07:51,908  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:07:51,908  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:07:51,908  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:07:51,916  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:07:51,919  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2054520800_0047_m_000003_0 is done. And is in the process of committing
2024-04-23T21:07:51,920  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:51,920  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2054520800_0047_m_000003_0' done.
2024-04-23T21:07:51,920  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2054520800_0047_m_000003_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1109948
		FILE: Number of bytes written=58976834
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=13
		Total committed heap usage (bytes)=1345847296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8861
2024-04-23T21:07:51,920  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2054520800_0047_m_000003_0
2024-04-23T21:07:51,920  INFO [Thread-3920] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:51,921  INFO [Thread-3920] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:07:51,921  INFO [pool-228-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2054520800_0047_r_000000_0
2024-04-23T21:07:51,922  INFO [pool-228-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:51,922  INFO [pool-228-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5face381
2024-04-23T21:07:51,922  WARN [pool-228-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:51,923  INFO [pool-228-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:07:51,924  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2054520800_0047_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:07:51,926  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local2054520800_0047_m_000002_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:51,926  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local2054520800_0047_m_000002_0
2024-04-23T21:07:51,927  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T21:07:51,929  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local2054520800_0047_m_000003_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:51,929  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local2054520800_0047_m_000003_0
2024-04-23T21:07:51,929  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T21:07:51,931  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local2054520800_0047_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:51,931  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local2054520800_0047_m_000000_0
2024-04-23T21:07:51,932  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 3, commitMemory -> 46, usedMemory ->69
2024-04-23T21:07:51,934  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local2054520800_0047_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:07:51,934  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local2054520800_0047_m_000001_0
2024-04-23T21:07:51,934  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 4, commitMemory -> 69, usedMemory ->92
2024-04-23T21:07:51,934  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:07:51,934  INFO [pool-228-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T21:07:51,934  INFO [pool-228-thread-1] reduce.MergeManagerImpl: finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:07:51,941  INFO [pool-228-thread-1] mapred.Merger: Merging 4 sorted segments
2024-04-23T21:07:51,941  INFO [pool-228-thread-1] mapred.Merger: Down to the last merge-pass, with 4 segments left of total size: 24 bytes
2024-04-23T21:07:51,943  INFO [pool-228-thread-1] reduce.MergeManagerImpl: Merged 4 segments, 92 bytes to disk to satisfy reduce memory limit
2024-04-23T21:07:51,943  INFO [pool-228-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-23T21:07:51,943  INFO [pool-228-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:07:51,943  INFO [pool-228-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:07:51,943  INFO [pool-228-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-23T21:07:51,944  INFO [pool-228-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T21:07:51,944  INFO [pool-228-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:07:51,944  INFO [pool-228-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,01KB
2024-04-23T21:07:51,945  INFO [pool-228-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:07:51,945  INFO [pool-228-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:51,945  INFO [pool-228-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T21:07:51,946  INFO [pool-228-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:07:51,946  INFO [pool-228-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@2a57348d, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@6ef4cbac, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@4beaf7ce
2024-04-23T21:07:51,946  INFO [pool-228-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-51_319_8262872747998787052-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-51_319_8262872747998787052-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:51,946  INFO [pool-228-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-51_319_8262872747998787052-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-51_319_8262872747998787052-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:07:51,946  INFO [pool-228-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-51_319_8262872747998787052-1/-mr-10001/.hive-staging_hive_2024-04-23_21-07-51_319_8262872747998787052-1/_tmp.-ext-10002/000000_0
2024-04-23T21:07:51,953  INFO [pool-228-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:51,954  INFO [pool-228-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:51,954  INFO [pool-228-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:51,954  INFO [pool-228-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:07:51,954  INFO [pool-228-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T21:07:51,954  INFO [pool-228-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:51,955  INFO [pool-228-thread-1] mapred.Task: Task:attempt_local2054520800_0047_r_000000_0 is done. And is in the process of committing
2024-04-23T21:07:51,955  INFO [pool-228-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:07:51,955  INFO [pool-228-thread-1] mapred.Task: Task 'attempt_local2054520800_0047_r_000000_0' done.
2024-04-23T21:07:51,955  INFO [pool-228-thread-1] mapred.Task: Final Counters for attempt_local2054520800_0047_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1117352
		FILE: Number of bytes written=58977087
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=108
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =4
		Failed Shuffles=0
		Merged Map outputs=4
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1345847296
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:51,955  INFO [pool-228-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2054520800_0047_r_000000_0
2024-04-23T21:07:51,955  INFO [Thread-3920] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23T21:07:52,569  INFO [Heartbeater-2] lockmgr.DbTxnManager: Sending heartbeat for txnid:15 and lockid:0 queryId=null txnid:0
2024-04-23T21:07:52,571  INFO [Heartbeater-2] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T21:07:52,572  INFO [Heartbeater-2] metastore.HMSHandler: 6: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:07:52,572  INFO [Heartbeater-2] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T21:07:52,573  INFO [Heartbeater-2] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@712a156c, with PersistenceManager: null will be shutdown
2024-04-23T21:07:52,573  INFO [Heartbeater-2] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@712a156c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@46a2c6cb created in the thread with id: 53
2024-04-23T21:07:52,593  INFO [Heartbeater-2] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@712a156c from thread id: 53
2024-04-23T21:07:52,593  INFO [Heartbeater-2] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T21:07:52,594  INFO [Heartbeater-2] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23 21:07:52,792 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:07:52,793  INFO [main] exec.Task: 2024-04-23 21:07:52,792 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2054520800_0047
2024-04-23T21:07:52,794  INFO [main] exec.Task: Ended Job = job_local2054520800_0047
2024-04-23T21:07:52,796  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:52,796  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:07:52,796  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:52,796  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:52,796  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:52,796  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210751_5689146b-7654-4c5e-8f38-681f5e95cef5); Time taken: 1.328 seconds
2024-04-23T21:07:52,800  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:07:52,800  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:07:52,800  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:4, 
2024-04-23T21:07:52,801  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = 1 where b != 1
2024-04-23T21:07:52,801  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-51_319_8262872747998787052-1
2024-04-23T21:07:52,802  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-51_319_8262872747998787052-1 on fs with scheme file
2024-04-23T21:07:52,802  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02): update acidTbl set b = 1 where b != 1
2024-04-23T21:07:52,802  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:07:52,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:52,814  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:52,814  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = 1 where b != 1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:07:52,815  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:07:52,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:52,827  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:52,827  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:52,827  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:52,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:52,834  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:52,834  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:52,834  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:52,834  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:52,841  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:52,841  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:52,841  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:52,853  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:52,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:52,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:07:52,883  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:07:52,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:52,893  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:52,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:52,902  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:52,902  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:07:52,910  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:52,910  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:07:52,968  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:52,968  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:52,968  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:52,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:52,974  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:52,981  INFO [main] parse.UpdateDeleteSemanticAnalyzer: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:52,985  INFO [main] optimizer.ColumnPrunerProcFactory: RS 5 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2]}
2024-04-23T21:07:52,986  INFO [main] optimizer.ColumnPrunerProcFactory: RS 5 newColExprMap: {VALUE._col1=Column[_col2], VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:52,986  INFO [main] optimizer.ColumnPrunerProcFactory: RS 3 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:07:52,986  INFO [main] optimizer.ColumnPrunerProcFactory: RS 3 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:52,987  INFO [main] optimizer.ColumnPrunerProcFactory: RS 3 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:52,987  INFO [main] optimizer.ColumnPrunerProcFactory: RS 3 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:07:52,995  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:53,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:07:53,010  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:53,010  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:53,011  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:53,011  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:07:53,021  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:07:53,021  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed plan generation
2024-04-23T21:07:53,021  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
2024-04-23T21:07:53,021  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:53,022  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:_c2, type:int, comment:null)], properties:null)
2024-04-23T21:07:53,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:53,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=26, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=4, getCheckConstraints_(CheckConstraintsRequest)=2, getValidWriteIds_(List, String)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, flushCache_()=0, getTable_(GetTableRequest)=49}
2024-04-23T21:07:53,022  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02); Time taken: 0.22 seconds
2024-04-23T21:07:53,022  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02
2024-04-23T21:07:53,022  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02
2024-04-23T21:07:53,036  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:07:53,036  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:53,041  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02): update acidTbl set b = 1 where b != 1
2024-04-23T21:07:53,041  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02
2024-04-23T21:07:53,041  INFO [main] ql.Driver: Query ID = alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02
Total jobs = 1
2024-04-23T21:07:53,041  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:53,041  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:53,171  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:07:53,171  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:07:53,171  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:07:53,171  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:07:53,171  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:07:53,171  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:07:53,172  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:07:53,172  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:07:53,176  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:53,176  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T21:07:53,176  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:53,185  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:53,190  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,26KB
2024-04-23T21:07:53,195  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:07:53,198  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,97KB
2024-04-23T21:07:53,199  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:53,203  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-52_814_6009481811137880233-1/-mr-10000
2024-04-23T21:07:53,205  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:53,211  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:53,216  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:53,220  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:07:53,220  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:07:53,220  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:53,221  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:07:53,222  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: (not leaf-(EQUALS b 1)) minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:2:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:07:53,223  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: (not leaf-(EQUALS b 1))
2024-04-23T21:07:53,245  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/4
2024-04-23T21:07:53,245  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 4). duration: 24 ms
2024-04-23T21:07:53,245  INFO [main] io.HiveInputFormat: number of splits 4
2024-04-23T21:07:53,263  INFO [main] mapreduce.JobSubmitter: number of splits:4
2024-04-23T21:07:53,284  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local61876514_0048
2024-04-23T21:07:53,284  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:53,346  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:53,346  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:53,347  INFO [Thread-3987] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:53,347  INFO [Thread-3987] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:53,350  INFO [Thread-3987] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:53,350  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local61876514_0048_m_000000_0
2024-04-23T21:07:53,350  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:53,351  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,351  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:53,353  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,26KB
2024-04-23T21:07:53,354  INFO [LocalJobRunner Map Task Executor #0] orc.OrcInputFormat: ORC pushdown predicate: (not leaf-(EQUALS b 1))
2024-04-23T21:07:53,354  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,355  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 679, sarg: (not leaf-(EQUALS b 1)), schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:07:53,361  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:53,365  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:53,365  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:53,365  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:53,365  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:53,365  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:53,365  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:53,366  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:53,366  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:53,367  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:53,367  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Initializing Operator: FIL[9]
2024-04-23T21:07:53,367  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[10]
2024-04-23T21:07:53,367  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[11]
2024-04-23T21:07:53,367  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:53,368  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:53,369 ERROR [LocalJobRunner Map Task Executor #0] mr.ExecMapper: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row 
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:993)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307)
	at org.apache.hadoop.hive.ql.exec.vector.VectorReduceSinkOperator.process(VectorReduceSinkOperator.java:115)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorSelectOperator.process(VectorSelectOperator.java:158)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorFilterOperator.process(VectorFilterOperator.java:136)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:171)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.deliverVectorizedRowBatch(VectorMapOperator.java:809)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:878)
	... 11 more

2024-04-23T21:07:53,369  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Closing Operator: FIL[9]
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FIL_9:1, 
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[10]
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_10:1, 
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[11]
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[11]: Total records written - 0. abort - true
2024-04-23T21:07:53,370  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_11:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,371  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local61876514_0048_m_000001_0
2024-04-23T21:07:53,371  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:53,371  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,372  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:53,372  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,26KB
2024-04-23T21:07:53,373  INFO [LocalJobRunner Map Task Executor #0] orc.OrcInputFormat: ORC pushdown predicate: (not leaf-(EQUALS b 1))
2024-04-23T21:07:53,373  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,374  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, sarg: (not leaf-(EQUALS b 1)), schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:07:53,375  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:53,380  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:53,380  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:53,380  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:53,380  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:53,380  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:53,380  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:53,381  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:53,381  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:53,382  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:53,382  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Initializing Operator: FIL[9]
2024-04-23T21:07:53,382  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[10]
2024-04-23T21:07:53,382  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[11]
2024-04-23T21:07:53,382  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:53,383  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:53,384 ERROR [LocalJobRunner Map Task Executor #0] mr.ExecMapper: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row 
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:993)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307)
	at org.apache.hadoop.hive.ql.exec.vector.VectorReduceSinkOperator.process(VectorReduceSinkOperator.java:115)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorSelectOperator.process(VectorSelectOperator.java:158)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorFilterOperator.process(VectorFilterOperator.java:136)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:171)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.deliverVectorizedRowBatch(VectorMapOperator.java:809)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:878)
	... 11 more

2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Closing Operator: FIL[9]
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FIL_9:1, 
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[10]
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_10:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[11]
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[11]: Total records written - 0. abort - true
2024-04-23T21:07:53,384  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_11:0, 
2024-04-23T21:07:53,385  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local61876514_0048_m_000002_0
2024-04-23T21:07:53,385  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:53,386  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,386  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:53,387  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,26KB
2024-04-23T21:07:53,387  INFO [LocalJobRunner Map Task Executor #0] orc.OrcInputFormat: ORC pushdown predicate: (not leaf-(EQUALS b 1))
2024-04-23T21:07:53,387  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,388  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 672, sarg: (not leaf-(EQUALS b 1)), schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:07:53,390  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:53,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:53,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:53,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:53,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:53,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:53,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:53,397  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:53,398  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:53,398  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:53,399  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Initializing Operator: FIL[9]
2024-04-23T21:07:53,399  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[10]
2024-04-23T21:07:53,399  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[11]
2024-04-23T21:07:53,399  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:53,400  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:53,400 ERROR [LocalJobRunner Map Task Executor #0] mr.ExecMapper: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row 
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:993)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307)
	at org.apache.hadoop.hive.ql.exec.vector.VectorReduceSinkOperator.process(VectorReduceSinkOperator.java:115)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorSelectOperator.process(VectorSelectOperator.java:158)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorFilterOperator.process(VectorFilterOperator.java:136)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:171)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.deliverVectorizedRowBatch(VectorMapOperator.java:809)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:878)
	... 11 more

2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Closing Operator: FIL[9]
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: RECORDS_OUT_OPERATOR_FIL_9:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[10]
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_10:1, 
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[11]
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[11]: Total records written - 0. abort - true
2024-04-23T21:07:53,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_11:0, 
2024-04-23T21:07:53,402  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local61876514_0048_m_000003_0
2024-04-23T21:07:53,402  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:53,403  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,403  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:53,404  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,26KB
2024-04-23T21:07:53,404  INFO [LocalJobRunner Map Task Executor #0] orc.OrcInputFormat: ORC pushdown predicate: (not leaf-(EQUALS b 1))
2024-04-23T21:07:53,404  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:2:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:07:53,405  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, sarg: (not leaf-(EQUALS b 1)), schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:07:53,407  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:07:53,721  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:07:53,721  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:07:53,721  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:07:53,721  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:07:53,721  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:07:53,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:07:53,722  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:53,722  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:53,723  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:53,723  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Initializing Operator: FIL[9]
2024-04-23T21:07:53,723  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[10]
2024-04-23T21:07:53,724  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[11]
2024-04-23T21:07:53,724  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:07:53,724  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:07:53,725 ERROR [LocalJobRunner Map Task Executor #0] mr.ExecMapper: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row 
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:993)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148)
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54)
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184)
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073)
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307)
	at org.apache.hadoop.hive.ql.exec.vector.VectorReduceSinkOperator.process(VectorReduceSinkOperator.java:115)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorSelectOperator.process(VectorSelectOperator.java:158)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.vector.VectorFilterOperator.process(VectorFilterOperator.java:136)
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919)
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:171)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.deliverVectorizedRowBatch(VectorMapOperator.java:809)
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:878)
	... 11 more

2024-04-23T21:07:53,725  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:53,725  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,725  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: Closing Operator: FIL[9]
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorFilterOperator: RECORDS_OUT_OPERATOR_FIL_9:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[10]
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_10:1, 
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[11]
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[11]: Total records written - 0. abort - true
2024-04-23T21:07:53,726  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_11:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:53,727  INFO [Thread-3987] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:07:53,727  WARN [Thread-3987] mapred.LocalJobRunner: job_local61876514_0048
java.lang.Exception: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row 
	at org.apache.hadoop.mapred.LocalJobRunner$Job.runTasks(LocalJobRunner.java:492) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:552) [hadoop-mapreduce-client-common-3.1.0.jar:?]
Caused by: java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row 
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:157) ~[classes/:?]
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37) ~[classes/:?]
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: Hive Runtime Error while processing row 
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:993) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148) ~[classes/:?]
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37) ~[classes/:?]
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
Caused by: org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:184) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1073) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.process(ReduceSinkOperator.java:307) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.vector.VectorReduceSinkOperator.process(VectorReduceSinkOperator.java:115) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.vector.VectorSelectOperator.process(VectorSelectOperator.java:158) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.vector.VectorFilterOperator.process(VectorFilterOperator.java:136) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Operator.vectorForward(Operator.java:919) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:171) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.deliverVectorizedRowBatch(VectorMapOperator.java:809) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.vector.VectorMapOperator.process(VectorMapOperator.java:878) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapper.map(ExecMapper.java:148) ~[classes/:?]
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:54) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37) ~[classes/:?]
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349) ~[hadoop-mapreduce-client-core-3.1.0.jar:?]
	at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:271) ~[hadoop-mapreduce-client-common-3.1.0.jar:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_402]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) ~[?:1.8.0_402]
2024-04-23T21:07:54,356  WARN [main] mapreduce.Counters: Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
2024-04-23 21:07:54,348 Stage-1 map = 0%,  reduce = 0%
2024-04-23T21:07:54,356  INFO [main] exec.Task: 2024-04-23 21:07:54,348 Stage-1 map = 0%,  reduce = 0%
2024-04-23T21:07:54,356  WARN [main] mapreduce.Counters: Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
Ended Job = job_local61876514_0048 with errors
2024-04-23T21:07:54,356 ERROR [main] exec.Task: Ended Job = job_local61876514_0048 with errors
Error during job, obtaining debugging information...
2024-04-23T21:07:54,358 ERROR [Thread-3995] exec.Task: Error during job, obtaining debugging information...
2024-04-23T21:07:54,360  INFO [main] FileOperations: Deleting file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0001 on failure
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
2024-04-23T21:07:54,360 ERROR [main] ql.Driver: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
2024-04-23T21:07:54,360  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,360  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:07:54,361  INFO [main] ql.Driver: MapReduce Jobs Launched: 
2024-04-23T21:07:54,361  WARN [main] mapreduce.Counters: Group FileSystemCounters is deprecated. Use org.apache.hadoop.mapreduce.FileSystemCounter instead
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 FAIL
2024-04-23T21:07:54,361  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:54,361  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:54,361  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02); Time taken: 1.319 seconds
2024-04-23T21:07:54,361  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210752_e65217a7-e1d5-44c8-a0d5-b725f6ea0c02
2024-04-23T21:07:54,364  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,370  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:54,370  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-52_814_6009481811137880233-1
2024-04-23T21:07:54,370  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-52_814_6009481811137880233-1 on fs with scheme file
2024-04-23T21:07:54,370  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-52_802_259951808830674482-1
2024-04-23T21:07:54,371  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8543c13c-88f7-4996-a15c-3e79ce2f939e/hive_2024-04-23_21-07-52_802_259951808830674482-1 on fs with scheme file
2024-04-23T21:07:54,371  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e): drop table if exists acidTbl
2024-04-23T21:07:54,373  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T21:07:54,374  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:07:54,374  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:54,381  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,381  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,381  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,381  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,381  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=9, flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:07:54,382  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e); Time taken: 0.01 seconds
2024-04-23T21:07:54,382  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e
2024-04-23T21:07:54,382  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e
2024-04-23T21:07:54,395  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:07:54,395  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:54,395  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e): drop table if exists acidTbl
2024-04-23T21:07:54,395  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:54,401  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:54,407  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,408  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:54,491  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,491  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=90, getTable_(GetTableRequest)=6}
2024-04-23T21:07:54,491  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e); Time taken: 0.096 seconds
2024-04-23T21:07:54,491  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_ca1ec358-2dc9-46a9-9ba5-da6f6d23e96e
2024-04-23T21:07:54,494  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:07:54,498  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,499  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:07:54,500  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:54,500  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b): drop table if exists acidTblPart
2024-04-23T21:07:54,506  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T21:07:54,506  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:07:54,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:54,514  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,514  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,514  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,514  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=6, flushCache_()=0, openTxn_(String, TxnType)=6, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:54,515  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b); Time taken: 0.014 seconds
2024-04-23T21:07:54,515  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b
2024-04-23T21:07:54,516  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b
2024-04-23T21:07:54,529  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:07:54,529  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:54,529  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b): drop table if exists acidTblPart
2024-04-23T21:07:54,529  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:54,535  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,536  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:54,541  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,541  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:54,575  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,575  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:07:54,575  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b); Time taken: 0.046 seconds
2024-04-23T21:07:54,575  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_7f78898b-fda9-4209-a99a-aaa3799d425b
2024-04-23T21:07:54,578  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:07:54,582  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,582  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:07:54,583  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:54,583  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_d0330a9f-ec84-48cd-a7a1-06a66926bfd3): drop table if exists acidTbl2
2024-04-23T21:07:54,585  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T21:07:54,585  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:07:54,586  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,586  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,586  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,586  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, openTxn_(String, TxnType)=1, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:54,587  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_d0330a9f-ec84-48cd-a7a1-06a66926bfd3); Time taken: 0.003 seconds
2024-04-23T21:07:54,587  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210754_d0330a9f-ec84-48cd-a7a1-06a66926bfd3
2024-04-23T21:07:54,587  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:54,587  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_d0330a9f-ec84-48cd-a7a1-06a66926bfd3): drop table if exists acidTbl2
2024-04-23T21:07:54,587  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,587  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:07:54,588  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,588  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1}
2024-04-23T21:07:54,588  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_d0330a9f-ec84-48cd-a7a1-06a66926bfd3); Time taken: 0.001 seconds
2024-04-23T21:07:54,588  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_d0330a9f-ec84-48cd-a7a1-06a66926bfd3
2024-04-23T21:07:54,592  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:07:54,596  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,596  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:07:54,596  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:54,597  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:54,598  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T21:07:54,599  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:07:54,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:54,615  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,615  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,615  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,615  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,615  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=8, getTable_(GetTableRequest)=16, openTxn_(String, TxnType)=2}
2024-04-23T21:07:54,616  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0); Time taken: 0.018 seconds
2024-04-23T21:07:54,616  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0
2024-04-23T21:07:54,616  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0
2024-04-23T21:07:54,627  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:07:54,627  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:54,627  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:54,627  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,628  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:54,635  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,636  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:54,643  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:54,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,674  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=39}
2024-04-23T21:07:54,675  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0); Time taken: 0.047 seconds
2024-04-23T21:07:54,675  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_f1a4295c-1ee0-4a15-b35d-45e93c6c16a0
2024-04-23T21:07:54,678  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:07:54,682  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,682  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:07:54,682  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:54,683  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:54,684  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T21:07:54,685  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:07:54,685  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:54,692  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,693  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,693  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,693  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,693  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=7, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:07:54,693  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6); Time taken: 0.011 seconds
2024-04-23T21:07:54,693  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6
2024-04-23T21:07:54,694  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6
2024-04-23T21:07:54,705  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:07:54,705  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:54,705  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:54,706  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:54,714  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:54,721  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,721  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:54,750  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,751  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=36, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T21:07:54,751  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6); Time taken: 0.045 seconds
2024-04-23T21:07:54,751  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_12f8019e-4548-4a77-91d8-a543e5dea2b6
2024-04-23T21:07:54,756  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:07:54,763  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,763  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:07:54,764  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:54,765  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f): drop table if exists nonAcidNonBucket
2024-04-23T21:07:54,767  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:07:54,768  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:07:54,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:54,781  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,781  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,781  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,781  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,781  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, getTable_(GetTableRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:07:54,782  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f); Time taken: 0.017 seconds
2024-04-23T21:07:54,782  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f
2024-04-23T21:07:54,783  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f
2024-04-23T21:07:54,801  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:07:54,801  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:54,801  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f): drop table if exists nonAcidNonBucket
2024-04-23T21:07:54,801  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,801  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:54,814  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:54,827  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:54,827  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:54,870  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,870  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=56, getTable_(GetTableRequest)=13}
2024-04-23T21:07:54,871  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f); Time taken: 0.069 seconds
2024-04-23T21:07:54,871  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_655b817a-4cb2-49cc-a568-b188eb53127f
2024-04-23T21:07:54,874  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:07:54,879  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,879  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:07:54,880  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testVersioningVersionFileEnabled" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="3.016">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update T set a=3 where b=2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:07:54,941  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:07:54,943  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = e4aabc01-c668-4f75-ab5e-3ef87e812981
2024-04-23T21:07:54,945  INFO [main] SessionState: Hive Session ID = e4aabc01-c668-4f75-ab5e-3ef87e812981
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:54,946  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:07:54,951  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/e4aabc01-c668-4f75-ab5e-3ef87e812981
2024-04-23T21:07:54,954  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981
2024-04-23T21:07:54,956  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/e4aabc01-c668-4f75-ab5e-3ef87e812981/_tmp_space.db
2024-04-23T21:07:54,956  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=e4aabc01-c668-4f75-ab5e-3ef87e812981, clientType=HIVECLI]
2024-04-23T21:07:54,956  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:54,957  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_eee46041-6825-4736-b767-d2bb070a748d): drop table if exists acidTbl
2024-04-23T21:07:54,964  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:07:54,965  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:07:54,966  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:54,971  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,971  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,971  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,971  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1, openTxn_(String, TxnType)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:54,971  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_eee46041-6825-4736-b767-d2bb070a748d); Time taken: 0.014 seconds
2024-04-23T21:07:54,971  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210754_eee46041-6825-4736-b767-d2bb070a748d
2024-04-23T21:07:54,971  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:54,971  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_eee46041-6825-4736-b767-d2bb070a748d): drop table if exists acidTbl
2024-04-23T21:07:54,972  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:54,974  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,974  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:54,975  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_eee46041-6825-4736-b767-d2bb070a748d); Time taken: 0.003 seconds
2024-04-23T21:07:54,975  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_eee46041-6825-4736-b767-d2bb070a748d
2024-04-23T21:07:54,979  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:07:54,984  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:54,984  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:07:54,984  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:54,984  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210754_48713a72-150a-46fa-aff3-b64ee527ee66): drop table if exists acidTblPart
2024-04-23T21:07:54,987  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:07:54,987  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:07:54,988  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:54,990  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:54,990  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:54,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:54,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:07:54,991  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210754_48713a72-150a-46fa-aff3-b64ee527ee66); Time taken: 0.006 seconds
2024-04-23T21:07:54,991  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210754_48713a72-150a-46fa-aff3-b64ee527ee66
2024-04-23T21:07:54,991  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:54,991  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210754_48713a72-150a-46fa-aff3-b64ee527ee66): drop table if exists acidTblPart
2024-04-23T21:07:54,991  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:54,991  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:54,994  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:54,994  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:54,994  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210754_48713a72-150a-46fa-aff3-b64ee527ee66); Time taken: 0.003 seconds
2024-04-23T21:07:54,994  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210754_48713a72-150a-46fa-aff3-b64ee527ee66
2024-04-23T21:07:54,998  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:07:55,002  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,002  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:07:55,003  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:55,003  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_8e31dd96-5697-4ff4-80db-e3a697efdaca): drop table if exists acidTbl2
2024-04-23T21:07:55,005  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:07:55,005  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:07:55,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:55,008  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,008  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,008  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,008  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T21:07:55,008  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_8e31dd96-5697-4ff4-80db-e3a697efdaca); Time taken: 0.005 seconds
2024-04-23T21:07:55,009  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210755_8e31dd96-5697-4ff4-80db-e3a697efdaca
2024-04-23T21:07:55,009  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:55,009  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_8e31dd96-5697-4ff4-80db-e3a697efdaca): drop table if exists acidTbl2
2024-04-23T21:07:55,009  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,009  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:07:55,012  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,012  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,012  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_8e31dd96-5697-4ff4-80db-e3a697efdaca); Time taken: 0.003 seconds
2024-04-23T21:07:55,012  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_8e31dd96-5697-4ff4-80db-e3a697efdaca
2024-04-23T21:07:55,016  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:07:55,020  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,020  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:07:55,021  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:55,021  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_50494da9-71b9-4f24-afc3-9215e256d2b8): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:55,022  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:07:55,023  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:07:55,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:55,026  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,026  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,026  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,026  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=8, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,026  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_50494da9-71b9-4f24-afc3-9215e256d2b8); Time taken: 0.005 seconds
2024-04-23T21:07:55,026  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210755_50494da9-71b9-4f24-afc3-9215e256d2b8
2024-04-23T21:07:55,026  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:55,026  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_50494da9-71b9-4f24-afc3-9215e256d2b8): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:55,026  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,027  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:55,029  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,029  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:55,029  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_50494da9-71b9-4f24-afc3-9215e256d2b8); Time taken: 0.003 seconds
2024-04-23T21:07:55,029  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_50494da9-71b9-4f24-afc3-9215e256d2b8
2024-04-23T21:07:55,033  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:07:55,037  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,037  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:07:55,038  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:55,038  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_352dc28e-72a6-4436-b9a7-d6b5a1f5b093): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:55,040  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:07:55,040  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:07:55,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:55,043  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,043  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,043  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,043  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,043  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_352dc28e-72a6-4436-b9a7-d6b5a1f5b093); Time taken: 0.005 seconds
2024-04-23T21:07:55,044  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210755_352dc28e-72a6-4436-b9a7-d6b5a1f5b093
2024-04-23T21:07:55,044  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:55,044  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_352dc28e-72a6-4436-b9a7-d6b5a1f5b093): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:55,044  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:55,047  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,047  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,047  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_352dc28e-72a6-4436-b9a7-d6b5a1f5b093); Time taken: 0.003 seconds
2024-04-23T21:07:55,047  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_352dc28e-72a6-4436-b9a7-d6b5a1f5b093
2024-04-23T21:07:55,051  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:07:55,055  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,055  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:07:55,055  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:55,056  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_8013ffcc-fdea-40b4-8d08-527eb2c807b9): drop table if exists nonAcidNonBucket
2024-04-23T21:07:55,057  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:07:55,057  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:07:55,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:55,061  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,061  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,061  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,061  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=8, flushCache_()=0}
2024-04-23T21:07:55,061  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_8013ffcc-fdea-40b4-8d08-527eb2c807b9); Time taken: 0.005 seconds
2024-04-23T21:07:55,061  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210755_8013ffcc-fdea-40b4-8d08-527eb2c807b9
2024-04-23T21:07:55,061  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:55,061  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_8013ffcc-fdea-40b4-8d08-527eb2c807b9): drop table if exists nonAcidNonBucket
2024-04-23T21:07:55,061  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,062  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:55,064  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,065  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_8013ffcc-fdea-40b4-8d08-527eb2c807b9); Time taken: 0.003 seconds
2024-04-23T21:07:55,065  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_8013ffcc-fdea-40b4-8d08-527eb2c807b9
2024-04-23T21:07:55,069  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:07:55,073  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,073  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:07:55,073  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,074  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,076  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:07:55,076  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:07:55,077  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,077  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,081  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:07:55,082  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:55,083  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,083  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,083  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,084  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,084  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, getValidTxns_(long)=1, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=8, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:55,084  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5); Time taken: 0.01 seconds
2024-04-23T21:07:55,084  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5
2024-04-23T21:07:55,085  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5
2024-04-23T21:07:55,101  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:07:55,101  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:55,102  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,103  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931675, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, rawDataSize=0, totalSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:55,110  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:07:55,137  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,138  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=33}
2024-04-23T21:07:55,138  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5); Time taken: 0.035 seconds
2024-04-23T21:07:55,138  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_70b6e1d4-0bbe-4ba1-af2e-fe8d7647edb5
2024-04-23T21:07:55,141  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:07:55,145  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,145  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:07:55,146  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,146  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,148  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:07:55,149  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:07:55,149  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,149  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,151  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:07:55,152  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:55,153  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,153  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,153  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,154  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,154  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=0}
2024-04-23T21:07:55,154  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42); Time taken: 0.008 seconds
2024-04-23T21:07:55,154  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42
2024-04-23T21:07:55,154  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42
2024-04-23T21:07:55,167  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:07:55,167  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:55,168  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,168  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931675, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:55,174  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:07:55,192  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,192  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T21:07:55,192  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42); Time taken: 0.024 seconds
2024-04-23T21:07:55,192  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_be590111-10b1-4ce0-b6dc-af858f39ea42
2024-04-23T21:07:55,196  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:07:55,200  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,200  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:07:55,201  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,201  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,203  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:07:55,203  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:07:55,204  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,204  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,206  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:07:55,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:55,208  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,209  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=8, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0}
2024-04-23T21:07:55,209  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24); Time taken: 0.008 seconds
2024-04-23T21:07:55,209  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24
2024-04-23T21:07:55,210  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24
2024-04-23T21:07:55,221  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:07:55,221  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:55,221  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,222  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931675, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, transactional=false, numFiles=0, numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:55,227  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:07:55,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,241  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24); Time taken: 0.02 seconds
2024-04-23T21:07:55,242  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_2857a090-b6a5-4c3d-aa88-50e825de3e24
2024-04-23T21:07:55,245  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:07:55,249  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,249  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:07:55,250  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,250  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,253  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:07:55,253  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:07:55,254  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,254  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,256  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:07:55,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:55,258  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,258  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,259  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=7, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=2}
2024-04-23T21:07:55,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67); Time taken: 0.009 seconds
2024-04-23T21:07:55,259  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67
2024-04-23T21:07:55,260  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67
2024-04-23T21:07:55,273  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:07:55,273  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:55,273  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,273  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931675, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:55,279  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:07:55,293  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,293  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=1}
2024-04-23T21:07:55,293  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67); Time taken: 0.02 seconds
2024-04-23T21:07:55,293  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_099db6d9-fc5f-4868-85aa-4bab28371b67
2024-04-23T21:07:55,296  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:07:55,301  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,301  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:07:55,301  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,302  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,304  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:07:55,305  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:07:55,305  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,305  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,308  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:07:55,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:55,310  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,310  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,310  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,310  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,310  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=8, flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,310  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac); Time taken: 0.008 seconds
2024-04-23T21:07:55,311  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac
2024-04-23T21:07:55,311  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac
2024-04-23T21:07:55,323  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:07:55,323  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:55,324  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:07:55,324  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,325  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/e4aabc01-c668-4f75-ab5e-3ef87e812981/_tmp_space.db/dedc097f-1b9d-43f3-b7a5-b3c67d4227a3
2024-04-23T21:07:55,328  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,328  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,328  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac); Time taken: 0.004 seconds
2024-04-23T21:07:55,328  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_8a187997-4d9e-49a2-a382-6a31bb215cac
2024-04-23T21:07:55,333  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:07:55,339  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,339  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:07:55,339  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,340  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,342  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:07:55,342  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:07:55,342  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,342  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,345  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:07:55,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:55,347  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,347  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,347  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,347  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,348  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,348  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17); Time taken: 0.007 seconds
2024-04-23T21:07:55,348  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17
2024-04-23T21:07:55,348  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17
2024-04-23T21:07:55,361  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:07:55,361  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:55,361  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:07:55,362  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931675, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=false, bucketing_version=2, totalSize=0, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:07:55,368  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:07:55,382  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,382  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T21:07:55,382  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17); Time taken: 0.021 seconds
2024-04-23T21:07:55,382  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_0e3781e0-277f-4344-af8c-27f8e0146c17
2024-04-23T21:07:55,386  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:07:55,391  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,392  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:07:55,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T21:07:55,392  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3e47662a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@471259c8 will be shutdown
2024-04-23T21:07:55,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T21:07:55,393  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -10
2024-04-23T21:07:55,393  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:07:55,393  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0): drop table if exists T
2024-04-23T21:07:55,394  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T21:07:55,395  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:07:55,395  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T21:07:55,396  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7fa6232a, with PersistenceManager: null will be shutdown
2024-04-23T21:07:55,396  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7fa6232a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5701af88 created in the thread with id: 1
2024-04-23T21:07:55,413  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7fa6232a from thread id: 1
2024-04-23T21:07:55,413  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T21:07:55,413  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T21:07:55,415  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:07:55,415  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:07:55,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:55,434  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:55,434  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,434  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,434  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=18}
2024-04-23T21:07:55,434  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0); Time taken: 0.041 seconds
2024-04-23T21:07:55,435  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0
2024-04-23T21:07:55,435  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0
2024-04-23T21:07:55,451  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:07:55,451  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:55,451  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0): drop table if exists T
2024-04-23T21:07:55,451  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:55,457  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:55,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:55,464  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:55,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T21:07:55,558  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t does not exist; Force to delete it.
2024-04-23T21:07:55,559 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:55,559  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,559  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=102, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:55,559  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0); Time taken: 0.108 seconds
2024-04-23T21:07:55,559  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_f34ead27-9c35-449b-8570-dfa0979563c0
2024-04-23T21:07:55,562  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:07:55,567  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,568  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:07:55,569  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) stored as orc
2024-04-23T21:07:55,569  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4): create table T (a int, b int) stored as orc
2024-04-23T21:07:55,571  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:07:55,571  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:07:55,572  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,572  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,577  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:07:55,577  INFO [main] parse.CalcitePlanner: Automatically chose to make default.T acid.
2024-04-23T21:07:55,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:07:55,578  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,578  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,578  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:55,578  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,579  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:07:55,579  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4); Time taken: 0.009 seconds
2024-04-23T21:07:55,579  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4
2024-04-23T21:07:55,579  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4
2024-04-23T21:07:55,591  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:07:55,591  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:07:55,592  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4): create table T (a int, b int) stored as orc
2024-04-23T21:07:55,592  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:55,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931675, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional_properties=default, transactional=true, rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:07:55,599  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:55,625  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:55,625  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=32}
2024-04-23T21:07:55,625  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4); Time taken: 0.033 seconds
2024-04-23T21:07:55,625  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_120beec4-14a7-42dd-afad-7d100d8fffd4
2024-04-23T21:07:55,628  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:07:55,633  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:55,633  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:07:55,634  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into T values(1,2)
2024-04-23T21:07:55,634  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b): insert into T values(1,2)
2024-04-23T21:07:55,636  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:07:55,636  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:07:55,637  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:07:55,637  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:07:55,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:55,647  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:55,647  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:55,647  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:55,647  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:55,647  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:55,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:55,654  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:55,654  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:55,654  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:55,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:55,747  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:55,747  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:55,747  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:07:55,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:07:55,750  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:07:55,750  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:55,750  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:07:55,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:55,756  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:55,758  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T21:07:55,759  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T21:07:55,765  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 15
2024-04-23T21:07:55,765  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [15])
2024-04-23T21:07:55,765  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:07:55,768  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:07:55,769  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:07:55,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:55,783  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:55,784  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:07:55,784  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:07:55,784  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:07:55,784  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:07:55,784  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:07:55,784  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:07:55,784  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:07:55,785  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:07:55,785  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:07:55,785  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:55,785  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:07:55,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:55,785  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=8, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=27, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=27, allocateTableWriteId_(long, String, String)=5}
2024-04-23T21:07:55,785  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b); Time taken: 0.151 seconds
2024-04-23T21:07:55,786  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b
2024-04-23T21:07:55,786  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b
2024-04-23T21:07:55,801  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:07:55,801  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:07:55,803  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b): insert into T values(1,2)
2024-04-23T21:07:55,804  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b
2024-04-23T21:07:55,804  INFO [main] ql.Driver: Query ID = alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b
Total jobs = 1
2024-04-23T21:07:55,804  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:07:55,804  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:07:55,931  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:07:55,931  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:07:55,933  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:07:55,933  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:07:55,933  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981/hive_2024-04-23_21-07-55_634_1129588457661831219-1/dummy_path
2024-04-23T21:07:55,942  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:07:55,943  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,67KB
2024-04-23T21:07:55,944  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:55,948  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981/hive_2024-04-23_21-07-55_634_1129588457661831219-1/-mr-10000
2024-04-23T21:07:55,950  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:07:55,957  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:07:55,961  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:07:55,962  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:07:55,962  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:07:55,962  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981/hive_2024-04-23_21-07-55_634_1129588457661831219-1/dummy_path
2024-04-23T21:07:55,963  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:07:55,980  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:07:55,999  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1675048039_0049
2024-04-23T21:07:55,999  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:07:56,060  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:07:56,060  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:07:56,061  INFO [Thread-4057] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:56,061  INFO [Thread-4057] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:07:56,062  INFO [Thread-4057] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:07:56,062  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1675048039_0049_m_000000_0
2024-04-23T21:07:56,065  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:07:56,066  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981/hive_2024-04-23_21-07-55_634_1129588457661831219-1/dummy_path/null:0+1
2024-04-23T21:07:56,068  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:07:56,068  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,67KB
2024-04-23T21:07:56,069  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:07:56,070  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:07:56,071  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:07:56,071  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:07:56,071  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:07:56,072  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:07:56,072  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:07:56,072  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:07:56,072  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:07:56,072  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:07:56,072  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1675048039_0049/job_local1675048039_0049.xml], properties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@577e7a1e
2024-04-23T21:07:56,073  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:56,073  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:56,073  INFO [LocalJobRunner Map Task Executor #0] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:07:56,075  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:56,075  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:07:56,082  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:07:56,086  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:07:56,086  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:07:56,086  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:1, 
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:1, 
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:07:56,087  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:07:56,088  INFO [LocalJobRunner Map Task Executor #0] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:07:56,099  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.t:1, RECORDS_OUT_OPERATOR_FS_4:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-23T21:07:56,100  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:07:56,102  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1675048039_0049_m_000000_0 is done. And is in the process of committing
2024-04-23T21:07:56,103  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:07:56,103  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1675048039_0049_m_000000_0' done.
2024-04-23T21:07:56,103  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1675048039_0049_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=1173441
		FILE: Number of bytes written=61478874
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1948778496
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.t=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	File Input Format Counters 
		Bytes Read=5726
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:07:56,103  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1675048039_0049_m_000000_0
2024-04-23T21:07:56,103  INFO [Thread-4057] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:07:57,062 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:07:57,062  INFO [main] exec.Task: 2024-04-23 21:07:57,062 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1675048039_0049
2024-04-23T21:07:57,063  INFO [main] exec.Task: Ended Job = job_local1675048039_0049
2024-04-23T21:07:57,065  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:07:57,065  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:07:57,066  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t/_tmp.delta_0000001_0000001_0000
2024-04-23T21:07:57,067  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.t
2024-04-23T21:07:57,067  INFO [main] exec.Task: Loading data to table default.t from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/t
2024-04-23T21:07:57,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:57,073  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:57,080  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T21:07:57,105  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:07:57,105  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:57,112  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,112  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:07:57,112  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981/hive_2024-04-23_21-07-55_634_1129588457661831219-1/-mr-10000
2024-04-23T21:07:57,113  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:57,120  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,128  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:07:57,129  INFO [main] FileOperations: Read stats for default.t/, numRows, true, 1, false: 
2024-04-23T21:07:57,129  INFO [main] FileOperations: Read stats for default.t/, rawDataSize, true, 0, false: 
2024-04-23T21:07:57,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T21:07:57,152  INFO [main] FileOperations: Read stats for default.t/, insertCount, true, 1, false: 
2024-04-23T21:07:57,152  INFO [main] FileOperations: Read stats for default.t/, updateCount, true, 0, false: 
2024-04-23T21:07:57,152  INFO [main] FileOperations: Read stats for default.t/, deleteCount, true, 0, false: 
2024-04-23T21:07:57,154  INFO [main] stats.BasicStatsTask: Table default.t stats: [numFiles=1, numRows=1, totalSize=666, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:07:57,154  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:57,155  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=48, getTable_(GetTableRequest)=27, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-23T21:07:57,155  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:07:57,155  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:57,155  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:07:57,155  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b); Time taken: 1.351 seconds
2024-04-23T21:07:57,155  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210755_db628e8e-db0d-46fa-9e73-9a1abd63e19b
2024-04-23T21:07:57,165  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,165  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:07:57,166  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update T set a=3 where b=2
2024-04-23T21:07:57,166  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981/hive_2024-04-23_21-07-55_634_1129588457661831219-1
2024-04-23T21:07:57,167  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/e4aabc01-c668-4f75-ab5e-3ef87e812981/hive_2024-04-23_21-07-55_634_1129588457661831219-1 on fs with scheme file
2024-04-23T21:07:57,167  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210757_e256db5d-39ec-4a41-9274-6255f72dff10): update T set a=3 where b=2
2024-04-23T21:07:57,169  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T21:07:57,169  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:07:57,170  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:07:57,170  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:57,176  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,177  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update T set a=3 where b=2> as 
<insert into table `default`.`T` select ROW__ID,`a`,`b` from `default`.`T` sort by ROW__ID >
2024-04-23T21:07:57,177  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:07:57,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:57,187  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,187  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:07:57,187  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:57,187  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:57,194  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,194  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:57,194  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:57,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:57,200  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,201  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:07:57,201  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:07:57,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:07:57,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T21:07:57,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T21:07:57,242  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [1], allowMissingStats: true
2024-04-23T21:07:57,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:57,252  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,252  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:07:57,261  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.t	
2024-04-23T21:07:57,271  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b
No Stats for default@t, Columns: b
2024-04-23T21:07:57,271  INFO [main] SessionState: No Stats for default@t, Columns: b
2024-04-23T21:07:57,328  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:07:57,329  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:07:57,329  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:07:57,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:07:57,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,339 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:07:57,340 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:07:57,340  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:07:57,340 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:07:57,341  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:57,341  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, getNotNullConstraints_(NotNullConstraintsRequest)=1, getTable_(GetTableRequest)=35, getTableColumnStatistics_(String, String, List, String)=29, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getAllTableConstraints_(AllTableConstraintsRequest)=5, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:07:57,341  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210757_e256db5d-39ec-4a41-9274-6255f72dff10); Time taken: 0.174 seconds
2024-04-23T21:07:57,341  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:07:57,344  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,350  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:07:57,351  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2): drop table if exists acidTbl
2024-04-23T21:07:57,353  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T21:07:57,353  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:07:57,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:57,361  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,361  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:57,361  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:57,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:57,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-23T21:07:57,362  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2); Time taken: 0.01 seconds
2024-04-23T21:07:57,362  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2
2024-04-23T21:07:57,362  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2
2024-04-23T21:07:57,377  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:07:57,377  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:57,377  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2): drop table if exists acidTbl
2024-04-23T21:07:57,377  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:57,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:57,386  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,386  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:57,393  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:07:57,489  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:57,490  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=103, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:57,490  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2); Time taken: 0.112 seconds
2024-04-23T21:07:57,490  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210757_e54c5a09-6382-4473-971a-c3247a678ab2
2024-04-23T21:07:57,494  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:07:57,499  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,501  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:07:57,501  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:07:57,501  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82): drop table if exists acidTblPart
2024-04-23T21:07:57,503  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T21:07:57,504  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:07:57,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:57,522  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,522  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:57,522  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:57,522  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:57,522  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getTable_(GetTableRequest)=16, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:07:57,523  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82); Time taken: 0.021 seconds
2024-04-23T21:07:57,523  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82
2024-04-23T21:07:57,524  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82
2024-04-23T21:07:57,541  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:07:57,541  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:57,541  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82): drop table if exists acidTblPart
2024-04-23T21:07:57,541  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:57,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:57,553  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,553  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:57,564  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:07:57,607  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:57,607  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=11, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=54}
2024-04-23T21:07:57,608  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82); Time taken: 0.066 seconds
2024-04-23T21:07:57,608  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210757_4885d51f-aee6-4860-8bc8-4563c0938b82
2024-04-23T21:07:57,611  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:07:57,616  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,616  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:07:57,616  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:07:57,617  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210757_9400ebaa-36a2-40e8-b11d-1d14b2026678): drop table if exists acidTbl2
2024-04-23T21:07:57,619  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T21:07:57,619  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:07:57,620  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:57,620  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:57,620  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:57,620  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=8, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:07:57,620  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210757_9400ebaa-36a2-40e8-b11d-1d14b2026678); Time taken: 0.003 seconds
2024-04-23T21:07:57,620  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210757_9400ebaa-36a2-40e8-b11d-1d14b2026678
2024-04-23T21:07:57,620  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:07:57,621  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210757_9400ebaa-36a2-40e8-b11d-1d14b2026678): drop table if exists acidTbl2
2024-04-23T21:07:57,621  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:57,621  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:07:57,621  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:57,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:57,622  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210757_9400ebaa-36a2-40e8-b11d-1d14b2026678); Time taken: 0.001 seconds
2024-04-23T21:07:57,622  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210757_9400ebaa-36a2-40e8-b11d-1d14b2026678
2024-04-23T21:07:57,626  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:07:57,630  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,631  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:07:57,631  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:07:57,631  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:57,633  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T21:07:57,633  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:07:57,634  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:57,652  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,652  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:57,652  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:57,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:57,653  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=18, commitTxn_(CommitTxnRequest)=9}
2024-04-23T21:07:57,653  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f); Time taken: 0.021 seconds
2024-04-23T21:07:57,653  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f
2024-04-23T21:07:57,653  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f
2024-04-23T21:07:57,667  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:07:57,667  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:57,667  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f): drop table if exists nonAcidOrcTbl
2024-04-23T21:07:57,667  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:57,667  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:57,675  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:57,684  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:07:57,727  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:57,727  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=52}
2024-04-23T21:07:57,728  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f); Time taken: 0.06 seconds
2024-04-23T21:07:57,728  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210757_edd3077e-2ea2-4659-b0ea-acb9a322456f
2024-04-23T21:07:57,731  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:07:57,737  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,737  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:07:57,738  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:57,738  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:57,742  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:07:57,742  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:07:57,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:57,750  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,750  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:57,751  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:57,751  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:57,751  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:57,751  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6); Time taken: 0.013 seconds
2024-04-23T21:07:57,751  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6
2024-04-23T21:07:57,752  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6
2024-04-23T21:07:57,764  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:07:57,764  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:57,764  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6): drop table if exists nonAcidOrcTbl2
2024-04-23T21:07:57,764  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:57,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:57,773  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:57,781  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:07:57,811  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:57,811  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=38, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T21:07:57,811  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6); Time taken: 0.047 seconds
2024-04-23T21:07:57,811  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210757_da9a49db-d557-40dd-9ece-0f60336c49c6
2024-04-23T21:07:57,814  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:07:57,819  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,819  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:07:57,820  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:07:57,820  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6): drop table if exists nonAcidNonBucket
2024-04-23T21:07:57,822  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 16
2024-04-23T21:07:57,823  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:07:57,823  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:57,832  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,832  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:07:57,832  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:07:57,832  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:07:57,832  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=9}
2024-04-23T21:07:57,833  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6); Time taken: 0.012 seconds
2024-04-23T21:07:57,833  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6
2024-04-23T21:07:57,833  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6
2024-04-23T21:07:57,846  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:07:57,846  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:07:57,846  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6): drop table if exists nonAcidNonBucket
2024-04-23T21:07:57,846  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:07:57,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:57,854  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:57,862  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:07:57,862  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:07:57,892  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:07:57,892  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=37}
2024-04-23T21:07:57,892  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6); Time taken: 0.046 seconds
2024-04-23T21:07:57,892  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210757_6a28cfdf-b356-4a43-bbab-d97054cb8ab6
2024-04-23T21:07:57,895  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:07:57,899  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:07:57,900  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:07:57,900  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testReadMyOwnInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="5.545"/>
  <testcase name="testAddAndDropPartitionAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.479"/>
  <testcase name="testImplicitRollback" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="5.586"/>
  <testcase name="testTruncateWithBase" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="2.975"/>
  <testcase name="exchangePartition" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.652"/>
  <testcase name="testTruncateWithBaseOnePartition" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.89"/>
  <testcase name="testParallelInsertAnalyzeStats" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="9.513"/>
  <testcase name="testDDLsAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.472"/>
  <testcase name="testTruncateWithBaseAllPartition" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.883"/>
  <testcase name="testTimeOutReaper" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.476">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where a = 5 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:08:38,950  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:08:38,951  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:08:38,951  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:08:38,951  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:08:38,953  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 0c04be3b-68aa-4fb9-971c-0388a4884e97
2024-04-23T21:08:38,955  INFO [main] SessionState: Hive Session ID = 0c04be3b-68aa-4fb9-971c-0388a4884e97
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:38,956  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:38,961  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0c04be3b-68aa-4fb9-971c-0388a4884e97
2024-04-23T21:08:38,964  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/0c04be3b-68aa-4fb9-971c-0388a4884e97
2024-04-23T21:08:38,966  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0c04be3b-68aa-4fb9-971c-0388a4884e97/_tmp_space.db
2024-04-23T21:08:38,967  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=0c04be3b-68aa-4fb9-971c-0388a4884e97, clientType=HIVECLI]
2024-04-23T21:08:38,967  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:38,967  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210838_ae23da33-965f-4a56-a750-166df766f9c1): drop table if exists acidTbl
2024-04-23T21:08:38,976  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:08:38,977  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:08:38,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:38,983  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:38,983  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:38,983  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:38,984  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=2, openTxn_(String, TxnType)=8, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:38,984  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210838_ae23da33-965f-4a56-a750-166df766f9c1); Time taken: 0.016 seconds
2024-04-23T21:08:38,984  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210838_ae23da33-965f-4a56-a750-166df766f9c1
2024-04-23T21:08:38,984  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:38,984  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210838_ae23da33-965f-4a56-a750-166df766f9c1): drop table if exists acidTbl
2024-04-23T21:08:38,984  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:38,985  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:38,988  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:38,988  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:38,988  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210838_ae23da33-965f-4a56-a750-166df766f9c1); Time taken: 0.004 seconds
2024-04-23T21:08:38,989  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210838_ae23da33-965f-4a56-a750-166df766f9c1
2024-04-23T21:08:38,997  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:08:39,004  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,004  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:08:39,004  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:39,004  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_9c4680ab-79a5-4d77-b134-5024e34646ff): drop table if exists acidTblPart
2024-04-23T21:08:39,007  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:08:39,007  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:08:39,007  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:39,011  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,011  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,011  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,011  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=15, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:39,011  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_9c4680ab-79a5-4d77-b134-5024e34646ff); Time taken: 0.007 seconds
2024-04-23T21:08:39,011  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210839_9c4680ab-79a5-4d77-b134-5024e34646ff
2024-04-23T21:08:39,011  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:39,011  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_9c4680ab-79a5-4d77-b134-5024e34646ff): drop table if exists acidTblPart
2024-04-23T21:08:39,012  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:39,015  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,015  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,015  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_9c4680ab-79a5-4d77-b134-5024e34646ff); Time taken: 0.004 seconds
2024-04-23T21:08:39,015  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_9c4680ab-79a5-4d77-b134-5024e34646ff
2024-04-23T21:08:39,021  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:08:39,026  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,026  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:08:39,027  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:39,027  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_277ed740-ff0f-47c8-b206-9715ef72d868): drop table if exists acidTbl2
2024-04-23T21:08:39,029  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:08:39,029  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:08:39,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:39,032  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,033  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,033  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,033  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T21:08:39,033  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_277ed740-ff0f-47c8-b206-9715ef72d868); Time taken: 0.006 seconds
2024-04-23T21:08:39,033  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210839_277ed740-ff0f-47c8-b206-9715ef72d868
2024-04-23T21:08:39,033  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:39,033  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_277ed740-ff0f-47c8-b206-9715ef72d868): drop table if exists acidTbl2
2024-04-23T21:08:39,034  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:39,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,037  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,037  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_277ed740-ff0f-47c8-b206-9715ef72d868); Time taken: 0.004 seconds
2024-04-23T21:08:39,037  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_277ed740-ff0f-47c8-b206-9715ef72d868
2024-04-23T21:08:39,042  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:08:39,047  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,048  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:08:39,048  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:39,048  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_8689d9fe-767d-42d9-946d-b3cbb84d2f56): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:39,050  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:08:39,051  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:08:39,051  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:39,054  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,054  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,054  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:08:39,055  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_8689d9fe-767d-42d9-946d-b3cbb84d2f56); Time taken: 0.006 seconds
2024-04-23T21:08:39,055  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210839_8689d9fe-767d-42d9-946d-b3cbb84d2f56
2024-04-23T21:08:39,055  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:39,055  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_8689d9fe-767d-42d9-946d-b3cbb84d2f56): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:39,055  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:39,058  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,058  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,058  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_8689d9fe-767d-42d9-946d-b3cbb84d2f56); Time taken: 0.003 seconds
2024-04-23T21:08:39,058  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_8689d9fe-767d-42d9-946d-b3cbb84d2f56
2024-04-23T21:08:39,064  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:08:39,069  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,069  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:08:39,070  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:39,070  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_4e281dc2-932a-4c46-810c-8bffb9033a56): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:39,072  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:08:39,073  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:08:39,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:39,076  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,076  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,076  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,077  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T21:08:39,077  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_4e281dc2-932a-4c46-810c-8bffb9033a56); Time taken: 0.006 seconds
2024-04-23T21:08:39,077  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210839_4e281dc2-932a-4c46-810c-8bffb9033a56
2024-04-23T21:08:39,077  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:39,077  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_4e281dc2-932a-4c46-810c-8bffb9033a56): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:39,077  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,078  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:39,081  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,081  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:39,081  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_4e281dc2-932a-4c46-810c-8bffb9033a56); Time taken: 0.004 seconds
2024-04-23T21:08:39,081  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_4e281dc2-932a-4c46-810c-8bffb9033a56
2024-04-23T21:08:39,088  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:08:39,097  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,097  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:08:39,098  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:39,098  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_d7a6e1ca-fc04-4948-96c8-c7fdbb5799f7): drop table if exists nonAcidNonBucket
2024-04-23T21:08:39,101  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:08:39,101  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:08:39,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:39,106  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,106  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,106  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,106  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=16, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:39,106  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_d7a6e1ca-fc04-4948-96c8-c7fdbb5799f7); Time taken: 0.008 seconds
2024-04-23T21:08:39,107  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210839_d7a6e1ca-fc04-4948-96c8-c7fdbb5799f7
2024-04-23T21:08:39,107  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:39,107  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_d7a6e1ca-fc04-4948-96c8-c7fdbb5799f7): drop table if exists nonAcidNonBucket
2024-04-23T21:08:39,107  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:39,112  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,112  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,112  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_d7a6e1ca-fc04-4948-96c8-c7fdbb5799f7); Time taken: 0.005 seconds
2024-04-23T21:08:39,112  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_d7a6e1ca-fc04-4948-96c8-c7fdbb5799f7
2024-04-23T21:08:39,118  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:08:39,124  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,124  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:08:39,125  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,125  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,127  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:08:39,128  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:08:39,128  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:39,128  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:39,134  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:08:39,134  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:39,136  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:39,136  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,136  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,136  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,136  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=6, flushCache_()=0}
2024-04-23T21:08:39,136  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6); Time taken: 0.011 seconds
2024-04-23T21:08:39,137  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6
2024-04-23T21:08:39,137  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6
2024-04-23T21:08:39,154  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:08:39,154  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:39,155  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,155  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931719, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, bucketing_version=2, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:39,163  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:08:39,200  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=44, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,200  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6); Time taken: 0.045 seconds
2024-04-23T21:08:39,200  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_8d5654b0-5977-4864-8133-9c71a132dbc6
2024-04-23T21:08:39,204  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:08:39,210  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,210  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:08:39,210  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,211  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,213  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:08:39,213  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:08:39,214  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:39,214  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:39,216  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:08:39,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:39,218  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:39,218  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,218  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,218  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,218  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=2}
2024-04-23T21:08:39,218  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4); Time taken: 0.007 seconds
2024-04-23T21:08:39,219  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4
2024-04-23T21:08:39,219  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4
2024-04-23T21:08:39,235  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:08:39,235  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:39,236  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,236  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931719, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:39,242  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:08:39,256  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,256  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-23T21:08:39,256  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4); Time taken: 0.02 seconds
2024-04-23T21:08:39,256  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_962826c3-28d6-4f06-80b9-a8f615dceba4
2024-04-23T21:08:39,260  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:08:39,266  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,266  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:08:39,267  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,267  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,269  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:08:39,269  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:08:39,270  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:39,270  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:39,272  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:08:39,273  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:39,274  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:39,274  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,274  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,274  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=1, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,275  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef); Time taken: 0.007 seconds
2024-04-23T21:08:39,275  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef
2024-04-23T21:08:39,275  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef
2024-04-23T21:08:39,290  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:08:39,290  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:39,290  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,290  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931719, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, numFilesErasureCoded=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:39,297  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:08:39,310  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,310  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,311  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef); Time taken: 0.02 seconds
2024-04-23T21:08:39,311  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_a5181ff8-3f71-4364-b929-5743a86abfef
2024-04-23T21:08:39,315  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:08:39,321  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,321  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:08:39,321  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,322  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,324  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:08:39,324  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:08:39,324  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:39,325  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:39,327  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:08:39,327  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:39,329  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:39,329  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,329  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:39,329  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504); Time taken: 0.008 seconds
2024-04-23T21:08:39,329  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504
2024-04-23T21:08:39,329  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504
2024-04-23T21:08:39,349  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:08:39,349  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:39,350  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,350  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,351  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931719, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numRows=0, transactional=false, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:39,359  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:08:39,375  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,375  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,375  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504); Time taken: 0.026 seconds
2024-04-23T21:08:39,375  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_cd178314-9ef5-4a7a-b97b-e549b7bc5504
2024-04-23T21:08:39,379  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:08:39,386  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,386  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:08:39,387  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,387  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,389  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:08:39,389  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:08:39,390  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:39,390  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:39,392  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:08:39,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:39,394  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:39,394  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,394  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,394  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,394  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2}
2024-04-23T21:08:39,395  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885); Time taken: 0.007 seconds
2024-04-23T21:08:39,395  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885
2024-04-23T21:08:39,395  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885
2024-04-23T21:08:39,411  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:08:39,411  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:39,412  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:39,412  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,413  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/0c04be3b-68aa-4fb9-971c-0388a4884e97/_tmp_space.db/2543b529-11ba-46d3-b279-3686d82be26c
2024-04-23T21:08:39,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:08:39,416  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885); Time taken: 0.004 seconds
2024-04-23T21:08:39,416  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_eaddfe94-35c6-4d56-b0f9-06830c8e6885
2024-04-23T21:08:39,420  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:08:39,427  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,427  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:08:39,428  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,428  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_68725196-fe9f-4d82-813b-883646650330): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,430  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:08:39,431  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:08:39,431  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:39,431  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:39,434  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:08:39,434  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:39,435  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:39,435  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,435  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,435  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,436  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T21:08:39,436  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_68725196-fe9f-4d82-813b-883646650330); Time taken: 0.007 seconds
2024-04-23T21:08:39,436  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210839_68725196-fe9f-4d82-813b-883646650330
2024-04-23T21:08:39,436  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_68725196-fe9f-4d82-813b-883646650330
2024-04-23T21:08:39,452  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_68725196-fe9f-4d82-813b-883646650330 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:08:39,452  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:39,452  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_68725196-fe9f-4d82-813b-883646650330): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:39,452  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931719, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFiles=0, bucketing_version=2, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:39,458  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:08:39,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,471  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_68725196-fe9f-4d82-813b-883646650330); Time taken: 0.019 seconds
2024-04-23T21:08:39,471  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_68725196-fe9f-4d82-813b-883646650330
2024-04-23T21:08:39,475  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:08:39,482  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,482  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:08:39,482  INFO [main] ql.TxnCommandsBaseForTests: Running the query: start transaction
2024-04-23T21:08:39,483  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_78e5f930-9168-44ff-9262-79822b029630): start transaction
2024-04-23T21:08:39,485  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:08:39,485  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:08:39,485  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:39,485  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:39,486  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:39,486  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,486  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,486  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,486  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:08:39,486  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_78e5f930-9168-44ff-9262-79822b029630); Time taken: 0.003 seconds
2024-04-23T21:08:39,486  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210839_78e5f930-9168-44ff-9262-79822b029630
2024-04-23T21:08:39,486  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T21:08:39,486  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_78e5f930-9168-44ff-9262-79822b029630): start transaction
2024-04-23T21:08:39,486  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,487  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:08:39,487  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_78e5f930-9168-44ff-9262-79822b029630); Time taken: 0.0 seconds
2024-04-23T21:08:39,487  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where a = 5
2024-04-23T21:08:39,487  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_86e7ba94-3283-4f63-a0b2-b0608a03f6e6): delete from acidTbl where a = 5
2024-04-23T21:08:39,487  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:08:39,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:39,510  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,510  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where a = 5> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:08:39,510  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:08:39,516  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:39,516  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:39,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:08:39,523  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,523  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:39,523  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:39,524  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:39,531  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,531  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:39,531  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:39,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:08:39,595  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:08:39,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:08:39,605  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,606  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:08:39,616  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:08:39,629  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:08:39,629  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:08:39,703  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:39,703  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:39,703  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:39,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:39,715  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,718 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:08:39,719 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:08:39,719  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:08:39,720 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:08:39,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=29, getValidWriteIds_(List, String)=8, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=49, getTableColumnStatistics_(String, String, List, String)=34}
2024-04-23T21:08:39,721  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_86e7ba94-3283-4f63-a0b2-b0608a03f6e6); Time taken: 0.233 seconds
2024-04-23T21:08:39,721  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_78e5f930-9168-44ff-9262-79822b029630
2024-04-23T21:08:39,726  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,737  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:39,737  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1): drop table if exists acidTbl
2024-04-23T21:08:39,739  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:08:39,739  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:08:39,740  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:39,746  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,746  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,746  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,747  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,747  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, rollbackTxn_(long)=16, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,747  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1); Time taken: 0.009 seconds
2024-04-23T21:08:39,747  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1
2024-04-23T21:08:39,748  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1
2024-04-23T21:08:39,769  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:08:39,769  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:39,769  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1): drop table if exists acidTbl
2024-04-23T21:08:39,770  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:39,777  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:39,783  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:39,820  INFO [HiveClientCache-cleaner-0] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T21:08:39,820  INFO [HiveClientCache-cleaner-0] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -12
2024-04-23T21:08:39,888  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,888  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=111}
2024-04-23T21:08:39,888  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1); Time taken: 0.119 seconds
2024-04-23T21:08:39,888  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_de113b3f-278d-4c55-b012-28b7e552c0b1
2024-04-23T21:08:39,892  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:08:39,899  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,899  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:08:39,900  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:39,900  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57): drop table if exists acidTblPart
2024-04-23T21:08:39,902  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:08:39,902  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:08:39,903  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:39,909  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,909  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,909  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,909  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,909  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:08:39,909  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57); Time taken: 0.009 seconds
2024-04-23T21:08:39,910  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57
2024-04-23T21:08:39,910  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57
2024-04-23T21:08:39,925  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:08:39,925  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:39,925  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57): drop table if exists acidTblPart
2024-04-23T21:08:39,925  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:39,931  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:39,937  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:39,937  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:39,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=45}
2024-04-23T21:08:39,977  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57); Time taken: 0.051 seconds
2024-04-23T21:08:39,977  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_fd26fdbc-3a6f-41b5-beaf-4426d3e6cb57
2024-04-23T21:08:39,981  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:08:39,987  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:39,987  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:08:39,988  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:39,988  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210839_65ace382-5148-44f7-a8d0-b20938b11a24): drop table if exists acidTbl2
2024-04-23T21:08:39,991  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 2
2024-04-23T21:08:39,991  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:08:39,992  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:39,992  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:39,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:39,993  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:39,993  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210839_65ace382-5148-44f7-a8d0-b20938b11a24); Time taken: 0.005 seconds
2024-04-23T21:08:39,993  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210839_65ace382-5148-44f7-a8d0-b20938b11a24
2024-04-23T21:08:39,993  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:39,993  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210839_65ace382-5148-44f7-a8d0-b20938b11a24): drop table if exists acidTbl2
2024-04-23T21:08:39,993  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:39,994  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:08:39,994  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:39,994  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:39,995  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210839_65ace382-5148-44f7-a8d0-b20938b11a24); Time taken: 0.001 seconds
2024-04-23T21:08:39,995  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210839_65ace382-5148-44f7-a8d0-b20938b11a24
2024-04-23T21:08:40,000  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:08:40,006  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,006  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:08:40,007  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:40,007  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:40,009  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 3
2024-04-23T21:08:40,010  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:08:40,010  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:40,044  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,045  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,045  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,045  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,045  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=34, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:08:40,045  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a); Time taken: 0.038 seconds
2024-04-23T21:08:40,045  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a
2024-04-23T21:08:40,046  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a
2024-04-23T21:08:40,065  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:08:40,065  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:40,065  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:40,065  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,065  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:40,073  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:40,081  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:40,170  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,170  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=96, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,170  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a); Time taken: 0.105 seconds
2024-04-23T21:08:40,170  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_fe51f04e-b7e9-4824-9071-27705bb0869a
2024-04-23T21:08:40,174  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:08:40,180  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,181  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:08:40,181  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:40,182  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:40,184  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 8
2024-04-23T21:08:40,184  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:08:40,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:40,192  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,192  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,193  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,193  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,193  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=7, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,193  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074); Time taken: 0.012 seconds
2024-04-23T21:08:40,193  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074
2024-04-23T21:08:40,194  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074
2024-04-23T21:08:40,208  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:08:40,208  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:40,208  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:40,208  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,209  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:40,216  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:40,224  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:40,269  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,269  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=53, getTable_(GetTableRequest)=8}
2024-04-23T21:08:40,270  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074); Time taken: 0.061 seconds
2024-04-23T21:08:40,270  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_5f2ce7b0-ac5d-464f-8b27-56b69af67074
2024-04-23T21:08:40,274  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:08:40,281  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,281  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:08:40,282  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:40,282  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553): drop table if exists nonAcidNonBucket
2024-04-23T21:08:40,285  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 10
2024-04-23T21:08:40,285  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:08:40,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:40,294  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,294  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,294  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,294  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,294  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T21:08:40,294  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553); Time taken: 0.012 seconds
2024-04-23T21:08:40,295  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553
2024-04-23T21:08:40,295  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553
2024-04-23T21:08:40,311  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:08:40,311  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:40,311  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553): drop table if exists nonAcidNonBucket
2024-04-23T21:08:40,311  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:40,320  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:40,329  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:40,358  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,358  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=38, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,358  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553); Time taken: 0.047 seconds
2024-04-23T21:08:40,358  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_8c818b94-fad1-47d0-9959-ce62eb02c553
2024-04-23T21:08:40,362  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:08:40,369  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,369  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:08:40,369  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeOnTezEdges" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.681">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:08:40,430  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:08:40,432  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 3e046fd7-134c-43fb-81c3-4e0d29fb5e8f
2024-04-23T21:08:40,434  INFO [main] SessionState: Hive Session ID = 3e046fd7-134c-43fb-81c3-4e0d29fb5e8f
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:40,435  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:40,440  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3e046fd7-134c-43fb-81c3-4e0d29fb5e8f
2024-04-23T21:08:40,442  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e046fd7-134c-43fb-81c3-4e0d29fb5e8f
2024-04-23T21:08:40,445  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3e046fd7-134c-43fb-81c3-4e0d29fb5e8f/_tmp_space.db
2024-04-23T21:08:40,445  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=3e046fd7-134c-43fb-81c3-4e0d29fb5e8f, clientType=HIVECLI]
2024-04-23T21:08:40,445  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:40,445  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_478fe5d1-1d0b-4b91-a18b-611048bb36e7): drop table if exists acidTbl
2024-04-23T21:08:40,454  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:08:40,454  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:08:40,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:40,464  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,464  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,464  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,464  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=8, flushCache_()=0, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,464  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_478fe5d1-1d0b-4b91-a18b-611048bb36e7); Time taken: 0.019 seconds
2024-04-23T21:08:40,464  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210840_478fe5d1-1d0b-4b91-a18b-611048bb36e7
2024-04-23T21:08:40,464  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:40,464  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_478fe5d1-1d0b-4b91-a18b-611048bb36e7): drop table if exists acidTbl
2024-04-23T21:08:40,465  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:40,468  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,468  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,468  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_478fe5d1-1d0b-4b91-a18b-611048bb36e7); Time taken: 0.004 seconds
2024-04-23T21:08:40,468  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_478fe5d1-1d0b-4b91-a18b-611048bb36e7
2024-04-23T21:08:40,474  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:08:40,481  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,482  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:08:40,482  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:40,482  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_c96bf157-b9fd-463a-b422-68d0d7e256b2): drop table if exists acidTblPart
2024-04-23T21:08:40,484  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:08:40,485  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:08:40,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:40,488  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,488  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,488  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,488  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14}
2024-04-23T21:08:40,488  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_c96bf157-b9fd-463a-b422-68d0d7e256b2); Time taken: 0.006 seconds
2024-04-23T21:08:40,489  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210840_c96bf157-b9fd-463a-b422-68d0d7e256b2
2024-04-23T21:08:40,489  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:40,489  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_c96bf157-b9fd-463a-b422-68d0d7e256b2): drop table if exists acidTblPart
2024-04-23T21:08:40,489  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:40,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,492  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,492  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_c96bf157-b9fd-463a-b422-68d0d7e256b2); Time taken: 0.003 seconds
2024-04-23T21:08:40,492  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_c96bf157-b9fd-463a-b422-68d0d7e256b2
2024-04-23T21:08:40,498  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:08:40,504  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,504  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:08:40,504  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:40,505  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_f3126496-c21d-4b65-8322-690744ddec30): drop table if exists acidTbl2
2024-04-23T21:08:40,507  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:08:40,507  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:08:40,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:40,510  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,510  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,510  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,510  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:08:40,511  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_f3126496-c21d-4b65-8322-690744ddec30); Time taken: 0.005 seconds
2024-04-23T21:08:40,511  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210840_f3126496-c21d-4b65-8322-690744ddec30
2024-04-23T21:08:40,511  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:40,511  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_f3126496-c21d-4b65-8322-690744ddec30): drop table if exists acidTbl2
2024-04-23T21:08:40,511  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,511  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:40,514  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,514  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,514  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_f3126496-c21d-4b65-8322-690744ddec30); Time taken: 0.003 seconds
2024-04-23T21:08:40,514  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_f3126496-c21d-4b65-8322-690744ddec30
2024-04-23T21:08:40,520  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:08:40,526  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,526  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:08:40,527  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:40,527  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_7b682603-4bc9-4bd4-b68a-1ef7b696de10): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:40,529  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:08:40,529  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:08:40,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:40,532  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,532  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,532  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,532  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:08:40,532  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_7b682603-4bc9-4bd4-b68a-1ef7b696de10); Time taken: 0.005 seconds
2024-04-23T21:08:40,533  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210840_7b682603-4bc9-4bd4-b68a-1ef7b696de10
2024-04-23T21:08:40,533  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:40,533  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_7b682603-4bc9-4bd4-b68a-1ef7b696de10): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:40,533  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:40,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,536  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_7b682603-4bc9-4bd4-b68a-1ef7b696de10); Time taken: 0.003 seconds
2024-04-23T21:08:40,536  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_7b682603-4bc9-4bd4-b68a-1ef7b696de10
2024-04-23T21:08:40,541  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:08:40,547  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,547  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:08:40,548  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:40,548  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_0e66c407-17ea-4bab-a6c9-45d9e856e0f8): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:40,550  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:08:40,550  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:08:40,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:40,553  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,553  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,553  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,554  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=1}
2024-04-23T21:08:40,554  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_0e66c407-17ea-4bab-a6c9-45d9e856e0f8); Time taken: 0.005 seconds
2024-04-23T21:08:40,554  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210840_0e66c407-17ea-4bab-a6c9-45d9e856e0f8
2024-04-23T21:08:40,554  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:40,554  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_0e66c407-17ea-4bab-a6c9-45d9e856e0f8): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:40,554  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:40,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,557  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_0e66c407-17ea-4bab-a6c9-45d9e856e0f8); Time taken: 0.003 seconds
2024-04-23T21:08:40,557  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_0e66c407-17ea-4bab-a6c9-45d9e856e0f8
2024-04-23T21:08:40,563  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:08:40,570  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,570  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:08:40,570  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:40,571  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_ece84ded-776a-4025-bac2-0a072ff68226): drop table if exists nonAcidNonBucket
2024-04-23T21:08:40,573  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:08:40,573  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:08:40,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:40,576  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,576  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,576  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,576  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:08:40,577  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_ece84ded-776a-4025-bac2-0a072ff68226); Time taken: 0.005 seconds
2024-04-23T21:08:40,577  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210840_ece84ded-776a-4025-bac2-0a072ff68226
2024-04-23T21:08:40,577  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:40,577  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_ece84ded-776a-4025-bac2-0a072ff68226): drop table if exists nonAcidNonBucket
2024-04-23T21:08:40,577  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:40,580  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,580  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,580  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_ece84ded-776a-4025-bac2-0a072ff68226); Time taken: 0.003 seconds
2024-04-23T21:08:40,580  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_ece84ded-776a-4025-bac2-0a072ff68226
2024-04-23T21:08:40,586  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:08:40,592  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,592  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:08:40,592  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,593  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,595  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:08:40,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:08:40,595  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:40,596  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:40,601  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:08:40,601  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:40,603  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:40,603  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,603  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,603  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,603  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2}
2024-04-23T21:08:40,603  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6); Time taken: 0.01 seconds
2024-04-23T21:08:40,603  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6
2024-04-23T21:08:40,604  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6
2024-04-23T21:08:40,622  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:08:40,622  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:40,623  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,623  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,624  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931720, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, numFiles=0, bucketing_version=2, totalSize=0, numFilesErasureCoded=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:40,629  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:08:40,670  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,670  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=47, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,671  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6); Time taken: 0.047 seconds
2024-04-23T21:08:40,671  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_93e6e620-2347-4af0-a843-fd5821cd5ad6
2024-04-23T21:08:40,675  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:08:40,682  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,683  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:08:40,683  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,683  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,686  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:08:40,686  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:08:40,686  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:40,686  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:40,689  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:08:40,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:40,691  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:40,691  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,691  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:08:40,691  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070); Time taken: 0.008 seconds
2024-04-23T21:08:40,692  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070
2024-04-23T21:08:40,692  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070
2024-04-23T21:08:40,707  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:08:40,707  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:40,708  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,708  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931720, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:40,714  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:08:40,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,730  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T21:08:40,730  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070); Time taken: 0.022 seconds
2024-04-23T21:08:40,730  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_cc684ed1-f127-4371-a058-bbca65648070
2024-04-23T21:08:40,735  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:08:40,743  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,744  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:08:40,744  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,744  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,747  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:08:40,747  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:08:40,747  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:40,747  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:40,750  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:08:40,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:40,752  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:40,752  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,752  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,752  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,752  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2}
2024-04-23T21:08:40,752  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e); Time taken: 0.008 seconds
2024-04-23T21:08:40,752  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e
2024-04-23T21:08:40,753  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e
2024-04-23T21:08:40,768  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:08:40,768  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:40,768  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,769  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931720, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, bucketing_version=2, totalSize=0, numFiles=0, numRows=0, numFilesErasureCoded=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:40,774  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:08:40,787  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,788  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,788  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e); Time taken: 0.019 seconds
2024-04-23T21:08:40,788  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_291e0316-7fc7-45fb-a50f-97c72b8ad41e
2024-04-23T21:08:40,792  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:08:40,798  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,798  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:08:40,798  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,799  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,801  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:08:40,801  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:08:40,802  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:40,802  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:40,805  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:08:40,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:40,806  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:40,806  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,806  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,806  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,806  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, flushCache_()=0}
2024-04-23T21:08:40,807  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de); Time taken: 0.007 seconds
2024-04-23T21:08:40,807  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de
2024-04-23T21:08:40,807  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de
2024-04-23T21:08:40,821  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:08:40,821  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:40,821  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,821  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,822  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931720, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, transactional=false, rawDataSize=0, numRows=0, numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:40,827  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:08:40,842  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,842  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,842  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de); Time taken: 0.021 seconds
2024-04-23T21:08:40,842  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_591ca9bc-84e3-482b-846e-a1709d17a9de
2024-04-23T21:08:40,846  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:08:40,852  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,852  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:08:40,853  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,853  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,856  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:08:40,856  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:08:40,856  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:40,857  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:40,859  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:08:40,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:40,861  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:40,861  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,861  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-23T21:08:40,861  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da); Time taken: 0.008 seconds
2024-04-23T21:08:40,861  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da
2024-04-23T21:08:40,862  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da
2024-04-23T21:08:40,876  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:08:40,876  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:40,877  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:40,877  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,878  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3e046fd7-134c-43fb-81c3-4e0d29fb5e8f/_tmp_space.db/3a6893db-64b5-40cc-b88a-7ee602d37a9c
2024-04-23T21:08:40,881  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,881  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:40,881  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da); Time taken: 0.004 seconds
2024-04-23T21:08:40,881  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_2cba1d94-c774-4206-a1a8-4bf247b0f1da
2024-04-23T21:08:40,885  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:08:40,892  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,892  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:08:40,892  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,892  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,895  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:08:40,895  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:08:40,896  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:40,896  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:40,898  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:08:40,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:40,900  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:40,900  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:40,900  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:40,900  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:40,900  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:40,900  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445); Time taken: 0.008 seconds
2024-04-23T21:08:40,900  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445
2024-04-23T21:08:40,901  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445
2024-04-23T21:08:40,915  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:08:40,915  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:40,915  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:40,916  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:40,916  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931720, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0, numFiles=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:40,922  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:08:40,935  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:40,935  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-23T21:08:40,935  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445); Time taken: 0.02 seconds
2024-04-23T21:08:40,935  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_4b877ad4-e078-4bfc-8684-69422d524445
2024-04-23T21:08:40,940  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:08:40,946  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:40,946  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:08:40,948  INFO [main] ql.TxnCommandsBaseForTests: Running the query: explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T21:08:40,948  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T21:08:40,951  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:08:40,951  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:08:40,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:40,972  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T21:08:40,976  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3e046fd7-134c-43fb-81c3-4e0d29fb5e8f/_tmp_space.db/merge_tmp_table
2024-04-23T21:08:40,979  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` > 8
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 7
   WHERE `t`.`a` = `s`.`a` AND NOT(`s`.`a` > 8)
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND NOT(`s`.`a` > 8)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:08:40,980  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:08:40,984  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:40,984  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:40,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:08:40,991  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:40,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:08:41,020  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,021  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:41,021  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:41,021  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,027  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,028  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,034  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,041  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,048  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,048  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:41,048  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:41,049  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:41,049  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:41,049  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:41,061  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:08:41,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T21:08:41,121  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:08:41,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:08:41,130  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:08:41,139  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:08:41,149  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:08:41,149  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:08:41,149  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:08:41,150  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:08:41,161  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T21:08:41,172  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T21:08:41,184  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: b, a
No Stats for default@nonacidorctbl, Columns: b, a
2024-04-23T21:08:41,184  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: b, a
2024-04-23T21:08:41,375  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:41,375  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:41,375  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:41,376  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:41,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,384  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,391  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,403  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,414  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,421 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.ExplainSemanticAnalyzer.analyzeInternal(ExplainSemanticAnalyzer.java:175) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:08:41,423 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:08:41,423 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.ExplainSemanticAnalyzer.analyzeInternal(ExplainSemanticAnalyzer.java:175)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:08:41,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:41,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getAllTableConstraints_(AllTableConstraintsRequest)=30, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=119, getTableColumnStatistics_(String, String, List, String)=62, createTable_(Table)=3}
2024-04-23T21:08:41,424  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.476 seconds
2024-04-23T21:08:41,424  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,429  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:41,439  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:41,439  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3e046fd7-134c-43fb-81c3-4e0d29fb5e8f/hive_2024-04-23_21-08-40_979_8075053030328700980-1
2024-04-23T21:08:41,439  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists acidTbl
2024-04-23T21:08:41,443  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:08:41,443  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:08:41,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,453  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,453  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:41,453  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:41,453  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:41,453  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, flushCache_()=0, rollbackTxn_(long)=14, getTable_(GetTableRequest)=9}
2024-04-23T21:08:41,453  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.014 seconds
2024-04-23T21:08:41,454  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,454  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,475  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:08:41,475  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:41,475  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists acidTbl
2024-04-23T21:08:41,476  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:41,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,482  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,488  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,488  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:41,640  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:41,640  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=158, getTable_(GetTableRequest)=6}
2024-04-23T21:08:41,640  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.165 seconds
2024-04-23T21:08:41,640  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,644  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:08:41,653  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:41,654  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:08:41,655  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:41,655  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists acidTblPart
2024-04-23T21:08:41,657  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 8
2024-04-23T21:08:41,658  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:08:41,658  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:41,665  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,665  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:41,665  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:41,665  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:41,665  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:08:41,665  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.01 seconds
2024-04-23T21:08:41,666  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,666  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,682  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:08:41,682  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:41,682  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists acidTblPart
2024-04-23T21:08:41,682  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:41,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:41,688  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:41,695  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,695  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:41,736  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:41,736  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=48, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:41,736  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.054 seconds
2024-04-23T21:08:41,737  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,741  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:08:41,748  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:41,748  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:08:41,748  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:41,749  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists acidTbl2
2024-04-23T21:08:41,752  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 10
2024-04-23T21:08:41,752  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:08:41,753  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:41,753  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:41,753  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:41,753  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=0, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:41,753  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.004 seconds
2024-04-23T21:08:41,754  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,754  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:41,754  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists acidTbl2
2024-04-23T21:08:41,754  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:41,754  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:08:41,755  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:41,755  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:41,755  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.001 seconds
2024-04-23T21:08:41,755  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,761  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:08:41,768  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:41,768  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:08:41,769  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:41,769  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:41,772  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 10
2024-04-23T21:08:41,772  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:08:41,773  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:41,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,798  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:41,798  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:41,798  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:41,798  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=25, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14}
2024-04-23T21:08:41,799  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.029 seconds
2024-04-23T21:08:41,799  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,799  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,819  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:08:41,819  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:41,819  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:41,819  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:41,820  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:41,828  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,828  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:41,836  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:41,869  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:41,869  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=41}
2024-04-23T21:08:41,869  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.05 seconds
2024-04-23T21:08:41,869  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,874  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:08:41,882  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:41,882  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:08:41,882  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:41,883  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:41,885  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 12
2024-04-23T21:08:41,885  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:08:41,886  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:41,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,894  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:41,894  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:41,894  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:41,894  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=8, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:41,894  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.011 seconds
2024-04-23T21:08:41,894  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,895  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,909  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:08:41,909  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:41,909  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:41,910  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:41,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:41,917  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:41,925  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:41,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:41,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=34}
2024-04-23T21:08:41,952  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.043 seconds
2024-04-23T21:08:41,952  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,957  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:08:41,964  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:41,964  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:08:41,965  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:41,965  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists nonAcidNonBucket
2024-04-23T21:08:41,968  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 14
2024-04-23T21:08:41,968  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:08:41,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:41,977  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:41,977  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:41,977  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:41,977  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:41,977  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:08:41,977  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.012 seconds
2024-04-23T21:08:41,978  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,978  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:41,994  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:08:41,994  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:41,995  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952): drop table if exists nonAcidNonBucket
2024-04-23T21:08:41,995  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:41,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:42,003  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:42,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:42,011  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:42,011  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:42,039  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,040  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=36, getTable_(GetTableRequest)=8}
2024-04-23T21:08:42,040  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952); Time taken: 0.045 seconds
2024-04-23T21:08:42,040  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210840_67b212c3-f66e-47d2-bd62-ef8a0a781952
2024-04-23T21:08:42,044  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:08:42,050  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,050  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:08:42,051  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeType2SCD01" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="6.808">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:08:42,111  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:08:42,114  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 7c199f91-1cd3-46b7-bcfa-20a233429e07
2024-04-23T21:08:42,118  INFO [main] SessionState: Hive Session ID = 7c199f91-1cd3-46b7-bcfa-20a233429e07
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:42,118  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:42,124  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7c199f91-1cd3-46b7-bcfa-20a233429e07
2024-04-23T21:08:42,127  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07
2024-04-23T21:08:42,129  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7c199f91-1cd3-46b7-bcfa-20a233429e07/_tmp_space.db
2024-04-23T21:08:42,130  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=7c199f91-1cd3-46b7-bcfa-20a233429e07, clientType=HIVECLI]
2024-04-23T21:08:42,130  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:42,130  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_29526552-753c-4e49-add8-d79e9191832f): drop table if exists acidTbl
2024-04-23T21:08:42,143  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:08:42,143  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:08:42,146  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:42,156  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,156  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,156  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,156  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=12, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:08:42,156  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_29526552-753c-4e49-add8-d79e9191832f); Time taken: 0.026 seconds
2024-04-23T21:08:42,156  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210842_29526552-753c-4e49-add8-d79e9191832f
2024-04-23T21:08:42,156  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,156  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_29526552-753c-4e49-add8-d79e9191832f): drop table if exists acidTbl
2024-04-23T21:08:42,156  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,157  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:42,160  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,160  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,160  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_29526552-753c-4e49-add8-d79e9191832f); Time taken: 0.004 seconds
2024-04-23T21:08:42,160  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_29526552-753c-4e49-add8-d79e9191832f
2024-04-23T21:08:42,167  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:08:42,174  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,175  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:08:42,175  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:42,175  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_4ccd7f2b-3e3a-4e80-89eb-5c4706595066): drop table if exists acidTblPart
2024-04-23T21:08:42,178  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:08:42,178  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:08:42,179  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:42,182  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,182  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,182  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,183  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:42,183  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_4ccd7f2b-3e3a-4e80-89eb-5c4706595066); Time taken: 0.007 seconds
2024-04-23T21:08:42,183  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210842_4ccd7f2b-3e3a-4e80-89eb-5c4706595066
2024-04-23T21:08:42,183  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,183  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_4ccd7f2b-3e3a-4e80-89eb-5c4706595066): drop table if exists acidTblPart
2024-04-23T21:08:42,183  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:42,187  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,187  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,187  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_4ccd7f2b-3e3a-4e80-89eb-5c4706595066); Time taken: 0.004 seconds
2024-04-23T21:08:42,187  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_4ccd7f2b-3e3a-4e80-89eb-5c4706595066
2024-04-23T21:08:42,194  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:08:42,201  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,201  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:08:42,202  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:42,202  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_29e83d62-6e64-4836-a815-1114a0da0c4c): drop table if exists acidTbl2
2024-04-23T21:08:42,205  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:08:42,205  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:08:42,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:42,209  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,209  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,209  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=1, openTxn_(String, TxnType)=2}
2024-04-23T21:08:42,209  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_29e83d62-6e64-4836-a815-1114a0da0c4c); Time taken: 0.007 seconds
2024-04-23T21:08:42,210  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210842_29e83d62-6e64-4836-a815-1114a0da0c4c
2024-04-23T21:08:42,210  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,210  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_29e83d62-6e64-4836-a815-1114a0da0c4c): drop table if exists acidTbl2
2024-04-23T21:08:42,210  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:42,213  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,213  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,213  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_29e83d62-6e64-4836-a815-1114a0da0c4c); Time taken: 0.003 seconds
2024-04-23T21:08:42,213  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_29e83d62-6e64-4836-a815-1114a0da0c4c
2024-04-23T21:08:42,220  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:08:42,227  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,227  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:08:42,228  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:42,228  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_e4cd6058-c060-49ac-91f1-7d3654b86935): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:42,231  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:08:42,231  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:08:42,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:42,235  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,235  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,235  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,235  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0}
2024-04-23T21:08:42,235  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_e4cd6058-c060-49ac-91f1-7d3654b86935); Time taken: 0.007 seconds
2024-04-23T21:08:42,236  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210842_e4cd6058-c060-49ac-91f1-7d3654b86935
2024-04-23T21:08:42,236  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,236  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_e4cd6058-c060-49ac-91f1-7d3654b86935): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:42,236  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,236  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:42,239  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,239  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,239  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_e4cd6058-c060-49ac-91f1-7d3654b86935); Time taken: 0.003 seconds
2024-04-23T21:08:42,239  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_e4cd6058-c060-49ac-91f1-7d3654b86935
2024-04-23T21:08:42,245  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:08:42,251  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,251  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:08:42,252  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:42,252  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_791f00fd-f34d-44d6-9506-b8c6430bcf76): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:42,254  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:08:42,254  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:08:42,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:42,258  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,258  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,258  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=1}
2024-04-23T21:08:42,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_791f00fd-f34d-44d6-9506-b8c6430bcf76); Time taken: 0.006 seconds
2024-04-23T21:08:42,259  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210842_791f00fd-f34d-44d6-9506-b8c6430bcf76
2024-04-23T21:08:42,259  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,259  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_791f00fd-f34d-44d6-9506-b8c6430bcf76): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:42,259  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:42,262  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,262  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,262  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_791f00fd-f34d-44d6-9506-b8c6430bcf76); Time taken: 0.003 seconds
2024-04-23T21:08:42,262  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_791f00fd-f34d-44d6-9506-b8c6430bcf76
2024-04-23T21:08:42,268  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:08:42,274  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,274  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:08:42,275  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:42,275  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_939bdc64-d574-4103-9e9c-e9c83973db1f): drop table if exists nonAcidNonBucket
2024-04-23T21:08:42,277  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:08:42,277  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:08:42,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:42,281  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,281  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,281  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,281  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:08:42,281  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_939bdc64-d574-4103-9e9c-e9c83973db1f); Time taken: 0.006 seconds
2024-04-23T21:08:42,281  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210842_939bdc64-d574-4103-9e9c-e9c83973db1f
2024-04-23T21:08:42,281  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,281  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_939bdc64-d574-4103-9e9c-e9c83973db1f): drop table if exists nonAcidNonBucket
2024-04-23T21:08:42,281  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:42,285  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,285  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:42,285  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_939bdc64-d574-4103-9e9c-e9c83973db1f); Time taken: 0.004 seconds
2024-04-23T21:08:42,285  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_939bdc64-d574-4103-9e9c-e9c83973db1f
2024-04-23T21:08:42,292  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:08:42,298  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,299  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:08:42,299  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,299  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,302  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:08:42,302  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:08:42,303  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,303  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,309  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:08:42,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:42,311  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:42,311  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,311  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,311  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,311  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=6, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2}
2024-04-23T21:08:42,311  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6); Time taken: 0.012 seconds
2024-04-23T21:08:42,312  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6
2024-04-23T21:08:42,312  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6
2024-04-23T21:08:42,330  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:08:42,330  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:42,331  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,331  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931722, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=true, rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:42,337  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:08:42,374  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,375  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,375  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6); Time taken: 0.043 seconds
2024-04-23T21:08:42,375  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_d299ef84-2e25-46a3-8e70-09935c755bd6
2024-04-23T21:08:42,379  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:08:42,385  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,385  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:08:42,386  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,386  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,389  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:08:42,389  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:08:42,389  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,389  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,392  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:08:42,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:42,395  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:42,395  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,395  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,395  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,395  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, getDatabase_(String)=3, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:08:42,395  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec); Time taken: 0.009 seconds
2024-04-23T21:08:42,396  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec
2024-04-23T21:08:42,396  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec
2024-04-23T21:08:42,410  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:08:42,410  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:42,411  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,411  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931722, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:42,417  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:08:42,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,430  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec); Time taken: 0.019 seconds
2024-04-23T21:08:42,430  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_330a4bbf-d256-476d-83ff-f1e876a542ec
2024-04-23T21:08:42,435  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:08:42,441  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,441  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:08:42,441  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,442  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,444  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:08:42,444  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:08:42,445  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,445  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,448  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:08:42,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:42,449  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:42,449  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,449  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,449  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,449  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=1, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:08:42,450  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8); Time taken: 0.007 seconds
2024-04-23T21:08:42,450  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8
2024-04-23T21:08:42,450  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8
2024-04-23T21:08:42,465  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:08:42,465  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:42,465  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,465  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931722, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFilesErasureCoded=0, totalSize=0, bucketing_version=2, numFiles=0, transactional=false, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:42,471  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:08:42,485  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,485  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,485  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8); Time taken: 0.02 seconds
2024-04-23T21:08:42,485  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_2d378942-e300-4242-8730-ed0a58da13a8
2024-04-23T21:08:42,490  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:08:42,497  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,497  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:08:42,498  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,498  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,500  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:08:42,501  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:08:42,501  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,501  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,504  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:08:42,504  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:42,506  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:42,506  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,506  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,506  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,506  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2}
2024-04-23T21:08:42,506  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08); Time taken: 0.008 seconds
2024-04-23T21:08:42,507  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08
2024-04-23T21:08:42,507  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08
2024-04-23T21:08:42,522  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:08:42,522  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:42,522  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,522  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,523  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931722, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, bucketing_version=2, totalSize=0, numFilesErasureCoded=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:42,528  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:08:42,541  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,541  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T21:08:42,541  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08); Time taken: 0.019 seconds
2024-04-23T21:08:42,541  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_a5151640-d10f-4dfc-b368-0420cbe6db08
2024-04-23T21:08:42,545  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:08:42,552  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,552  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:08:42,552  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,553  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,555  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:08:42,555  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:08:42,556  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,556  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,559  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:08:42,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:42,560  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:42,561  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,561  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,561  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,561  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getDatabase_(String)=1}
2024-04-23T21:08:42,561  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb); Time taken: 0.008 seconds
2024-04-23T21:08:42,561  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb
2024-04-23T21:08:42,562  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb
2024-04-23T21:08:42,577  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:08:42,577  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:42,577  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:42,577  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,578  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7c199f91-1cd3-46b7-bcfa-20a233429e07/_tmp_space.db/4742e8cc-f7ca-4bc3-8f42-6cbbc0ee45ee
2024-04-23T21:08:42,581  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,581  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:42,581  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb); Time taken: 0.004 seconds
2024-04-23T21:08:42,581  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_bfc6e327-655a-48e1-810a-7820a9fb20eb
2024-04-23T21:08:42,585  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:08:42,592  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,592  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:08:42,592  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,593  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,595  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:08:42,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:08:42,596  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,596  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,598  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:08:42,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:42,600  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:42,600  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,600  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,600  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,600  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T21:08:42,600  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06); Time taken: 0.007 seconds
2024-04-23T21:08:42,600  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06
2024-04-23T21:08:42,601  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06
2024-04-23T21:08:42,615  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:08:42,615  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:42,615  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:42,615  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931722, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFilesErasureCoded=0, totalSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:42,621  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:08:42,634  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,635  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T21:08:42,635  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06); Time taken: 0.019 seconds
2024-04-23T21:08:42,635  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_3b9a2cc1-3af7-4bdf-950f-bc98efa42e06
2024-04-23T21:08:42,639  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:08:42,645  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,645  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:08:42,646  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists target
2024-04-23T21:08:42,646  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_0fdc562c-b0c6-4c5d-9bac-15acb32c985d): drop table if exists target
2024-04-23T21:08:42,648  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:08:42,649  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:08:42,649  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:42,652  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,652  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,652  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:42,653  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_0fdc562c-b0c6-4c5d-9bac-15acb32c985d); Time taken: 0.006 seconds
2024-04-23T21:08:42,653  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210842_0fdc562c-b0c6-4c5d-9bac-15acb32c985d
2024-04-23T21:08:42,653  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,653  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_0fdc562c-b0c6-4c5d-9bac-15acb32c985d): drop table if exists target
2024-04-23T21:08:42,653  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:42,656  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,656  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_0fdc562c-b0c6-4c5d-9bac-15acb32c985d); Time taken: 0.003 seconds
2024-04-23T21:08:42,657  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_0fdc562c-b0c6-4c5d-9bac-15acb32c985d
2024-04-23T21:08:42,662  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:08:42,669  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,669  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:08:42,669  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists source
2024-04-23T21:08:42,669  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_e0293a37-698a-44f0-98dd-24e7dec98c18): drop table if exists source
2024-04-23T21:08:42,672  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:08:42,672  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:08:42,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:42,675  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,675  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:42,676  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_e0293a37-698a-44f0-98dd-24e7dec98c18); Time taken: 0.007 seconds
2024-04-23T21:08:42,676  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210842_e0293a37-698a-44f0-98dd-24e7dec98c18
2024-04-23T21:08:42,676  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,676  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_e0293a37-698a-44f0-98dd-24e7dec98c18): drop table if exists source
2024-04-23T21:08:42,676  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,677  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:42,679  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,680  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,680  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_e0293a37-698a-44f0-98dd-24e7dec98c18); Time taken: 0.003 seconds
2024-04-23T21:08:42,680  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_e0293a37-698a-44f0-98dd-24e7dec98c18
2024-04-23T21:08:42,686  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:08:42,692  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,692  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:08:42,693  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists splitTable
2024-04-23T21:08:42,693  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_05f89627-6d31-4d12-961e-2f2cadf1a325): drop table if exists splitTable
2024-04-23T21:08:42,696  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:08:42,696  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:08:42,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T21:08:42,699  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,699  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,699  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,700  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_05f89627-6d31-4d12-961e-2f2cadf1a325); Time taken: 0.006 seconds
2024-04-23T21:08:42,700  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210842_05f89627-6d31-4d12-961e-2f2cadf1a325
2024-04-23T21:08:42,700  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:42,700  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_05f89627-6d31-4d12-961e-2f2cadf1a325): drop table if exists splitTable
2024-04-23T21:08:42,700  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T21:08:42,703  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,703  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:42,703  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_05f89627-6d31-4d12-961e-2f2cadf1a325); Time taken: 0.003 seconds
2024-04-23T21:08:42,703  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_05f89627-6d31-4d12-961e-2f2cadf1a325
2024-04-23T21:08:42,709  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:08:42,716  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,716  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:08:42,717  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table splitTable(op int)
2024-04-23T21:08:42,717  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057): create table splitTable(op int)
2024-04-23T21:08:42,720  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T21:08:42,720  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:08:42,721  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,721  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,727  INFO [main] parse.CalcitePlanner: Creating table default.splitTable position=13
2024-04-23T21:08:42,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:42,729  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:42,729  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:42,729  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:42,729  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:42,729  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:08:42,729  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057); Time taken: 0.012 seconds
2024-04-23T21:08:42,729  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057
2024-04-23T21:08:42,730  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057
2024-04-23T21:08:42,748  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:08:42,748  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:42,748  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057): create table splitTable(op int)
2024-04-23T21:08:42,748  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:42,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:splitTable, dbName:default, owner:alex, createTime:1713931722, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:op, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"op":"true"}}, rawDataSize=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:42,754  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable
2024-04-23T21:08:42,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:42,785  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=36}
2024-04-23T21:08:42,785  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057); Time taken: 0.037 seconds
2024-04-23T21:08:42,785  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_e0e14b30-9cd5-4f83-b768-d001d1d33057
2024-04-23T21:08:42,790  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:08:42,796  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:42,796  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:08:42,797  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into splitTable values (0),(1)
2024-04-23T21:08:42,797  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e): insert into splitTable values (0),(1)
2024-04-23T21:08:42,799  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T21:08:42,799  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:08:42,800  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:42,800  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:42,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T21:08:42,838  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:42,838  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:42,838  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:42,838  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:42,838  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:42,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T21:08:42,846  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:42,846  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:42,846  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:42,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:42,940  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:42,940  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:42,940  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:42,940  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:42,943  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:42,943  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:42,943  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:42,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T21:08:42,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:42,953  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1
2024-04-23T21:08:42,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.splittable	
2024-04-23T21:08:42,957  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.splittable	
2024-04-23T21:08:42,958  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:08:42,961  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:08:42,961  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:42,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:42,979  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:42,980  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T21:08:42,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:42,990  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:43,006  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:43,007  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:08:43,007  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:08:43,007  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:08:43,007  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:08:43,007  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:08:43,007  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:08:43,008  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:08:43,008  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:43,008  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:43,008  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null)], properties:null)
2024-04-23T21:08:43,008  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:43,008  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=71, getNotNullConstraints_(NotNullConstraintsRequest)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, getAllTableConstraints_(AllTableConstraintsRequest)=31, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=4, getCheckConstraints_(CheckConstraintsRequest)=2}
2024-04-23T21:08:43,008  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e); Time taken: 0.211 seconds
2024-04-23T21:08:43,008  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e
2024-04-23T21:08:43,009  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e
2024-04-23T21:08:43,023  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:08:43,023  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:08:43,023  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e): insert into splitTable values (0),(1)
2024-04-23T21:08:43,024  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e
2024-04-23T21:08:43,024  INFO [main] ql.Driver: Query ID = alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e
Total jobs = 3
2024-04-23T21:08:43,024  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-23T21:08:43,024  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-23T21:08:43,181  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:08:43,181  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:08:43,183  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:43,184  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:08:43,184  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-42_797_6533623729474351031-1/dummy_path
2024-04-23T21:08:43,193  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:43,194  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T21:08:43,195  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:43,198  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-42_797_6533623729474351031-1/-mr-10001
2024-04-23T21:08:43,203  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:43,210  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:43,214  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:43,215  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:08:43,215  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:08:43,216  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-42_797_6533623729474351031-1/dummy_path
2024-04-23T21:08:43,216  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:43,235  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:43,253  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local925024130_0068
2024-04-23T21:08:43,253  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:43,314  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:43,314  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:43,314  INFO [Thread-5802] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:43,315  INFO [Thread-5802] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:43,316  INFO [Thread-5802] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:43,316  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local925024130_0068_m_000000_0
2024-04-23T21:08:43,319  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:43,320  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-42_797_6533623729474351031-1/dummy_path/null:0+1
2024-04-23T21:08:43,322  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:43,322  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T21:08:43,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:08:43,325  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:43,325  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:43,326  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:08:43,326  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:08:43,326  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:08:43,326  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:08:43,326  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:08:43,326  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int>
2024-04-23T21:08:43,326  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:08:43,327  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@24ed96d7, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@12162de7, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [op] : [int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@542cb1ef
2024-04-23T21:08:43,327  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1/_tmp.-ext-10002/000000_0
2024-04-23T21:08:43,327  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:08:43,327  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1/_tmp.-ext-10002/000000_0
2024-04-23T21:08:43,336  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:08:43,336  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:08:43,337  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:08:43,343  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.splittable:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:43,343  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:43,346  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local925024130_0068_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:43,347  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:08:43,347  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local925024130_0068_m_000000_0' done.
2024-04-23T21:08:43,347  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local925024130_0068_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1552359
		FILE: Number of bytes written=85318153
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1939865600
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.splittable=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=5948
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:43,347  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local925024130_0068_m_000000_0
2024-04-23T21:08:43,347  INFO [Thread-5802] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:08:44,316 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:08:44,316  INFO [main] exec.Task: 2024-04-23 21:08:44,316 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local925024130_0068
2024-04-23T21:08:44,318  INFO [main] exec.Task: Ended Job = job_local925024130_0068
2024-04-23T21:08:44,320  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T21:08:44,320  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T21:08:44,320  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T21:08:44,320  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T21:08:44,321  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1/-ext-10000
2024-04-23T21:08:44,321  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1/-ext-10002
2024-04-23T21:08:44,321  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.splittable
2024-04-23T21:08:44,321  INFO [main] exec.Task: Loading data to table default.splittable from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1/-ext-10000
2024-04-23T21:08:44,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:44,330  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:44,340  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,341  WARN [main] metadata.Hive: Cannot get a table snapshot for splittable
2024-04-23T21:08:44,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.splittable newtbl=splittable	
2024-04-23T21:08:44,368  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:08:44,368  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:44,375  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,375  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:08:44,376  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-42_797_6533623729474351031-1/-mr-10001
2024-04-23T21:08:44,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:44,384  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,385  INFO [main] FileOperations: Read stats for default.splittable/, numRows, true, 2, false: 
2024-04-23T21:08:44,385  INFO [main] FileOperations: Read stats for default.splittable/, rawDataSize, true, 2, false: 
2024-04-23T21:08:44,385  WARN [main] metadata.Hive: Cannot get a table snapshot for splittable
2024-04-23T21:08:44,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.splittable newtbl=splittable	
2024-04-23T21:08:44,406  INFO [main] stats.BasicStatsTask: Table default.splittable stats: [numFiles=1, numRows=2, totalSize=4, rawDataSize=2, numFilesErasureCoded=0]
2024-04-23T21:08:44,406  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:44,406  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=48, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=33}
MapReduce Jobs Launched: 
2024-04-23T21:08:44,406  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:08:44,407  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:44,407  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:44,407  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e); Time taken: 1.383 seconds
2024-04-23T21:08:44,407  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210842_84af1e03-e897-4083-850b-3c51c8f2e59e
2024-04-23T21:08:44,411  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:08:44,417  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:44,418  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:08:44,418  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table source (key int, data int)
2024-04-23T21:08:44,418  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1
2024-04-23T21:08:44,419  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/splittable/.hive-staging_hive_2024-04-23_21-08-42_797_6533623729474351031-1 on fs with scheme file
2024-04-23T21:08:44,419  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-42_797_6533623729474351031-1
2024-04-23T21:08:44,419  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-42_797_6533623729474351031-1 on fs with scheme file
2024-04-23T21:08:44,419  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15): create table source (key int, data int)
2024-04-23T21:08:44,422  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:08:44,422  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:08:44,423  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:44,423  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:44,425  INFO [main] parse.CalcitePlanner: Creating table default.source position=13
2024-04-23T21:08:44,426  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:44,427  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:44,427  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:44,427  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:44,427  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:44,427  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getDatabase_(String)=2}
2024-04-23T21:08:44,428  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15); Time taken: 0.008 seconds
2024-04-23T21:08:44,428  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15
2024-04-23T21:08:44,428  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15
2024-04-23T21:08:44,443  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:08:44,443  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:44,443  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15): create table source (key int, data int)
2024-04-23T21:08:44,443  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:44,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:source, dbName:default, owner:alex, createTime:1713931724, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"data":"true","key":"true"}}, numFiles=0, totalSize=0, bucketing_version=2, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:44,449  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source
2024-04-23T21:08:44,462  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:44,462  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:44,462  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15); Time taken: 0.019 seconds
2024-04-23T21:08:44,462  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210844_7e387f5f-fcf6-44f7-aa0c-821b4859ac15
2024-04-23T21:08:44,466  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:08:44,473  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:44,473  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:08:44,473  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:44,474  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:44,476  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:08:44,476  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:08:44,477  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:44,477  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:44,479  INFO [main] parse.CalcitePlanner: Creating table default.target position=13
2024-04-23T21:08:44,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:44,481  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:44,481  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:44,481  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:44,481  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:44,481  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=1, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:08:44,482  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975); Time taken: 0.007 seconds
2024-04-23T21:08:44,482  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975
2024-04-23T21:08:44,482  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975
2024-04-23T21:08:44,497  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:08:44,497  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:44,497  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:44,498  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:44,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:target, dbName:default, owner:alex, createTime:1713931724, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null), FieldSchema(name:cur, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[key], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"cur":"true","data":"true","key":"true"}}, transactional=true, totalSize=0, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:44,503  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:44,518  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:44,518  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T21:08:44,518  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975); Time taken: 0.021 seconds
2024-04-23T21:08:44,519  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210844_06c9195f-ed86-4b4c-88cb-8d1403c80975
2024-04-23T21:08:44,523  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:08:44,529  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:44,529  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:08:44,529  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T21:08:44,530  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T21:08:44,533  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:08:44,533  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:08:44,534  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:44,534  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:44,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:44,547  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,547  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:44,547  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:44,547  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:44,547  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:44,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:44,553  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,553  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:44,554  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:44,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:44,626  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:44,626  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:44,626  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:44,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:44,630  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:44,630  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:44,630  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:44,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:44,639  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,641  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.target	
2024-04-23T21:08:44,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.target	
2024-04-23T21:08:44,652  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T21:08:44,652  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=target (txnIds: [20])
2024-04-23T21:08:44,653  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:08:44,656  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2], VALUE._col0=Column[_col1]}
2024-04-23T21:08:44,656  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2], VALUE._col0=Column[_col1]}
2024-04-23T21:08:44,657  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:08:44,657  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:44,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:44,673  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:44,674  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:44,674  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:08:44,674  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:44,674  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:44,674  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null), FieldSchema(name:col3, type:int, comment:null)], properties:null)
2024-04-23T21:08:44,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:44,674  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=31, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getCheckConstraints_(CheckConstraintsRequest)=0, allocateTableWriteId_(long, String, String)=10, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=10, getAllTableConstraints_(AllTableConstraintsRequest)=4, getNotNullConstraints_(NotNullConstraintsRequest)=2, flushCache_()=0}
2024-04-23T21:08:44,675  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1); Time taken: 0.144 seconds
2024-04-23T21:08:44,675  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1
2024-04-23T21:08:44,675  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1
2024-04-23T21:08:44,694  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:08:44,694  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:08:44,697  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T21:08:44,697  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1
2024-04-23T21:08:44,697  INFO [main] ql.Driver: Query ID = alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1
Total jobs = 1
2024-04-23T21:08:44,697  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:08:44,697  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:08:44,829  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:08:44,829  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:08:44,829  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:08:44,829  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:08:44,829  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:08:44,829  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:08:44,829  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:08:44,829  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:08:44,831  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:44,832  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:08:44,832  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-44_530_9138520114271378790-1/dummy_path
2024-04-23T21:08:44,842  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:44,842  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,46KB
2024-04-23T21:08:44,847  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:08:44,848  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T21:08:44,849  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:44,852  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-44_530_9138520114271378790-1/-mr-10000
2024-04-23T21:08:44,854  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:44,861  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:44,866  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:44,867  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:08:44,867  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:08:44,867  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-44_530_9138520114271378790-1/dummy_path
2024-04-23T21:08:44,868  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:44,886  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:44,906  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local967253188_0069
2024-04-23T21:08:44,906  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:44,988  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:44,988  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:44,988  INFO [Thread-5848] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:44,989  INFO [Thread-5848] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:44,990  INFO [Thread-5848] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:44,990  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local967253188_0069_m_000000_0
2024-04-23T21:08:44,991  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:44,991  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-44_530_9138520114271378790-1/dummy_path/null:0+1
2024-04-23T21:08:44,992  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:44,992  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,46KB
2024-04-23T21:08:44,993  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:08:44,999  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:08:44,999  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:08:44,999  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:08:44,999  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:08:44,999  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:08:45,000  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:08:45,000  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:45,000  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:45,001  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:08:45,002  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:08:45,002  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:08:45,002  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:08:45,002  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:08:45,002  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int,col3:int>
2024-04-23T21:08:45,002  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:08:45,002  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:08:45,003  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:08:45,003  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:08:45,003  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, 
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 3. abort - false
2024-04-23T21:08:45,004  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:3, RECORDS_OUT_OPERATOR_RS_4:3, 
2024-04-23T21:08:45,005  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:45,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:08:45,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:08:45,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 51; bufvoid = 104857600
2024-04-23T21:08:45,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214388(104857552); length = 9/6553600
2024-04-23T21:08:45,016  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:08:45,019  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local967253188_0069_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:45,020  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:08:45,020  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local967253188_0069_m_000000_0' done.
2024-04-23T21:08:45,020  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local967253188_0069_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1558374
		FILE: Number of bytes written=86569316
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=3
		Map output bytes=51
		Map output materialized bytes=69
		Input split bytes=361
		Combine input records=0
		Spilled Records=3
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1942487040
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=3
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=3
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=3
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=3
	File Input Format Counters 
		Bytes Read=5520
2024-04-23T21:08:45,020  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local967253188_0069_m_000000_0
2024-04-23T21:08:45,020  INFO [Thread-5848] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:08:45,021  INFO [Thread-5848] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:08:45,022  INFO [pool-339-thread-1] mapred.LocalJobRunner: Starting task: attempt_local967253188_0069_r_000000_0
2024-04-23T21:08:45,022  INFO [pool-339-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:45,022  INFO [pool-339-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@304fda7a
2024-04-23T21:08:45,022  WARN [pool-339-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:45,023  INFO [pool-339-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1359740928, maxSingleShuffleLimit=339935232, mergeThreshold=897429056, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:45,024  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local967253188_0069_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:45,026  INFO [localfetcher#93] reduce.LocalFetcher: localfetcher#93 about to shuffle output of map attempt_local967253188_0069_m_000000_0 decomp: 21 len: 25 to MEMORY
2024-04-23T21:08:45,026  INFO [localfetcher#93] reduce.InMemoryMapOutput: Read 21 bytes from map-output for attempt_local967253188_0069_m_000000_0
2024-04-23T21:08:45,026  INFO [localfetcher#93] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 21, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->21
2024-04-23T21:08:45,027  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:45,027  INFO [pool-339-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:45,027  INFO [pool-339-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:45,034  INFO [pool-339-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:45,034  INFO [pool-339-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T21:08:45,036  INFO [pool-339-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 21 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:45,036  INFO [pool-339-thread-1] reduce.MergeManagerImpl: Merging 1 files, 25 bytes from disk
2024-04-23T21:08:45,036  INFO [pool-339-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:45,036  INFO [pool-339-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:45,036  INFO [pool-339-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T21:08:45,037  INFO [pool-339-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:45,037  INFO [pool-339-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:45,038  INFO [pool-339-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local967253188_0069/job_local967253188_0069.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@523ce813
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:45,039  INFO [pool-339-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:08:45,040  INFO [pool-339-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:08:45,040  INFO [pool-339-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:08:45,047  INFO [pool-339-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:08:45,052  INFO [pool-339-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:08:45,052  INFO [pool-339-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:45,052  INFO [pool-339-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:08:45,052  INFO [pool-339-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:08:45,054  INFO [pool-339-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:08:45,065  INFO [pool-339-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.target:1, 
2024-04-23T21:08:45,065  INFO [pool-339-thread-1] mapred.Task: Task:attempt_local967253188_0069_r_000000_0 is done. And is in the process of committing
2024-04-23T21:08:45,066  INFO [pool-339-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:45,066  INFO [pool-339-thread-1] mapred.Task: Task 'attempt_local967253188_0069_r_000000_0' done.
2024-04-23T21:08:45,066  INFO [pool-339-thread-1] mapred.Task: Final Counters for attempt_local967253188_0069_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1564750
		FILE: Number of bytes written=86570397
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=25
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1942487040
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:45,066  INFO [pool-339-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local967253188_0069_r_000000_0
2024-04-23T21:08:45,066  INFO [pool-339-thread-1] mapred.LocalJobRunner: Starting task: attempt_local967253188_0069_r_000001_0
2024-04-23T21:08:45,066  INFO [pool-339-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:45,067  INFO [pool-339-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@51fe1d0d
2024-04-23T21:08:45,067  WARN [pool-339-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:45,067  INFO [pool-339-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1359740928, maxSingleShuffleLimit=339935232, mergeThreshold=897429056, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:45,068  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local967253188_0069_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:45,071  INFO [localfetcher#94] reduce.LocalFetcher: localfetcher#94 about to shuffle output of map attempt_local967253188_0069_m_000000_0 decomp: 40 len: 44 to MEMORY
2024-04-23T21:08:45,071  INFO [localfetcher#94] reduce.InMemoryMapOutput: Read 40 bytes from map-output for attempt_local967253188_0069_m_000000_0
2024-04-23T21:08:45,071  INFO [localfetcher#94] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 40, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->40
2024-04-23T21:08:45,072  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:45,072  INFO [pool-339-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:45,072  INFO [pool-339-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:45,078  INFO [pool-339-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:45,078  INFO [pool-339-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T21:08:45,080  INFO [pool-339-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 40 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:45,080  INFO [pool-339-thread-1] reduce.MergeManagerImpl: Merging 1 files, 44 bytes from disk
2024-04-23T21:08:45,080  INFO [pool-339-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:45,080  INFO [pool-339-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:45,080  INFO [pool-339-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T21:08:45,080  INFO [pool-339-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:45,081  INFO [pool-339-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:45,081  INFO [pool-339-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T21:08:45,082  INFO [pool-339-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:45,082  INFO [pool-339-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:08:45,082  INFO [pool-339-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:08:45,082  INFO [pool-339-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:08:45,082  INFO [pool-339-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local967253188_0069/job_local967253188_0069.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@37b112cb
2024-04-23T21:08:45,083  INFO [pool-339-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:45,083  INFO [pool-339-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:45,083  INFO [pool-339-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:08:45,083  INFO [pool-339-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:08:45,083  INFO [pool-339-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:08:45,088  INFO [pool-339-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:08:45,088  INFO [pool-339-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:08:45,088  INFO [pool-339-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:08:45,088  INFO [pool-339-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:08:45,088  INFO [pool-339-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:08:45,089  INFO [pool-339-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:08:45,098  INFO [pool-339-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.target:2, RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T21:08:45,098  INFO [pool-339-thread-1] mapred.Task: Task:attempt_local967253188_0069_r_000001_0 is done. And is in the process of committing
2024-04-23T21:08:45,099  INFO [pool-339-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:45,099  INFO [pool-339-thread-1] mapred.Task: Task 'attempt_local967253188_0069_r_000001_0' done.
2024-04-23T21:08:45,099  INFO [pool-339-thread-1] mapred.Task: Final Counters for attempt_local967253188_0069_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1571120
		FILE: Number of bytes written=86571516
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=44
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1942487040
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:45,099  INFO [pool-339-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local967253188_0069_r_000001_0
2024-04-23T21:08:45,099  INFO [Thread-5848] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:08:45,991 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:08:45,991  INFO [main] exec.Task: 2024-04-23 21:08:45,991 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local967253188_0069
2024-04-23T21:08:45,993  INFO [main] exec.Task: Ended Job = job_local967253188_0069
2024-04-23T21:08:45,995  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:08:45,995  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:08:45,996  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:08:45,996  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:08:45,997  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000
2024-04-23T21:08:45,999  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.target
2024-04-23T21:08:46,000  INFO [main] exec.Task: Loading data to table default.target from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:46,000  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:46,008  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:46,014  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,015  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T21:08:46,040  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:08:46,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:46,046  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,046  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:08:46,046  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-44_530_9138520114271378790-1/-mr-10000
2024-04-23T21:08:46,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:46,053  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,064  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:08:46,064  INFO [main] FileOperations: Read stats for default.target/, numRows, true, 3, false: 
2024-04-23T21:08:46,064  INFO [main] FileOperations: Read stats for default.target/, rawDataSize, true, 0, false: 
2024-04-23T21:08:46,065  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T21:08:46,083  INFO [main] FileOperations: Read stats for default.target/, insertCount, true, 3, false: 
2024-04-23T21:08:46,083  INFO [main] FileOperations: Read stats for default.target/, updateCount, true, 0, false: 
2024-04-23T21:08:46,083  INFO [main] FileOperations: Read stats for default.target/, deleteCount, true, 0, false: 
2024-04-23T21:08:46,085  INFO [main] stats.BasicStatsTask: Table default.target stats: [numFiles=2, numRows=3, totalSize=1460, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:08:46,086  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:46,086  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, getTable_(GetTableRequest)=25, alter_table_(String, String, String, Table, EnvironmentContext, String)=43}
MapReduce Jobs Launched: 
2024-04-23T21:08:46,086  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:08:46,086  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:46,087  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:46,087  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1); Time taken: 1.389 seconds
2024-04-23T21:08:46,087  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210844_3c641151-34fd-4010-ae83-c03344e412b1
2024-04-23T21:08:46,097  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:46,098  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:08:46,098  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into source  values(1,7),(3,8)
2024-04-23T21:08:46,098  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-44_530_9138520114271378790-1
2024-04-23T21:08:46,099  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-44_530_9138520114271378790-1 on fs with scheme file
2024-04-23T21:08:46,099  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83): insert into source  values(1,7),(3,8)
2024-04-23T21:08:46,102  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-23T21:08:46,102  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:08:46,102  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:46,102  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:46,105  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:46,128  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,129  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:46,129  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:46,129  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:46,129  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:46,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:46,136  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,137  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:46,137  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:46,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:46,204  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:46,204  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:46,204  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:46,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:46,208  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:46,208  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:46,208  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:46,208  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:46,217  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,218  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1
2024-04-23T21:08:46,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.source	
2024-04-23T21:08:46,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.source	
2024-04-23T21:08:46,223  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:08:46,225  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:08:46,226  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:46,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:46,242  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,243  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T21:08:46,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:46,251  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:46,266  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:46,266  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:08:46,266  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:08:46,266  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:08:46,266  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:08:46,266  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:08:46,266  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:08:46,267  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:08:46,267  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:46,267  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:46,267  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:08:46,267  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:46,267  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=4, getNotNullConstraints_(NotNullConstraintsRequest)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=5, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0, getTable_(GetTableRequest)=56}
2024-04-23T21:08:46,267  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83); Time taken: 0.168 seconds
2024-04-23T21:08:46,268  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83
2024-04-23T21:08:46,268  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83
2024-04-23T21:08:46,282  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:08:46,282  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:08:46,282  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83): insert into source  values(1,7),(3,8)
2024-04-23T21:08:46,283  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83
2024-04-23T21:08:46,283  INFO [main] ql.Driver: Query ID = alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83
Total jobs = 3
2024-04-23T21:08:46,283  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-23T21:08:46,283  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-23T21:08:46,406  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:08:46,406  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:08:46,409  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:46,409  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:08:46,409  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-46_099_4903255001430025627-1/dummy_path
2024-04-23T21:08:46,418  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:46,419  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,99KB
2024-04-23T21:08:46,420  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:46,423  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-46_099_4903255001430025627-1/-mr-10001
2024-04-23T21:08:46,427  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:46,434  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:46,438  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:46,439  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:08:46,439  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:08:46,439  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-46_099_4903255001430025627-1/dummy_path
2024-04-23T21:08:46,439  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:46,456  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:46,474  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1596951253_0070
2024-04-23T21:08:46,474  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:46,534  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:46,534  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:46,535  INFO [Thread-5922] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:46,535  INFO [Thread-5922] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:46,536  INFO [Thread-5922] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:46,536  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1596951253_0070_m_000000_0
2024-04-23T21:08:46,537  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:46,537  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-46_099_4903255001430025627-1/dummy_path/null:0+1
2024-04-23T21:08:46,538  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:46,538  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,99KB
2024-04-23T21:08:46,538  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:08:46,539  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:46,539  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:08:46,540  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@4f18b5fe, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@47761a9, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [key, data] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@1e037713
2024-04-23T21:08:46,541  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1/_tmp.-ext-10002/000000_0
2024-04-23T21:08:46,541  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:08:46,541  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1/_tmp.-ext-10002/000000_0
2024-04-23T21:08:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:08:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:08:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:08:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:08:46,548  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:08:46,549  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:08:46,554  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.source:2, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-23T21:08:46,555  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:46,555  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1596951253_0070_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:46,555  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:08:46,555  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1596951253_0070_m_000000_0' done.
2024-04-23T21:08:46,556  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1596951253_0070_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1578213
		FILE: Number of bytes written=87819461
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1942487040
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.source=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6054
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:46,556  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1596951253_0070_m_000000_0
2024-04-23T21:08:46,556  INFO [Thread-5922] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:08:46,572  INFO [Metastore Scheduled Worker 4] metastore.HMSHandler: 10: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:08:46,572  INFO [Metastore Scheduled Worker 4] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@472598ac, with PersistenceManager: null will be shutdown
2024-04-23T21:08:46,573  INFO [Metastore Scheduled Worker 4] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@472598ac, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5cdff0cb created in the thread with id: 48
2024-04-23T21:08:46,596  INFO [Metastore Scheduled Worker 4] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@472598ac from thread id: 48
2024-04-23 21:08:47,536 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:08:47,536  INFO [main] exec.Task: 2024-04-23 21:08:47,536 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1596951253_0070
2024-04-23T21:08:47,537  INFO [main] exec.Task: Ended Job = job_local1596951253_0070
2024-04-23T21:08:47,541  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T21:08:47,541  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T21:08:47,541  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T21:08:47,541  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T21:08:47,541  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1/-ext-10000
2024-04-23T21:08:47,541  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1/-ext-10002
2024-04-23T21:08:47,542  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.source
2024-04-23T21:08:47,542  INFO [main] exec.Task: Loading data to table default.source from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1/-ext-10000
2024-04-23T21:08:47,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:47,550  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,550  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:47,558  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,559  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T21:08:47,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T21:08:47,582  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:08:47,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:47,590  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,590  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:08:47,590  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-46_099_4903255001430025627-1/-mr-10001
2024-04-23T21:08:47,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:47,600  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,600  INFO [main] FileOperations: Read stats for default.source/, numRows, true, 2, false: 
2024-04-23T21:08:47,600  INFO [main] FileOperations: Read stats for default.source/, rawDataSize, true, 6, false: 
2024-04-23T21:08:47,600  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T21:08:47,600  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T21:08:47,621  INFO [main] stats.BasicStatsTask: Table default.source stats: [numFiles=1, numRows=2, totalSize=8, rawDataSize=6, numFilesErasureCoded=0]
2024-04-23T21:08:47,622  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:47,622  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=32, isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=44}
MapReduce Jobs Launched: 
2024-04-23T21:08:47,622  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:08:47,622  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:47,622  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:47,622  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83); Time taken: 1.34 seconds
2024-04-23T21:08:47,622  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210846_09195452-8665-4003-9606-4ba637e0bd83
2024-04-23T21:08:47,627  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:08:47,633  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:47,633  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:08:47,634  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T21:08:47,634  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1
2024-04-23T21:08:47,634  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-46_099_4903255001430025627-1 on fs with scheme file
2024-04-23T21:08:47,634  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-46_099_4903255001430025627-1
2024-04-23T21:08:47,635  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-46_099_4903255001430025627-1 on fs with scheme file
2024-04-23T21:08:47,636  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210847_0e592970-e5ca-48aa-a57d-1340b28dfe2b): merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T21:08:47,639  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T21:08:47,639  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:08:47,640  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:08:47,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:47,646  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T21:08:47,651  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/7c199f91-1cd3-46b7-bcfa-20a233429e07/_tmp_space.db/merge_tmp_table
2024-04-23T21:08:47,654  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)> as 
<FROM
  `default`.`target` `t`
  RIGHT OUTER JOIN
  (select `curMatch`.*, case when `splitTable`.`op` is null or `splitTable`.`op` = 0 then 0 else 1 end `o/p\n` from (select `s`.*, case when `t`.`cur` is null then 0 else 1 end `m` from `source` `s` left outer join (select * from `target` where `target`.`cur`=1) `t` on `s`.`key`=`t`.`key`) `curMatch` left outer join `splitTable` on `curMatch`.`m`=1) `s`
  ON `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
INSERT INTO `default`.`target`    -- update clause(insert part)
 SELECT `t`.`key`, `t`.`data`, 0
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
INSERT INTO `default`.`target`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`target`    -- insert clause
  SELECT `s`.`key`,`s`.`data`,1
   WHERE `t`.`key` IS NULL AND `t`.`cur` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1 GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:08:47,655  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:08:47,659  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:47,660  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:47,666  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,667  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,667  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,668  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:47,675  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,676  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,676  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:47,684  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,684  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,684  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,685  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,685  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,685  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,685  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,685  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:47,692  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,692  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:47,698  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:47,704  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,704  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:47,704  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:47,706  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,706  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,706  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,706  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,706  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,706  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,706  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:47,707  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:47,707  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,707  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,707  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,707  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:47,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T21:08:47,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-23T21:08:47,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.splittable	
2024-04-23T21:08:47,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T21:08:47,829  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:08:47,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:47,838  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:47,846  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.target	
2024-04-23T21:08:47,856  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: cur, data, key
No Stats for default@target, Columns: cur, data, key
2024-04-23T21:08:47,857  INFO [main] SessionState: No Stats for default@target, Columns: cur, data, key
2024-04-23T21:08:47,857  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:08:47,858  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:47,871  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:47,882  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.source	
2024-04-23T21:08:47,896  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: key, data
No Stats for default@source, Columns: key, data
2024-04-23T21:08:47,896  INFO [main] SessionState: No Stats for default@source, Columns: key, data
2024-04-23T21:08:47,897  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 2], allowMissingStats: true
2024-04-23T21:08:47,898  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: key, cur
No Stats for default@target, Columns: key, cur
2024-04-23T21:08:47,898  INFO [main] SessionState: No Stats for default@target, Columns: key, cur
2024-04-23T21:08:47,899  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.splittable, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:08:47,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:47,911  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,911  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T21:08:47,921  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:47,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.splittable	
2024-04-23T21:08:47,933  WARN [main] calcite.RelOptHiveTable: No Stats for default@splittable, Columns: op
No Stats for default@splittable, Columns: op
2024-04-23T21:08:47,933  INFO [main] SessionState: No Stats for default@splittable, Columns: op
2024-04-23T21:08:48,190  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:48,191  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:48,192  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:48,198  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:48,205  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:48,212  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,221 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:08:48,222 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:08:48,223  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:08:48,223 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:08:48,223  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,223  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=97, isCompatibleWith_(Configuration)=4, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=18, flushCache_()=0, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=66, openTxn_(String, TxnType)=2, createTable_(Table)=2}
2024-04-23T21:08:48,224  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210847_0e592970-e5ca-48aa-a57d-1340b28dfe2b); Time taken: 0.588 seconds
2024-04-23T21:08:48,224  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:08:48,228  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,236  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:48,237  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/7c199f91-1cd3-46b7-bcfa-20a233429e07/hive_2024-04-23_21-08-47_654_2771146191032289777-1
2024-04-23T21:08:48,237  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528): drop table if exists acidTbl
2024-04-23T21:08:48,239  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T21:08:48,240  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:08:48,241  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:48,247  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,247  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,247  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,247  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,247  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=12, openTxn_(String, TxnType)=3, flushCache_()=0}
2024-04-23T21:08:48,247  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528); Time taken: 0.01 seconds
2024-04-23T21:08:48,248  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528
2024-04-23T21:08:48,248  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528
2024-04-23T21:08:48,264  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:08:48,264  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:48,265  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528): drop table if exists acidTbl
2024-04-23T21:08:48,265  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:48,271  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,271  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:48,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:48,392  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,392  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=121, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:48,392  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528); Time taken: 0.127 seconds
2024-04-23T21:08:48,392  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_0da89c3f-c962-4b6d-b1f2-5aacc4edb528
2024-04-23T21:08:48,397  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:08:48,405  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,405  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:08:48,406  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:48,406  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97): drop table if exists acidTblPart
2024-04-23T21:08:48,416  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T21:08:48,416  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:08:48,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:48,434  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,434  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,434  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,434  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, flushCache_()=0, openTxn_(String, TxnType)=10, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=17}
2024-04-23T21:08:48,434  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97); Time taken: 0.028 seconds
2024-04-23T21:08:48,435  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97
2024-04-23T21:08:48,435  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97
2024-04-23T21:08:48,452  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:08:48,452  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:48,452  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97): drop table if exists acidTblPart
2024-04-23T21:08:48,452  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:48,459  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:48,465  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:48,508  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,508  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=49, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T21:08:48,508  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97); Time taken: 0.056 seconds
2024-04-23T21:08:48,509  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_a3bb8340-c74a-4301-917d-d11ab1865f97
2024-04-23T21:08:48,514  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T21:08:48,522  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,522  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T21:08:48,523  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:48,523  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_331bd021-c77e-4ad2-9056-40bc7741444a): drop table if exists acidTbl2
2024-04-23T21:08:48,525  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T21:08:48,526  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:08:48,526  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,526  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,526  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,526  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=0}
2024-04-23T21:08:48,527  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_331bd021-c77e-4ad2-9056-40bc7741444a); Time taken: 0.003 seconds
2024-04-23T21:08:48,527  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423210848_331bd021-c77e-4ad2-9056-40bc7741444a
2024-04-23T21:08:48,527  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:48,527  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_331bd021-c77e-4ad2-9056-40bc7741444a): drop table if exists acidTbl2
2024-04-23T21:08:48,527  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,527  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:08:48,528  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-23T21:08:48,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_331bd021-c77e-4ad2-9056-40bc7741444a); Time taken: 0.001 seconds
2024-04-23T21:08:48,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_331bd021-c77e-4ad2-9056-40bc7741444a
2024-04-23T21:08:48,534  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:08:48,542  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,542  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:08:48,543  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:48,543  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:48,546  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T21:08:48,546  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T21:08:48,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:48,573  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,573  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,573  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,573  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,573  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, getTable_(GetTableRequest)=26, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:48,573  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f); Time taken: 0.03 seconds
2024-04-23T21:08:48,573  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f
2024-04-23T21:08:48,574  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f
2024-04-23T21:08:48,591  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:08:48,591  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:48,591  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:48,591  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:48,599  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,600  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:48,608  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:48,670  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,670  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=71, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T21:08:48,671  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f); Time taken: 0.079 seconds
2024-04-23T21:08:48,671  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_7dede1ee-1792-454f-82b6-5b4858ddf94f
2024-04-23T21:08:48,675  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T21:08:48,682  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,682  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T21:08:48,683  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:48,683  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:48,685  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 23
2024-04-23T21:08:48,686  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T21:08:48,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:48,694  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,694  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,694  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,694  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,694  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:08:48,695  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9); Time taken: 0.011 seconds
2024-04-23T21:08:48,695  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:27 for queryId=alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9
2024-04-23T21:08:48,695  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9
2024-04-23T21:08:48,711  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:08:48,711  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:48,711  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:48,711  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,711  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:48,719  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:48,727  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:48,755  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,755  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=36, getTable_(GetTableRequest)=8}
2024-04-23T21:08:48,756  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9); Time taken: 0.044 seconds
2024-04-23T21:08:48,756  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_d70f0175-8b3b-494b-bd61-f55b46db29f9
2024-04-23T21:08:48,760  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T21:08:48,767  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,767  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T21:08:48,768  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:48,768  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad): drop table if exists nonAcidNonBucket
2024-04-23T21:08:48,770  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 23
2024-04-23T21:08:48,770  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T21:08:48,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:48,779  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,779  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,779  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,779  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,779  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=2}
2024-04-23T21:08:48,779  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad); Time taken: 0.011 seconds
2024-04-23T21:08:48,779  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad
2024-04-23T21:08:48,780  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad
2024-04-23T21:08:48,798  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:08:48,798  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:48,798  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad): drop table if exists nonAcidNonBucket
2024-04-23T21:08:48,798  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:48,806  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:48,814  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:48,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:48,843  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,843  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=37}
2024-04-23T21:08:48,843  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad); Time taken: 0.045 seconds
2024-04-23T21:08:48,844  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_e107fd50-7fe6-4b85-857a-f0587a44d7ad
2024-04-23T21:08:48,848  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T21:08:48,855  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,855  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T21:08:48,856  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeType2SCD02" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="5.457">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:08:48,920  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:08:48,922  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 4f47e161-869d-401c-83f3-650e241c82d7
2024-04-23T21:08:48,924  INFO [main] SessionState: Hive Session ID = 4f47e161-869d-401c-83f3-650e241c82d7
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:48,925  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:48,930  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4f47e161-869d-401c-83f3-650e241c82d7
2024-04-23T21:08:48,932  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7
2024-04-23T21:08:48,935  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4f47e161-869d-401c-83f3-650e241c82d7/_tmp_space.db
2024-04-23T21:08:48,935  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=4f47e161-869d-401c-83f3-650e241c82d7, clientType=HIVECLI]
2024-04-23T21:08:48,935  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:48,936  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_4f2dd949-4446-4e3d-b5ac-35e72ead102f): drop table if exists acidTbl
2024-04-23T21:08:48,945  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:08:48,945  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:08:48,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:48,955  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,955  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=9}
2024-04-23T21:08:48,955  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_4f2dd949-4446-4e3d-b5ac-35e72ead102f); Time taken: 0.019 seconds
2024-04-23T21:08:48,956  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210848_4f2dd949-4446-4e3d-b5ac-35e72ead102f
2024-04-23T21:08:48,956  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:48,956  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_4f2dd949-4446-4e3d-b5ac-35e72ead102f): drop table if exists acidTbl
2024-04-23T21:08:48,956  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,956  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:48,959  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,959  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:48,959  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_4f2dd949-4446-4e3d-b5ac-35e72ead102f); Time taken: 0.003 seconds
2024-04-23T21:08:48,959  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_4f2dd949-4446-4e3d-b5ac-35e72ead102f
2024-04-23T21:08:48,965  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:08:48,973  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,973  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:08:48,973  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:48,974  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210848_7d303e83-916f-4bf0-a179-c622d4dd3d76): drop table if exists acidTblPart
2024-04-23T21:08:48,976  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:08:48,976  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:08:48,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:48,979  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:48,979  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:48,979  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:48,979  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=14}
2024-04-23T21:08:48,980  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210848_7d303e83-916f-4bf0-a179-c622d4dd3d76); Time taken: 0.005 seconds
2024-04-23T21:08:48,980  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210848_7d303e83-916f-4bf0-a179-c622d4dd3d76
2024-04-23T21:08:48,980  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:48,980  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210848_7d303e83-916f-4bf0-a179-c622d4dd3d76): drop table if exists acidTblPart
2024-04-23T21:08:48,980  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:48,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:48,983  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:48,983  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:48,983  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210848_7d303e83-916f-4bf0-a179-c622d4dd3d76); Time taken: 0.003 seconds
2024-04-23T21:08:48,983  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210848_7d303e83-916f-4bf0-a179-c622d4dd3d76
2024-04-23T21:08:48,990  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:08:48,999  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:48,999  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:08:48,999  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:49,000  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_99116aa0-3122-44a2-8436-4a1de076a1eb): drop table if exists acidTbl2
2024-04-23T21:08:49,002  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:08:49,002  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:08:49,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:49,005  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,005  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,005  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,006  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:08:49,006  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_99116aa0-3122-44a2-8436-4a1de076a1eb); Time taken: 0.005 seconds
2024-04-23T21:08:49,006  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210849_99116aa0-3122-44a2-8436-4a1de076a1eb
2024-04-23T21:08:49,006  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:49,006  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_99116aa0-3122-44a2-8436-4a1de076a1eb): drop table if exists acidTbl2
2024-04-23T21:08:49,006  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,006  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:49,009  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,009  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:49,010  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_99116aa0-3122-44a2-8436-4a1de076a1eb); Time taken: 0.003 seconds
2024-04-23T21:08:49,010  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_99116aa0-3122-44a2-8436-4a1de076a1eb
2024-04-23T21:08:49,016  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:08:49,023  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,023  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:08:49,023  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:49,024  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_a0b1af33-8dba-40d1-9b7e-6dcbc9df2721): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:49,026  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:08:49,026  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:08:49,027  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:49,029  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,029  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,029  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,030  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-23T21:08:49,030  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_a0b1af33-8dba-40d1-9b7e-6dcbc9df2721); Time taken: 0.005 seconds
2024-04-23T21:08:49,030  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210849_a0b1af33-8dba-40d1-9b7e-6dcbc9df2721
2024-04-23T21:08:49,030  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:49,030  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_a0b1af33-8dba-40d1-9b7e-6dcbc9df2721): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:49,030  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:49,033  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,033  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:49,033  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_a0b1af33-8dba-40d1-9b7e-6dcbc9df2721); Time taken: 0.003 seconds
2024-04-23T21:08:49,034  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_a0b1af33-8dba-40d1-9b7e-6dcbc9df2721
2024-04-23T21:08:49,040  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:08:49,046  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,046  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:08:49,047  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:49,047  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_5fd29b91-f578-4a4e-ab96-7e6176e03734): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:49,049  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:08:49,050  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:08:49,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:49,053  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,053  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,053  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,053  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:08:49,053  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_5fd29b91-f578-4a4e-ab96-7e6176e03734); Time taken: 0.006 seconds
2024-04-23T21:08:49,054  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210849_5fd29b91-f578-4a4e-ab96-7e6176e03734
2024-04-23T21:08:49,054  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:49,054  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_5fd29b91-f578-4a4e-ab96-7e6176e03734): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:49,054  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:49,057  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,057  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:49,057  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_5fd29b91-f578-4a4e-ab96-7e6176e03734); Time taken: 0.003 seconds
2024-04-23T21:08:49,057  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_5fd29b91-f578-4a4e-ab96-7e6176e03734
2024-04-23T21:08:49,064  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:08:49,071  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,071  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:08:49,071  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:49,072  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_6bf848c1-efac-4610-b32c-bc7c89854fb9): drop table if exists nonAcidNonBucket
2024-04-23T21:08:49,074  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:08:49,074  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:08:49,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:49,077  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,077  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,077  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,077  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1}
2024-04-23T21:08:49,078  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_6bf848c1-efac-4610-b32c-bc7c89854fb9); Time taken: 0.005 seconds
2024-04-23T21:08:49,078  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210849_6bf848c1-efac-4610-b32c-bc7c89854fb9
2024-04-23T21:08:49,078  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:49,078  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_6bf848c1-efac-4610-b32c-bc7c89854fb9): drop table if exists nonAcidNonBucket
2024-04-23T21:08:49,078  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,078  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:49,081  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,081  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:49,082  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_6bf848c1-efac-4610-b32c-bc7c89854fb9); Time taken: 0.003 seconds
2024-04-23T21:08:49,082  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_6bf848c1-efac-4610-b32c-bc7c89854fb9
2024-04-23T21:08:49,088  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:08:49,095  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,095  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:08:49,096  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,096  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,098  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:08:49,099  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:08:49,099  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:49,099  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:49,107  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:08:49,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:49,109  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:49,109  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,109  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,109  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,109  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=8, commitTxn_(CommitTxnRequest)=14, getDatabase_(String)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:08:49,109  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3); Time taken: 0.013 seconds
2024-04-23T21:08:49,110  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3
2024-04-23T21:08:49,110  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3
2024-04-23T21:08:49,131  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:08:49,131  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:49,132  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,132  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,133  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, transactional=true, totalSize=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:49,138  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:08:49,182  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,182  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=49, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:49,182  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3); Time taken: 0.05 seconds
2024-04-23T21:08:49,182  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_03dc2c0c-c82d-4a5c-aef6-b629706bf1f3
2024-04-23T21:08:49,187  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:08:49,195  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,196  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:08:49,197  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,197  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,200  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:08:49,200  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:08:49,200  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:49,200  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:49,203  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:08:49,203  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:49,206  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:49,206  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,206  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,206  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,206  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=15, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:49,206  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436); Time taken: 0.009 seconds
2024-04-23T21:08:49,207  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436
2024-04-23T21:08:49,207  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436
2024-04-23T21:08:49,223  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:08:49,223  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:49,224  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,224  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:49,230  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:08:49,252  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,252  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=27}
2024-04-23T21:08:49,252  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436); Time taken: 0.028 seconds
2024-04-23T21:08:49,252  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_205faa41-18cf-4d65-93e4-70493c52e436
2024-04-23T21:08:49,260  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:08:49,271  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,271  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:08:49,272  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,272  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,276  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:08:49,276  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:08:49,277  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:49,277  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:49,280  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:08:49,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:49,283  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:49,283  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,283  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,283  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,283  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=20, getDatabase_(String)=3, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:08:49,284  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06); Time taken: 0.011 seconds
2024-04-23T21:08:49,284  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06
2024-04-23T21:08:49,284  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06
2024-04-23T21:08:49,308  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:08:49,308  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:49,308  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,308  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFiles=0, bucketing_version=2, totalSize=0, numRows=0, rawDataSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:49,317  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:08:49,337  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,338  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=28}
2024-04-23T21:08:49,338  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06); Time taken: 0.029 seconds
2024-04-23T21:08:49,338  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_fdc0d049-7a1d-410b-9ef7-6dfe0e551d06
2024-04-23T21:08:49,344  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:08:49,352  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,352  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:08:49,353  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,353  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,356  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:08:49,356  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:08:49,356  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:49,356  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:49,360  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:08:49,360  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:49,362  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:49,362  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,362  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,362  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,362  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-23T21:08:49,362  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36); Time taken: 0.009 seconds
2024-04-23T21:08:49,363  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36
2024-04-23T21:08:49,363  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36
2024-04-23T21:08:49,383  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:08:49,383  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:49,383  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,383  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, bucketing_version=2, numFiles=0, numFilesErasureCoded=0, transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:49,390  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:08:49,411  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,411  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=27}
2024-04-23T21:08:49,411  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36); Time taken: 0.028 seconds
2024-04-23T21:08:49,411  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_58a123b3-930e-4ee9-af68-c2eca4640d36
2024-04-23T21:08:49,419  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:08:49,430  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,430  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:08:49,431  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,431  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,435  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:08:49,435  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:08:49,436  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:49,436  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:49,440  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:08:49,440  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:49,443  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:49,443  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,443  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,443  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,443  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, getValidWriteIds_(List, String)=4, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=19, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=0}
2024-04-23T21:08:49,443  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322); Time taken: 0.012 seconds
2024-04-23T21:08:49,443  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322
2024-04-23T21:08:49,444  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322
2024-04-23T21:08:49,461  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:08:49,461  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:49,462  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:49,462  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,463  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4f47e161-869d-401c-83f3-650e241c82d7/_tmp_space.db/ec49f26f-657b-4e20-a4c0-cd393dbae0b9
2024-04-23T21:08:49,466  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,466  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:08:49,466  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322); Time taken: 0.004 seconds
2024-04-23T21:08:49,466  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_bcefb0fc-3563-446c-9aa8-37e459d97322
2024-04-23T21:08:49,473  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:08:49,485  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,485  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:08:49,486  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,486  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,490  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:08:49,490  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:08:49,491  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:49,491  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:49,495  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:08:49,495  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:49,497  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:49,497  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,497  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,497  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,497  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=19, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:08:49,497  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d); Time taken: 0.011 seconds
2024-04-23T21:08:49,498  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d
2024-04-23T21:08:49,498  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d
2024-04-23T21:08:49,523  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:08:49,523  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:49,523  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:49,524  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, totalSize=0, numRows=0, transactional=false, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:49,533  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:08:49,581  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,581  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=57}
2024-04-23T21:08:49,582  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d); Time taken: 0.058 seconds
2024-04-23T21:08:49,582  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_306af747-6a0a-434d-80dc-598bc15bd78d
2024-04-23T21:08:49,589  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:08:49,601  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,601  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:08:49,601  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists target
2024-04-23T21:08:49,602  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2): drop table if exists target
2024-04-23T21:08:49,604  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:08:49,604  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:08:49,605  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:49,629  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:49,629  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,629  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,629  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,629  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=19, getTable_(GetTableRequest)=24}
2024-04-23T21:08:49,629  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2); Time taken: 0.027 seconds
2024-04-23T21:08:49,630  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2
2024-04-23T21:08:49,630  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2
2024-04-23T21:08:49,653  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:08:49,654  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:49,654  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2): drop table if exists target
2024-04-23T21:08:49,654  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,654  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:49,660  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:49,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:49,667  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:49,667  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.target	
2024-04-23T21:08:49,800  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target does not exist; Force to delete it.
2024-04-23T21:08:49,800 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:49,800  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,800  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=140}
2024-04-23T21:08:49,801  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2); Time taken: 0.146 seconds
2024-04-23T21:08:49,801  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_5b7903a9-5429-492f-80cf-2728d4ba01b2
2024-04-23T21:08:49,805  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:08:49,812  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,812  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:08:49,813  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists source
2024-04-23T21:08:49,813  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa): drop table if exists source
2024-04-23T21:08:49,815  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:08:49,816  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:08:49,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:49,839  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:49,839  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,839  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,839  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,839  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=23, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:49,839  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa); Time taken: 0.026 seconds
2024-04-23T21:08:49,839  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa
2024-04-23T21:08:49,840  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa
2024-04-23T21:08:49,855  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:08:49,855  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:49,856  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa): drop table if exists source
2024-04-23T21:08:49,856  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,856  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:49,864  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:49,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:49,872  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:49,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.source	
2024-04-23T21:08:49,901  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source does not exist; Force to delete it.
2024-04-23T21:08:49,902 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source
2024-04-23T21:08:49,902  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,902  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=38}
2024-04-23T21:08:49,902  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa); Time taken: 0.046 seconds
2024-04-23T21:08:49,902  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_58fe68f2-2243-44b6-9cb3-a59bdfb376fa
2024-04-23T21:08:49,907  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:08:49,914  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:49,914  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:08:49,915  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table source (key int, data int)
2024-04-23T21:08:49,915  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5): create table source (key int, data int)
2024-04-23T21:08:49,918  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:08:49,918  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:08:49,919  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:49,919  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:49,925  INFO [main] parse.CalcitePlanner: Creating table default.source position=13
2024-04-23T21:08:49,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:49,926  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:49,926  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:49,926  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:49,927  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:49,927  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getDatabase_(String)=1, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-23T21:08:49,927  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5); Time taken: 0.012 seconds
2024-04-23T21:08:49,927  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5
2024-04-23T21:08:49,927  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5
2024-04-23T21:08:49,943  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:08:49,943  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:49,943  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5): create table source (key int, data int)
2024-04-23T21:08:49,943  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:49,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:source, dbName:default, owner:alex, createTime:1713931729, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"data":"true","key":"true"}}, numRows=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:49,949  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source
2024-04-23T21:08:49,986  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:49,986  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=42}
2024-04-23T21:08:49,986  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5); Time taken: 0.043 seconds
2024-04-23T21:08:49,986  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210849_7c26fe32-e7a0-4d4a-9222-0f354fd543a5
2024-04-23T21:08:49,991  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:08:49,998  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:50,000  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:08:50,001  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:50,001  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:50,004  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 4
2024-04-23T21:08:50,004  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:08:50,005  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:50,005  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:50,008  INFO [main] parse.CalcitePlanner: Creating table default.target position=13
2024-04-23T21:08:50,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:50,010  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:50,010  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:50,010  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:50,010  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:50,010  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-23T21:08:50,010  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0); Time taken: 0.009 seconds
2024-04-23T21:08:50,010  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0
2024-04-23T21:08:50,010  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0
2024-04-23T21:08:50,031  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:08:50,031  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:50,032  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:50,032  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:50,033  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:target, dbName:default, owner:alex, createTime:1713931730, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null), FieldSchema(name:cur, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[key], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"cur":"true","data":"true","key":"true"}}, transactional=true, numFiles=0, bucketing_version=2, totalSize=0, numRows=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:50,038  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:50,053  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:50,054  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T21:08:50,054  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0); Time taken: 0.021 seconds
2024-04-23T21:08:50,054  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210850_2917aee6-1ede-4cf5-be61-0312e3d230a0
2024-04-23T21:08:50,058  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:08:50,067  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:50,067  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:08:50,067  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T21:08:50,068  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T21:08:50,070  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 6
2024-04-23T21:08:50,070  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:08:50,071  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:50,071  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:50,074  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:50,094  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:50,095  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:50,095  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:50,095  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:50,095  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:50,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:50,101  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:50,101  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:50,101  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:50,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:50,195  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:50,195  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:50,195  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:50,196  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:50,198  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:50,198  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:50,198  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:50,198  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:50,204  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:50,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.target	
2024-04-23T21:08:50,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.target	
2024-04-23T21:08:50,216  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-23T21:08:50,216  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=target (txnIds: [17])
2024-04-23T21:08:50,217  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:08:50,220  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2]}
2024-04-23T21:08:50,220  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col1=Column[_col2], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:08:50,221  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:08:50,222  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:50,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:50,237  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:50,237  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:50,238  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:08:50,238  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:50,238  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:50,238  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null), FieldSchema(name:col3, type:int, comment:null)], properties:null)
2024-04-23T21:08:50,238  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:50,238  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=39, getNotNullConstraints_(NotNullConstraintsRequest)=2, getCheckConstraints_(CheckConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=28}
2024-04-23T21:08:50,238  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09); Time taken: 0.17 seconds
2024-04-23T21:08:50,238  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09
2024-04-23T21:08:50,238  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09
2024-04-23T21:08:50,257  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:08:50,257  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:08:50,260  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T21:08:50,260  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09
2024-04-23T21:08:50,260  INFO [main] ql.Driver: Query ID = alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09
Total jobs = 1
2024-04-23T21:08:50,260  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:08:50,260  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:08:50,391  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:08:50,391  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:08:50,391  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:08:50,391  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:08:50,391  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:08:50,391  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:08:50,391  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:08:50,391  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:08:50,393  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:50,394  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:08:50,394  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-50_067_4648645211348357875-1/dummy_path
2024-04-23T21:08:50,403  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:50,404  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,44KB
2024-04-23T21:08:50,408  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:08:50,409  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T21:08:50,410  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:50,413  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-50_067_4648645211348357875-1/-mr-10000
2024-04-23T21:08:50,415  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:50,422  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:50,427  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:50,428  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:08:50,428  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:08:50,428  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-50_067_4648645211348357875-1/dummy_path
2024-04-23T21:08:50,428  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:50,446  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:50,465  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1488939370_0071
2024-04-23T21:08:50,465  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:50,525  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:50,525  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:50,525  INFO [Thread-6001] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:50,526  INFO [Thread-6001] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:50,527  INFO [Thread-6001] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:50,527  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1488939370_0071_m_000000_0
2024-04-23T21:08:50,530  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:50,531  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-50_067_4648645211348357875-1/dummy_path/null:0+1
2024-04-23T21:08:50,533  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:50,533  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,44KB
2024-04-23T21:08:50,534  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:08:50,538  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:08:50,538  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:08:50,538  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:08:50,538  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:08:50,538  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:08:50,539  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:08:50,539  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:50,540  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:50,540  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:08:50,540  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:08:50,540  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:08:50,541  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:08:50,541  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:08:50,541  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int,col3:int>
2024-04-23T21:08:50,541  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:08:50,541  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:08:50,541  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:3, 
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 3. abort - false
2024-04-23T21:08:50,542  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:3, RECORDS_OUT_INTERMEDIATE:3, 
2024-04-23T21:08:50,545  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:50,545  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:08:50,545  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:08:50,545  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 51; bufvoid = 104857600
2024-04-23T21:08:50,545  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214388(104857552); length = 9/6553600
2024-04-23T21:08:50,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:08:50,560  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1488939370_0071_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:50,561  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:08:50,561  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1488939370_0071_m_000000_0' done.
2024-04-23T21:08:50,561  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1488939370_0071_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1584204
		FILE: Number of bytes written=89075430
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=3
		Map output bytes=51
		Map output materialized bytes=69
		Input split bytes=361
		Combine input records=0
		Spilled Records=3
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1939341312
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=3
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=3
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=3
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=3
	File Input Format Counters 
		Bytes Read=5500
2024-04-23T21:08:50,561  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1488939370_0071_m_000000_0
2024-04-23T21:08:50,561  INFO [Thread-6001] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:08:50,563  INFO [Thread-6001] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:08:50,563  INFO [pool-348-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1488939370_0071_r_000000_0
2024-04-23T21:08:50,565  INFO [pool-348-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:50,565  INFO [pool-348-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4ccd4c64
2024-04-23T21:08:50,565  WARN [pool-348-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:50,566  INFO [pool-348-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1357538944, maxSingleShuffleLimit=339384736, mergeThreshold=895975744, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:50,567  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1488939370_0071_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:50,569  INFO [localfetcher#95] reduce.LocalFetcher: localfetcher#95 about to shuffle output of map attempt_local1488939370_0071_m_000000_0 decomp: 21 len: 25 to MEMORY
2024-04-23T21:08:50,569  INFO [localfetcher#95] reduce.InMemoryMapOutput: Read 21 bytes from map-output for attempt_local1488939370_0071_m_000000_0
2024-04-23T21:08:50,569  INFO [localfetcher#95] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 21, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->21
2024-04-23T21:08:50,570  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:50,570  INFO [pool-348-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:50,570  INFO [pool-348-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:50,576  INFO [pool-348-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:50,576  INFO [pool-348-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T21:08:50,579  INFO [pool-348-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 21 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:50,579  INFO [pool-348-thread-1] reduce.MergeManagerImpl: Merging 1 files, 25 bytes from disk
2024-04-23T21:08:50,579  INFO [pool-348-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:50,579  INFO [pool-348-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:50,579  INFO [pool-348-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T21:08:50,579  INFO [pool-348-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:50,579  INFO [pool-348-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:50,580  INFO [pool-348-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T21:08:50,581  INFO [pool-348-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:50,581  INFO [pool-348-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:08:50,581  INFO [pool-348-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:08:50,581  INFO [pool-348-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:08:50,581  INFO [pool-348-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1488939370_0071/job_local1488939370_0071.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@ee5d9fe
2024-04-23T21:08:50,582  INFO [pool-348-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:50,582  INFO [pool-348-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:50,582  INFO [pool-348-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:08:50,582  INFO [pool-348-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:08:50,582  INFO [pool-348-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:08:50,590  INFO [pool-348-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:08:50,595  INFO [pool-348-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:08:50,595  INFO [pool-348-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:50,595  INFO [pool-348-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:08:50,595  INFO [pool-348-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:08:50,597  INFO [pool-348-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:08:50,610  INFO [pool-348-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.target:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T21:08:50,610  INFO [pool-348-thread-1] mapred.Task: Task:attempt_local1488939370_0071_r_000000_0 is done. And is in the process of committing
2024-04-23T21:08:50,610  INFO [pool-348-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:50,610  INFO [pool-348-thread-1] mapred.Task: Task 'attempt_local1488939370_0071_r_000000_0' done.
2024-04-23T21:08:50,610  INFO [pool-348-thread-1] mapred.Task: Final Counters for attempt_local1488939370_0071_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1590580
		FILE: Number of bytes written=89076511
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=25
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1939341312
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:50,610  INFO [pool-348-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1488939370_0071_r_000000_0
2024-04-23T21:08:50,610  INFO [pool-348-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1488939370_0071_r_000001_0
2024-04-23T21:08:50,611  INFO [pool-348-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:50,611  INFO [pool-348-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@42a27b13
2024-04-23T21:08:50,611  WARN [pool-348-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:50,612  INFO [pool-348-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1357538944, maxSingleShuffleLimit=339384736, mergeThreshold=895975744, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:50,612  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1488939370_0071_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:50,615  INFO [localfetcher#96] reduce.LocalFetcher: localfetcher#96 about to shuffle output of map attempt_local1488939370_0071_m_000000_0 decomp: 40 len: 44 to MEMORY
2024-04-23T21:08:50,615  INFO [localfetcher#96] reduce.InMemoryMapOutput: Read 40 bytes from map-output for attempt_local1488939370_0071_m_000000_0
2024-04-23T21:08:50,615  INFO [localfetcher#96] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 40, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->40
2024-04-23T21:08:50,616  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:50,616  INFO [pool-348-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:50,616  INFO [pool-348-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:50,622  INFO [pool-348-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:50,622  INFO [pool-348-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T21:08:50,625  INFO [pool-348-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 40 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:50,625  INFO [pool-348-thread-1] reduce.MergeManagerImpl: Merging 1 files, 44 bytes from disk
2024-04-23T21:08:50,625  INFO [pool-348-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:50,625  INFO [pool-348-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:50,625  INFO [pool-348-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T21:08:50,625  INFO [pool-348-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:50,626  INFO [pool-348-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:50,626  INFO [pool-348-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T21:08:50,627  INFO [pool-348-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:50,627  INFO [pool-348-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:08:50,627  INFO [pool-348-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:08:50,627  INFO [pool-348-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:08:50,627  INFO [pool-348-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1488939370_0071/job_local1488939370_0071.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2bda7935
2024-04-23T21:08:50,628  INFO [pool-348-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:50,628  INFO [pool-348-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:50,628  INFO [pool-348-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:08:50,628  INFO [pool-348-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:08:50,628  INFO [pool-348-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:08:50,633  INFO [pool-348-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:08:50,634  INFO [pool-348-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:08:50,634  INFO [pool-348-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:50,634  INFO [pool-348-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:08:50,634  INFO [pool-348-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:08:50,635  INFO [pool-348-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:08:50,646  INFO [pool-348-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.target:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:50,646  INFO [pool-348-thread-1] mapred.Task: Task:attempt_local1488939370_0071_r_000001_0 is done. And is in the process of committing
2024-04-23T21:08:50,647  INFO [pool-348-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:50,647  INFO [pool-348-thread-1] mapred.Task: Task 'attempt_local1488939370_0071_r_000001_0' done.
2024-04-23T21:08:50,647  INFO [pool-348-thread-1] mapred.Task: Final Counters for attempt_local1488939370_0071_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1596950
		FILE: Number of bytes written=89077630
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=44
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1939341312
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:50,647  INFO [pool-348-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1488939370_0071_r_000001_0
2024-04-23T21:08:50,647  INFO [Thread-6001] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:08:51,526 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:08:51,526  INFO [main] exec.Task: 2024-04-23 21:08:51,526 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1488939370_0071
2024-04-23T21:08:51,527  INFO [main] exec.Task: Ended Job = job_local1488939370_0071
2024-04-23T21:08:51,528  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:08:51,528  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:08:51,528  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:08:51,528  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:08:51,528  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target/_tmp.delta_0000001_0000001_0000
2024-04-23T21:08:51,530  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.target
2024-04-23T21:08:51,530  INFO [main] exec.Task: Loading data to table default.target from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/target
2024-04-23T21:08:51,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:51,537  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:51,544  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T21:08:51,585  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:08:51,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:51,591  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,591  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:08:51,592  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-50_067_4648645211348357875-1/-mr-10000
2024-04-23T21:08:51,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:51,599  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,611  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:08:51,611  INFO [main] FileOperations: Read stats for default.target/, numRows, true, 3, false: 
2024-04-23T21:08:51,611  INFO [main] FileOperations: Read stats for default.target/, rawDataSize, true, 0, false: 
2024-04-23T21:08:51,612  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T21:08:51,632  INFO [main] FileOperations: Read stats for default.target/, insertCount, true, 3, false: 
2024-04-23T21:08:51,632  INFO [main] FileOperations: Read stats for default.target/, updateCount, true, 0, false: 
2024-04-23T21:08:51,633  INFO [main] FileOperations: Read stats for default.target/, deleteCount, true, 0, false: 
2024-04-23T21:08:51,635  INFO [main] stats.BasicStatsTask: Table default.target stats: [numFiles=2, numRows=3, totalSize=1460, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:08:51,636  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:51,636  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=26, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=60}
MapReduce Jobs Launched: 
2024-04-23T21:08:51,637  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:08:51,637  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:51,637  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:51,637  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09); Time taken: 1.376 seconds
2024-04-23T21:08:51,637  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210850_eb1262f3-73d4-4918-81da-8bc434508a09
2024-04-23T21:08:51,649  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:51,649  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:08:51,650  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into source  values(1,7),(3,8)
2024-04-23T21:08:51,650  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-50_067_4648645211348357875-1
2024-04-23T21:08:51,650  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-50_067_4648645211348357875-1 on fs with scheme file
2024-04-23T21:08:51,651  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0): insert into source  values(1,7),(3,8)
2024-04-23T21:08:51,654  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:08:51,654  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:08:51,654  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:51,654  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:51,658  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:51,682  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,682  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:51,682  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:51,682  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:51,682  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:51,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:51,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,691  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:51,691  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:51,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:51,765  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:51,765  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:51,765  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:08:51,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:08:51,768  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:08:51,768  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:51,768  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:08:51,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:51,777  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,779  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1
2024-04-23T21:08:51,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.source	
2024-04-23T21:08:51,783  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.source	
2024-04-23T21:08:51,784  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:08:51,787  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:08:51,788  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:51,796  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:51,807  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,807  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T21:08:51,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:51,816  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:51,831  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:51,831  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:08:51,831  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:08:51,831  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:08:51,831  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:08:51,831  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:08:51,831  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:08:51,832  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:08:51,832  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:51,832  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:51,832  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:08:51,832  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:51,832  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getTable_(GetTableRequest)=61, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidWriteIds_(List, String)=4, getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=13, getAllTableConstraints_(AllTableConstraintsRequest)=5}
2024-04-23T21:08:51,832  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0); Time taken: 0.181 seconds
2024-04-23T21:08:51,832  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0
2024-04-23T21:08:51,832  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0
2024-04-23T21:08:51,848  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:08:51,848  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:08:51,848  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0): insert into source  values(1,7),(3,8)
2024-04-23T21:08:51,848  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0
2024-04-23T21:08:51,848  INFO [main] ql.Driver: Query ID = alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0
Total jobs = 3
2024-04-23T21:08:51,848  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-23T21:08:51,849  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-23T21:08:51,971  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:08:51,971  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:08:51,973  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:51,973  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:08:51,973  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-51_651_5076456226164426624-1/dummy_path
2024-04-23T21:08:51,982  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:51,983  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,99KB
2024-04-23T21:08:51,984  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:51,987  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-51_651_5076456226164426624-1/-mr-10001
2024-04-23T21:08:51,991  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:51,998  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:52,002  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:52,003  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:08:52,003  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:08:52,003  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-51_651_5076456226164426624-1/dummy_path
2024-04-23T21:08:52,003  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:52,020  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:52,038  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2008869805_0072
2024-04-23T21:08:52,038  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:52,110  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:52,110  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:52,110  INFO [Thread-6075] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:52,110  INFO [Thread-6075] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:52,112  INFO [Thread-6075] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:52,112  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2008869805_0072_m_000000_0
2024-04-23T21:08:52,112  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:52,113  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-51_651_5076456226164426624-1/dummy_path/null:0+1
2024-04-23T21:08:52,113  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:52,113  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,99KB
2024-04-23T21:08:52,114  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:08:52,114  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:52,114  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:08:52,115  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@56eb9c09, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@52ae3780, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [key, data] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@7e9a5d7
2024-04-23T21:08:52,116  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1/_tmp.-ext-10002/000000_0
2024-04-23T21:08:52,116  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:08:52,116  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1/_tmp.-ext-10002/000000_0
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:08:52,123  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:08:52,124  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:52,124  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:08:52,124  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:52,124  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:08:52,124  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:08:52,129  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.source:2, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-23T21:08:52,129  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:52,129  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2008869805_0072_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:52,130  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:08:52,130  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2008869805_0072_m_000000_0' done.
2024-04-23T21:08:52,130  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2008869805_0072_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1604043
		FILE: Number of bytes written=90325575
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1939341312
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.source=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6054
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:52,130  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2008869805_0072_m_000000_0
2024-04-23T21:08:52,130  INFO [Thread-6075] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:08:53,112 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:08:53,112  INFO [main] exec.Task: 2024-04-23 21:08:53,112 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local2008869805_0072
2024-04-23T21:08:53,113  INFO [main] exec.Task: Ended Job = job_local2008869805_0072
2024-04-23T21:08:53,116  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T21:08:53,116  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T21:08:53,116  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T21:08:53,116  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T21:08:53,116  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1/-ext-10000
2024-04-23T21:08:53,117  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1/-ext-10002
2024-04-23T21:08:53,117  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.source
2024-04-23T21:08:53,117  INFO [main] exec.Task: Loading data to table default.source from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1/-ext-10000
2024-04-23T21:08:53,117  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:53,125  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:53,133  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,135  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T21:08:53,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T21:08:53,155  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:08:53,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:53,163  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,163  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:08:53,163  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-51_651_5076456226164426624-1/-mr-10001
2024-04-23T21:08:53,164  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:53,172  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,172  INFO [main] FileOperations: Read stats for default.source/, numRows, true, 2, false: 
2024-04-23T21:08:53,172  INFO [main] FileOperations: Read stats for default.source/, rawDataSize, true, 6, false: 
2024-04-23T21:08:53,173  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T21:08:53,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T21:08:53,193  INFO [main] stats.BasicStatsTask: Table default.source stats: [numFiles=1, numRows=2, totalSize=8, rawDataSize=6, numFilesErasureCoded=0]
2024-04-23T21:08:53,193  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:53,194  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=40, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=32}
MapReduce Jobs Launched: 
2024-04-23T21:08:53,194  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:08:53,194  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:53,194  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:08:53,194  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0); Time taken: 1.345 seconds
2024-04-23T21:08:53,194  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210851_fc5ce435-884e-489a-bc19-ed98bc2a2ea0
2024-04-23T21:08:53,198  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:08:53,205  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:53,205  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:08:53,205  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T21:08:53,206  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-51_651_5076456226164426624-1
2024-04-23T21:08:53,207  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-51_651_5076456226164426624-1 on fs with scheme file
2024-04-23T21:08:53,207  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1
2024-04-23T21:08:53,207  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/source/.hive-staging_hive_2024-04-23_21-08-51_651_5076456226164426624-1 on fs with scheme file
2024-04-23T21:08:53,207  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210853_847e1ea7-1749-41a1-8950-18e1ed881342): merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T21:08:53,211  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 19
2024-04-23T21:08:53,211  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:08:53,212  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:08:53,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,218  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T21:08:53,222  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4f47e161-869d-401c-83f3-650e241c82d7/_tmp_space.db/merge_tmp_table
2024-04-23T21:08:53,225  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)> as 
<FROM
  `default`.`target` `t`
  RIGHT OUTER JOIN
  (select `source`.*, 0 `c` from `source` union all select `source`.*, 1 `c` from `source` inner join `target` on `source`.`key`=`target`.`key` where `target`.`cur`=1) `s`
  ON `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
INSERT INTO `default`.`target`    -- update clause(insert part)
 SELECT `t`.`key`, `t`.`data`, 0
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
INSERT INTO `default`.`target`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`target`    -- insert clause
  SELECT `s`.`key`,`s`.`data`,1
   WHERE `t`.`key` IS NULL AND `t`.`cur` IS NULL AND `t`.`cur` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1 GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:08:53,227  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:08:53,232  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:53,232  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,239  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,240  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,240  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,240  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,240  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:53,248  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,248  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,248  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,248  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,249  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,249  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,249  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,249  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,249  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,263  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,269  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,269  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:53,269  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:53,270  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,270  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,271  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-23T21:08:53,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-23T21:08:53,300  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T21:08:53,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T21:08:53,420  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:08:53,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,429  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,437  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.target	
2024-04-23T21:08:53,447  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: key, data, cur
No Stats for default@target, Columns: key, data, cur
2024-04-23T21:08:53,447  INFO [main] SessionState: No Stats for default@target, Columns: key, data, cur
2024-04-23T21:08:53,449  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:08:53,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:53,460  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,460  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T21:08:53,472  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.source	
2024-04-23T21:08:53,485  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: data, key
No Stats for default@source, Columns: data, key
2024-04-23T21:08:53,485  INFO [main] SessionState: No Stats for default@source, Columns: data, key
2024-04-23T21:08:53,486  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:08:53,487  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: key, data
No Stats for default@source, Columns: key, data
2024-04-23T21:08:53,487  INFO [main] SessionState: No Stats for default@source, Columns: key, data
2024-04-23T21:08:53,487  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 2], allowMissingStats: true
2024-04-23T21:08:53,488  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: key, cur
No Stats for default@target, Columns: key, cur
2024-04-23T21:08:53,488  INFO [main] SessionState: No Stats for default@target, Columns: key, cur
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,715  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,716  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:53,717  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,723  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,723  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,729  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T21:08:53,735  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,745 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:08:53,746 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:08:53,746  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:08:53,746 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:08:53,746  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:53,746  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=62, getAllTableConstraints_(AllTableConstraintsRequest)=21, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=8, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, createTable_(Table)=2, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=59}
2024-04-23T21:08:53,747  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210853_847e1ea7-1749-41a1-8950-18e1ed881342); Time taken: 0.539 seconds
2024-04-23T21:08:53,747  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:08:53,751  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:53,759  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:53,759  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f47e161-869d-401c-83f3-650e241c82d7/hive_2024-04-23_21-08-53_225_5970008822717150448-1
2024-04-23T21:08:53,759  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12): drop table if exists acidTbl
2024-04-23T21:08:53,762  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 19
2024-04-23T21:08:53,762  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:08:53,762  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:53,768  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,768  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:53,768  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:53,768  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:53,769  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=12, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:53,769  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12); Time taken: 0.009 seconds
2024-04-23T21:08:53,769  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12
2024-04-23T21:08:53,769  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12
2024-04-23T21:08:53,785  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:08:53,785  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:53,785  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12): drop table if exists acidTbl
2024-04-23T21:08:53,785  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:53,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:53,791  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,792  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:53,797  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,797  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:53,914  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:53,914  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=122, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:53,914  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12); Time taken: 0.129 seconds
2024-04-23T21:08:53,914  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210853_2e1bbc31-901b-496d-aee9-fdb96ea0ab12
2024-04-23T21:08:53,918  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:08:53,925  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:53,927  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:08:53,928  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:53,928  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad): drop table if exists acidTblPart
2024-04-23T21:08:53,931  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 19
2024-04-23T21:08:53,931  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:08:53,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:53,949  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,949  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:53,950  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:53,950  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:53,950  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=16, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2}
2024-04-23T21:08:53,950  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad); Time taken: 0.022 seconds
2024-04-23T21:08:53,950  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad
2024-04-23T21:08:53,951  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad
2024-04-23T21:08:53,967  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:08:53,967  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:53,967  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad): drop table if exists acidTblPart
2024-04-23T21:08:53,967  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:53,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:53,973  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:53,979  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:53,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:54,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=49, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,022  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad); Time taken: 0.055 seconds
2024-04-23T21:08:54,023  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210853_f12aaf85-1db2-4ea4-9525-4741a23241ad
2024-04-23T21:08:54,027  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:08:54,034  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:08:54,034  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:54,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_43786f71-15dd-444e-8bb9-8fb418e8c2fd): drop table if exists acidTbl2
2024-04-23T21:08:54,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 19
2024-04-23T21:08:54,037  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:08:54,038  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,038  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,038  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,038  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:08:54,038  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_43786f71-15dd-444e-8bb9-8fb418e8c2fd); Time taken: 0.003 seconds
2024-04-23T21:08:54,038  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423210854_43786f71-15dd-444e-8bb9-8fb418e8c2fd
2024-04-23T21:08:54,039  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:54,039  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_43786f71-15dd-444e-8bb9-8fb418e8c2fd): drop table if exists acidTbl2
2024-04-23T21:08:54,039  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,039  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:08:54,039  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,039  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:08:54,040  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_43786f71-15dd-444e-8bb9-8fb418e8c2fd); Time taken: 0.0 seconds
2024-04-23T21:08:54,040  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_43786f71-15dd-444e-8bb9-8fb418e8c2fd
2024-04-23T21:08:54,046  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:08:54,052  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,052  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:08:54,053  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:54,053  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:54,056  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 19
2024-04-23T21:08:54,056  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:08:54,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:54,078  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,078  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,078  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,078  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,078  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=21, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:08:54,079  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1); Time taken: 0.025 seconds
2024-04-23T21:08:54,079  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1
2024-04-23T21:08:54,079  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1
2024-04-23T21:08:54,094  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:08:54,094  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:54,094  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:54,094  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:54,102  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:54,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:54,136  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,136  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=34, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,137  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1); Time taken: 0.042 seconds
2024-04-23T21:08:54,137  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_6e3e7c31-d2b5-405d-9030-9e64ffc133f1
2024-04-23T21:08:54,141  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:08:54,148  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,148  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:08:54,149  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:54,149  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:54,151  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 19
2024-04-23T21:08:54,151  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:08:54,152  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:54,159  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,159  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,160  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,160  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,160  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=7, getValidTxns_(long)=0}
2024-04-23T21:08:54,160  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc); Time taken: 0.011 seconds
2024-04-23T21:08:54,160  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc
2024-04-23T21:08:54,161  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc
2024-04-23T21:08:54,176  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:08:54,176  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:54,176  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:54,176  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:54,185  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:54,194  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:54,220  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,221  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=34}
2024-04-23T21:08:54,221  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc); Time taken: 0.044 seconds
2024-04-23T21:08:54,221  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_dbef8850-3b3e-4be9-a17e-bc5db35051bc
2024-04-23T21:08:54,225  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T21:08:54,232  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,232  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T21:08:54,233  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:54,233  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2): drop table if exists nonAcidNonBucket
2024-04-23T21:08:54,236  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 20
2024-04-23T21:08:54,236  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:08:54,237  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:54,244  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,244  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,244  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,244  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,245  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, getTable_(GetTableRequest)=7}
2024-04-23T21:08:54,245  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2); Time taken: 0.011 seconds
2024-04-23T21:08:54,245  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2
2024-04-23T21:08:54,245  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2
2024-04-23T21:08:54,260  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:08:54,260  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:54,260  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2): drop table if exists nonAcidNonBucket
2024-04-23T21:08:54,260  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:54,268  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:54,275  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:54,303  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,303  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=35, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7}
2024-04-23T21:08:54,303  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2); Time taken: 0.043 seconds
2024-04-23T21:08:54,303  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_65d3ba4d-ad5d-4cde-a1cd-8d70c39987b2
2024-04-23T21:08:54,307  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:08:54,314  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,314  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:08:54,315  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testQuotedIdentifier2" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="10.795">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: 
merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete
 when matched and `g/h` < 0 then update set vc=''  , `d?*de e` =  `d?*de e` * j + 1  
 when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1101)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:08:54,375  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:08:54,377  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 5b7b38f0-71f7-4898-98eb-418826ab1931
2024-04-23T21:08:54,380  INFO [main] SessionState: Hive Session ID = 5b7b38f0-71f7-4898-98eb-418826ab1931
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:54,381  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:08:54,386  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931
2024-04-23T21:08:54,389  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931
2024-04-23T21:08:54,391  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db
2024-04-23T21:08:54,392  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=5b7b38f0-71f7-4898-98eb-418826ab1931, clientType=HIVECLI]
2024-04-23T21:08:54,392  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:08:54,392  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_f9980d6c-b14d-40bb-bdc0-e308e67742e4): drop table if exists acidTbl
2024-04-23T21:08:54,401  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:08:54,402  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:08:54,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:54,412  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,412  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,412  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,412  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:54,412  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_f9980d6c-b14d-40bb-bdc0-e308e67742e4); Time taken: 0.02 seconds
2024-04-23T21:08:54,412  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210854_f9980d6c-b14d-40bb-bdc0-e308e67742e4
2024-04-23T21:08:54,412  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:54,412  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_f9980d6c-b14d-40bb-bdc0-e308e67742e4): drop table if exists acidTbl
2024-04-23T21:08:54,413  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:08:54,416  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,416  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_f9980d6c-b14d-40bb-bdc0-e308e67742e4); Time taken: 0.004 seconds
2024-04-23T21:08:54,416  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_f9980d6c-b14d-40bb-bdc0-e308e67742e4
2024-04-23T21:08:54,423  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:08:54,432  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,432  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:08:54,433  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:08:54,433  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_dfab4b06-7363-45ae-b01b-ead262d9df08): drop table if exists acidTblPart
2024-04-23T21:08:54,436  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:08:54,436  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:08:54,437  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:54,445  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,445  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,445  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,445  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=17, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:08:54,446  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_dfab4b06-7363-45ae-b01b-ead262d9df08); Time taken: 0.012 seconds
2024-04-23T21:08:54,446  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210854_dfab4b06-7363-45ae-b01b-ead262d9df08
2024-04-23T21:08:54,446  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:54,446  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_dfab4b06-7363-45ae-b01b-ead262d9df08): drop table if exists acidTblPart
2024-04-23T21:08:54,446  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:08:54,449  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,449  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,449  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_dfab4b06-7363-45ae-b01b-ead262d9df08); Time taken: 0.003 seconds
2024-04-23T21:08:54,449  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_dfab4b06-7363-45ae-b01b-ead262d9df08
2024-04-23T21:08:54,456  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:08:54,464  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,464  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:08:54,465  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:08:54,465  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_dfbb13ae-efd2-4653-bb37-6a5a19e7d1ef): drop table if exists acidTbl2
2024-04-23T21:08:54,468  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:08:54,468  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:08:54,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:54,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,472  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T21:08:54,472  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_dfbb13ae-efd2-4653-bb37-6a5a19e7d1ef); Time taken: 0.006 seconds
2024-04-23T21:08:54,472  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210854_dfbb13ae-efd2-4653-bb37-6a5a19e7d1ef
2024-04-23T21:08:54,472  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:54,472  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_dfbb13ae-efd2-4653-bb37-6a5a19e7d1ef): drop table if exists acidTbl2
2024-04-23T21:08:54,472  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:08:54,475  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,475  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,475  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_dfbb13ae-efd2-4653-bb37-6a5a19e7d1ef); Time taken: 0.003 seconds
2024-04-23T21:08:54,475  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_dfbb13ae-efd2-4653-bb37-6a5a19e7d1ef
2024-04-23T21:08:54,482  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:08:54,490  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,490  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:08:54,491  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:08:54,491  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_23443c1d-6166-4dec-85eb-ce2e22297269): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:54,493  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:08:54,493  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:08:54,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:54,496  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,496  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,496  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,497  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, flushCache_()=0}
2024-04-23T21:08:54,497  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_23443c1d-6166-4dec-85eb-ce2e22297269); Time taken: 0.005 seconds
2024-04-23T21:08:54,497  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210854_23443c1d-6166-4dec-85eb-ce2e22297269
2024-04-23T21:08:54,497  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:54,497  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_23443c1d-6166-4dec-85eb-ce2e22297269): drop table if exists nonAcidOrcTbl
2024-04-23T21:08:54,497  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,497  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:08:54,500  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,500  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,500  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_23443c1d-6166-4dec-85eb-ce2e22297269); Time taken: 0.003 seconds
2024-04-23T21:08:54,500  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_23443c1d-6166-4dec-85eb-ce2e22297269
2024-04-23T21:08:54,506  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:08:54,513  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,513  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:08:54,514  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:54,514  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_94dfbd39-c30e-4007-9532-64eeef2c2a46): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:54,516  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:08:54,516  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:08:54,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:54,519  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,519  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,519  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,520  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, flushCache_()=0}
2024-04-23T21:08:54,520  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_94dfbd39-c30e-4007-9532-64eeef2c2a46); Time taken: 0.005 seconds
2024-04-23T21:08:54,520  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210854_94dfbd39-c30e-4007-9532-64eeef2c2a46
2024-04-23T21:08:54,520  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:54,520  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_94dfbd39-c30e-4007-9532-64eeef2c2a46): drop table if exists nonAcidOrcTbl2
2024-04-23T21:08:54,520  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:08:54,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,523  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_94dfbd39-c30e-4007-9532-64eeef2c2a46); Time taken: 0.003 seconds
2024-04-23T21:08:54,523  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_94dfbd39-c30e-4007-9532-64eeef2c2a46
2024-04-23T21:08:54,529  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:08:54,536  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,536  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:08:54,537  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:08:54,537  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_c6013bcc-b49d-4ba9-93d9-58eae75cc088): drop table if exists nonAcidNonBucket
2024-04-23T21:08:54,539  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:08:54,539  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:08:54,540  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:54,542  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,542  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,542  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,542  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:08:54,543  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_c6013bcc-b49d-4ba9-93d9-58eae75cc088); Time taken: 0.005 seconds
2024-04-23T21:08:54,543  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210854_c6013bcc-b49d-4ba9-93d9-58eae75cc088
2024-04-23T21:08:54,543  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:08:54,543  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_c6013bcc-b49d-4ba9-93d9-58eae75cc088): drop table if exists nonAcidNonBucket
2024-04-23T21:08:54,543  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:08:54,546  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,546  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,546  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_c6013bcc-b49d-4ba9-93d9-58eae75cc088); Time taken: 0.003 seconds
2024-04-23T21:08:54,546  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_c6013bcc-b49d-4ba9-93d9-58eae75cc088
2024-04-23T21:08:54,552  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:08:54,558  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,559  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:08:54,559  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,559  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,562  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:08:54,562  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:08:54,562  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:54,562  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:54,569  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:08:54,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:54,572  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:54,572  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,572  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,572  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,572  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=6, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getDatabase_(String)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:54,572  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f); Time taken: 0.013 seconds
2024-04-23T21:08:54,573  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f
2024-04-23T21:08:54,573  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f
2024-04-23T21:08:54,594  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:08:54,594  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:54,595  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,595  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931734, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true, numRows=0, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:54,601  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:08:54,643  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,643  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=47}
2024-04-23T21:08:54,643  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f); Time taken: 0.048 seconds
2024-04-23T21:08:54,643  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_f4ce4daf-10a7-4fdd-8366-4dae28fcbe6f
2024-04-23T21:08:54,649  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:08:54,657  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,657  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:08:54,657  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,658  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,660  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:08:54,660  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:08:54,661  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:54,661  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:54,664  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:08:54,664  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:54,666  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:54,666  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,666  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,666  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,666  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getDatabase_(String)=2}
2024-04-23T21:08:54,666  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205); Time taken: 0.008 seconds
2024-04-23T21:08:54,666  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205
2024-04-23T21:08:54,667  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205
2024-04-23T21:08:54,682  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:08:54,682  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:54,683  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,683  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931734, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:54,689  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:08:54,702  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,702  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-23T21:08:54,703  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205); Time taken: 0.019 seconds
2024-04-23T21:08:54,703  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_5b67aa16-35b8-4dee-8b60-83f2720c4205
2024-04-23T21:08:54,707  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:08:54,714  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,714  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:08:54,715  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,715  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,717  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:08:54,717  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:08:54,718  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:54,718  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:54,720  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:08:54,721  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:54,722  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:54,722  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,722  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,722  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,722  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:08:54,722  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf); Time taken: 0.007 seconds
2024-04-23T21:08:54,723  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf
2024-04-23T21:08:54,723  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf
2024-04-23T21:08:54,738  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:08:54,738  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:54,738  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,738  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931734, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, bucketing_version=2, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, transactional=false, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:54,744  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:08:54,757  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,757  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=17, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,757  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf); Time taken: 0.018 seconds
2024-04-23T21:08:54,757  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_23ad2fcd-72a1-4a2d-87d9-d3983090dedf
2024-04-23T21:08:54,761  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:08:54,768  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,768  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:08:54,769  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,769  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,771  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:08:54,772  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:08:54,772  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:54,772  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:54,775  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:08:54,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:54,777  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:54,777  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,777  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,777  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,777  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2}
2024-04-23T21:08:54,777  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8); Time taken: 0.008 seconds
2024-04-23T21:08:54,777  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8
2024-04-23T21:08:54,777  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8
2024-04-23T21:08:54,792  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:08:54,792  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:54,793  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,793  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931734, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, totalSize=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:54,798  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:08:54,812  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,812  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,812  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8); Time taken: 0.019 seconds
2024-04-23T21:08:54,812  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_52755a6f-987e-443b-8bcf-5256543a59e8
2024-04-23T21:08:54,816  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:08:54,823  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,823  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:08:54,824  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,824  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,827  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:08:54,827  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:08:54,828  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:54,828  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:54,830  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:08:54,831  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:54,832  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:54,832  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,832  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,832  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,832  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1, flushCache_()=0, getDatabase_(String)=2}
2024-04-23T21:08:54,832  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e); Time taken: 0.008 seconds
2024-04-23T21:08:54,833  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e
2024-04-23T21:08:54,833  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e
2024-04-23T21:08:54,848  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:08:54,848  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:54,849  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:54,849  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,850  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/cb732afa-ae9c-4cda-b168-dc98a6bbf45d
2024-04-23T21:08:54,853  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,853  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:54,853  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e); Time taken: 0.004 seconds
2024-04-23T21:08:54,853  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_c7543266-6737-4577-9849-8b7fb77e3a1e
2024-04-23T21:08:54,857  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:08:54,864  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,864  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:08:54,865  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,865  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,868  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:08:54,868  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:08:54,868  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:54,868  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:54,871  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:08:54,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:54,873  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:54,873  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,873  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,873  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,873  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, flushCache_()=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-23T21:08:54,873  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5); Time taken: 0.008 seconds
2024-04-23T21:08:54,873  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5
2024-04-23T21:08:54,874  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5
2024-04-23T21:08:54,889  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:08:54,889  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:54,889  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:08:54,889  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931734, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numRows=0, bucketing_version=2, transactional=false, numFilesErasureCoded=0, rawDataSize=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:54,895  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:08:54,907  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:54,907  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=17}
2024-04-23T21:08:54,907  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5); Time taken: 0.018 seconds
2024-04-23T21:08:54,907  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_b33532d5-d681-4b1d-91c5-1372859360d5
2024-04-23T21:08:54,912  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:08:54,918  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:54,918  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:08:54,919  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `aci/d_u/ami`
2024-04-23T21:08:54,919  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa): drop table if exists `aci/d_u/ami`
2024-04-23T21:08:54,921  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:08:54,922  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:08:54,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:54,942  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,942  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:54,942  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:54,942  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:54,942  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=20, isCompatibleWith_(Configuration)=1}
2024-04-23T21:08:54,942  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa); Time taken: 0.023 seconds
2024-04-23T21:08:54,942  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa
2024-04-23T21:08:54,943  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa
2024-04-23T21:08:54,962  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:08:54,962  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:54,962  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa): drop table if exists `aci/d_u/ami`
2024-04-23T21:08:54,962  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:54,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:54,969  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:54,974  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:54,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,085  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami does not exist; Force to delete it.
2024-04-23T21:08:55,085 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:55,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:55,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=116, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T21:08:55,086  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa); Time taken: 0.123 seconds
2024-04-23T21:08:55,086  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210854_32e267a1-e0ed-44b8-b5fa-5981be6dffaa
2024-04-23T21:08:55,091  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:08:55,101  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:55,103  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:08:55,104  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `src/name`
2024-04-23T21:08:55,104  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5): drop table if exists `src/name`
2024-04-23T21:08:55,107  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:08:55,108  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:08:55,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:08:55,140  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,140  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:55,140  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:55,140  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:55,140  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, getTable_(GetTableRequest)=29, commitTxn_(CommitTxnRequest)=17, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4}
2024-04-23T21:08:55,140  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5); Time taken: 0.036 seconds
2024-04-23T21:08:55,141  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5
2024-04-23T21:08:55,141  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5
2024-04-23T21:08:55,158  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:08:55,158  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:08:55,158  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5): drop table if exists `src/name`
2024-04-23T21:08:55,158  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:55,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:08:55,166  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:08:55,174  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,174  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.src/name	
2024-04-23T21:08:55,204  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/src-47-name does not exist; Force to delete it.
2024-04-23T21:08:55,204 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/src-47-name
2024-04-23T21:08:55,204  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:55,204  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=38}
2024-04-23T21:08:55,205  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5); Time taken: 0.046 seconds
2024-04-23T21:08:55,205  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210855_d19947e6-0b19-400a-921e-b11710539ab5
2024-04-23T21:08:55,209  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:08:55,217  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:55,217  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:08:55,218  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:55,218  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:55,221  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:08:55,221  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:08:55,222  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:55,222  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:55,228  INFO [main] parse.CalcitePlanner: Creating table default.aci/d_u/ami position=13
2024-04-23T21:08:55,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:55,230  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:55,230  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:55,230  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:55,230  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:55,230  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=6, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:08:55,230  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57); Time taken: 0.012 seconds
2024-04-23T21:08:55,231  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57
2024-04-23T21:08:55,231  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57
2024-04-23T21:08:55,247  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:08:55,247  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:55,248  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:08:55,248  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:55,249  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:aci/d_u/ami, dbName:default, owner:alex, createTime:1713931735, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i, type:int, comment:null), FieldSchema(name:d?*de e, type:decimal(5,2), comment:null), FieldSchema(name:vc, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[i], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"d?*de e":"true","i":"true","vc":"true"}}, bucketing_version=2, numRows=0, transactional=true, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:08:55,254  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:55,293  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:55,293  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=45}
2024-04-23T21:08:55,294  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57); Time taken: 0.045 seconds
2024-04-23T21:08:55,294  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210855_efbe6983-dbda-478d-b30f-8bb02b559e57
2024-04-23T21:08:55,298  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:08:55,306  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:55,306  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:08:55,307  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-23T21:08:55,307  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f): create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-23T21:08:55,310  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T21:08:55,310  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:08:55,311  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:08:55,311  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:08:55,314  INFO [main] parse.CalcitePlanner: Creating table default.src/name position=13
2024-04-23T21:08:55,314  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:08:55,315  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:08:55,316  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:55,316  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:08:55,316  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:55,316  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, flushCache_()=0}
2024-04-23T21:08:55,316  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f); Time taken: 0.009 seconds
2024-04-23T21:08:55,316  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f
2024-04-23T21:08:55,316  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f
2024-04-23T21:08:55,338  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:08:55,338  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:08:55,338  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f): create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-23T21:08:55,339  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:08:55,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:src/name, dbName:default, owner:alex, createTime:1713931735, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:g/h, type:int, comment:null), FieldSchema(name:j, type:decimal(5,2), comment:null), FieldSchema(name:k, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, rawDataSize=0, numFiles=0, numFilesErasureCoded=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"g/h":"true","j":"true","k":"true"}}, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:08:55,348  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/src-47-name
2024-04-23T21:08:55,366  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:08:55,367  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=26, isCompatibleWith_(Configuration)=0}
2024-04-23T21:08:55,367  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f); Time taken: 0.028 seconds
2024-04-23T21:08:55,367  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210855_c9db3897-7583-4187-b5c8-ad113a8fb27f
2024-04-23T21:08:55,372  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:08:55,380  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:08:55,380  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:08:55,380  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-23T21:08:55,381  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-23T21:08:55,386  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T21:08:55,386  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:08:55,386  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:08:55,387  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,401  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T21:08:55,406  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table
2024-04-23T21:08:55,409  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)> as 
<FROM
  `default`.`aci/d_u/ami` `d/8`
  RIGHT OUTER JOIN
  `default`.`src/name` `a/b`
  ON `i`=`g/h`
INSERT INTO `default`.`aci/d_u/ami`    -- delete clause
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` > 5
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- update clause(insert part)
 SELECT `d/8`.`i`, `d?*de e` * `j` + 1, ''
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
INSERT INTO `default`.`aci/d_u/ami`    -- update clause (delete part)
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- insert clause
  SELECT `a/b`.`g/h`,`a/b`.`j`,`a/b`.`k`
   WHERE `d/8`.`i` IS NULL AND `d?*de e` <> 0
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`d/8`.ROW__ID)
 WHERE `i`=`g/h` GROUP BY `d/8`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:08:55,411  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:08:55,416  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:08:55,416  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:55,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,426  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,427  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:08:55,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,438  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:55,438  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:55,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,446  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,454  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,454  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,461  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,468  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,468  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:08:55,468  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:08:55,468  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:55,469  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:55,469  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:55,481  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,513  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.src/name	
2024-04-23T21:08:55,547  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.aci/d_u/ami, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:08:55,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,557  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,558  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,567  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,567  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,578  WARN [main] calcite.RelOptHiveTable: No Stats for default@aci/d_u/ami, Columns: i, d?*de e
No Stats for default@aci/d_u/ami, Columns: i, d?*de e
2024-04-23T21:08:55,578  INFO [main] SessionState: No Stats for default@aci/d_u/ami, Columns: i, d?*de e
2024-04-23T21:08:55,579  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.src/name, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:08:55,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:08:55,590  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:08:55,602  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,603  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.src/name	
2024-04-23T21:08:55,617  WARN [main] calcite.RelOptHiveTable: No Stats for default@src/name, Columns: g/h, k, j
No Stats for default@src/name, Columns: g/h, k, j
2024-04-23T21:08:55,617  INFO [main] SessionState: No Stats for default@src/name, Columns: g/h, k, j
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:55,803  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:55,804  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:08:55,804  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,810  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,816  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,823  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,830  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,843  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-23T21:08:55,844  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=aci/d_u/ami (txnIds: [17])
2024-04-23T21:08:55,850  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,856  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,863  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table/.hive-staging_hive_2024-04-23_21-08-55_409_1626804205768031025-1
2024-04-23T21:08:55,867  INFO [main] parse.MergeSemanticAnalyzer: CBO Succeeded; optimized logical plan.
2024-04-23T21:08:55,882  INFO [main] optimizer.ColumnPrunerProcFactory: RS 13 oldColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,882  INFO [main] optimizer.ColumnPrunerProcFactory: RS 13 newColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,882  INFO [main] optimizer.ColumnPrunerProcFactory: RS 20 oldColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,882  INFO [main] optimizer.ColumnPrunerProcFactory: RS 20 newColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,882  INFO [main] optimizer.ColumnPrunerProcFactory: RS 26 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2], VALUE._col0=Column[_col1]}
2024-04-23T21:08:55,883  INFO [main] optimizer.ColumnPrunerProcFactory: RS 26 newColExprMap: {VALUE._col1=Column[_col2], VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,883  INFO [main] optimizer.ColumnPrunerProcFactory: RS 31 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2]}
2024-04-23T21:08:55,883  INFO [main] optimizer.ColumnPrunerProcFactory: RS 31 newColExprMap: {VALUE._col0=Column[_col1], VALUE._col1=Column[_col2], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,883  INFO [main] optimizer.ColumnPrunerProcFactory: RS 11 oldColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,883  INFO [main] optimizer.ColumnPrunerProcFactory: RS 11 newColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,883  INFO [main] optimizer.ColumnPrunerProcFactory: RS 18 oldColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,883  INFO [main] optimizer.ColumnPrunerProcFactory: RS 18 newColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,884  INFO [main] optimizer.ColumnPrunerProcFactory: RS 37 oldColExprMap: {VALUE._col0=Column[_col1], KEY._col0=Column[_col0]}
2024-04-23T21:08:55,884  INFO [main] optimizer.ColumnPrunerProcFactory: RS 37 newColExprMap: {VALUE._col0=Column[_col1], KEY._col0=Column[_col0]}
2024-04-23T21:08:55,884  INFO [main] optimizer.ColumnPrunerProcFactory: JOIN 7 oldExprs: {0=[Column[KEY.reducesinkkey0], Column[VALUE._col0], Column[VALUE._col1]], 1=[Column[KEY.reducesinkkey0], Column[VALUE._col0], Column[VALUE._col1]]}
2024-04-23T21:08:55,884  INFO [main] optimizer.ColumnPrunerProcFactory: JOIN 7 newExprs: {1=[Column[KEY.reducesinkkey0], Column[VALUE._col0], Column[VALUE._col1]], 0=[Column[KEY.reducesinkkey0], Column[VALUE._col0], Column[VALUE._col1]]}
2024-04-23T21:08:55,885  INFO [main] optimizer.ColumnPrunerProcFactory: RS 6 oldColExprMap: {VALUE._col1=Column[_col2], VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:08:55,885  INFO [main] optimizer.ColumnPrunerProcFactory: RS 6 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1], VALUE._col1=Column[_col2]}
2024-04-23T21:08:55,885  INFO [main] optimizer.ColumnPrunerProcFactory: RS 5 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2]}
2024-04-23T21:08:55,885  INFO [main] optimizer.ColumnPrunerProcFactory: RS 5 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col1=Column[_col2], VALUE._col0=Column[_col1]}
2024-04-23T21:08:55,889  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:08:55,891  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:55,891  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:55,891  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:55,891  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:55,891  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:08:55,907  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,913  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,927  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,942  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:08:55,957  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:08:55,973  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:55,974  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,974  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vector.serde.deserialize IS true]
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:55,975  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:55,976  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,976  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 2)
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 2
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vector.serde.deserialize IS true]
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 3
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,977  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 4)
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 4
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vector.serde.deserialize IS true]
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 5
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:55,978  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 6)
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 6
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vector.serde.deserialize IS true]
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:55,979  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 7
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 8)
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:08:55,980  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 8
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vector.serde.deserialize IS true]
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 9
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Map notVectorizedReason: Vectorized map work only works with 1 TableScanOperator
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 10
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Vectorized map work only works with 1 TableScanOperator IS false]
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 11
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:08:55,981  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:08:55,982  INFO [main] parse.MergeSemanticAnalyzer: Completed plan generation
2024-04-23T21:08:55,982  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
2024-04-23T21:08:55,982  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:08:55,982  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_c0, type:int, comment:null)], properties:null)
2024-04-23T21:08:55,982  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:08:55,982  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=36, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=2, getValidWriteIds_(List, String)=6, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, getTableColumnStatistics_(String, String, List, String)=67, allocateTableWriteId_(long, String, String)=9, getTable_(GetTableRequest)=117, createTable_(Table)=3, getCheckConstraints_(CheckConstraintsRequest)=2}
2024-04-23T21:08:55,982  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7); Time taken: 0.601 seconds
2024-04-23T21:08:55,983  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7
2024-04-23T21:08:55,983  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7
2024-04-23T21:08:56,001  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:08:56,001  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:08:56,007  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-23T21:08:56,008  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7
2024-04-23T21:08:56,008  INFO [main] ql.Driver: Query ID = alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7
Total jobs = 6
2024-04-23T21:08:56,008  INFO [main] ql.Driver: Total jobs = 6
Launching Job 1 out of 6
2024-04-23T21:08:56,008  INFO [main] ql.Driver: Launching Job 1 out of 6
2024-04-23T21:08:56,132  INFO [main] ql.Driver: Starting task [Stage-5:MAPRED] in serial mode
2024-04-23T21:08:56,132  INFO [main] exec.Utilities: Not using thread pool for getContentSummary
2024-04-23T21:08:56,133  INFO [main] exec.Utilities: BytesPerReducer=256000000 maxReducers=1009 totalInputFileSize=0
Number of reduce tasks not specified. Estimated from input data size: 1
2024-04-23T21:08:56,133  INFO [main] exec.Task: Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:08:56,133  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:08:56,133  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:08:56,133  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:08:56,133  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:08:56,133  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:08:56,133  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:08:56,138  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:56,138  INFO [main] exec.Utilities: Processing alias subq:$hdt$_0:a/b
2024-04-23T21:08:56,138  INFO [main] exec.Utilities: Adding 2 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/src-47-name
2024-04-23T21:08:56,138  INFO [main] exec.Utilities: Processing alias subq:$hdt$_1:d/8
2024-04-23T21:08:56,138  INFO [main] exec.Utilities: Adding 2 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:56,145  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/src-47-name to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1/-mr-10000/f13bf2f0-2401-4e75-bc2d-0d36023a7351 (false)
2024-04-23T21:08:56,152  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1/-mr-10000/1288062c-b5df-44d6-a085-c3f0c61ffbb7 (false)
2024-04-23T21:08:56,160  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:56,162  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 8,26KB
2024-04-23T21:08:56,167  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:08:56,173  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 13,24KB
2024-04-23T21:08:56,174  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:56,189  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:56,196  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:56,200  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:56,201  INFO [main] io.HiveInputFormat: Generating splits as currentDirs is not empty. currentDirs: [file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1/-mr-10000/f13bf2f0-2401-4e75-bc2d-0d36023a7351]
2024-04-23T21:08:56,201  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:08:56,201  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = i,d?*de e
2024-04-23T21:08:56,205  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:08:56,205  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:08:56,205  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = i,d?*de e
2024-04-23T21:08:56,205  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1/-mr-10000/f13bf2f0-2401-4e75-bc2d-0d36023a7351
2024-04-23T21:08:56,205  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:08:56,205  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.aci/d_u/ami:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:08:56,205  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:08:56,209  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/0
2024-04-23T21:08:56,209  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 0). duration: 4 ms
2024-04-23T21:08:56,209  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:56,226  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:56,253  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local240368623_0073
2024-04-23T21:08:56,253  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:56,315  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:56,315  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:56,316  INFO [Thread-6166] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:56,316  INFO [Thread-6166] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:56,317  INFO [Thread-6166] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:56,317  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local240368623_0073_m_000000_0
2024-04-23T21:08:56,320  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:56,321  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.mapred.TextInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1/-mr-10000/f13bf2f0-2401-4e75-bc2d-0d36023a7351/emptyFile:0+0
2024-04-23T21:08:56,323  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:56,325  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 8,26KB
2024-04-23T21:08:56,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:08:56,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:08:56,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:08:56,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:08:56,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:08:56,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:08:56,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:08:56,332  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:56,334  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
    <TS>Id =2
      <Children>
        <FIL>Id =42
          <Children>
            <SEL>Id =4
              <Children>
                <RS>Id =6
                  <Children>
                  <\Children>
                  <Parent>Id = 4 null<\Parent>
                <\RS>
              <\Children>
              <Parent>Id = 42 null<\Parent>
            <\SEL>
          <\Children>
          <Parent>Id = 2 null<\Parent>
        <\FIL>
      <\Children>
      <Parent>Id = 0 null<\Parent>
    <\TS>
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:56,335  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[2]
2024-04-23T21:08:56,335  INFO [LocalJobRunner Map Task Executor #0] exec.FilterOperator: Initializing Operator: FIL[42]
2024-04-23T21:08:56,335  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[4]
2024-04-23T21:08:56,335  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<i:int,d?*de e:decimal(5,2),vc:varchar(128),row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>>
2024-04-23T21:08:56,336  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:08:56,336  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = 1
2024-04-23T21:08:56,336  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:08:56,336  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:08:56,336  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<g/h:int,j:decimal(5,2),k:varchar(128)>
2024-04-23T21:08:56,336  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[5]
2024-04-23T21:08:56,336  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = 0
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 0. abort - false
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:0, 
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[5]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[5]: Total records written - 0. abort - false
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_5:0, 
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[2]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_2:0, 
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.FilterOperator: Closing Operator: FIL[42]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.FilterOperator: RECORDS_OUT_OPERATOR_FIL_42:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[4]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_4:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[6]: Total records written - 0. abort - false
2024-04-23T21:08:56,337  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,341  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:56,341  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:08:56,367  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local240368623_0073_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:56,368  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1/-mr-10000/f13bf2f0-2401-4e75-bc2d-0d36023a7351/emptyFile:0+0
2024-04-23T21:08:56,368  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local240368623_0073_m_000000_0' done.
2024-04-23T21:08:56,368  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local240368623_0073_m_000000_0: Counters: 33
	File System Counters
		FILE: Number of bytes read=1612886
		FILE: Number of bytes written=91583046
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=0
		Map output records=0
		Map output bytes=0
		Map output materialized bytes=6
		Input split bytes=364
		Combine input records=0
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1941962752
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=0
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FIL_42=0
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_5=0
		RECORDS_OUT_OPERATOR_RS_6=0
		RECORDS_OUT_OPERATOR_SEL_1=0
		RECORDS_OUT_OPERATOR_SEL_4=0
		RECORDS_OUT_OPERATOR_TS_0=0
		RECORDS_OUT_OPERATOR_TS_2=0
	File Input Format Counters 
		Bytes Read=8349
2024-04-23T21:08:56,368  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local240368623_0073_m_000000_0
2024-04-23T21:08:56,368  INFO [Thread-6166] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:08:56,370  INFO [Thread-6166] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:08:56,370  INFO [pool-357-thread-1] mapred.LocalJobRunner: Starting task: attempt_local240368623_0073_r_000000_0
2024-04-23T21:08:56,375  INFO [pool-357-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:56,375  INFO [pool-357-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6488f6ae
2024-04-23T21:08:56,375  WARN [pool-357-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:56,377  INFO [pool-357-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1359373952, maxSingleShuffleLimit=339843488, mergeThreshold=897186816, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:56,378  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local240368623_0073_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:56,384  INFO [localfetcher#97] reduce.LocalFetcher: localfetcher#97 about to shuffle output of map attempt_local240368623_0073_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:08:56,385  INFO [localfetcher#97] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local240368623_0073_m_000000_0
2024-04-23T21:08:56,385  INFO [localfetcher#97] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:08:56,386  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:56,386  INFO [pool-357-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:56,386  INFO [pool-357-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:56,397  INFO [pool-357-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:56,397  INFO [pool-357-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:56,402  INFO [pool-357-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:56,403  INFO [pool-357-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:08:56,403  INFO [pool-357-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:56,403  INFO [pool-357-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:56,403  INFO [pool-357-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:56,403  INFO [pool-357-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:56,405  INFO [pool-357-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:56,412  INFO [pool-357-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 13,24KB
2024-04-23T21:08:56,415  INFO [pool-357-thread-1] ExecReducer: 
<JOIN>Id =7
  <Children>
    <SEL>Id =8
      <Children>
        <FIL>Id =9
          <Children>
            <SEL>Id =10
              <Children>
                <FS>Id =43
                  <Children>
                  <\Children>
                  <Parent>Id = 10 null<\Parent>
                <\FS>
              <\Children>
              <Parent>Id = 9 null<\Parent>
            <\SEL>
          <\Children>
          <Parent>Id = 8 null<\Parent>
        <\FIL>
        <FIL>Id =16
          <Children>
            <SEL>Id =17
              <Children>
                <FS>Id =45
                  <Children>
                  <\Children>
                  <Parent>Id = 17 null<\Parent>
                <\FS>
              <\Children>
              <Parent>Id = 16 null<\Parent>
            <\SEL>
          <\Children>
          <Parent>Id = 8 null<\Parent>
        <\FIL>
        <FIL>Id =23
          <Children>
            <SEL>Id =24
              <Children>
                <FS>Id =47
                  <Children>
                  <\Children>
                  <Parent>Id = 24 null<\Parent>
                <\FS>
              <\Children>
              <Parent>Id = 23 null<\Parent>
            <\SEL>
          <\Children>
          <Parent>Id = 8 null<\Parent>
        <\FIL>
        <FIL>Id =29
          <Children>
            <SEL>Id =30
              <Children>
                <FS>Id =49
                  <Children>
                  <\Children>
                  <Parent>Id = 30 null<\Parent>
                <\FS>
              <\Children>
              <Parent>Id = 29 null<\Parent>
            <\SEL>
          <\Children>
          <Parent>Id = 8 null<\Parent>
        <\FIL>
        <FIL>Id =34
          <Children>
            <SEL>Id =35
              <Children>
                <GBY>Id =36
                  <Children>
                    <FS>Id =51
                      <Children>
                      <\Children>
                      <Parent>Id = 36 null<\Parent>
                    <\FS>
                  <\Children>
                  <Parent>Id = 35 null<\Parent>
                <\GBY>
              <\Children>
              <Parent>Id = 34 null<\Parent>
            <\SEL>
          <\Children>
          <Parent>Id = 8 null<\Parent>
        <\FIL>
      <\Children>
      <Parent>Id = 7 null<\Parent>
    <\SEL>
  <\Children>
  <Parent><\Parent>
<\JOIN>
2024-04-23T21:08:56,416  INFO [pool-357-thread-1] exec.JoinOperator: Initializing Operator: JOIN[7]
2024-04-23T21:08:56,419  INFO [pool-357-thread-1] exec.CommonJoinOperator: JOIN struct<_col0:int,_col1:decimal(5,2),_col2:varchar(128),_col3:int,_col4:decimal(5,2),_col5:struct<writeid:bigint,bucketid:int,rowid:bigint>> totalsz = 6
2024-04-23T21:08:56,419  INFO [pool-357-thread-1] exec.SelectOperator: Initializing Operator: SEL[8]
2024-04-23T21:08:56,419  INFO [pool-357-thread-1] exec.SelectOperator: SELECT struct<_col0:int,_col1:decimal(5,2),_col2:varchar(128),_col3:int,_col4:decimal(5,2),_col5:struct<writeid:bigint,bucketid:int,rowid:bigint>>
2024-04-23T21:08:56,419  INFO [pool-357-thread-1] exec.FilterOperator: Initializing Operator: FIL[9]
2024-04-23T21:08:56,419  INFO [pool-357-thread-1] exec.SelectOperator: Initializing Operator: SEL[10]
2024-04-23T21:08:56,419  INFO [pool-357-thread-1] exec.SelectOperator: SELECT struct<_col0:decimal(5,2),_col1:struct<writeid:bigint,bucketid:int,rowid:bigint>,_col2:int,_col3:int,_col4:decimal(5,2),_col5:decimal(5,2),_col6:varchar(128),_col7:int,_col8:int>
2024-04-23T21:08:56,419  INFO [pool-357-thread-1] exec.FileSinkOperator: Initializing Operator: FS[43]
2024-04-23T21:08:56,420  INFO [pool-357-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@1d04bb6d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local240368623_0073/job_local240368623_0073.xml], properties={columns=_col0, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>, escape.delim=\, column.name.delimiter=,}, tableProperties={columns=_col0, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>, column.name.delimiter=,, escape.delim=\}, partitionProperties=Optional.empty, columnNames=[_col0], columnTypes=[struct<writeid:bigint,bucketid:int,rowid:bigint>], getClass()=class org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@316d0e6f
2024-04-23T21:08:56,420  INFO [pool-357-thread-1] exec.FilterOperator: Initializing Operator: FIL[16]
2024-04-23T21:08:56,420  INFO [pool-357-thread-1] exec.SelectOperator: Initializing Operator: SEL[17]
2024-04-23T21:08:56,420  INFO [pool-357-thread-1] exec.SelectOperator: SELECT struct<_col0:decimal(5,2),_col1:struct<writeid:bigint,bucketid:int,rowid:bigint>,_col2:int,_col3:int,_col4:decimal(5,2),_col5:decimal(5,2),_col6:varchar(128),_col7:int,_col8:int>
2024-04-23T21:08:56,420  INFO [pool-357-thread-1] exec.FileSinkOperator: Initializing Operator: FS[45]
2024-04-23T21:08:56,421  INFO [pool-357-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@1d04bb6d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local240368623_0073/job_local240368623_0073.xml], properties={columns=_col0, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>, escape.delim=\, column.name.delimiter=,}, tableProperties={columns=_col0, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>, column.name.delimiter=,, escape.delim=\}, partitionProperties=Optional.empty, columnNames=[_col0], columnTypes=[struct<writeid:bigint,bucketid:int,rowid:bigint>], getClass()=class org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@3818ef5a
2024-04-23T21:08:56,421  INFO [pool-357-thread-1] exec.FilterOperator: Initializing Operator: FIL[23]
2024-04-23T21:08:56,422  INFO [pool-357-thread-1] exec.SelectOperator: Initializing Operator: SEL[24]
2024-04-23T21:08:56,423  INFO [pool-357-thread-1] exec.SelectOperator: SELECT struct<_col0:decimal(5,2),_col1:struct<writeid:bigint,bucketid:int,rowid:bigint>,_col2:int,_col3:int,_col4:decimal(5,2),_col5:decimal(5,2),_col6:varchar(128),_col7:int,_col8:int>
2024-04-23T21:08:56,423  INFO [pool-357-thread-1] exec.FileSinkOperator: Initializing Operator: FS[47]
2024-04-23T21:08:56,424  INFO [pool-357-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@1d04bb6d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local240368623_0073/job_local240368623_0073.xml], properties={columns=_col0,_col1,_col2, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=int,decimal(5,2),varchar(128), escape.delim=\, column.name.delimiter=,}, tableProperties={columns=_col0,_col1,_col2, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=int,decimal(5,2),varchar(128), column.name.delimiter=,, escape.delim=\}, partitionProperties=Optional.empty, columnNames=[_col0, _col1, _col2], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@4463cbe8
2024-04-23T21:08:56,424  INFO [pool-357-thread-1] exec.FilterOperator: Initializing Operator: FIL[29]
2024-04-23T21:08:56,424  INFO [pool-357-thread-1] exec.SelectOperator: Initializing Operator: SEL[30]
2024-04-23T21:08:56,424  INFO [pool-357-thread-1] exec.SelectOperator: SELECT struct<_col0:decimal(5,2),_col1:struct<writeid:bigint,bucketid:int,rowid:bigint>,_col2:int,_col3:int,_col4:decimal(5,2),_col5:decimal(5,2),_col6:varchar(128),_col7:int,_col8:int>
2024-04-23T21:08:56,424  INFO [pool-357-thread-1] exec.FileSinkOperator: Initializing Operator: FS[49]
2024-04-23T21:08:56,425  INFO [pool-357-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@1d04bb6d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local240368623_0073/job_local240368623_0073.xml], properties={columns=_col0,_col1,_col2, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=int,decimal(5,2),varchar(128), escape.delim=\, column.name.delimiter=,}, tableProperties={columns=_col0,_col1,_col2, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=int,decimal(5,2),varchar(128), column.name.delimiter=,, escape.delim=\}, partitionProperties=Optional.empty, columnNames=[_col0, _col1, _col2], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@11247a13
2024-04-23T21:08:56,425  INFO [pool-357-thread-1] exec.FilterOperator: Initializing Operator: FIL[34]
2024-04-23T21:08:56,425  INFO [pool-357-thread-1] exec.SelectOperator: Initializing Operator: SEL[35]
2024-04-23T21:08:56,425  INFO [pool-357-thread-1] exec.SelectOperator: SELECT struct<_col0:decimal(5,2),_col1:struct<writeid:bigint,bucketid:int,rowid:bigint>,_col2:int,_col3:int,_col4:decimal(5,2),_col5:decimal(5,2),_col6:varchar(128),_col7:int,_col8:int>
2024-04-23T21:08:56,425  INFO [pool-357-thread-1] exec.GroupByOperator: Initializing Operator: GBY[36]
2024-04-23T21:08:56,427  INFO [pool-357-thread-1] exec.GroupByOperator: Max hash table memory: 970981376 bytes
2024-04-23T21:08:56,427  INFO [pool-357-thread-1] exec.GroupByOperator: isTez: false isLlap: false numExecutors: 1 maxMemory: 1941962752
2024-04-23T21:08:56,427  INFO [pool-357-thread-1] exec.FileSinkOperator: Initializing Operator: FS[51]
2024-04-23T21:08:56,427  INFO [pool-357-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@1d04bb6d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local240368623_0073/job_local240368623_0073.xml], properties={columns=_col0,_col1, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>,bigint, escape.delim=\, column.name.delimiter=,}, tableProperties={columns=_col0,_col1, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>,bigint, column.name.delimiter=,, escape.delim=\}, partitionProperties=Optional.empty, columnNames=[_col0, _col1], columnTypes=[struct<writeid:bigint,bucketid:int,rowid:bigint>, bigint], getClass()=class org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@56833297
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.JoinOperator: Closing Operator: JOIN[7]
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.JoinOperator: RECORDS_OUT_OPERATOR_JOIN_7:0, RECORDS_OUT_INTERMEDIATE:0, SKEWJOINFOLLOWUPJOBS:0, 
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.SelectOperator: Closing Operator: SEL[8]
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_8:0, 
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.FilterOperator: Closing Operator: FIL[9]
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.FilterOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FIL_9:0, 
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.SelectOperator: Closing Operator: SEL[10]
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_10:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.FileSinkOperator: Closing Operator: FS[43]
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.FileSinkOperator: FS[43]: records written - 0
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10007/000000_0
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_task_tmp.-mr-10007/_tmp.000000_0
2024-04-23T21:08:56,428  INFO [pool-357-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10007/000000_0
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:0, RECORDS_OUT_OPERATOR_FS_43:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FilterOperator: Closing Operator: FIL[16]
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FilterOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FIL_16:0, 
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.SelectOperator: Closing Operator: SEL[17]
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_17:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FileSinkOperator: Closing Operator: FS[45]
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FileSinkOperator: FS[45]: records written - 0
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10008/000000_0
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_task_tmp.-mr-10008/_tmp.000000_0
2024-04-23T21:08:56,437  INFO [pool-357-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10008/000000_0
2024-04-23T21:08:56,444  INFO [pool-357-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_45:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:0, 
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.FilterOperator: Closing Operator: FIL[23]
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.FilterOperator: RECORDS_OUT_OPERATOR_FIL_23:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.SelectOperator: Closing Operator: SEL[24]
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_24:0, 
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.FileSinkOperator: Closing Operator: FS[47]
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.FileSinkOperator: FS[47]: records written - 0
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10009/000000_0
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_task_tmp.-mr-10009/_tmp.000000_0
2024-04-23T21:08:56,445  INFO [pool-357-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10009/000000_0
2024-04-23T21:08:56,452  INFO [pool-357-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_47:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:0, 
2024-04-23T21:08:56,452  INFO [pool-357-thread-1] exec.FilterOperator: Closing Operator: FIL[29]
2024-04-23T21:08:56,452  INFO [pool-357-thread-1] exec.FilterOperator: RECORDS_OUT_OPERATOR_FIL_29:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,452  INFO [pool-357-thread-1] exec.SelectOperator: Closing Operator: SEL[30]
2024-04-23T21:08:56,452  INFO [pool-357-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_30:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,452  INFO [pool-357-thread-1] exec.FileSinkOperator: Closing Operator: FS[49]
2024-04-23T21:08:56,452  INFO [pool-357-thread-1] exec.FileSinkOperator: FS[49]: records written - 0
2024-04-23T21:08:56,453  INFO [pool-357-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10010/000000_0
2024-04-23T21:08:56,453  INFO [pool-357-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_task_tmp.-mr-10010/_tmp.000000_0
2024-04-23T21:08:56,453  INFO [pool-357-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10010/000000_0
2024-04-23T21:08:56,459  INFO [pool-357-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_49:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:0, 
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.FilterOperator: Closing Operator: FIL[34]
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.FilterOperator: RECORDS_OUT_OPERATOR_FIL_34:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.SelectOperator: Closing Operator: SEL[35]
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_35:0, 
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.GroupByOperator: Closing Operator: GBY[36]
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.GroupByOperator: Begin Hash Table flush: size = 0
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.GroupByOperator: RECORDS_OUT_OPERATOR_GBY_36:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.FileSinkOperator: Closing Operator: FS[51]
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.FileSinkOperator: FS[51]: records written - 0
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10011/000000_0
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_task_tmp.-mr-10011/_tmp.000000_0
2024-04-23T21:08:56,460  INFO [pool-357-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-mr-10011/000000_0
2024-04-23T21:08:56,467  INFO [pool-357-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_51:0, 
2024-04-23T21:08:56,468  INFO [pool-357-thread-1] mapred.Task: Task:attempt_local240368623_0073_r_000000_0 is done. And is in the process of committing
2024-04-23T21:08:56,469  INFO [pool-357-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:56,469  INFO [pool-357-thread-1] mapred.Task: Task 'attempt_local240368623_0073_r_000000_0' done.
2024-04-23T21:08:56,469  INFO [pool-357-thread-1] mapred.Task: Final Counters for attempt_local240368623_0073_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1626290
		FILE: Number of bytes written=91583592
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1941962752
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:56,469  INFO [pool-357-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local240368623_0073_r_000000_0
2024-04-23T21:08:56,469  INFO [Thread-6166] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:08:57,316 Stage-5 map = 100%,  reduce = 100%
2024-04-23T21:08:57,316  INFO [main] exec.Task: 2024-04-23 21:08:57,316 Stage-5 map = 100%,  reduce = 100%
Ended Job = job_local240368623_0073
2024-04-23T21:08:57,317  INFO [main] exec.Task: Ended Job = job_local240368623_0073
Launching Job 2 out of 6
2024-04-23T21:08:57,323  INFO [main] ql.Driver: Launching Job 2 out of 6
2024-04-23T21:08:57,485  INFO [main] ql.Driver: Starting task [Stage-6:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:08:57,485  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:08:57,485  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:08:57,485  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:08:57,485  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:08:57,485  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:08:57,485  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:08:57,486  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:08:57,489  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:57,489  INFO [main] exec.Utilities: Processing alias file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10007
2024-04-23T21:08:57,490  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10007
2024-04-23T21:08:57,503  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:57,504  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,66KB
2024-04-23T21:08:57,509  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:08:57,510  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T21:08:57,512  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:57,517  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10001
2024-04-23T21:08:57,519  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:57,527  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:57,532  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:57,533  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0
2024-04-23T21:08:57,533  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = _col0
2024-04-23T21:08:57,533  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10007
2024-04-23T21:08:57,537  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:08:57,538  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:57,560  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:57,580  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1889525626_0074
2024-04-23T21:08:57,580  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:57,664  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:57,664  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:57,665  INFO [Thread-6223] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:57,665  INFO [Thread-6223] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:57,666  INFO [Thread-6223] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:57,667  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1889525626_0074_m_000000_0
2024-04-23T21:08:57,667  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:57,668  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.mapred.SequenceFileInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10007/000000_0:0+96
2024-04-23T21:08:57,668  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:57,669  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,66KB
2024-04-23T21:08:57,670  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:08:57,674  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:08:57,674  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:08:57,674  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:08:57,674  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:08:57,674  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:08:57,675  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:08:57,675  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:57,675  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>
    <TS>Id =44
      <Children>
        <RS>Id =53
          <Children>
          <\Children>
          <Parent>Id = 44 null<\Parent>
        <\RS>
      <\Children>
      <Parent><\Parent>
    <\TS>
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:57,676  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[44]
2024-04-23T21:08:57,676  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[53]
2024-04-23T21:08:57,676  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[44]
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_44:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[53]
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[53]: Total records written - 0. abort - false
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_53:0, 
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:57,677  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:08:57,692  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1889525626_0074_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:57,692  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10007/000000_0:0+96
2024-04-23T21:08:57,693  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1889525626_0074_m_000000_0' done.
2024-04-23T21:08:57,693  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1889525626_0074_m_000000_0: Counters: 28
	File System Counters
		FILE: Number of bytes read=1631710
		FILE: Number of bytes written=92838815
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=0
		Map output records=0
		Map output bytes=0
		Map output materialized bytes=12
		Input split bytes=334
		Combine input records=0
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=0
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_53=0
		RECORDS_OUT_OPERATOR_TS_44=0
	File Input Format Counters 
		Bytes Read=5032
2024-04-23T21:08:57,693  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1889525626_0074_m_000000_0
2024-04-23T21:08:57,693  INFO [Thread-6223] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:08:57,694  INFO [Thread-6223] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:08:57,694  INFO [pool-360-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1889525626_0074_r_000000_0
2024-04-23T21:08:57,695  INFO [pool-360-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:57,695  INFO [pool-360-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@42b97fc9
2024-04-23T21:08:57,695  WARN [pool-360-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:57,696  INFO [pool-360-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356437888, maxSingleShuffleLimit=339109472, mergeThreshold=895249024, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:57,696  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1889525626_0074_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:57,697  INFO [localfetcher#98] reduce.LocalFetcher: localfetcher#98 about to shuffle output of map attempt_local1889525626_0074_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:08:57,697  INFO [localfetcher#98] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1889525626_0074_m_000000_0
2024-04-23T21:08:57,697  INFO [localfetcher#98] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:08:57,698  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:57,698  INFO [pool-360-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:57,698  INFO [pool-360-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:57,704  INFO [pool-360-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:57,704  INFO [pool-360-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:57,707  INFO [pool-360-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:57,707  INFO [pool-360-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:08:57,707  INFO [pool-360-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:57,707  INFO [pool-360-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:57,707  INFO [pool-360-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:57,708  INFO [pool-360-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:57,708  INFO [pool-360-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:57,709  INFO [pool-360-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T21:08:57,709  INFO [pool-360-thread-1] ExecReducer: 
<SEL>Id =14
  <Children>
    <FS>Id =15
      <Children>
      <\Children>
      <Parent>Id = 14 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:57,709  INFO [pool-360-thread-1] exec.SelectOperator: Initializing Operator: SEL[14]
2024-04-23T21:08:57,709  INFO [pool-360-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<>>
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.FileSinkOperator: Initializing Operator: FS[15]
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1889525626_0074/job_local1889525626_0074.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@69e124e
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.SelectOperator: Closing Operator: SEL[14]
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_14:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.FileSinkOperator: Closing Operator: FS[15]
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.FileSinkOperator: FS[15]: records written - 0
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:57,710  INFO [pool-360-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:57,715  INFO [pool-360-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_1_default.aci/d_u/ami:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_15:0, 
2024-04-23T21:08:57,716  INFO [pool-360-thread-1] mapred.Task: Task:attempt_local1889525626_0074_r_000000_0 is done. And is in the process of committing
2024-04-23T21:08:57,716  INFO [pool-360-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:57,716  INFO [pool-360-thread-1] mapred.Task: Task 'attempt_local1889525626_0074_r_000000_0' done.
2024-04-23T21:08:57,716  INFO [pool-360-thread-1] mapred.Task: Final Counters for attempt_local1889525626_0074_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1637523
		FILE: Number of bytes written=92838878
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:57,716  INFO [pool-360-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1889525626_0074_r_000000_0
2024-04-23T21:08:57,716  INFO [pool-360-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1889525626_0074_r_000001_0
2024-04-23T21:08:57,717  INFO [pool-360-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:57,717  INFO [pool-360-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7f83d80b
2024-04-23T21:08:57,717  WARN [pool-360-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:57,718  INFO [pool-360-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356437888, maxSingleShuffleLimit=339109472, mergeThreshold=895249024, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:57,718  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1889525626_0074_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:57,721  INFO [localfetcher#99] reduce.LocalFetcher: localfetcher#99 about to shuffle output of map attempt_local1889525626_0074_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:08:57,721  INFO [localfetcher#99] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1889525626_0074_m_000000_0
2024-04-23T21:08:57,721  INFO [localfetcher#99] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:08:57,722  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:57,722  INFO [pool-360-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:57,722  INFO [pool-360-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:57,728  INFO [pool-360-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:57,728  INFO [pool-360-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:57,731  INFO [pool-360-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:57,731  INFO [pool-360-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:08:57,731  INFO [pool-360-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:57,731  INFO [pool-360-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:57,731  INFO [pool-360-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:57,731  INFO [pool-360-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:57,732  INFO [pool-360-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:57,732  INFO [pool-360-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T21:08:57,734  INFO [pool-360-thread-1] ExecReducer: 
<SEL>Id =14
  <Children>
    <FS>Id =15
      <Children>
      <\Children>
      <Parent>Id = 14 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:57,734  INFO [pool-360-thread-1] exec.SelectOperator: Initializing Operator: SEL[14]
2024-04-23T21:08:57,734  INFO [pool-360-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<>>
2024-04-23T21:08:57,734  INFO [pool-360-thread-1] exec.FileSinkOperator: Initializing Operator: FS[15]
2024-04-23T21:08:57,734  INFO [pool-360-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1889525626_0074/job_local1889525626_0074.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@347dacd
2024-04-23T21:08:57,734  INFO [pool-360-thread-1] exec.SelectOperator: Closing Operator: SEL[14]
2024-04-23T21:08:57,735  INFO [pool-360-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_14:0, 
2024-04-23T21:08:57,735  INFO [pool-360-thread-1] exec.FileSinkOperator: Closing Operator: FS[15]
2024-04-23T21:08:57,735  INFO [pool-360-thread-1] exec.FileSinkOperator: FS[15]: records written - 0
2024-04-23T21:08:57,735  INFO [pool-360-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:57,735  INFO [pool-360-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:57,740  INFO [pool-360-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_15:0, RECORDS_OUT_1_default.aci/d_u/ami:0, TOTAL_TABLE_ROWS_WRITTEN:0, 
2024-04-23T21:08:57,740  INFO [pool-360-thread-1] mapred.Task: Task:attempt_local1889525626_0074_r_000001_0 is done. And is in the process of committing
2024-04-23T21:08:57,740  INFO [pool-360-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:57,740  INFO [pool-360-thread-1] mapred.Task: Task 'attempt_local1889525626_0074_r_000001_0' done.
2024-04-23T21:08:57,741  INFO [pool-360-thread-1] mapred.Task: Final Counters for attempt_local1889525626_0074_r_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1643330
		FILE: Number of bytes written=92838941
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:57,741  INFO [pool-360-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1889525626_0074_r_000001_0
2024-04-23T21:08:57,741  INFO [Thread-6223] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:08:58,667 Stage-6 map = 100%,  reduce = 100%
2024-04-23T21:08:58,667  INFO [main] exec.Task: 2024-04-23 21:08:58,667 Stage-6 map = 100%,  reduce = 100%
Ended Job = job_local1889525626_0074
2024-04-23T21:08:58,669  INFO [main] exec.Task: Ended Job = job_local1889525626_0074
2024-04-23T21:08:58,671  INFO [main] FileOperations: No manifests found in directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami/_tmp.delete_delta_0000001_0000001_0000 - query produced no output
Launching Job 3 out of 6
2024-04-23T21:08:58,671  INFO [main] ql.Driver: Launching Job 3 out of 6
2024-04-23T21:08:58,797  INFO [main] ql.Driver: Starting task [Stage-8:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:08:58,797  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:08:58,797  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:08:58,797  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:08:58,797  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:08:58,797  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:08:58,797  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:08:58,797  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:08:58,799  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:08:58,799  INFO [main] exec.Utilities: Processing alias file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10008
2024-04-23T21:08:58,800  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10008
2024-04-23T21:08:58,809  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:08:58,810  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,66KB
2024-04-23T21:08:58,815  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:08:58,816  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T21:08:58,817  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:58,820  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10002
2024-04-23T21:08:58,822  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:58,829  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:08:58,833  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:08:58,834  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0
2024-04-23T21:08:58,834  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = _col0
2024-04-23T21:08:58,834  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10008
2024-04-23T21:08:58,837  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:08:58,838  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:08:58,856  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:08:58,877  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local894393652_0075
2024-04-23T21:08:58,877  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:08:58,940  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:08:58,940  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:08:58,940  INFO [Thread-6276] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:58,940  INFO [Thread-6276] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:08:58,942  INFO [Thread-6276] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:08:58,942  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local894393652_0075_m_000000_0
2024-04-23T21:08:58,942  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:58,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.mapred.SequenceFileInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10008/000000_0:0+96
2024-04-23T21:08:58,943  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:08:58,943  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,66KB
2024-04-23T21:08:58,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:08:58,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:08:58,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:08:58,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:08:58,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:08:58,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:08:58,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:08:58,949  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:08:58,950  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>
    <TS>Id =46
      <Children>
        <RS>Id =54
          <Children>
          <\Children>
          <Parent>Id = 46 null<\Parent>
        <\RS>
      <\Children>
      <Parent><\Parent>
    <\TS>
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:08:58,950  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[46]
2024-04-23T21:08:58,950  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[54]
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[46]
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_46:0, 
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[54]
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[54]: Total records written - 0. abort - false
2024-04-23T21:08:58,951  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_54:0, 
2024-04-23T21:08:58,952  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:08:58,952  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:08:58,967  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local894393652_0075_m_000000_0 is done. And is in the process of committing
2024-04-23T21:08:58,967  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10008/000000_0:0+96
2024-04-23T21:08:58,967  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local894393652_0075_m_000000_0' done.
2024-04-23T21:08:58,968  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local894393652_0075_m_000000_0: Counters: 28
	File System Counters
		FILE: Number of bytes read=1648750
		FILE: Number of bytes written=94089342
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=0
		Map output records=0
		Map output bytes=0
		Map output materialized bytes=12
		Input split bytes=334
		Combine input records=0
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=0
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_54=0
		RECORDS_OUT_OPERATOR_TS_46=0
	File Input Format Counters 
		Bytes Read=5032
2024-04-23T21:08:58,968  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local894393652_0075_m_000000_0
2024-04-23T21:08:58,968  INFO [Thread-6276] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:08:58,969  INFO [Thread-6276] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:08:58,969  INFO [pool-363-thread-1] mapred.LocalJobRunner: Starting task: attempt_local894393652_0075_r_000000_0
2024-04-23T21:08:58,970  INFO [pool-363-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:58,970  INFO [pool-363-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@573b2fdb
2024-04-23T21:08:58,970  WARN [pool-363-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:58,971  INFO [pool-363-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356437888, maxSingleShuffleLimit=339109472, mergeThreshold=895249024, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:58,971  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local894393652_0075_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:58,972  INFO [localfetcher#100] reduce.LocalFetcher: localfetcher#100 about to shuffle output of map attempt_local894393652_0075_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:08:58,972  INFO [localfetcher#100] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local894393652_0075_m_000000_0
2024-04-23T21:08:58,972  INFO [localfetcher#100] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:08:58,973  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:58,973  INFO [pool-363-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:58,973  INFO [pool-363-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:58,979  INFO [pool-363-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:58,980  INFO [pool-363-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:58,982  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:58,982  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:08:58,982  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:58,982  INFO [pool-363-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:58,982  INFO [pool-363-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:58,982  INFO [pool-363-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:58,983  INFO [pool-363-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:58,983  INFO [pool-363-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] ExecReducer: 
<SEL>Id =21
  <Children>
    <FS>Id =22
      <Children>
      <\Children>
      <Parent>Id = 21 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.SelectOperator: Initializing Operator: SEL[21]
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<>>
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.FileSinkOperator: Initializing Operator: FS[22]
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local894393652_0075/job_local894393652_0075.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3d23c10e
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.SelectOperator: Closing Operator: SEL[21]
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_21:0, 
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.FileSinkOperator: Closing Operator: FS[22]
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.FileSinkOperator: FS[22]: records written - 0
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:58,984  INFO [pool-363-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:58,989  INFO [pool-363-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_22:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_2_default.aci/d_u/ami:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:08:58,990  INFO [pool-363-thread-1] mapred.Task: Task:attempt_local894393652_0075_r_000000_0 is done. And is in the process of committing
2024-04-23T21:08:58,990  INFO [pool-363-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:58,990  INFO [pool-363-thread-1] mapred.Task: Task 'attempt_local894393652_0075_r_000000_0' done.
2024-04-23T21:08:58,990  INFO [pool-363-thread-1] mapred.Task: Final Counters for attempt_local894393652_0075_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1654563
		FILE: Number of bytes written=94089405
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:58,990  INFO [pool-363-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local894393652_0075_r_000000_0
2024-04-23T21:08:58,990  INFO [pool-363-thread-1] mapred.LocalJobRunner: Starting task: attempt_local894393652_0075_r_000001_0
2024-04-23T21:08:58,991  INFO [pool-363-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:08:58,991  INFO [pool-363-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7ce41895
2024-04-23T21:08:58,991  WARN [pool-363-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:08:58,992  INFO [pool-363-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356437888, maxSingleShuffleLimit=339109472, mergeThreshold=895249024, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:08:58,992  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local894393652_0075_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:08:58,995  INFO [localfetcher#101] reduce.LocalFetcher: localfetcher#101 about to shuffle output of map attempt_local894393652_0075_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:08:58,995  INFO [localfetcher#101] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local894393652_0075_m_000000_0
2024-04-23T21:08:58,995  INFO [localfetcher#101] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:08:58,996  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:08:58,996  INFO [pool-363-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:58,996  INFO [pool-363-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:08:59,003  INFO [pool-363-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:59,003  INFO [pool-363-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:59,005  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:08:59,005  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:08:59,006  INFO [pool-363-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:08:59,006  INFO [pool-363-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:08:59,006  INFO [pool-363-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:08:59,006  INFO [pool-363-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:08:59,006  INFO [pool-363-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:08:59,007  INFO [pool-363-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T21:08:59,007  INFO [pool-363-thread-1] ExecReducer: 
<SEL>Id =21
  <Children>
    <FS>Id =22
      <Children>
      <\Children>
      <Parent>Id = 21 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:08:59,007  INFO [pool-363-thread-1] exec.SelectOperator: Initializing Operator: SEL[21]
2024-04-23T21:08:59,007  INFO [pool-363-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<>>
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.FileSinkOperator: Initializing Operator: FS[22]
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local894393652_0075/job_local894393652_0075.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6a28b97e
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.SelectOperator: Closing Operator: SEL[21]
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_21:0, 
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.FileSinkOperator: Closing Operator: FS[22]
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.FileSinkOperator: FS[22]: records written - 0
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:59,008  INFO [pool-363-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:08:59,013  INFO [pool-363-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_2_default.aci/d_u/ami:0, RECORDS_OUT_OPERATOR_FS_22:0, 
2024-04-23T21:08:59,013  INFO [pool-363-thread-1] mapred.Task: Task:attempt_local894393652_0075_r_000001_0 is done. And is in the process of committing
2024-04-23T21:08:59,014  INFO [pool-363-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:08:59,014  INFO [pool-363-thread-1] mapred.Task: Task 'attempt_local894393652_0075_r_000001_0' done.
2024-04-23T21:08:59,014  INFO [pool-363-thread-1] mapred.Task: Final Counters for attempt_local894393652_0075_r_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1660370
		FILE: Number of bytes written=94089468
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:08:59,014  INFO [pool-363-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local894393652_0075_r_000001_0
2024-04-23T21:08:59,014  INFO [Thread-6276] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:08:59,942 Stage-8 map = 100%,  reduce = 100%
2024-04-23T21:08:59,942  INFO [main] exec.Task: 2024-04-23 21:08:59,942 Stage-8 map = 100%,  reduce = 100%
Ended Job = job_local894393652_0075
2024-04-23T21:08:59,944  INFO [main] exec.Task: Ended Job = job_local894393652_0075
2024-04-23T21:08:59,946  INFO [main] FileOperations: No manifests found in directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami/_tmp.delete_delta_0000001_0000001_0001 - query produced no output
Launching Job 4 out of 6
2024-04-23T21:08:59,946  INFO [main] ql.Driver: Launching Job 4 out of 6
2024-04-23T21:09:00,103  INFO [main] ql.Driver: Starting task [Stage-10:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:09:00,104  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:00,104  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:00,104  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:00,104  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:00,104  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:00,104  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:00,104  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:00,106  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:00,106  INFO [main] exec.Utilities: Processing alias file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10009
2024-04-23T21:09:00,106  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10009
2024-04-23T21:09:00,115  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:00,116  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,34KB
2024-04-23T21:09:00,120  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:00,121  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,39KB
2024-04-23T21:09:00,122  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:00,126  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10003
2024-04-23T21:09:00,128  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:00,136  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:00,140  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:00,141  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1,2
2024-04-23T21:09:00,141  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = _col0,_col1,_col2
2024-04-23T21:09:00,141  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10009
2024-04-23T21:09:00,144  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:09:00,145  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:00,162  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:00,180  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local606772826_0076
2024-04-23T21:09:00,180  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:00,240  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:00,240  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:00,240  INFO [Thread-6329] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:00,240  INFO [Thread-6329] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:00,242  INFO [Thread-6329] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:00,242  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local606772826_0076_m_000000_0
2024-04-23T21:09:00,242  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:00,243  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.mapred.SequenceFileInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10009/000000_0:0+96
2024-04-23T21:09:00,243  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:00,244  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,34KB
2024-04-23T21:09:00,244  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:09:00,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:00,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:00,249  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:00,249  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:00,249  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:00,249  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:00,249  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:00,251  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>
    <TS>Id =48
      <Children>
        <RS>Id =55
          <Children>
          <\Children>
          <Parent>Id = 48 null<\Parent>
        <\RS>
      <\Children>
      <Parent><\Parent>
    <\TS>
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:00,251  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[48]
2024-04-23T21:09:00,251  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[55]
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[48]
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_48:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[55]
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[55]: Total records written - 0. abort - false
2024-04-23T21:09:00,252  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_55:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:00,253  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:00,253  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:00,267  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local606772826_0076_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:00,267  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10009/000000_0:0+96
2024-04-23T21:09:00,267  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local606772826_0076_m_000000_0' done.
2024-04-23T21:09:00,267  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local606772826_0076_m_000000_0: Counters: 28
	File System Counters
		FILE: Number of bytes read=1665458
		FILE: Number of bytes written=95339249
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=0
		Map output records=0
		Map output bytes=0
		Map output materialized bytes=12
		Input split bytes=334
		Combine input records=0
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=0
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_55=0
		RECORDS_OUT_OPERATOR_TS_48=0
	File Input Format Counters 
		Bytes Read=4700
2024-04-23T21:09:00,268  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local606772826_0076_m_000000_0
2024-04-23T21:09:00,268  INFO [Thread-6329] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:00,269  INFO [Thread-6329] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:00,269  INFO [pool-366-thread-1] mapred.LocalJobRunner: Starting task: attempt_local606772826_0076_r_000000_0
2024-04-23T21:09:00,269  INFO [pool-366-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:00,269  INFO [pool-366-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@45aabae6
2024-04-23T21:09:00,269  WARN [pool-366-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:00,271  INFO [pool-366-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356437888, maxSingleShuffleLimit=339109472, mergeThreshold=895249024, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:00,271  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local606772826_0076_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:00,272  INFO [localfetcher#102] reduce.LocalFetcher: localfetcher#102 about to shuffle output of map attempt_local606772826_0076_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:00,272  INFO [localfetcher#102] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local606772826_0076_m_000000_0
2024-04-23T21:09:00,272  INFO [localfetcher#102] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:00,273  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:00,273  INFO [pool-366-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:00,273  INFO [pool-366-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:00,280  INFO [pool-366-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:00,280  INFO [pool-366-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:00,282  INFO [pool-366-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:00,282  INFO [pool-366-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:00,282  INFO [pool-366-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:00,282  INFO [pool-366-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:00,283  INFO [pool-366-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:00,283  INFO [pool-366-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:00,283  INFO [pool-366-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:00,283  INFO [pool-366-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,39KB
2024-04-23T21:09:00,284  INFO [pool-366-thread-1] ExecReducer: 
<SEL>Id =27
  <Children>
    <FS>Id =28
      <Children>
      <\Children>
      <Parent>Id = 27 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:00,284  INFO [pool-366-thread-1] exec.SelectOperator: Initializing Operator: SEL[27]
2024-04-23T21:09:00,284  INFO [pool-366-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:decimal(5,2),_col1:varchar(128)>>
2024-04-23T21:09:00,284  INFO [pool-366-thread-1] exec.FileSinkOperator: Initializing Operator: FS[28]
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local606772826_0076/job_local606772826_0076.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@79131cfd
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] exec.SelectOperator: Closing Operator: SEL[27]
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_27:0, 
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] exec.FileSinkOperator: Closing Operator: FS[28]
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] exec.FileSinkOperator: FS[28]: records written - 0
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:00,285  INFO [pool-366-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:00,290  INFO [pool-366-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_28:0, RECORDS_OUT_3_default.aci/d_u/ami:0, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, 
2024-04-23T21:09:00,291  INFO [pool-366-thread-1] mapred.Task: Task:attempt_local606772826_0076_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:00,291  INFO [pool-366-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:00,291  INFO [pool-366-thread-1] mapred.Task: Task 'attempt_local606772826_0076_r_000000_0' done.
2024-04-23T21:09:00,291  INFO [pool-366-thread-1] mapred.Task: Final Counters for attempt_local606772826_0076_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1670981
		FILE: Number of bytes written=95339312
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:00,291  INFO [pool-366-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local606772826_0076_r_000000_0
2024-04-23T21:09:00,292  INFO [pool-366-thread-1] mapred.LocalJobRunner: Starting task: attempt_local606772826_0076_r_000001_0
2024-04-23T21:09:00,292  INFO [pool-366-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:00,292  INFO [pool-366-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4a4e837a
2024-04-23T21:09:00,292  WARN [pool-366-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:00,294  INFO [pool-366-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356437888, maxSingleShuffleLimit=339109472, mergeThreshold=895249024, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:00,294  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local606772826_0076_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:00,297  INFO [localfetcher#103] reduce.LocalFetcher: localfetcher#103 about to shuffle output of map attempt_local606772826_0076_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:00,297  INFO [localfetcher#103] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local606772826_0076_m_000000_0
2024-04-23T21:09:00,297  INFO [localfetcher#103] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:00,297  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:00,298  INFO [pool-366-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:00,298  INFO [pool-366-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:00,304  INFO [pool-366-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:00,304  INFO [pool-366-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:00,307  INFO [pool-366-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:00,307  INFO [pool-366-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:00,307  INFO [pool-366-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:00,307  INFO [pool-366-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:00,307  INFO [pool-366-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:00,307  INFO [pool-366-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:00,308  INFO [pool-366-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:00,308  INFO [pool-366-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,39KB
2024-04-23T21:09:00,309  INFO [pool-366-thread-1] ExecReducer: 
<SEL>Id =27
  <Children>
    <FS>Id =28
      <Children>
      <\Children>
      <Parent>Id = 27 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:00,309  INFO [pool-366-thread-1] exec.SelectOperator: Initializing Operator: SEL[27]
2024-04-23T21:09:00,309  INFO [pool-366-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:decimal(5,2),_col1:varchar(128)>>
2024-04-23T21:09:00,309  INFO [pool-366-thread-1] exec.FileSinkOperator: Initializing Operator: FS[28]
2024-04-23T21:09:00,309  INFO [pool-366-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local606772826_0076/job_local606772826_0076.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7626682a
2024-04-23T21:09:00,309  INFO [pool-366-thread-1] exec.SelectOperator: Closing Operator: SEL[27]
2024-04-23T21:09:00,310  INFO [pool-366-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_27:0, 
2024-04-23T21:09:00,310  INFO [pool-366-thread-1] exec.FileSinkOperator: Closing Operator: FS[28]
2024-04-23T21:09:00,310  INFO [pool-366-thread-1] exec.FileSinkOperator: FS[28]: records written - 0
2024-04-23T21:09:00,310  INFO [pool-366-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:00,310  INFO [pool-366-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:00,310  INFO [pool-366-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:00,315  INFO [pool-366-thread-1] exec.FileSinkOperator: RECORDS_OUT_3_default.aci/d_u/ami:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_28:0, TOTAL_TABLE_ROWS_WRITTEN:0, 
2024-04-23T21:09:00,315  INFO [pool-366-thread-1] mapred.Task: Task:attempt_local606772826_0076_r_000001_0 is done. And is in the process of committing
2024-04-23T21:09:00,316  INFO [pool-366-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:00,316  INFO [pool-366-thread-1] mapred.Task: Task 'attempt_local606772826_0076_r_000001_0' done.
2024-04-23T21:09:00,316  INFO [pool-366-thread-1] mapred.Task: Final Counters for attempt_local606772826_0076_r_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1676498
		FILE: Number of bytes written=95339375
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:00,316  INFO [pool-366-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local606772826_0076_r_000001_0
2024-04-23T21:09:00,316  INFO [Thread-6329] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:01,241 Stage-10 map = 100%,  reduce = 100%
2024-04-23T21:09:01,241  INFO [main] exec.Task: 2024-04-23 21:09:01,241 Stage-10 map = 100%,  reduce = 100%
Ended Job = job_local606772826_0076
2024-04-23T21:09:01,242  INFO [main] exec.Task: Ended Job = job_local606772826_0076
2024-04-23T21:09:01,242  INFO [main] FileOperations: No manifests found in directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami/_tmp.delta_0000001_0000001_0002 - query produced no output
Launching Job 5 out of 6
2024-04-23T21:09:01,242  INFO [main] ql.Driver: Launching Job 5 out of 6
2024-04-23T21:09:01,380  INFO [main] ql.Driver: Starting task [Stage-12:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:09:01,380  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:01,380  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:01,380  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:01,380  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:01,380  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:01,380  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:01,380  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:01,382  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:01,383  INFO [main] exec.Utilities: Processing alias file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10010
2024-04-23T21:09:01,383  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10010
2024-04-23T21:09:01,392  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:01,393  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,33KB
2024-04-23T21:09:01,398  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:01,400  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,39KB
2024-04-23T21:09:01,401  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:01,405  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10004
2024-04-23T21:09:01,408  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:01,431  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:01,436  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:01,437  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1,2
2024-04-23T21:09:01,437  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = _col0,_col1,_col2
2024-04-23T21:09:01,437  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10010
2024-04-23T21:09:01,441  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:09:01,441  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:01,461  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:01,481  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local267623251_0077
2024-04-23T21:09:01,481  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:01,547  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:01,547  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:01,548  INFO [Thread-6382] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:01,548  INFO [Thread-6382] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:01,549  INFO [Thread-6382] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:01,549  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local267623251_0077_m_000000_0
2024-04-23T21:09:01,550  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:01,550  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.mapred.SequenceFileInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10010/000000_0:0+96
2024-04-23T21:09:01,551  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:01,551  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,33KB
2024-04-23T21:09:01,552  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:09:01,556  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:01,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:01,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:01,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:01,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:01,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:01,557  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:01,558  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>
    <TS>Id =50
      <Children>
        <RS>Id =56
          <Children>
          <\Children>
          <Parent>Id = 50 null<\Parent>
        <\RS>
      <\Children>
      <Parent><\Parent>
    <\TS>
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:01,558  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[50]
2024-04-23T21:09:01,558  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[56]
2024-04-23T21:09:01,558  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:0, 
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[50]
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_50:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[56]
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[56]: Total records written - 0. abort - false
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_56:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:01,559  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:01,575  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local267623251_0077_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:01,575  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10010/000000_0:0+96
2024-04-23T21:09:01,575  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local267623251_0077_m_000000_0' done.
2024-04-23T21:09:01,575  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local267623251_0077_m_000000_0: Counters: 28
	File System Counters
		FILE: Number of bytes read=1681582
		FILE: Number of bytes written=96589149
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=0
		Map output records=0
		Map output bytes=0
		Map output materialized bytes=12
		Input split bytes=334
		Combine input records=0
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1936719872
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=0
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_56=0
		RECORDS_OUT_OPERATOR_TS_50=0
	File Input Format Counters 
		Bytes Read=4696
2024-04-23T21:09:01,575  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local267623251_0077_m_000000_0
2024-04-23T21:09:01,575  INFO [Thread-6382] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:01,577  INFO [Thread-6382] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:01,577  INFO [pool-369-thread-1] mapred.LocalJobRunner: Starting task: attempt_local267623251_0077_r_000000_0
2024-04-23T21:09:01,577  INFO [pool-369-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:01,577  INFO [pool-369-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6a7a1176
2024-04-23T21:09:01,578  WARN [pool-369-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:01,578  INFO [pool-369-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1355703936, maxSingleShuffleLimit=338925984, mergeThreshold=894764608, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:01,579  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local267623251_0077_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:01,580  INFO [localfetcher#104] reduce.LocalFetcher: localfetcher#104 about to shuffle output of map attempt_local267623251_0077_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:01,580  INFO [localfetcher#104] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local267623251_0077_m_000000_0
2024-04-23T21:09:01,580  INFO [localfetcher#104] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:01,580  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:01,581  INFO [pool-369-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:01,581  INFO [pool-369-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:01,587  INFO [pool-369-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:01,587  INFO [pool-369-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:01,590  INFO [pool-369-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:01,590  INFO [pool-369-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:01,590  INFO [pool-369-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:01,590  INFO [pool-369-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:01,590  INFO [pool-369-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:01,590  INFO [pool-369-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:01,590  INFO [pool-369-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:01,591  INFO [pool-369-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,39KB
2024-04-23T21:09:01,592  INFO [pool-369-thread-1] ExecReducer: 
<SEL>Id =32
  <Children>
    <FS>Id =33
      <Children>
      <\Children>
      <Parent>Id = 32 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:01,592  INFO [pool-369-thread-1] exec.SelectOperator: Initializing Operator: SEL[32]
2024-04-23T21:09:01,592  INFO [pool-369-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:decimal(5,2),_col1:varchar(128)>>
2024-04-23T21:09:01,592  INFO [pool-369-thread-1] exec.FileSinkOperator: Initializing Operator: FS[33]
2024-04-23T21:09:01,592  INFO [pool-369-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local267623251_0077/job_local267623251_0077.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7ccad860
2024-04-23T21:09:01,593  INFO [pool-369-thread-1] exec.SelectOperator: Closing Operator: SEL[32]
2024-04-23T21:09:01,593  INFO [pool-369-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_32:0, 
2024-04-23T21:09:01,593  INFO [pool-369-thread-1] exec.FileSinkOperator: Closing Operator: FS[33]
2024-04-23T21:09:01,593  INFO [pool-369-thread-1] exec.FileSinkOperator: FS[33]: records written - 0
2024-04-23T21:09:01,593  INFO [pool-369-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:01,593  INFO [pool-369-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:01,593  INFO [pool-369-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:01,599  INFO [pool-369-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_33:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_4_default.aci/d_u/ami:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:01,599  INFO [pool-369-thread-1] mapred.Task: Task:attempt_local267623251_0077_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:01,599  INFO [pool-369-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:01,599  INFO [pool-369-thread-1] mapred.Task: Task 'attempt_local267623251_0077_r_000000_0' done.
2024-04-23T21:09:01,599  INFO [pool-369-thread-1] mapred.Task: Final Counters for attempt_local267623251_0077_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1687102
		FILE: Number of bytes written=96589212
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1936719872
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:01,599  INFO [pool-369-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local267623251_0077_r_000000_0
2024-04-23T21:09:01,600  INFO [pool-369-thread-1] mapred.LocalJobRunner: Starting task: attempt_local267623251_0077_r_000001_0
2024-04-23T21:09:01,600  INFO [pool-369-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:01,600  INFO [pool-369-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2f235d1
2024-04-23T21:09:01,600  WARN [pool-369-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:01,601  INFO [pool-369-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1355703936, maxSingleShuffleLimit=338925984, mergeThreshold=894764608, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:01,602  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local267623251_0077_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:01,605  INFO [localfetcher#105] reduce.LocalFetcher: localfetcher#105 about to shuffle output of map attempt_local267623251_0077_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:01,605  INFO [localfetcher#105] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local267623251_0077_m_000000_0
2024-04-23T21:09:01,605  INFO [localfetcher#105] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:01,606  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:01,606  INFO [pool-369-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:01,606  INFO [pool-369-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:01,612  INFO [pool-369-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:01,612  INFO [pool-369-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:01,614  INFO [pool-369-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:01,615  INFO [pool-369-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:01,615  INFO [pool-369-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:01,615  INFO [pool-369-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:01,615  INFO [pool-369-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:01,615  INFO [pool-369-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:01,616  INFO [pool-369-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:01,616  INFO [pool-369-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,39KB
2024-04-23T21:09:01,617  INFO [pool-369-thread-1] ExecReducer: 
<SEL>Id =32
  <Children>
    <FS>Id =33
      <Children>
      <\Children>
      <Parent>Id = 32 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:01,617  INFO [pool-369-thread-1] exec.SelectOperator: Initializing Operator: SEL[32]
2024-04-23T21:09:01,617  INFO [pool-369-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:decimal(5,2),_col1:varchar(128)>>
2024-04-23T21:09:01,617  INFO [pool-369-thread-1] exec.FileSinkOperator: Initializing Operator: FS[33]
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local267623251_0077/job_local267623251_0077.xml], properties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.aci/d_u/ami, transactional=true, columns.types=int:decimal(5,2):varchar(128), bucket_field_name=i, columns=i,d?*de e,vc, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[i, d?*de e, vc], columnTypes=[int, decimal(5,2), varchar(128)], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6a8b2d00
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] exec.SelectOperator: Closing Operator: SEL[32]
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_32:0, 
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] exec.FileSinkOperator: Closing Operator: FS[33]
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] exec.FileSinkOperator: FS[33]: records written - 0
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:01,618  INFO [pool-369-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:01,624  INFO [pool-369-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_33:0, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_4_default.aci/d_u/ami:0, 
2024-04-23T21:09:01,625  INFO [pool-369-thread-1] mapred.Task: Task:attempt_local267623251_0077_r_000001_0 is done. And is in the process of committing
2024-04-23T21:09:01,625  INFO [pool-369-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:01,625  INFO [pool-369-thread-1] mapred.Task: Task 'attempt_local267623251_0077_r_000001_0' done.
2024-04-23T21:09:01,625  INFO [pool-369-thread-1] mapred.Task: Final Counters for attempt_local267623251_0077_r_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1692616
		FILE: Number of bytes written=96589275
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1936719872
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:01,625  INFO [pool-369-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local267623251_0077_r_000001_0
2024-04-23T21:09:01,626  INFO [Thread-6382] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:02,550 Stage-12 map = 100%,  reduce = 100%
2024-04-23T21:09:02,550  INFO [main] exec.Task: 2024-04-23 21:09:02,550 Stage-12 map = 100%,  reduce = 100%
Ended Job = job_local267623251_0077
2024-04-23T21:09:02,552  INFO [main] exec.Task: Ended Job = job_local267623251_0077
2024-04-23T21:09:02,553  INFO [main] FileOperations: No manifests found in directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami/_tmp.delta_0000001_0000001_0003 - query produced no output
Launching Job 6 out of 6
2024-04-23T21:09:02,553  INFO [main] ql.Driver: Launching Job 6 out of 6
2024-04-23T21:09:02,682  INFO [main] ql.Driver: Starting task [Stage-14:MAPRED] in serial mode
2024-04-23T21:09:02,682  INFO [main] exec.Utilities: Not using thread pool for getContentSummary
2024-04-23T21:09:02,683  INFO [main] exec.Utilities: BytesPerReducer=256000000 maxReducers=1009 totalInputFileSize=96
Number of reduce tasks not specified. Estimated from input data size: 1
2024-04-23T21:09:02,683  INFO [main] exec.Task: Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:02,683  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:02,683  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:02,683  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:02,683  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:02,683  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:02,683  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:02,685  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:02,685  INFO [main] exec.Utilities: Processing alias file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10011
2024-04-23T21:09:02,685  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10011
2024-04-23T21:09:02,694  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:02,695  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,37KB
2024-04-23T21:09:02,700  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:02,701  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,46KB
2024-04-23T21:09:02,702  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:02,705  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10006
2024-04-23T21:09:02,709  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:02,716  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:02,720  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:02,721  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:09:02,721  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = _col0,_col1
2024-04-23T21:09:02,721  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10011
2024-04-23T21:09:02,725  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:09:02,725  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:02,742  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:02,768  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1935584684_0078
2024-04-23T21:09:02,768  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:02,834  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:02,834  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:02,835  INFO [Thread-6436] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:02,835  INFO [Thread-6436] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:02,836  INFO [Thread-6436] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:02,837  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1935584684_0078_m_000000_0
2024-04-23T21:09:02,837  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:02,838  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.mapred.SequenceFileInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10011/000000_0:0+96
2024-04-23T21:09:02,839  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:02,839  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,37KB
2024-04-23T21:09:02,841  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:09:02,845  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:02,845  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:02,845  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:02,845  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:02,845  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:02,846  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:02,846  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:02,846  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>
    <TS>Id =52
      <Children>
        <RS>Id =57
          <Children>
          <\Children>
          <Parent>Id = 52 null<\Parent>
        <\RS>
      <\Children>
      <Parent><\Parent>
    <\TS>
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:02,847  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[52]
2024-04-23T21:09:02,847  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[57]
2024-04-23T21:09:02,847  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:09:02,848  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:02,848  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:09:02,848  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[52]
2024-04-23T21:09:02,848  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_52:0, 
2024-04-23T21:09:02,848  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[57]
2024-04-23T21:09:02,848  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[57]: Total records written - 0. abort - false
2024-04-23T21:09:02,848  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_57:0, 
2024-04-23T21:09:02,849  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:02,849  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:02,864  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1935584684_0078_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:02,865  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10011/000000_0:0+96
2024-04-23T21:09:02,865  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1935584684_0078_m_000000_0' done.
2024-04-23T21:09:02,865  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1935584684_0078_m_000000_0: Counters: 28
	File System Counters
		FILE: Number of bytes read=1697735
		FILE: Number of bytes written=97843289
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=0
		Map output records=0
		Map output bytes=0
		Map output materialized bytes=6
		Input split bytes=334
		Combine input records=0
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1936719872
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=0
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_57=0
		RECORDS_OUT_OPERATOR_TS_52=0
	File Input Format Counters 
		Bytes Read=4731
2024-04-23T21:09:02,865  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1935584684_0078_m_000000_0
2024-04-23T21:09:02,865  INFO [Thread-6436] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:02,865  INFO [Thread-6436] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:02,866  INFO [pool-372-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1935584684_0078_r_000000_0
2024-04-23T21:09:02,866  INFO [pool-372-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:02,866  INFO [pool-372-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2e4a5c85
2024-04-23T21:09:02,866  WARN [pool-372-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:02,867  INFO [pool-372-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1355703936, maxSingleShuffleLimit=338925984, mergeThreshold=894764608, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:02,867  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1935584684_0078_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:02,868  INFO [localfetcher#106] reduce.LocalFetcher: localfetcher#106 about to shuffle output of map attempt_local1935584684_0078_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:02,869  INFO [localfetcher#106] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1935584684_0078_m_000000_0
2024-04-23T21:09:02,869  INFO [localfetcher#106] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:02,869  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:02,869  INFO [pool-372-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:02,869  INFO [pool-372-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:02,876  INFO [pool-372-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:02,876  INFO [pool-372-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:02,878  INFO [pool-372-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:02,878  INFO [pool-372-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:02,878  INFO [pool-372-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:02,878  INFO [pool-372-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:02,878  INFO [pool-372-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:02,879  INFO [pool-372-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:02,879  INFO [pool-372-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:02,880  INFO [pool-372-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,46KB
2024-04-23T21:09:02,881  INFO [pool-372-thread-1] ExecReducer: 
<GBY>Id =38
  <Children>
    <FIL>Id =39
      <Children>
        <SEL>Id =40
          <Children>
            <FS>Id =41
              <Children>
              <\Children>
              <Parent>Id = 40 null<\Parent>
            <\FS>
          <\Children>
          <Parent>Id = 39 null<\Parent>
        <\SEL>
      <\Children>
      <Parent>Id = 38 null<\Parent>
    <\FIL>
  <\Children>
  <Parent><\Parent>
<\GBY>
2024-04-23T21:09:02,881  INFO [pool-372-thread-1] exec.GroupByOperator: Initializing Operator: GBY[38]
2024-04-23T21:09:02,881  INFO [pool-372-thread-1] exec.GroupByOperator: isTez: false isLlap: false numExecutors: 1 maxMemory: 1936719872
2024-04-23T21:09:02,881  INFO [pool-372-thread-1] exec.FilterOperator: Initializing Operator: FIL[39]
2024-04-23T21:09:02,881  INFO [pool-372-thread-1] exec.SelectOperator: Initializing Operator: SEL[40]
2024-04-23T21:09:02,881  INFO [pool-372-thread-1] exec.SelectOperator: SELECT struct<_col0:struct<writeid:bigint,bucketid:int,rowid:bigint>,_col1:bigint>
2024-04-23T21:09:02,882  INFO [pool-372-thread-1] exec.FileSinkOperator: Initializing Operator: FS[41]
2024-04-23T21:09:02,882  INFO [pool-372-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@52c71bba, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1558f63d, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [val] : [int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@1dfa1137
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.GroupByOperator: Closing Operator: GBY[38]
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.GroupByOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_GBY_38:0, 
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.FilterOperator: Closing Operator: FIL[39]
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.FilterOperator: RECORDS_OUT_OPERATOR_FIL_39:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.SelectOperator: Closing Operator: SEL[40]
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_40:0, 
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.FileSinkOperator: Closing Operator: FS[41]
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.FileSinkOperator: FS[41]: records written - 0
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table/.hive-staging_hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-ext-10005/000000_0
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table/.hive-staging_hive_2024-04-23_21-08-55_409_1626804205768031025-1/_task_tmp.-ext-10005/_tmp.000000_0
2024-04-23T21:09:02,883  INFO [pool-372-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table/.hive-staging_hive_2024-04-23_21-08-55_409_1626804205768031025-1/_tmp.-ext-10005/000000_0
2024-04-23T21:09:02,895  INFO [pool-372-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_OPERATOR_FS_41:0, RECORDS_OUT_5_default.merge_tmp_table:0, 
2024-04-23T21:09:02,895  INFO [pool-372-thread-1] mapred.Task: Task:attempt_local1935584684_0078_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:02,895  INFO [pool-372-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:02,895  INFO [pool-372-thread-1] mapred.Task: Task 'attempt_local1935584684_0078_r_000000_0' done.
2024-04-23T21:09:02,896  INFO [pool-372-thread-1] mapred.Task: Final Counters for attempt_local1935584684_0078_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1704306
		FILE: Number of bytes written=97843364
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1936719872
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:02,896  INFO [pool-372-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1935584684_0078_r_000000_0
2024-04-23T21:09:02,896  INFO [Thread-6436] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:03,837 Stage-14 map = 100%,  reduce = 100%
2024-04-23T21:09:03,837  INFO [main] exec.Task: 2024-04-23 21:09:03,837 Stage-14 map = 100%,  reduce = 100%
Ended Job = job_local1935584684_0078
2024-04-23T21:09:03,838  INFO [main] exec.Task: Ended Job = job_local1935584684_0078
2024-04-23T21:09:03,840  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.aci/d_u/ami
2024-04-23T21:09:03,840  INFO [main] exec.Task: Loading data to table default.aci/d_u/ami from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:03,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,847  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,853  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:03,883  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.aci/d_u/ami
2024-04-23T21:09:03,884  INFO [main] exec.Task: Loading data to table default.aci/d_u/ami from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:03,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,889  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,895  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,896  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:03,912  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.aci/d_u/ami
2024-04-23T21:09:03,912  INFO [main] exec.Task: Loading data to table default.aci/d_u/ami from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:03,912  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,918  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,924  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:03,941  INFO [main] ql.Driver: Starting task [Stage-3:MOVE] in serial mode
Loading data to table default.aci/d_u/ami
2024-04-23T21:09:03,941  INFO [main] exec.Task: Loading data to table default.aci/d_u/ami from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/aci-47-d_u-47-ami
2024-04-23T21:09:03,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,947  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,954  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:03,972  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Loading data to table default.merge_tmp_table
2024-04-23T21:09:03,972  INFO [main] exec.Task: Loading data to table default.merge_tmp_table from file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table/.hive-staging_hive_2024-04-23_21-08-55_409_1626804205768031025-1/-ext-10005
2024-04-23T21:09:03,974  WARN [main] metadata.Hive: Cannot get a table snapshot for merge_tmp_table
2024-04-23T21:09:03,974  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=merge_tmp_table
2024-04-23T21:09:03,974  INFO [main] ql.Driver: Starting task [Stage-7:STATS] in serial mode
2024-04-23T21:09:03,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,981  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,981  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:03,981  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10001
2024-04-23T21:09:03,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:03,989  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:03,989  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, numRows, false, 0, false: 
2024-04-23T21:09:03,989  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, rawDataSize, false, 0, false: 
2024-04-23T21:09:03,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:04,007  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, insertCount, false, 0, false: 
2024-04-23T21:09:04,007  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, updateCount, false, 0, false: 
2024-04-23T21:09:04,007  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, deleteCount, false, 0, false: 
2024-04-23T21:09:04,007  INFO [main] stats.BasicStatsTask: Table default.aci/d_u/ami stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:04,008  INFO [main] ql.Driver: Starting task [Stage-9:STATS] in serial mode
2024-04-23T21:09:04,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,014  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,014  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:04,014  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10002
2024-04-23T21:09:04,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,022  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,022  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, numRows, false, 0, false: 
2024-04-23T21:09:04,022  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, rawDataSize, false, 0, false: 
2024-04-23T21:09:04,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:04,041  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, insertCount, false, 0, false: 
2024-04-23T21:09:04,041  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, updateCount, false, 0, false: 
2024-04-23T21:09:04,041  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, deleteCount, false, 0, false: 
2024-04-23T21:09:04,041  INFO [main] stats.BasicStatsTask: Table default.aci/d_u/ami stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:04,041  INFO [main] ql.Driver: Starting task [Stage-11:STATS] in serial mode
2024-04-23T21:09:04,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,047  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,047  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:04,048  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10003
2024-04-23T21:09:04,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,055  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,055  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, numRows, false, 0, false: 
2024-04-23T21:09:04,055  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, rawDataSize, false, 0, false: 
2024-04-23T21:09:04,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:04,072  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, insertCount, false, 0, false: 
2024-04-23T21:09:04,072  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, updateCount, false, 0, false: 
2024-04-23T21:09:04,072  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, deleteCount, false, 0, false: 
2024-04-23T21:09:04,072  INFO [main] stats.BasicStatsTask: Table default.aci/d_u/ami stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:04,073  INFO [main] ql.Driver: Starting task [Stage-13:STATS] in serial mode
2024-04-23T21:09:04,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,078  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,078  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:04,079  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10004
2024-04-23T21:09:04,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,086  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,086  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, numRows, false, 0, false: 
2024-04-23T21:09:04,086  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, rawDataSize, false, 0, false: 
2024-04-23T21:09:04,087  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.aci/d_u/ami newtbl=aci/d_u/ami	
2024-04-23T21:09:04,103  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, insertCount, false, 0, false: 
2024-04-23T21:09:04,103  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, updateCount, false, 0, false: 
2024-04-23T21:09:04,103  INFO [main] FileOperations: Read stats for default.aci%2fd_u%2fami/, deleteCount, false, 0, false: 
2024-04-23T21:09:04,103  INFO [main] stats.BasicStatsTask: Table default.aci/d_u/ami stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:04,104  INFO [main] ql.Driver: Starting task [Stage-15:STATS] in serial mode
2024-04-23T21:09:04,104  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:04,104  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1/-mr-10006
2024-04-23T21:09:04,106  INFO [main] FileOperations: Read stats for default.merge_tmp_table/, numRows, true, 0, false: 
2024-04-23T21:09:04,106  INFO [main] FileOperations: Read stats for default.merge_tmp_table/, rawDataSize, true, 0, false: 
2024-04-23T21:09:04,106  WARN [main] metadata.Hive: Cannot get a table snapshot for merge_tmp_table
2024-04-23T21:09:04,106  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=merge_tmp_table
2024-04-23T21:09:04,106  INFO [main] stats.BasicStatsTask: Table default.merge_tmp_table stats: [numFiles=1, numRows=0, totalSize=0, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:04,107  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:04,107  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=148, getTable_(GetTableRequest)=95, isCompatibleWith_(Configuration)=2}
MapReduce Jobs Launched: 
2024-04-23T21:09:04,107  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-5:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:04,107  INFO [main] ql.Driver: Stage-Stage-5:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Stage-Stage-6:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:04,107  INFO [main] ql.Driver: Stage-Stage-6:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Stage-Stage-8:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:04,107  INFO [main] ql.Driver: Stage-Stage-8:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Stage-Stage-10:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:04,107  INFO [main] ql.Driver: Stage-Stage-10:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Stage-Stage-12:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:04,107  INFO [main] ql.Driver: Stage-Stage-12:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Stage-Stage-14:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:04,108  INFO [main] ql.Driver: Stage-Stage-14:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:04,108  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:04,108  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7); Time taken: 8.1 seconds
2024-04-23T21:09:04,108  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210855_5ae1c4df-35d4-49c8-a5d2-9b5c2b7da9f7
2024-04-23T21:09:04,129  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:04,131  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:09:04,131  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete
 when matched and `g/h` < 0 then update set vc=''  , `d?*de e` =  `d?*de e` * j + 1  
 when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-23T21:09:04,132  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table/.hive-staging_hive_2024-04-23_21-08-55_409_1626804205768031025-1
2024-04-23T21:09:04,132  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/5b7b38f0-71f7-4898-98eb-418826ab1931/_tmp_space.db/merge_tmp_table/.hive-staging_hive_2024-04-23_21-08-55_409_1626804205768031025-1 on fs with scheme file
2024-04-23T21:09:04,132  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1
2024-04-23T21:09:04,133  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_409_1626804205768031025-1 on fs with scheme file
2024-04-23T21:09:04,133  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1
2024-04-23T21:09:04,135  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-08-55_381_8001883493932680437-1 on fs with scheme file
2024-04-23T21:09:04,135  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210904_c2b2024a-3cbc-4e53-92be-46b83d858b8b): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete
 when matched and `g/h` < 0 then update set vc=''  , `d?*de e` =  `d?*de e` * j + 1  
 when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-23T21:09:04,139  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:09:04,139  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:09:04,142  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:09:04,142  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,148  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,149  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete
 when matched and `g/h` < 0 then update set vc=''  , `d?*de e` =  `d?*de e` * j + 1  
 when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)> as 
<FROM
  `default`.`aci/d_u/ami` `d/8`
  RIGHT OUTER JOIN
  `default`.`src/name` `a/b`
  ON `i`=`g/h`
INSERT INTO `default`.`aci/d_u/ami`    -- delete clause
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` > 5
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- update clause(insert part)
 SELECT `d/8`.`i`, `d?*de e` * `j` + 1, ''
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
INSERT INTO `default`.`aci/d_u/ami`    -- update clause (delete part)
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- insert clause
  SELECT `a/b`.`g/h`,`a/b`.`j`,`a/b`.`k`
   WHERE `d/8`.`i` IS NULL AND `d?*de e` <> 0
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`d/8`.ROW__ID)
 WHERE `i`=`g/h` GROUP BY `d/8`.ROW__ID HAVING count(*) > 1>
2024-04-23T21:09:04,150  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:09:04,155  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:04,155  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:04,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,162  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,163  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:09:04,186  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,186  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:04,186  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:04,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,192  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,192  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,199  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,205  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,211  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,211  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:04,211  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:04,212  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:04,212  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:04,212  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:04,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.src/name	
2024-04-23T21:09:04,260  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.aci/d_u/ami, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:09:04,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,270  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,270  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,279  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,279  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,288  WARN [main] calcite.RelOptHiveTable: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T21:09:04,288  INFO [main] SessionState: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T21:09:04,288  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.src/name, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:09:04,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:09:04,300  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,300  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T21:09:04,311  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.src/name	
2024-04-23T21:09:04,321  WARN [main] calcite.RelOptHiveTable: No Stats for default@src/name, Columns: g/h, k, j
No Stats for default@src/name, Columns: g/h, k, j
2024-04-23T21:09:04,321  INFO [main] SessionState: No Stats for default@src/name, Columns: g/h, k, j
2024-04-23T21:09:04,488  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:04,488  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:04,488  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:04,488  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:04,488  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:04,489  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:04,489  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:04,489  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:04,489  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:04,489  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:04,489  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:04,489  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:04,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,495  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,496  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,502  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,508  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T21:09:04,515  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,521 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1101) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:09:04,522 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:09:04,522  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:09:04,522 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1101)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:09:04,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:04,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=8, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=9, getTableColumnStatistics_(String, String, List, String)=57, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=23, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=86}
2024-04-23T21:09:04,523  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210904_c2b2024a-3cbc-4e53-92be-46b83d858b8b); Time taken: 0.388 seconds
2024-04-23T21:09:04,523  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:09:04,528  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:04,536  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:09:04,537  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/5b7b38f0-71f7-4898-98eb-418826ab1931/hive_2024-04-23_21-09-04_149_8769052955654219610-1
2024-04-23T21:09:04,537  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442): drop table if exists acidTbl
2024-04-23T21:09:04,539  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:09:04,540  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:09:04,540  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:04,546  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,546  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:04,546  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:04,547  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:04,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=13, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:09:04,547  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442); Time taken: 0.009 seconds
2024-04-23T21:09:04,547  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442
2024-04-23T21:09:04,548  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442
2024-04-23T21:09:04,564  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:09:04,564  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:04,565  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442): drop table if exists acidTbl
2024-04-23T21:09:04,565  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:04,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:04,571  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:04,577  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:04,681  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:04,681  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=110}
2024-04-23T21:09:04,682  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442); Time taken: 0.116 seconds
2024-04-23T21:09:04,682  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210904_d2960bb0-e1f0-4751-877f-1abe232f4442
2024-04-23T21:09:04,686  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:09:04,693  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:04,694  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:09:04,694  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:09:04,694  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29): drop table if exists acidTblPart
2024-04-23T21:09:04,697  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:09:04,697  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:09:04,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:04,703  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,704  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:04,704  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:04,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:04,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:09:04,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29); Time taken: 0.01 seconds
2024-04-23T21:09:04,704  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29
2024-04-23T21:09:04,705  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29
2024-04-23T21:09:04,725  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:09:04,725  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:04,725  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29): drop table if exists acidTblPart
2024-04-23T21:09:04,725  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:04,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:04,731  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:04,737  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:04,776  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:04,776  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=45, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:04,777  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29); Time taken: 0.051 seconds
2024-04-23T21:09:04,777  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210904_31f0885c-5d54-4662-814b-e126e81abc29
2024-04-23T21:09:04,781  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:09:04,789  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:04,789  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:09:04,790  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:09:04,790  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210904_02e698a7-056a-4316-a1d8-1c9cd947a606): drop table if exists acidTbl2
2024-04-23T21:09:04,792  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T21:09:04,792  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:09:04,793  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:04,793  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:04,793  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:04,793  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-23T21:09:04,793  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210904_02e698a7-056a-4316-a1d8-1c9cd947a606); Time taken: 0.003 seconds
2024-04-23T21:09:04,794  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210904_02e698a7-056a-4316-a1d8-1c9cd947a606
2024-04-23T21:09:04,794  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:04,794  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210904_02e698a7-056a-4316-a1d8-1c9cd947a606): drop table if exists acidTbl2
2024-04-23T21:09:04,794  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:04,795  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:09:04,795  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:04,795  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=1}
2024-04-23T21:09:04,795  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210904_02e698a7-056a-4316-a1d8-1c9cd947a606); Time taken: 0.001 seconds
2024-04-23T21:09:04,795  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210904_02e698a7-056a-4316-a1d8-1c9cd947a606
2024-04-23T21:09:04,802  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:09:04,809  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:04,809  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:09:04,809  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:09:04,810  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:04,812  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 18
2024-04-23T21:09:04,813  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:09:04,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:04,835  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,835  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:04,835  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:04,835  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:04,835  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=22, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:04,836  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3); Time taken: 0.025 seconds
2024-04-23T21:09:04,836  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3
2024-04-23T21:09:04,836  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3
2024-04-23T21:09:04,852  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:09:04,852  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:04,852  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:04,852  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:04,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:04,860  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:04,867  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,868  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:04,922  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:04,922  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=61, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:04,922  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3); Time taken: 0.069 seconds
2024-04-23T21:09:04,922  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210904_03e6c427-9c81-49f3-b471-bc7ec64c54e3
2024-04-23T21:09:04,927  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:09:04,934  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:04,934  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:09:04,934  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:04,935  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:04,937  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-23T21:09:04,938  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:09:04,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:04,946  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,946  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:04,946  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:04,946  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:04,946  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:09:04,946  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f); Time taken: 0.011 seconds
2024-04-23T21:09:04,946  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f
2024-04-23T21:09:04,947  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f
2024-04-23T21:09:04,963  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:09:04,963  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:04,963  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:04,963  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:04,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:04,971  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:04,978  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:04,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:05,007  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,007  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=36, getTable_(GetTableRequest)=8}
2024-04-23T21:09:05,007  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f); Time taken: 0.044 seconds
2024-04-23T21:09:05,008  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210904_8c55f1da-f01e-46ab-a61a-bd3e33e0ba9f
2024-04-23T21:09:05,012  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:09:05,020  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,020  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:09:05,020  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:09:05,021  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0): drop table if exists nonAcidNonBucket
2024-04-23T21:09:05,023  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 18
2024-04-23T21:09:05,023  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:09:05,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:05,031  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:05,032  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,032  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,032  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,032  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=7, openTxn_(String, TxnType)=2}
2024-04-23T21:09:05,032  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0); Time taken: 0.011 seconds
2024-04-23T21:09:05,032  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0
2024-04-23T21:09:05,033  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0
2024-04-23T21:09:05,049  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:09:05,049  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:05,049  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0): drop table if exists nonAcidNonBucket
2024-04-23T21:09:05,049  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:05,056  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:05,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:05,064  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:05,064  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:05,091  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,091  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=35}
2024-04-23T21:09:05,091  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0); Time taken: 0.042 seconds
2024-04-23T21:09:05,091  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_4262e7f2-e3c7-481d-a557-3c93bf41f2e0
2024-04-23T21:09:05,096  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T21:09:05,105  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,105  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T21:09:05,106  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.729">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 4 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:09:05,174  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:09:05,177  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 3d55ed60-d939-4522-b3c7-5da264ed961e
2024-04-23T21:09:05,180  INFO [main] SessionState: Hive Session ID = 3d55ed60-d939-4522-b3c7-5da264ed961e
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:09:05,180  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:09:05,186  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3d55ed60-d939-4522-b3c7-5da264ed961e
2024-04-23T21:09:05,189  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e
2024-04-23T21:09:05,191  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3d55ed60-d939-4522-b3c7-5da264ed961e/_tmp_space.db
2024-04-23T21:09:05,191  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=3d55ed60-d939-4522-b3c7-5da264ed961e, clientType=HIVECLI]
2024-04-23T21:09:05,192  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:09:05,192  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_773d4900-31d5-4cfe-bcb7-178956ff7a96): drop table if exists acidTbl
2024-04-23T21:09:05,203  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:09:05,203  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:09:05,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:05,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=11, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, getValidTxns_(long)=3}
2024-04-23T21:09:05,209  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_773d4900-31d5-4cfe-bcb7-178956ff7a96); Time taken: 0.016 seconds
2024-04-23T21:09:05,209  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210905_773d4900-31d5-4cfe-bcb7-178956ff7a96
2024-04-23T21:09:05,209  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:05,209  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_773d4900-31d5-4cfe-bcb7-178956ff7a96): drop table if exists acidTbl
2024-04-23T21:09:05,209  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:05,212  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,212  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,212  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_773d4900-31d5-4cfe-bcb7-178956ff7a96); Time taken: 0.003 seconds
2024-04-23T21:09:05,213  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_773d4900-31d5-4cfe-bcb7-178956ff7a96
2024-04-23T21:09:05,219  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:09:05,227  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,228  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:09:05,228  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:09:05,229  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_6d35def2-148d-4ff9-81f4-7eaee9b57553): drop table if exists acidTblPart
2024-04-23T21:09:05,231  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:09:05,231  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:09:05,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:05,234  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,234  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,234  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,234  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:09:05,235  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_6d35def2-148d-4ff9-81f4-7eaee9b57553); Time taken: 0.005 seconds
2024-04-23T21:09:05,235  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210905_6d35def2-148d-4ff9-81f4-7eaee9b57553
2024-04-23T21:09:05,235  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:05,235  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_6d35def2-148d-4ff9-81f4-7eaee9b57553): drop table if exists acidTblPart
2024-04-23T21:09:05,235  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,235  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:05,238  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,238  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,238  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_6d35def2-148d-4ff9-81f4-7eaee9b57553); Time taken: 0.003 seconds
2024-04-23T21:09:05,238  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_6d35def2-148d-4ff9-81f4-7eaee9b57553
2024-04-23T21:09:05,245  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:09:05,252  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,253  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:09:05,253  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:09:05,253  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_2f38baaa-f5c5-4d82-a914-b56a2334d731): drop table if exists acidTbl2
2024-04-23T21:09:05,256  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:09:05,256  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:09:05,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:09:05,259  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,259  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, flushCache_()=1}
2024-04-23T21:09:05,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_2f38baaa-f5c5-4d82-a914-b56a2334d731); Time taken: 0.006 seconds
2024-04-23T21:09:05,260  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210905_2f38baaa-f5c5-4d82-a914-b56a2334d731
2024-04-23T21:09:05,260  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:05,260  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_2f38baaa-f5c5-4d82-a914-b56a2334d731): drop table if exists acidTbl2
2024-04-23T21:09:05,260  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:09:05,263  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,263  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,263  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_2f38baaa-f5c5-4d82-a914-b56a2334d731); Time taken: 0.003 seconds
2024-04-23T21:09:05,263  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_2f38baaa-f5c5-4d82-a914-b56a2334d731
2024-04-23T21:09:05,270  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:09:05,277  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,277  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:09:05,278  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:09:05,278  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_754cb35c-d6da-4e2f-a05a-87bd81107f03): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:05,280  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:09:05,281  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:09:05,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:05,284  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,284  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,284  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,284  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:09:05,284  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_754cb35c-d6da-4e2f-a05a-87bd81107f03); Time taken: 0.006 seconds
2024-04-23T21:09:05,284  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210905_754cb35c-d6da-4e2f-a05a-87bd81107f03
2024-04-23T21:09:05,284  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:05,284  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_754cb35c-d6da-4e2f-a05a-87bd81107f03): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:05,284  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:05,287  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,287  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,288  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_754cb35c-d6da-4e2f-a05a-87bd81107f03); Time taken: 0.003 seconds
2024-04-23T21:09:05,288  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_754cb35c-d6da-4e2f-a05a-87bd81107f03
2024-04-23T21:09:05,294  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:09:05,302  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,302  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:09:05,302  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:05,303  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_747fe335-77c1-4463-a2f8-b89877b5a724): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:05,305  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:09:05,305  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:09:05,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:05,308  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,308  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,308  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,309  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2}
2024-04-23T21:09:05,309  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_747fe335-77c1-4463-a2f8-b89877b5a724); Time taken: 0.005 seconds
2024-04-23T21:09:05,309  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210905_747fe335-77c1-4463-a2f8-b89877b5a724
2024-04-23T21:09:05,309  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:05,309  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_747fe335-77c1-4463-a2f8-b89877b5a724): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:05,309  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:05,312  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,312  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,312  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_747fe335-77c1-4463-a2f8-b89877b5a724); Time taken: 0.003 seconds
2024-04-23T21:09:05,312  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_747fe335-77c1-4463-a2f8-b89877b5a724
2024-04-23T21:09:05,319  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:09:05,327  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,328  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:09:05,328  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:09:05,328  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_ddd37527-9859-41fb-ad91-eed25648d8a0): drop table if exists nonAcidNonBucket
2024-04-23T21:09:05,331  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:09:05,331  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:09:05,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:05,334  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,334  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,335  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,335  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:09:05,335  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_ddd37527-9859-41fb-ad91-eed25648d8a0); Time taken: 0.006 seconds
2024-04-23T21:09:05,335  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210905_ddd37527-9859-41fb-ad91-eed25648d8a0
2024-04-23T21:09:05,335  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:05,335  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_ddd37527-9859-41fb-ad91-eed25648d8a0): drop table if exists nonAcidNonBucket
2024-04-23T21:09:05,335  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:05,338  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,338  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,338  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_ddd37527-9859-41fb-ad91-eed25648d8a0); Time taken: 0.003 seconds
2024-04-23T21:09:05,338  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_ddd37527-9859-41fb-ad91-eed25648d8a0
2024-04-23T21:09:05,345  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:09:05,353  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,353  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:09:05,354  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,354  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,357  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:09:05,357  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:09:05,357  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:05,357  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:05,364  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:09:05,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:05,366  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:05,366  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,366  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,366  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,366  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=6, getValidTxns_(long)=0, getDatabase_(String)=1}
2024-04-23T21:09:05,367  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274); Time taken: 0.012 seconds
2024-04-23T21:09:05,367  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274
2024-04-23T21:09:05,367  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274
2024-04-23T21:09:05,392  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:09:05,392  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:05,393  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,393  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931745, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=true, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, totalSize=0, numFilesErasureCoded=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:09:05,400  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:05,441  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,442  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=47, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,442  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274); Time taken: 0.048 seconds
2024-04-23T21:09:05,442  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_9a01d764-d209-40d6-a177-9a288734a274
2024-04-23T21:09:05,447  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:09:05,455  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,457  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:09:05,458  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,458  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,461  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:09:05,461  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:09:05,462  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:05,462  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:05,465  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:09:05,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:05,467  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:05,467  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,467  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,468  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,468  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=16, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,468  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7); Time taken: 0.01 seconds
2024-04-23T21:09:05,468  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7
2024-04-23T21:09:05,469  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7
2024-04-23T21:09:05,486  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:09:05,486  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:05,487  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,487  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,488  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931745, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:09:05,493  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:09:05,514  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,514  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-23T21:09:05,514  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7); Time taken: 0.027 seconds
2024-04-23T21:09:05,514  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_6deae69c-9d92-4575-a258-70989ebed4c7
2024-04-23T21:09:05,519  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:09:05,528  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,528  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:09:05,529  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,529  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,532  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:09:05,532  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:09:05,533  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:05,533  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:05,536  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:09:05,536  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:05,538  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:05,538  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,538  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,538  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,538  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, flushCache_()=0, getDatabase_(String)=2}
2024-04-23T21:09:05,538  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8); Time taken: 0.009 seconds
2024-04-23T21:09:05,539  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8
2024-04-23T21:09:05,539  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8
2024-04-23T21:09:05,557  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:09:05,557  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:05,557  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,557  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,558  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931745, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, transactional=false, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFiles=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:05,563  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:09:05,577  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,577  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,577  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8); Time taken: 0.02 seconds
2024-04-23T21:09:05,578  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_40b523a8-918f-4dfa-af48-8d4afba905f8
2024-04-23T21:09:05,584  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:09:05,592  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,592  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:09:05,592  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,593  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,596  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:09:05,596  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:09:05,597  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:05,597  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:05,600  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:09:05,600  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:05,602  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:05,602  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,603  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,603  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,603  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, getDatabase_(String)=2}
2024-04-23T21:09:05,603  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea); Time taken: 0.01 seconds
2024-04-23T21:09:05,603  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea
2024-04-23T21:09:05,604  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea
2024-04-23T21:09:05,621  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:09:05,621  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:05,621  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,621  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,622  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931745, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, numFilesErasureCoded=0, totalSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:05,629  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:09:05,644  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,644  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,644  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea); Time taken: 0.023 seconds
2024-04-23T21:09:05,644  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_720e21d6-1a16-4167-890c-c64ee5edc1ea
2024-04-23T21:09:05,651  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:09:05,659  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,659  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:09:05,660  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,660  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,664  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:09:05,664  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:09:05,665  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:05,665  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:05,668  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:09:05,669  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:05,670  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:05,670  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,670  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,670  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,670  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, flushCache_()=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:09:05,671  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b); Time taken: 0.01 seconds
2024-04-23T21:09:05,671  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b
2024-04-23T21:09:05,671  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b
2024-04-23T21:09:05,689  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:09:05,689  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:05,689  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:05,690  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,690  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/3d55ed60-d939-4522-b3c7-5da264ed961e/_tmp_space.db/ecf0f816-387d-4195-83ba-3fa06e216a61
2024-04-23T21:09:05,693  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,693  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:09:05,694  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b); Time taken: 0.004 seconds
2024-04-23T21:09:05,694  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_51f988c6-9f21-464b-89b2-486ad8c2986b
2024-04-23T21:09:05,699  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:09:05,709  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,709  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:09:05,709  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,710  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,713  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:09:05,713  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:09:05,714  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:05,714  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:05,717  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:09:05,717  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:05,719  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:05,719  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,719  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:05,719  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,719  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=15, getDatabase_(String)=2}
2024-04-23T21:09:05,719  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54); Time taken: 0.009 seconds
2024-04-23T21:09:05,720  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54
2024-04-23T21:09:05,720  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54
2024-04-23T21:09:05,737  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:09:05,737  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:05,737  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:05,737  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:05,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931745, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, rawDataSize=0, numFilesErasureCoded=0, bucketing_version=2, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:05,743  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:09:05,757  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:05,758  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-23T21:09:05,758  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54); Time taken: 0.02 seconds
2024-04-23T21:09:05,758  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_1e6d30dd-c9fa-4188-ba43-79658af58a54
2024-04-23T21:09:05,763  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:09:05,770  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:05,770  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:09:05,771  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:09:05,771  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:09:05,773  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:09:05,774  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:09:05,774  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:05,774  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:05,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:05,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:05,798  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:05,798  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:05,798  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:05,798  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:05,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:05,804  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:05,804  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:05,804  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:05,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:05,897  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:05,897  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:05,897  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:05,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:05,900  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:05,900  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:05,900  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:05,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:05,906  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:05,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:05,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:05,921  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T21:09:05,922  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T21:09:05,923  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:09:05,926  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:05,926  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:05,927  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:09:05,927  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:09:05,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:05,942  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:09:05,943  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:05,944  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:05,944  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:09:05,944  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:05,944  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:05,944  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:09:05,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:05,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=28, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0, getTable_(GetTableRequest)=39, allocateTableWriteId_(long, String, String)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:05,944  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175); Time taken: 0.173 seconds
2024-04-23T21:09:05,944  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175
2024-04-23T21:09:05,944  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175
2024-04-23T21:09:05,970  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:09:05,970  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:09:05,973  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T21:09:05,973  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175
2024-04-23T21:09:05,973  INFO [main] ql.Driver: Query ID = alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175
Total jobs = 1
2024-04-23T21:09:05,973  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:09:05,973  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:09:06,097  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:09:06,097  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:06,097  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:06,097  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:06,097  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:06,097  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:06,097  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:06,097  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:06,100  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:06,100  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:09:06,100  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-05_771_2966165086468454169-1/dummy_path
2024-04-23T21:09:06,109  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:06,109  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,29KB
2024-04-23T21:09:06,114  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:06,115  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:09:06,116  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:06,120  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-05_771_2966165086468454169-1/-mr-10000
2024-04-23T21:09:06,122  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:06,128  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:06,133  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:06,134  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:09:06,134  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:09:06,134  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-05_771_2966165086468454169-1/dummy_path
2024-04-23T21:09:06,134  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:06,150  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:06,169  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1740012667_0079
2024-04-23T21:09:06,169  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:06,228  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:06,228  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:06,229  INFO [Thread-6526] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:06,229  INFO [Thread-6526] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:06,231  INFO [Thread-6526] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:06,231  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1740012667_0079_m_000000_0
2024-04-23T21:09:06,233  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:06,234  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-05_771_2966165086468454169-1/dummy_path/null:0+1
2024-04-23T21:09:06,236  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:06,236  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,29KB
2024-04-23T21:09:06,237  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:09:06,241  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:06,241  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:06,241  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:06,241  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:06,241  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:06,242  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:06,242  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:06,242  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:09:06,243  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:09:06,244  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:09:06,244  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:09:06,244  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:09:06,244  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:06,244  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:09:06,244  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:09:06,245  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:09:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:09:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:09:06,248  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:09:06,262  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:09:06,274  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1740012667_0079_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:06,275  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:09:06,275  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1740012667_0079_m_000000_0' done.
2024-04-23T21:09:06,275  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1740012667_0079_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1710606
		FILE: Number of bytes written=99098839
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1938292736
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5342
2024-04-23T21:09:06,275  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1740012667_0079_m_000000_0
2024-04-23T21:09:06,276  INFO [Thread-6526] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:06,279  INFO [Thread-6526] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:06,279  INFO [pool-381-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1740012667_0079_r_000000_0
2024-04-23T21:09:06,284  INFO [pool-381-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:06,284  INFO [pool-381-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@75a3f5fc
2024-04-23T21:09:06,285  WARN [pool-381-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:06,286  INFO [pool-381-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356804864, maxSingleShuffleLimit=339201216, mergeThreshold=895491264, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:06,288  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1740012667_0079_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:06,294  INFO [localfetcher#107] reduce.LocalFetcher: localfetcher#107 about to shuffle output of map attempt_local1740012667_0079_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:09:06,295  INFO [localfetcher#107] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1740012667_0079_m_000000_0
2024-04-23T21:09:06,295  INFO [localfetcher#107] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:09:06,296  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:06,296  INFO [pool-381-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:06,296  INFO [pool-381-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:06,307  INFO [pool-381-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:06,307  INFO [pool-381-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:09:06,313  INFO [pool-381-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:06,313  INFO [pool-381-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:09:06,313  INFO [pool-381-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:06,313  INFO [pool-381-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:06,314  INFO [pool-381-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:09:06,314  INFO [pool-381-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:06,315  INFO [pool-381-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:06,316  INFO [pool-381-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:09:06,318  INFO [pool-381-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:06,318  INFO [pool-381-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:06,318  INFO [pool-381-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:09:06,318  INFO [pool-381-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:06,318  INFO [pool-381-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1740012667_0079/job_local1740012667_0079.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2411108b
2024-04-23T21:09:06,319  INFO [pool-381-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:06,319  INFO [pool-381-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:06,319  INFO [pool-381-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:06,321  INFO [pool-381-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:06,321  INFO [pool-381-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:06,338  INFO [pool-381-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:06,349  INFO [pool-381-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:06,349  INFO [pool-381-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:06,350  INFO [pool-381-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:06,350  INFO [pool-381-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:06,353  INFO [pool-381-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:09:06,382  INFO [pool-381-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:06,383  INFO [pool-381-thread-1] mapred.Task: Task:attempt_local1740012667_0079_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:06,384  INFO [pool-381-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:06,384  INFO [pool-381-thread-1] mapred.Task: Task 'attempt_local1740012667_0079_r_000000_0' done.
2024-04-23T21:09:06,384  INFO [pool-381-thread-1] mapred.Task: Final Counters for attempt_local1740012667_0079_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1716713
		FILE: Number of bytes written=99099878
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1938292736
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:06,384  INFO [pool-381-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1740012667_0079_r_000000_0
2024-04-23T21:09:06,384  INFO [pool-381-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1740012667_0079_r_000001_0
2024-04-23T21:09:06,385  INFO [pool-381-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:06,385  INFO [pool-381-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2e71478
2024-04-23T21:09:06,386  WARN [pool-381-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:06,388  INFO [pool-381-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356804864, maxSingleShuffleLimit=339201216, mergeThreshold=895491264, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:06,390  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1740012667_0079_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:06,395  INFO [localfetcher#108] reduce.LocalFetcher: localfetcher#108 about to shuffle output of map attempt_local1740012667_0079_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:09:06,395  INFO [localfetcher#108] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1740012667_0079_m_000000_0
2024-04-23T21:09:06,395  INFO [localfetcher#108] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:09:06,396  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:06,397  INFO [pool-381-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:06,397  INFO [pool-381-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:06,407  INFO [pool-381-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:06,407  INFO [pool-381-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:09:06,414  INFO [pool-381-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:06,414  INFO [pool-381-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:09:06,414  INFO [pool-381-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:06,414  INFO [pool-381-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:06,414  INFO [pool-381-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:09:06,414  INFO [pool-381-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:06,415  INFO [pool-381-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:06,416  INFO [pool-381-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:09:06,418  INFO [pool-381-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:06,418  INFO [pool-381-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:06,418  INFO [pool-381-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:09:06,418  INFO [pool-381-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:06,419  INFO [pool-381-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1740012667_0079/job_local1740012667_0079.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@509ef418
2024-04-23T21:09:06,420  INFO [pool-381-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:06,420  INFO [pool-381-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:06,420  INFO [pool-381-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:06,421  INFO [pool-381-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:06,421  INFO [pool-381-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:06,434  INFO [pool-381-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:06,434  INFO [pool-381-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:06,434  INFO [pool-381-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:09:06,434  INFO [pool-381-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:06,434  INFO [pool-381-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:06,437  INFO [pool-381-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:09:06,453  INFO [pool-381-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-23T21:09:06,453  INFO [pool-381-thread-1] mapred.Task: Task:attempt_local1740012667_0079_r_000001_0 is done. And is in the process of committing
2024-04-23T21:09:06,454  INFO [pool-381-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:06,454  INFO [pool-381-thread-1] mapred.Task: Task 'attempt_local1740012667_0079_r_000001_0' done.
2024-04-23T21:09:06,454  INFO [pool-381-thread-1] mapred.Task: Final Counters for attempt_local1740012667_0079_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1722796
		FILE: Number of bytes written=99100906
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1938292736
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:06,454  INFO [pool-381-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1740012667_0079_r_000001_0
2024-04-23T21:09:06,454  INFO [Thread-6526] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:07,230 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:09:07,230  INFO [main] exec.Task: 2024-04-23 21:09:07,230 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1740012667_0079
2024-04-23T21:09:07,230  INFO [main] exec.Task: Ended Job = job_local1740012667_0079
2024-04-23T21:09:07,231  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:09:07,231  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:09:07,231  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:09:07,232  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:09:07,232  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:09:07,233  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:09:07,233  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:07,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,239  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:07,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,246  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:07,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:07,283  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:09:07,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:07,290  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:07,290  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-05_771_2966165086468454169-1/-mr-10000
2024-04-23T21:09:07,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,298  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:07,309  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:09:07,309  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:09:07,309  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:09:07,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:07,330  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:09:07,330  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:09:07,330  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:09:07,333  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:07,333  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:07,333  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=58, getTable_(GetTableRequest)=25, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3}
MapReduce Jobs Launched: 
2024-04-23T21:09:07,334  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:07,334  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:07,334  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:07,334  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175); Time taken: 1.36 seconds
2024-04-23T21:09:07,334  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210905_561584e7-08d4-4dd6-b181-ecc26013b175
2024-04-23T21:09:07,347  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:07,347  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:09:07,348  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T21:09:07,348  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-05_771_2966165086468454169-1
2024-04-23T21:09:07,349  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-05_771_2966165086468454169-1 on fs with scheme file
2024-04-23T21:09:07,349  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e): select a,b from acidTbl order by a,b
2024-04-23T21:09:07,360  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:09:07,360  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:09:07,363  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:07,363  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:07,366  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:07,366  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:07,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,373  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:07,373  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:07,373  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:07,373  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:07,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,411  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T21:09:07,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,421  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:07,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:07,432  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:07,432  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:09:07,446  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:09:07,446  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T21:09:07,511  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:07,511  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:07,511  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:07,512  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-07_349_6581647603926903910-1/-mr-10001/.hive-staging_hive_2024-04-23_21-09-07_349_6581647603926903910-1
2024-04-23T21:09:07,532  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:09:07,535  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:09:07,535  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:09:07,537  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:09:07,549  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:07,549  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:09:07,549  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:09:07,550  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:07,551  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:07,551  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:09:07,551  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:07,551  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:07,551  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:09:07,553  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:09:07,553  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:07,553  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, getTableColumnStatistics_(String, String, List, String)=34, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=10, flushCache_()=0, getValidWriteIds_(List, String)=5, getAllTableConstraints_(AllTableConstraintsRequest)=6, getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=14}
2024-04-23T21:09:07,553  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e); Time taken: 0.204 seconds
2024-04-23T21:09:07,554  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e
2024-04-23T21:09:07,554  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e
2024-04-23T21:09:07,575  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:09:07,575  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:09:07,576  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e): select a,b from acidTbl order by a,b
2024-04-23T21:09:07,576  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e
2024-04-23T21:09:07,576  INFO [main] ql.Driver: Query ID = alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e
Total jobs = 1
2024-04-23T21:09:07,576  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:09:07,576  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:09:07,717  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:09:07,717  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:07,717  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:07,718  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:07,718  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:07,718  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:07,718  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:07,718  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:07,720  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:07,720  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T21:09:07,720  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:07,729  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:07,731  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:09:07,736  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:07,737  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,02KB
2024-04-23T21:09:07,738  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:07,743  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:07,751  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:07,755  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:07,756  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:09:07,756  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:09:07,756  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:07,757  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:09:07,757  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:09:07,757  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:09:07,769  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:09:07,769  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 12 ms
2024-04-23T21:09:07,769  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:09:07,788  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:09:07,808  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1481749867_0080
2024-04-23T21:09:07,808  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:07,886  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:07,887  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:07,887  INFO [Thread-6603] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:07,887  INFO [Thread-6603] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:07,889  INFO [Thread-6603] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:07,890  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1481749867_0080_m_000000_0
2024-04-23T21:09:07,890  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:07,891  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:09:07,891  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:07,892  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:09:07,892  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:09:07,893  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:09:07,894  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:09:07,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:07,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:07,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:07,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:07,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:07,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:07,916  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:07,916  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:07,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:09:07,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:09:07,929  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:09:07,932  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1481749867_0080_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:07,932  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:09:07,932  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1481749867_0080_m_000000_0' done.
2024-04-23T21:09:07,932  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1481749867_0080_m_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1733456
		FILE: Number of bytes written=100355472
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=16
		Total committed heap usage (bytes)=1936719872
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8955
2024-04-23T21:09:07,932  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1481749867_0080_m_000000_0
2024-04-23T21:09:07,932  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1481749867_0080_m_000001_0
2024-04-23T21:09:07,933  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:07,933  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:09:07,934  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:07,934  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,12KB
2024-04-23T21:09:07,934  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.acidtbl:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:09:07,935  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: false}
2024-04-23T21:09:07,936  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:09:07,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:07,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:07,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:07,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:07,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:07,940  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:07,941  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:07,941  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:07,941  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:09:07,941  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:09:07,942  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 1. abort - false
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_6:1, 
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T21:09:07,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:09:07,951  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:09:07,954  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1481749867_0080_m_000001_0 is done. And is in the process of committing
2024-04-23T21:09:07,954  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:09:07,954  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1481749867_0080_m_000001_0' done.
2024-04-23T21:09:07,954  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1481749867_0080_m_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1743416
		FILE: Number of bytes written=100355531
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1936719872
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=8947
2024-04-23T21:09:07,955  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1481749867_0080_m_000001_0
2024-04-23T21:09:07,955  INFO [Thread-6603] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:07,956  INFO [Thread-6603] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:07,956  INFO [pool-386-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1481749867_0080_r_000000_0
2024-04-23T21:09:07,956  INFO [pool-386-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:07,956  INFO [pool-386-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5db79eb7
2024-04-23T21:09:07,957  WARN [pool-386-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:07,957  INFO [pool-386-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1355703936, maxSingleShuffleLimit=338925984, mergeThreshold=894764608, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:07,958  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1481749867_0080_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:07,960  INFO [localfetcher#109] reduce.LocalFetcher: localfetcher#109 about to shuffle output of map attempt_local1481749867_0080_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:09:07,960  INFO [localfetcher#109] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1481749867_0080_m_000000_0
2024-04-23T21:09:07,960  INFO [localfetcher#109] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T21:09:07,963  INFO [localfetcher#109] reduce.LocalFetcher: localfetcher#109 about to shuffle output of map attempt_local1481749867_0080_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T21:09:07,964  INFO [localfetcher#109] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1481749867_0080_m_000001_0
2024-04-23T21:09:07,964  INFO [localfetcher#109] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T21:09:07,965  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:07,965  INFO [pool-386-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:09:07,965  INFO [pool-386-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:07,978  INFO [pool-386-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:09:07,978  INFO [pool-386-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-23T21:09:07,985  INFO [pool-386-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:07,985  INFO [pool-386-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-23T21:09:07,985  INFO [pool-386-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:07,986  INFO [pool-386-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:07,986  INFO [pool-386-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-23T21:09:07,986  INFO [pool-386-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:09:07,987  INFO [pool-386-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:07,988  INFO [pool-386-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,02KB
2024-04-23T21:09:07,990  INFO [pool-386-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:07,990  INFO [pool-386-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:09:07,990  INFO [pool-386-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T21:09:07,990  INFO [pool-386-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:09:07,991  INFO [pool-386-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@71b3c55c, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@20e4e27f>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@78a46cbe, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@10d8b66e
2024-04-23T21:09:07,992  INFO [pool-386-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-07_349_6581647603926903910-1/-mr-10001/.hive-staging_hive_2024-04-23_21-09-07_349_6581647603926903910-1/_tmp.-ext-10002/000000_0
2024-04-23T21:09:07,992  INFO [pool-386-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-07_349_6581647603926903910-1/-mr-10001/.hive-staging_hive_2024-04-23_21-09-07_349_6581647603926903910-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:09:07,992  INFO [pool-386-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-07_349_6581647603926903910-1/-mr-10001/.hive-staging_hive_2024-04-23_21-09-07_349_6581647603926903910-1/_tmp.-ext-10002/000000_0
2024-04-23T21:09:08,011  INFO [pool-386-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:09:08,011  INFO [pool-386-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:09:08,012  INFO [pool-386-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:08,012  INFO [pool-386-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:09:08,012  INFO [pool-386-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:09:08,013  INFO [pool-386-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:2, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-23T21:09:08,013  INFO [pool-386-thread-1] mapred.Task: Task:attempt_local1481749867_0080_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:08,014  INFO [pool-386-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:08,014  INFO [pool-386-thread-1] mapred.Task: Task 'attempt_local1481749867_0080_r_000000_0' done.
2024-04-23T21:09:08,015  INFO [pool-386-thread-1] mapred.Task: Final Counters for attempt_local1481749867_0080_r_000000_0: Counters: 34
	File System Counters
		FILE: Number of bytes read=1750666
		FILE: Number of bytes written=100355710
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1936719872
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:08,015  INFO [pool-386-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1481749867_0080_r_000000_0
2024-04-23T21:09:08,015  INFO [Thread-6603] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:08,889 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:09:08,890  INFO [main] exec.Task: 2024-04-23 21:09:08,889 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1481749867_0080
2024-04-23T21:09:08,891  INFO [main] exec.Task: Ended Job = job_local1481749867_0080
2024-04-23T21:09:08,894  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:08,894  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:09:08,894  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:08,894  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:08,894  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:08,894  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e); Time taken: 1.318 seconds
2024-04-23T21:09:08,894  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210907_22b72b05-d39e-41dc-aa83-7f2b901fb25e
2024-04-23T21:09:08,899  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:09:08,907  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:08,907  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:09:08,911  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:09:08,911  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:09:08,912  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:2, 
2024-04-23T21:09:08,912  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T21:09:08,912  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-07_349_6581647603926903910-1
2024-04-23T21:09:08,912  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/3d55ed60-d939-4522-b3c7-5da264ed961e/hive_2024-04-23_21-09-07_349_6581647603926903910-1 on fs with scheme file
2024-04-23T21:09:08,913  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210908_74f135fb-529e-4ffd-8065-02b6a815f8b3): START TRANSACTION
2024-04-23T21:09:08,915  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:09:08,915  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:09:08,916  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:08,916  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:08,916  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:08,916  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:08,916  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:08,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:08,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:09:08,916  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210908_74f135fb-529e-4ffd-8065-02b6a815f8b3); Time taken: 0.003 seconds
2024-04-23T21:09:08,916  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210908_74f135fb-529e-4ffd-8065-02b6a815f8b3
2024-04-23T21:09:08,916  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T21:09:08,916  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210908_74f135fb-529e-4ffd-8065-02b6a815f8b3): START TRANSACTION
2024-04-23T21:09:08,917  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:08,917  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:09:08,917  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210908_74f135fb-529e-4ffd-8065-02b6a815f8b3); Time taken: 0.001 seconds
2024-04-23T21:09:08,917  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 4
2024-04-23T21:09:08,917  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210908_eb0d6728-f09e-4397-ab0e-d18dc14293fe): delete from acidTbl where b = 4
2024-04-23T21:09:08,917  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:09:08,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:08,924  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:08,924  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 4> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:09:08,924  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:09:08,927  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:08,927  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:08,928  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:08,934  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:08,934  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:08,934  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:08,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:08,940  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:08,940  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:08,940  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:08,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:08,976  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-23T21:09:08,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:08,985  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:08,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:08,994  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:08,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:09:09,007  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-23T21:09:09,007  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-23T21:09:09,066  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:09,067  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:09,067  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:09,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:09,073  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,076 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:09:09,077 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:09:09,077  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:09:09,077 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:09:09,077  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:09,078  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=31, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, getTable_(GetTableRequest)=25, getAllTableConstraints_(AllTableConstraintsRequest)=4}
2024-04-23T21:09:09,078  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210908_eb0d6728-f09e-4397-ab0e-d18dc14293fe); Time taken: 0.16 seconds
2024-04-23T21:09:09,078  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210908_74f135fb-529e-4ffd-8065-02b6a815f8b3
2024-04-23T21:09:09,082  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:09,090  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:09:09,090  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0): drop table if exists acidTbl
2024-04-23T21:09:09,093  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T21:09:09,094  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:09:09,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:09,100  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,100  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:09,100  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:09,100  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:09,100  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=6, rollbackTxn_(long)=12, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:09,101  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0); Time taken: 0.01 seconds
2024-04-23T21:09:09,101  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0
2024-04-23T21:09:09,101  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0
2024-04-23T21:09:09,119  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:09:09,119  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:09,119  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0): drop table if exists acidTbl
2024-04-23T21:09:09,119  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:09,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:09,125  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:09,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:09,247  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:09,247  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=122}
2024-04-23T21:09:09,247  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0); Time taken: 0.128 seconds
2024-04-23T21:09:09,248  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210909_116dca13-e1ab-4fd4-b3b5-60888409fcc0
2024-04-23T21:09:09,252  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:09:09,260  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:09,262  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:09:09,263  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:09:09,263  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29): drop table if exists acidTblPart
2024-04-23T21:09:09,266  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T21:09:09,266  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:09:09,267  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:09,284  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,284  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:09,284  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:09,284  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:09,284  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=17}
2024-04-23T21:09:09,284  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29); Time taken: 0.021 seconds
2024-04-23T21:09:09,285  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29
2024-04-23T21:09:09,285  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29
2024-04-23T21:09:09,306  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:09:09,306  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:09,307  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29): drop table if exists acidTblPart
2024-04-23T21:09:09,307  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:09,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:09,313  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,313  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:09,319  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:09,365  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:09,365  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=52, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:09,365  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29); Time taken: 0.058 seconds
2024-04-23T21:09:09,365  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210909_f9131250-ffe9-490a-84fd-afcac205cb29
2024-04-23T21:09:09,370  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:09:09,380  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:09,380  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:09:09,381  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:09:09,381  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210909_a9f6741f-ddae-491b-bc62-6da8c13fc40c): drop table if exists acidTbl2
2024-04-23T21:09:09,384  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T21:09:09,384  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:09:09,385  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:09,385  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:09,385  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:09,385  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=1, flushCache_()=0, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=16, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:09,385  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210909_a9f6741f-ddae-491b-bc62-6da8c13fc40c); Time taken: 0.004 seconds
2024-04-23T21:09:09,385  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210909_a9f6741f-ddae-491b-bc62-6da8c13fc40c
2024-04-23T21:09:09,385  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:09,386  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210909_a9f6741f-ddae-491b-bc62-6da8c13fc40c): drop table if exists acidTbl2
2024-04-23T21:09:09,386  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:09,386  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:09:09,386  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:09,387  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T21:09:09,387  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210909_a9f6741f-ddae-491b-bc62-6da8c13fc40c); Time taken: 0.0 seconds
2024-04-23T21:09:09,387  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210909_a9f6741f-ddae-491b-bc62-6da8c13fc40c
2024-04-23T21:09:09,394  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:09:09,402  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:09,402  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:09:09,402  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:09:09,402  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:09,405  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T21:09:09,405  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:09:09,406  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:09,433  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,433  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:09,433  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:09,434  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:09,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=27, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:09:09,434  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e); Time taken: 0.031 seconds
2024-04-23T21:09:09,434  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e
2024-04-23T21:09:09,434  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e
2024-04-23T21:09:09,452  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:09:09,452  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:09,452  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:09,452  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:09,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:09,463  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:09,472  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,473  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:09,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:09,566  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=11, dropTable_(String, String, boolean, boolean, boolean)=102, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:09,566  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e); Time taken: 0.113 seconds
2024-04-23T21:09:09,566  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210909_b556e0e1-c8d0-4fa7-b3bf-c93d4c68bd1e
2024-04-23T21:09:09,573  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:09:09,581  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:09,582  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:09:09,582  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:09,582  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:09,585  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T21:09:09,585  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:09:09,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:09,594  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,594  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:09,594  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:09,594  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:09,594  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9}
2024-04-23T21:09:09,594  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3); Time taken: 0.012 seconds
2024-04-23T21:09:09,594  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3
2024-04-23T21:09:09,595  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3
2024-04-23T21:09:09,612  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:09:09,612  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:09,612  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:09,612  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:09,613  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:09,622  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,622  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:09,629  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:09,661  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:09,661  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=1}
2024-04-23T21:09:09,661  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3); Time taken: 0.049 seconds
2024-04-23T21:09:09,662  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210909_c033e567-e2ca-43c7-91ad-d42b2f3aefe3
2024-04-23T21:09:09,667  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:09:09,677  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:09,677  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:09:09,678  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:09:09,678  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6): drop table if exists nonAcidNonBucket
2024-04-23T21:09:09,680  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T21:09:09,681  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:09:09,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:09,689  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,690  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:09,690  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:09,690  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:09,690  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:09,690  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6); Time taken: 0.012 seconds
2024-04-23T21:09:09,690  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6
2024-04-23T21:09:09,691  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6
2024-04-23T21:09:09,725  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:09:09,725  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:09,725  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6): drop table if exists nonAcidNonBucket
2024-04-23T21:09:09,725  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:09,726  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:09,740  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,740  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:09,754  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:09,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:09,807  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:09,808  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=14, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=67}
2024-04-23T21:09:09,808  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6); Time taken: 0.082 seconds
2024-04-23T21:09:09,808  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210909_7c46e3c7-c698-4849-93e6-aab6dd2a36d6
2024-04-23T21:09:09,816  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:09:09,830  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:09,830  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:09:09,831  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testErrors" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="5.886"/>
  <testcase name="testMoreBucketsThanReducers" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="4.58">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = -1 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMoreBucketsThanReducers(TestTxnCommands.java:1429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:09:15,786  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:09:15,789  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab
2024-04-23T21:09:15,791  INFO [main] SessionState: Hive Session ID = a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:09:15,792  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:09:15,797  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab
2024-04-23T21:09:15,799  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab
2024-04-23T21:09:15,801  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/_tmp_space.db
2024-04-23T21:09:15,802  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab, clientType=HIVECLI]
2024-04-23T21:09:15,802  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:09:15,802  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210915_af089bea-28eb-46c6-87ac-be6866ffd41a): drop table if exists acidTbl
2024-04-23T21:09:15,812  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:09:15,812  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:09:15,815  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:15,822  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:15,822  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:15,822  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:15,822  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=9}
2024-04-23T21:09:15,823  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210915_af089bea-28eb-46c6-87ac-be6866ffd41a); Time taken: 0.02 seconds
2024-04-23T21:09:15,823  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210915_af089bea-28eb-46c6-87ac-be6866ffd41a
2024-04-23T21:09:15,823  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:15,823  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210915_af089bea-28eb-46c6-87ac-be6866ffd41a): drop table if exists acidTbl
2024-04-23T21:09:15,823  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:15,823  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:15,826  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:15,826  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:15,826  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210915_af089bea-28eb-46c6-87ac-be6866ffd41a); Time taken: 0.003 seconds
2024-04-23T21:09:15,826  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210915_af089bea-28eb-46c6-87ac-be6866ffd41a
2024-04-23T21:09:15,833  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:09:15,840  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:15,841  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:09:15,841  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:09:15,841  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210915_2070f9e7-ce59-46ba-be97-f900334d7e41): drop table if exists acidTblPart
2024-04-23T21:09:15,844  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:09:15,844  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:09:15,844  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:15,847  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:15,847  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:15,847  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:15,847  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:09:15,847  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210915_2070f9e7-ce59-46ba-be97-f900334d7e41); Time taken: 0.006 seconds
2024-04-23T21:09:15,848  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210915_2070f9e7-ce59-46ba-be97-f900334d7e41
2024-04-23T21:09:15,848  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:15,848  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210915_2070f9e7-ce59-46ba-be97-f900334d7e41): drop table if exists acidTblPart
2024-04-23T21:09:15,848  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:15,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:15,851  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:15,851  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:15,851  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210915_2070f9e7-ce59-46ba-be97-f900334d7e41); Time taken: 0.003 seconds
2024-04-23T21:09:15,851  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210915_2070f9e7-ce59-46ba-be97-f900334d7e41
2024-04-23T21:09:15,858  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:09:15,865  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:15,865  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:09:15,866  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:09:15,866  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210915_4d9aea1f-f6e5-4825-93e5-03f02ca62ec1): drop table if exists acidTbl2
2024-04-23T21:09:15,868  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:09:15,869  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:09:15,869  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:09:15,872  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:15,872  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:15,872  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:15,872  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:09:15,872  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210915_4d9aea1f-f6e5-4825-93e5-03f02ca62ec1); Time taken: 0.006 seconds
2024-04-23T21:09:15,872  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210915_4d9aea1f-f6e5-4825-93e5-03f02ca62ec1
2024-04-23T21:09:15,872  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:15,873  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210915_4d9aea1f-f6e5-4825-93e5-03f02ca62ec1): drop table if exists acidTbl2
2024-04-23T21:09:15,873  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:15,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:09:15,876  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:15,876  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:15,876  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210915_4d9aea1f-f6e5-4825-93e5-03f02ca62ec1); Time taken: 0.002 seconds
2024-04-23T21:09:15,876  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210915_4d9aea1f-f6e5-4825-93e5-03f02ca62ec1
2024-04-23T21:09:15,882  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:09:15,890  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:15,890  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:09:15,890  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:09:15,891  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210915_fee9e75d-fff5-4232-b63c-d59c4289a9d7): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:15,893  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:09:15,893  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:09:15,894  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:15,896  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:15,896  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:15,896  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:15,896  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:15,897  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210915_fee9e75d-fff5-4232-b63c-d59c4289a9d7); Time taken: 0.005 seconds
2024-04-23T21:09:15,897  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210915_fee9e75d-fff5-4232-b63c-d59c4289a9d7
2024-04-23T21:09:15,897  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:15,897  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210915_fee9e75d-fff5-4232-b63c-d59c4289a9d7): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:15,897  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:15,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:15,900  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:15,900  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:15,900  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210915_fee9e75d-fff5-4232-b63c-d59c4289a9d7); Time taken: 0.003 seconds
2024-04-23T21:09:15,900  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210915_fee9e75d-fff5-4232-b63c-d59c4289a9d7
2024-04-23T21:09:15,907  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:09:15,915  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:15,915  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:09:15,915  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:15,916  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210915_1b98db81-30d3-45fd-9c3a-db988efe49db): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:15,918  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:09:15,918  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:09:15,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:15,921  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:15,921  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:15,921  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:15,921  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:09:15,922  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210915_1b98db81-30d3-45fd-9c3a-db988efe49db); Time taken: 0.005 seconds
2024-04-23T21:09:15,922  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210915_1b98db81-30d3-45fd-9c3a-db988efe49db
2024-04-23T21:09:15,922  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:15,922  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210915_1b98db81-30d3-45fd-9c3a-db988efe49db): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:15,922  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:15,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:15,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:15,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:15,925  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210915_1b98db81-30d3-45fd-9c3a-db988efe49db); Time taken: 0.003 seconds
2024-04-23T21:09:15,925  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210915_1b98db81-30d3-45fd-9c3a-db988efe49db
2024-04-23T21:09:15,932  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:09:15,939  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:15,939  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:09:15,940  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:09:15,940  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210915_1e855ec8-d61b-4737-a419-4b8020e1d7d2): drop table if exists nonAcidNonBucket
2024-04-23T21:09:15,943  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:09:15,943  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:09:15,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:15,946  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:15,946  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:15,946  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:15,946  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:09:15,946  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210915_1e855ec8-d61b-4737-a419-4b8020e1d7d2); Time taken: 0.006 seconds
2024-04-23T21:09:15,947  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210915_1e855ec8-d61b-4737-a419-4b8020e1d7d2
2024-04-23T21:09:15,947  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:15,947  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210915_1e855ec8-d61b-4737-a419-4b8020e1d7d2): drop table if exists nonAcidNonBucket
2024-04-23T21:09:15,947  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:15,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:15,950  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:15,950  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:15,950  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210915_1e855ec8-d61b-4737-a419-4b8020e1d7d2); Time taken: 0.003 seconds
2024-04-23T21:09:15,950  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210915_1e855ec8-d61b-4737-a419-4b8020e1d7d2
2024-04-23T21:09:15,958  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:09:15,966  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:15,966  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:09:15,967  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:15,967  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:15,970  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:09:15,970  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:09:15,971  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:15,971  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:15,978  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:09:15,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:15,980  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:15,980  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:15,980  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:15,980  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:15,980  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=17, getValidWriteIds_(List, String)=7, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T21:09:15,980  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5); Time taken: 0.013 seconds
2024-04-23T21:09:15,981  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5
2024-04-23T21:09:15,981  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5
2024-04-23T21:09:16,002  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:09:16,002  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:16,002  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:16,003  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:16,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931756, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, totalSize=0, transactional=true, numFilesErasureCoded=0, numFiles=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:09:16,009  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:16,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:16,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=41, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:16,044  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5); Time taken: 0.042 seconds
2024-04-23T21:09:16,044  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210915_ebfc9c67-910a-41c4-9d27-e636265259a5
2024-04-23T21:09:16,049  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:09:16,057  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:16,058  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:09:16,059  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:16,059  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:16,062  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:09:16,063  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:09:16,063  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:16,063  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:16,066  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:09:16,066  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:16,069  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:16,069  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:16,069  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:16,069  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:16,069  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:09:16,069  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403); Time taken: 0.01 seconds
2024-04-23T21:09:16,069  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403
2024-04-23T21:09:16,069  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403
2024-04-23T21:09:16,086  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:09:16,086  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:16,086  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:16,086  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:16,087  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931756, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:09:16,092  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:09:16,110  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:16,110  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:16,111  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403); Time taken: 0.024 seconds
2024-04-23T21:09:16,111  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_f10608b7-3b3a-4aa6-90c5-8739cc636403
2024-04-23T21:09:16,116  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:09:16,123  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:16,123  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:09:16,124  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,124  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,127  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:09:16,127  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:09:16,128  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:16,128  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:16,131  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:09:16,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:16,132  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:16,133  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:16,133  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:16,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:16,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getDatabase_(String)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:09:16,133  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0); Time taken: 0.009 seconds
2024-04-23T21:09:16,133  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0
2024-04-23T21:09:16,133  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0
2024-04-23T21:09:16,150  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:09:16,150  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:16,150  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,150  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:16,151  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931756, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, totalSize=0, numRows=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:16,156  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:09:16,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:16,169  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T21:09:16,169  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0); Time taken: 0.019 seconds
2024-04-23T21:09:16,169  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_ceb463f8-e200-4c6b-a740-81e989fd00f0
2024-04-23T21:09:16,174  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:09:16,182  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:16,182  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:09:16,183  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,183  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,186  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:09:16,186  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:09:16,187  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:16,187  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:16,189  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:09:16,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:16,191  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:16,191  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:16,191  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:16,191  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:16,191  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T21:09:16,192  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b); Time taken: 0.008 seconds
2024-04-23T21:09:16,192  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b
2024-04-23T21:09:16,192  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b
2024-04-23T21:09:16,209  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:09:16,209  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:16,209  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,209  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:16,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931756, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, numRows=0, bucketing_version=2, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:16,214  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:09:16,228  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:16,229  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:16,229  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b); Time taken: 0.019 seconds
2024-04-23T21:09:16,229  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_03529a9d-0d31-4771-808d-c2f53263e04b
2024-04-23T21:09:16,234  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:09:16,243  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:16,243  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:09:16,244  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:16,244  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:16,247  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:09:16,247  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:09:16,248  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:16,248  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:16,251  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:09:16,251  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:16,253  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:16,253  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:16,253  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:16,253  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:16,253  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-23T21:09:16,253  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3); Time taken: 0.009 seconds
2024-04-23T21:09:16,253  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3
2024-04-23T21:09:16,253  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3
2024-04-23T21:09:16,271  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:09:16,271  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:16,271  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:16,271  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:16,272  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/_tmp_space.db/783f4967-e6c6-4e5d-9f0c-0c8014d166b8
2024-04-23T21:09:16,275  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:16,275  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:16,275  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3); Time taken: 0.004 seconds
2024-04-23T21:09:16,275  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_6e3dce34-4299-4583-a648-ee155cc44bb3
2024-04-23T21:09:16,280  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:09:16,289  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:16,289  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:09:16,290  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,290  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,292  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:09:16,293  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:09:16,293  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:16,293  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:16,296  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:09:16,296  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:16,298  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:16,298  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:16,298  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:16,298  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:16,298  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, flushCache_()=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:09:16,298  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327); Time taken: 0.008 seconds
2024-04-23T21:09:16,298  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327
2024-04-23T21:09:16,298  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327
2024-04-23T21:09:16,315  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:09:16,315  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:16,315  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:16,315  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:16,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931756, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, rawDataSize=0, bucketing_version=2, totalSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:16,321  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:09:16,333  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:16,334  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=17, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:16,334  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327); Time taken: 0.018 seconds
2024-04-23T21:09:16,334  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_400a9050-9b37-42a7-bc13-c490cac52327
2024-04-23T21:09:16,339  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:09:16,346  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:16,346  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:09:16,348  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl values(1,1)
2024-04-23T21:09:16,348  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): insert into acidTbl values(1,1)
2024-04-23T21:09:16,351  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:09:16,351  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:09:16,352  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:16,352  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:16,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:16,377  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:16,377  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:16,377  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:16,377  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:16,377  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:16,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:16,383  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:16,384  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:16,384  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:16,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:16,474  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:16,474  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:16,474  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:16,475  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:16,477  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:16,477  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:16,477  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:16,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:16,480  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:16,492  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T21:09:16,492  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T21:09:16,493  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:09:16,496  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:09:16,496  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:09:16,497  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:09:16,498  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:09:16,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:16,512  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:16,512  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:16,513  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:16,513  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:09:16,513  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:16,513  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:16,513  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:09:16,513  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:16,513  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=2, getAllTableConstraints_(AllTableConstraintsRequest)=28, getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, allocateTableWriteId_(long, String, String)=12, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=4, getTable_(GetTableRequest)=36, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:09:16,514  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.165 seconds
2024-04-23T21:09:16,514  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:16,514  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:16,537  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:09:16,537  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:09:16,540  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): insert into acidTbl values(1,1)
2024-04-23T21:09:16,541  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:16,541  INFO [main] ql.Driver: Query ID = alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
Total jobs = 1
2024-04-23T21:09:16,541  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:09:16,541  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:09:16,665  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:09:16,665  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:16,665  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:16,665  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:16,665  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:16,665  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:16,665  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:16,665  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:16,668  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:16,668  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:09:16,668  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-16_348_4790735234068990141-1/dummy_path
2024-04-23T21:09:16,677  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:16,678  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,26KB
2024-04-23T21:09:16,683  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:16,683  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T21:09:16,684  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:16,688  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-16_348_4790735234068990141-1/-mr-10000
2024-04-23T21:09:16,689  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:16,696  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:16,700  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:16,701  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:09:16,701  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:09:16,701  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-16_348_4790735234068990141-1/dummy_path
2024-04-23T21:09:16,701  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:16,718  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:16,736  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1450794840_0084
2024-04-23T21:09:16,736  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:16,797  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:16,797  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:16,797  INFO [Thread-6887] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:16,798  INFO [Thread-6887] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:16,799  INFO [Thread-6887] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:16,799  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1450794840_0084_m_000000_0
2024-04-23T21:09:16,802  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:16,802  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-16_348_4790735234068990141-1/dummy_path/null:0+1
2024-04-23T21:09:16,804  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:16,805  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,26KB
2024-04-23T21:09:16,805  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:09:16,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:16,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:16,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:16,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:16,809  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:16,810  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:16,810  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:16,810  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:16,811  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:09:16,811  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:09:16,811  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:09:16,811  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:09:16,811  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:09:16,812  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:09:16,812  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:09:16,812  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:09:16,812  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:09:16,812  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:09:16,812  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:1, 
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 1. abort - false
2024-04-23T21:09:16,813  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T21:09:16,816  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:16,816  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:16,816  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:09:16,816  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 16; bufvoid = 104857600
2024-04-23T21:09:16,816  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T21:09:16,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:09:16,831  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1450794840_0084_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:16,832  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:09:16,832  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1450794840_0084_m_000000_0' done.
2024-04-23T21:09:16,832  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1450794840_0084_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1809011
		FILE: Number of bytes written=105372621
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=1
		Map output bytes=16
		Map output materialized bytes=24
		Input split bytes=361
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1935671296
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
	File Input Format Counters 
		Bytes Read=5315
2024-04-23T21:09:16,832  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1450794840_0084_m_000000_0
2024-04-23T21:09:16,832  INFO [Thread-6887] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:16,833  INFO [Thread-6887] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:16,833  INFO [pool-400-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1450794840_0084_r_000000_0
2024-04-23T21:09:16,835  INFO [pool-400-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:16,835  INFO [pool-400-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3592daf
2024-04-23T21:09:16,835  WARN [pool-400-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:16,836  INFO [pool-400-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1354969856, maxSingleShuffleLimit=338742464, mergeThreshold=894280128, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:16,837  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1450794840_0084_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:16,839  INFO [localfetcher#114] reduce.LocalFetcher: localfetcher#114 about to shuffle output of map attempt_local1450794840_0084_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T21:09:16,839  INFO [localfetcher#114] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1450794840_0084_m_000000_0
2024-04-23T21:09:16,839  INFO [localfetcher#114] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T21:09:16,840  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:16,841  INFO [pool-400-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:16,841  INFO [pool-400-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:16,847  INFO [pool-400-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:16,847  INFO [pool-400-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:09:16,849  INFO [pool-400-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:16,850  INFO [pool-400-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T21:09:16,850  INFO [pool-400-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:16,850  INFO [pool-400-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:16,850  INFO [pool-400-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T21:09:16,850  INFO [pool-400-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:16,850  INFO [pool-400-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:16,851  INFO [pool-400-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T21:09:16,852  INFO [pool-400-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:16,852  INFO [pool-400-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:16,852  INFO [pool-400-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:09:16,852  INFO [pool-400-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:16,852  INFO [pool-400-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1450794840_0084/job_local1450794840_0084.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2f0ab219
2024-04-23T21:09:16,853  INFO [pool-400-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:16,853  INFO [pool-400-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:16,853  INFO [pool-400-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:16,853  INFO [pool-400-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:16,853  INFO [pool-400-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:16,853  INFO [pool-400-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:16,854  INFO [pool-400-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:16,854  INFO [pool-400-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:16,861  INFO [pool-400-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:16,865  INFO [pool-400-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:16,866  INFO [pool-400-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T21:09:16,866  INFO [pool-400-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:16,866  INFO [pool-400-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:16,867  INFO [pool-400-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:09:16,879  INFO [pool-400-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:16,880  INFO [pool-400-thread-1] mapred.Task: Task:attempt_local1450794840_0084_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:16,880  INFO [pool-400-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:16,880  INFO [pool-400-thread-1] mapred.Task: Task 'attempt_local1450794840_0084_r_000000_0' done.
2024-04-23T21:09:16,880  INFO [pool-400-thread-1] mapred.Task: Final Counters for attempt_local1450794840_0084_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1815047
		FILE: Number of bytes written=105373648
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1935671296
	HIVE
		CREATED_FILES=2
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:16,880  INFO [pool-400-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1450794840_0084_r_000000_0
2024-04-23T21:09:16,880  INFO [Thread-6887] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:17,799 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:09:17,799  INFO [main] exec.Task: 2024-04-23 21:09:17,799 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1450794840_0084
2024-04-23T21:09:17,800  INFO [main] exec.Task: Ended Job = job_local1450794840_0084
2024-04-23T21:09:17,802  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:09:17,802  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:09:17,802  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T21:09:17,804  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:09:17,805  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:17,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:17,822  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:17,822  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:17,834  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:17,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:17,874  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:09:17,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:17,879  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:17,879  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:17,880  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-16_348_4790735234068990141-1/-mr-10000
2024-04-23T21:09:17,881  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:17,886  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:17,895  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:09:17,895  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 1, false: 
2024-04-23T21:09:17,895  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:09:17,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:17,915  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 1, false: 
2024-04-23T21:09:17,915  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:09:17,915  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:09:17,917  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=1, numRows=1, totalSize=659, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:17,918  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:17,918  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=57, getTable_(GetTableRequest)=39, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-23T21:09:17,918  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:17,918  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:17,918  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:17,918  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 1.378 seconds
2024-04-23T21:09:17,919  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:17,933  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:17,933  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:09:17,934  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl values(0,0),(3,3)
2024-04-23T21:09:17,934  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-16_348_4790735234068990141-1
2024-04-23T21:09:17,935  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-16_348_4790735234068990141-1 on fs with scheme file
2024-04-23T21:09:17,935  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): insert into acidTbl values(0,0),(3,3)
2024-04-23T21:09:17,938  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:09:17,939  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:09:17,939  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:17,939  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:17,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:17,949  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:17,950  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:17,950  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:17,950  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:17,950  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:17,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:17,955  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:17,956  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:17,956  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:17,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:18,032  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:18,032  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:18,032  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:18,032  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:18,034  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:18,035  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:18,035  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:18,037  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:18,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:18,047  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 14
2024-04-23T21:09:18,047  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T21:09:18,048  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:09:18,051  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:18,051  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:09:18,052  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:09:18,052  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:09:18,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:18,067  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:18,068  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:18,068  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:09:18,068  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:18,068  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:18,068  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:09:18,068  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:18,068  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, getCheckConstraints_(CheckConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=4, allocateTableWriteId_(long, String, String)=8, isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=15, getTable_(GetTableRequest)=20}
2024-04-23T21:09:18,068  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.133 seconds
2024-04-23T21:09:18,069  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:18,069  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:18,086  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:09:18,086  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:09:18,090  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): insert into acidTbl values(0,0),(3,3)
2024-04-23T21:09:18,090  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:18,090  INFO [main] ql.Driver: Query ID = alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
Total jobs = 1
2024-04-23T21:09:18,090  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:09:18,090  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:09:18,222  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:09:18,222  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:18,222  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:18,222  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:18,222  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:18,222  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:18,222  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:18,222  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:18,224  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:18,224  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:09:18,224  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-17_935_3963513546206997524-1/dummy_path
2024-04-23T21:09:18,234  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:18,235  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,30KB
2024-04-23T21:09:18,239  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:18,240  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:09:18,241  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:18,244  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-17_935_3963513546206997524-1/-mr-10000
2024-04-23T21:09:18,246  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:18,253  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:18,258  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:18,259  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:09:18,259  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:09:18,259  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-17_935_3963513546206997524-1/dummy_path
2024-04-23T21:09:18,259  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:18,279  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:18,313  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local764974853_0085
2024-04-23T21:09:18,313  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:18,374  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:18,374  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:18,375  INFO [Thread-6947] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:18,375  INFO [Thread-6947] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:18,376  INFO [Thread-6947] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:18,376  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local764974853_0085_m_000000_0
2024-04-23T21:09:18,377  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:18,377  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-17_935_3963513546206997524-1/dummy_path/null:0+1
2024-04-23T21:09:18,378  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:18,378  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,30KB
2024-04-23T21:09:18,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:09:18,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:18,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:18,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:18,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:18,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:18,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:18,384  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:18,384  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:09:18,385  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:09:18,386  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:09:18,387  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:09:18,398  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:09:18,401  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local764974853_0085_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:18,401  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:09:18,401  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local764974853_0085_m_000000_0' done.
2024-04-23T21:09:18,401  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local764974853_0085_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1821128
		FILE: Number of bytes written=106625760
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=42
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5357
2024-04-23T21:09:18,401  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local764974853_0085_m_000000_0
2024-04-23T21:09:18,401  INFO [Thread-6947] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:18,402  INFO [Thread-6947] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:18,402  INFO [pool-405-thread-1] mapred.LocalJobRunner: Starting task: attempt_local764974853_0085_r_000000_0
2024-04-23T21:09:18,403  INFO [pool-405-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:18,403  INFO [pool-405-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4322b343
2024-04-23T21:09:18,403  WARN [pool-405-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:18,404  INFO [pool-405-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1356437888, maxSingleShuffleLimit=339109472, mergeThreshold=895249024, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:18,404  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local764974853_0085_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:18,405  INFO [localfetcher#115] reduce.LocalFetcher: localfetcher#115 about to shuffle output of map attempt_local764974853_0085_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:09:18,405  INFO [localfetcher#115] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local764974853_0085_m_000000_0
2024-04-23T21:09:18,405  INFO [localfetcher#115] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:09:18,406  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:18,406  INFO [pool-405-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:18,406  INFO [pool-405-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:18,412  INFO [pool-405-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:18,412  INFO [pool-405-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:09:18,414  INFO [pool-405-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:18,415  INFO [pool-405-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:09:18,415  INFO [pool-405-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:18,415  INFO [pool-405-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:18,415  INFO [pool-405-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:09:18,415  INFO [pool-405-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:18,415  INFO [pool-405-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:18,416  INFO [pool-405-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T21:09:18,416  INFO [pool-405-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:18,416  INFO [pool-405-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:18,416  INFO [pool-405-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:09:18,417  INFO [pool-405-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:18,417  INFO [pool-405-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local764974853_0085/job_local764974853_0085.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@391e71c5
2024-04-23T21:09:18,417  INFO [pool-405-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:18,417  INFO [pool-405-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:18,417  INFO [pool-405-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:18,418  INFO [pool-405-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:18,418  INFO [pool-405-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:18,418  INFO [pool-405-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:18,418  INFO [pool-405-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:18,418  INFO [pool-405-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:18,426  INFO [pool-405-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:18,431  INFO [pool-405-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:18,436  INFO [pool-405-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:18,436  INFO [pool-405-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:18,436  INFO [pool-405-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:18,436  INFO [pool-405-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:18,436  INFO [pool-405-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:09:18,438  INFO [pool-405-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-23T21:09:18,450  INFO [pool-405-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:18,451  INFO [pool-405-thread-1] mapred.Task: Task:attempt_local764974853_0085_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:18,451  INFO [pool-405-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:18,451  INFO [pool-405-thread-1] mapred.Task: Task 'attempt_local764974853_0085_r_000000_0' done.
2024-04-23T21:09:18,451  INFO [pool-405-thread-1] mapred.Task: Final Counters for attempt_local764974853_0085_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1827222
		FILE: Number of bytes written=106627646
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1937768448
	HIVE
		CREATED_FILES=2
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:18,451  INFO [pool-405-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local764974853_0085_r_000000_0
2024-04-23T21:09:18,451  INFO [Thread-6947] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:19,375 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:09:19,375  INFO [main] exec.Task: 2024-04-23 21:09:19,375 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local764974853_0085
2024-04-23T21:09:19,376  INFO [main] exec.Task: Ended Job = job_local764974853_0085
2024-04-23T21:09:19,377  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:09:19,377  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-23T21:09:19,377  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-23T21:09:19,378  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:09:19,378  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:19,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,384  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,393  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:19,413  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:09:19,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,419  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,420  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:19,420  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-17_935_3963513546206997524-1/-mr-10000
2024-04-23T21:09:19,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,427  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,446  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:09:19,447  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T21:09:19,447  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:09:19,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:19,467  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T21:09:19,467  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:09:19,467  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:09:19,468  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=3, numRows=3, totalSize=1978, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:19,468  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:19,468  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=40, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=28}
MapReduce Jobs Launched: 
2024-04-23T21:09:19,468  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:19,469  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:19,469  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:19,469  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 1.379 seconds
2024-04-23T21:09:19,469  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,484  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:19,484  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:09:19,485  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = -1
2024-04-23T21:09:19,485  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-17_935_3963513546206997524-1
2024-04-23T21:09:19,486  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a10adc7f-fd50-4ea9-9bbb-46e6ef7348ab/hive_2024-04-23_21-09-17_935_3963513546206997524-1 on fs with scheme file
2024-04-23T21:09:19,486  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): update acidTbl set b = -1
2024-04-23T21:09:19,489  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:09:19,489  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:09:19,489  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:19,497  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,497  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = -1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:09:19,497  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:09:19,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:19,508  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,508  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:19,508  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:19,509  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,515  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,515  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:19,515  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:19,515  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:19,515  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:19,527  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,535  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,536  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,555  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:09:19,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:19,574  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:09:19,584  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:19,584  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:19,631  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:19,631  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:19,631  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:19,633 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMoreBucketsThanReducers(TestTxnCommands.java:1429) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:09:19,635 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:09:19,635  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:09:19,635 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMoreBucketsThanReducers(TestTxnCommands.java:1429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:09:19,635  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:19,636  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=6, getValidWriteIds_(List, String)=3, getTableColumnStatistics_(String, String, List, String)=29, openTxn_(String, TxnType)=2, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=0, getTable_(GetTableRequest)=22, isCompatibleWith_(Configuration)=2}
2024-04-23T21:09:19,636  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.149 seconds
2024-04-23T21:09:19,636  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,641  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:19,652  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:09:19,652  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists acidTbl
2024-04-23T21:09:19,656  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T21:09:19,656  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:09:19,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:19,664  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,664  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:19,664  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:19,664  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:19,664  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getTable_(GetTableRequest)=7, rollbackTxn_(long)=16, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:09:19,665  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.012 seconds
2024-04-23T21:09:19,665  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,665  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,685  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:09:19,685  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:19,685  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists acidTbl
2024-04-23T21:09:19,685  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:19,685  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:19,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:19,697  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:19,812  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:19,812  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=121}
2024-04-23T21:09:19,812  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.127 seconds
2024-04-23T21:09:19,812  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,817  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:09:19,825  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:19,827  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:09:19,827  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:09:19,827  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists acidTblPart
2024-04-23T21:09:19,838  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T21:09:19,838  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:09:19,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:19,857  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,857  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:19,857  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:19,857  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:19,857  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=16, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=10, flushCache_()=0, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:09:19,858  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.03 seconds
2024-04-23T21:09:19,858  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,858  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,880  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:09:19,880  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:19,880  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists acidTblPart
2024-04-23T21:09:19,880  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:19,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:19,886  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,886  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:19,891  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:19,892  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:19,938  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:19,938  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=52, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:19,939  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.058 seconds
2024-04-23T21:09:19,939  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,944  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:09:19,952  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:19,952  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:09:19,952  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:09:19,952  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists acidTbl2
2024-04-23T21:09:19,955  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T21:09:19,955  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:09:19,956  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:19,956  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:19,956  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:19,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:09:19,957  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.004 seconds
2024-04-23T21:09:19,957  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,957  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:19,957  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists acidTbl2
2024-04-23T21:09:19,957  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:19,957  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:09:19,958  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:19,958  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:09:19,958  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.001 seconds
2024-04-23T21:09:19,958  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:19,965  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:09:19,973  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:19,973  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:09:19,973  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:09:19,973  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:19,976  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T21:09:19,976  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:09:19,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:20,000  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,000  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:20,001  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:20,001  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:20,001  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=23}
2024-04-23T21:09:20,001  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.028 seconds
2024-04-23T21:09:20,001  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,002  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,019  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:09:20,019  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:20,019  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:20,019  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:20,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:20,030  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:20,037  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:20,115  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:20,115  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=85, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=10}
2024-04-23T21:09:20,115  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.096 seconds
2024-04-23T21:09:20,115  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,120  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:09:20,128  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:20,128  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:09:20,129  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:20,129  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:20,131  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T21:09:20,132  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:09:20,132  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:20,140  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,140  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:20,140  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:20,140  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:20,140  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, flushCache_()=0, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:09:20,140  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.011 seconds
2024-04-23T21:09:20,140  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,141  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,157  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:09:20,157  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:20,158  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:20,158  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:20,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:20,166  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:20,174  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,174  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:20,204  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:20,205  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=38}
2024-04-23T21:09:20,205  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.046 seconds
2024-04-23T21:09:20,205  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,210  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:09:20,218  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:20,218  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:09:20,218  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:09:20,218  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists nonAcidNonBucket
2024-04-23T21:09:20,221  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T21:09:20,221  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:09:20,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:20,230  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,230  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:20,230  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:20,230  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:20,230  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=8, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:20,230  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.012 seconds
2024-04-23T21:09:20,231  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,231  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,248  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:09:20,248  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:20,248  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a): drop table if exists nonAcidNonBucket
2024-04-23T21:09:20,248  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:20,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:20,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:20,263  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:20,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:20,291  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:20,291  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=35, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:20,291  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a); Time taken: 0.043 seconds
2024-04-23T21:09:20,291  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210916_38a2cc4f-86b5-4d15-8825-66e689f5fd8a
2024-04-23T21:09:20,296  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:09:20,304  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:20,304  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:09:20,305  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testInsertOverwrite" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="10.788"/>
  <testcase name="testMergeNegative" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="1.429"/>
  <testcase name="testParallelInsertStats" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="10.77"/>
  <testcase name="testDeleteIn" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="7.909">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where a in(select a from acidTbl2) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:935)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T21:09:43,357  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:09:43,358  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:09:43,361  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 795c523f-0e89-4759-9f46-45d20dedab6b
2024-04-23T21:09:43,363  INFO [main] SessionState: Hive Session ID = 795c523f-0e89-4759-9f46-45d20dedab6b
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:09:43,364  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:09:43,369  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b
2024-04-23T21:09:43,372  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b
2024-04-23T21:09:43,374  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db
2024-04-23T21:09:43,375  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=795c523f-0e89-4759-9f46-45d20dedab6b, clientType=HIVECLI]
2024-04-23T21:09:43,375  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:09:43,375  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_3731188b-f0c6-4630-9c9e-d471c9354ec5): drop table if exists acidTbl
2024-04-23T21:09:43,386  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:09:43,386  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:09:43,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:43,392  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,392  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,392  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,392  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=10, isCompatibleWith_(Configuration)=0, flushCache_()=1}
2024-04-23T21:09:43,393  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_3731188b-f0c6-4630-9c9e-d471c9354ec5); Time taken: 0.017 seconds
2024-04-23T21:09:43,393  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423210943_3731188b-f0c6-4630-9c9e-d471c9354ec5
2024-04-23T21:09:43,393  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:43,393  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_3731188b-f0c6-4630-9c9e-d471c9354ec5): drop table if exists acidTbl
2024-04-23T21:09:43,393  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:43,396  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,396  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,396  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_3731188b-f0c6-4630-9c9e-d471c9354ec5); Time taken: 0.003 seconds
2024-04-23T21:09:43,396  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_3731188b-f0c6-4630-9c9e-d471c9354ec5
2024-04-23T21:09:43,405  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:09:43,415  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,417  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:09:43,418  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:09:43,418  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_d9124212-56bd-4c15-9425-db45e424ae7d): drop table if exists acidTblPart
2024-04-23T21:09:43,421  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:09:43,421  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:09:43,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:43,424  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,424  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=22, openTxn_(String, TxnType)=3}
2024-04-23T21:09:43,424  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_d9124212-56bd-4c15-9425-db45e424ae7d); Time taken: 0.006 seconds
2024-04-23T21:09:43,424  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423210943_d9124212-56bd-4c15-9425-db45e424ae7d
2024-04-23T21:09:43,425  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:43,425  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_d9124212-56bd-4c15-9425-db45e424ae7d): drop table if exists acidTblPart
2024-04-23T21:09:43,425  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:43,427  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,428  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,428  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_d9124212-56bd-4c15-9425-db45e424ae7d); Time taken: 0.002 seconds
2024-04-23T21:09:43,428  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_d9124212-56bd-4c15-9425-db45e424ae7d
2024-04-23T21:09:43,436  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:09:43,448  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,448  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:09:43,448  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:09:43,449  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_23e8f77d-0252-49da-ac71-af3605092114): drop table if exists acidTbl2
2024-04-23T21:09:43,451  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:09:43,452  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:09:43,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:09:43,455  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,455  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,455  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,455  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=20, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:09:43,455  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_23e8f77d-0252-49da-ac71-af3605092114); Time taken: 0.006 seconds
2024-04-23T21:09:43,455  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423210943_23e8f77d-0252-49da-ac71-af3605092114
2024-04-23T21:09:43,456  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:43,456  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_23e8f77d-0252-49da-ac71-af3605092114): drop table if exists acidTbl2
2024-04-23T21:09:43,456  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,456  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:09:43,459  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,459  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,459  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_23e8f77d-0252-49da-ac71-af3605092114); Time taken: 0.003 seconds
2024-04-23T21:09:43,459  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_23e8f77d-0252-49da-ac71-af3605092114
2024-04-23T21:09:43,467  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:09:43,478  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,478  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:09:43,478  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:09:43,478  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_3d1ff849-29a8-4bf9-8ad9-2e40b4900fc6): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:43,481  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:09:43,481  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:09:43,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:43,484  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,484  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,484  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,484  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=19, openTxn_(String, TxnType)=2}
2024-04-23T21:09:43,485  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_3d1ff849-29a8-4bf9-8ad9-2e40b4900fc6); Time taken: 0.006 seconds
2024-04-23T21:09:43,485  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423210943_3d1ff849-29a8-4bf9-8ad9-2e40b4900fc6
2024-04-23T21:09:43,485  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:43,485  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_3d1ff849-29a8-4bf9-8ad9-2e40b4900fc6): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:43,485  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,485  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:43,488  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,488  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,488  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_3d1ff849-29a8-4bf9-8ad9-2e40b4900fc6); Time taken: 0.003 seconds
2024-04-23T21:09:43,488  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_3d1ff849-29a8-4bf9-8ad9-2e40b4900fc6
2024-04-23T21:09:43,498  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:09:43,508  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,508  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:09:43,509  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:43,509  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_d45ec987-56c6-48aa-b1cf-bf9c42ea2207): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:43,511  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:09:43,512  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:09:43,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:43,515  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,515  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,515  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=20, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,515  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_d45ec987-56c6-48aa-b1cf-bf9c42ea2207); Time taken: 0.006 seconds
2024-04-23T21:09:43,515  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423210943_d45ec987-56c6-48aa-b1cf-bf9c42ea2207
2024-04-23T21:09:43,515  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:43,515  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_d45ec987-56c6-48aa-b1cf-bf9c42ea2207): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:43,515  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:43,518  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,518  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:09:43,518  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_d45ec987-56c6-48aa-b1cf-bf9c42ea2207); Time taken: 0.003 seconds
2024-04-23T21:09:43,518  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_d45ec987-56c6-48aa-b1cf-bf9c42ea2207
2024-04-23T21:09:43,527  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:09:43,537  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,537  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:09:43,537  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:09:43,538  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_cda03709-b8a7-4018-9bd5-4ce0920e658d): drop table if exists nonAcidNonBucket
2024-04-23T21:09:43,541  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:09:43,542  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:09:43,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:43,547  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,547  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,547  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=18}
2024-04-23T21:09:43,547  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_cda03709-b8a7-4018-9bd5-4ce0920e658d); Time taken: 0.009 seconds
2024-04-23T21:09:43,547  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423210943_cda03709-b8a7-4018-9bd5-4ce0920e658d
2024-04-23T21:09:43,547  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:43,547  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_cda03709-b8a7-4018-9bd5-4ce0920e658d): drop table if exists nonAcidNonBucket
2024-04-23T21:09:43,547  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:43,552  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,552  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,553  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_cda03709-b8a7-4018-9bd5-4ce0920e658d); Time taken: 0.005 seconds
2024-04-23T21:09:43,553  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_cda03709-b8a7-4018-9bd5-4ce0920e658d
2024-04-23T21:09:43,565  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:09:43,580  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,580  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:09:43,581  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,581  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,585  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:09:43,585  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:09:43,585  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:43,585  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:43,596  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:09:43,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:43,599  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:43,599  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,599  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,599  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,599  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=27, getValidWriteIds_(List, String)=11, getDatabase_(String)=3, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:09:43,599  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130); Time taken: 0.018 seconds
2024-04-23T21:09:43,599  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130
2024-04-23T21:09:43,600  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130
2024-04-23T21:09:43,636  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:09:43,636  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:43,637  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,637  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931783, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, totalSize=0, transactional=true, numFiles=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:09:43,645  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:43,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,699  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=60}
2024-04-23T21:09:43,699  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130); Time taken: 0.061 seconds
2024-04-23T21:09:43,699  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_15e85372-7f01-449d-a8e5-2f894e585130
2024-04-23T21:09:43,705  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:09:43,716  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,716  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:09:43,716  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,716  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,720  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:09:43,720  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:09:43,721  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:43,721  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:43,724  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:09:43,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:43,726  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:43,726  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,726  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,726  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,726  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=17, openTxn_(String, TxnType)=3, flushCache_()=0, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1}
2024-04-23T21:09:43,727  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067); Time taken: 0.01 seconds
2024-04-23T21:09:43,727  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067
2024-04-23T21:09:43,727  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067
2024-04-23T21:09:43,747  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:09:43,747  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:43,748  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,748  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,748  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931783, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:09:43,754  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtblpart
2024-04-23T21:09:43,774  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,775  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=26, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,775  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067); Time taken: 0.026 seconds
2024-04-23T21:09:43,775  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_bf32c06f-b099-4307-abe9-f9bba226b067
2024-04-23T21:09:43,781  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:09:43,791  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,791  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:09:43,792  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,792  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,795  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:09:43,796  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:09:43,796  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:43,796  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:43,799  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:09:43,799  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:43,801  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:43,801  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,801  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,801  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,801  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=17}
2024-04-23T21:09:43,801  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01); Time taken: 0.009 seconds
2024-04-23T21:09:43,802  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01
2024-04-23T21:09:43,802  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01
2024-04-23T21:09:43,823  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:09:43,823  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:43,823  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,823  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931783, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, totalSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:43,829  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl
2024-04-23T21:09:43,844  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,844  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T21:09:43,844  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01); Time taken: 0.021 seconds
2024-04-23T21:09:43,844  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_9a7ce014-8910-4982-aa7d-976bf2f0ed01
2024-04-23T21:09:43,851  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:09:43,862  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,862  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:09:43,863  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,863  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,866  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:09:43,866  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:09:43,867  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:43,867  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:43,871  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:09:43,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:43,872  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:43,872  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,872  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,872  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,873  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=4, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=19}
2024-04-23T21:09:43,873  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62); Time taken: 0.009 seconds
2024-04-23T21:09:43,873  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62
2024-04-23T21:09:43,873  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62
2024-04-23T21:09:43,894  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:09:43,894  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:43,894  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,894  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931783, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:43,901  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidorctbl2
2024-04-23T21:09:43,915  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T21:09:43,916  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62); Time taken: 0.021 seconds
2024-04-23T21:09:43,916  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_44efdace-a388-4423-a786-7f2add693d62
2024-04-23T21:09:43,922  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:09:43,933  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,934  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:09:43,934  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,934  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,937  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:09:43,938  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:09:43,938  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:43,938  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:43,941  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:09:43,942  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:43,943  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:43,943  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,943  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,943  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,944  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=18, openTxn_(String, TxnType)=3}
2024-04-23T21:09:43,944  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a); Time taken: 0.009 seconds
2024-04-23T21:09:43,944  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a
2024-04-23T21:09:43,944  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a
2024-04-23T21:09:43,962  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:09:43,962  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:43,963  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:09:43,963  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:43,964  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e
2024-04-23T21:09:43,966  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:43,966  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:43,966  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a); Time taken: 0.003 seconds
2024-04-23T21:09:43,966  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_d1a4bd59-dae0-49c8-8f0b-45556cbd492a
2024-04-23T21:09:43,972  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:09:43,981  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:43,981  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:09:43,982  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,982  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:43,985  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:09:43,985  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:09:43,985  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:43,985  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:43,988  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:09:43,989  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:09:43,990  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:43,990  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:43,990  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:43,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:43,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=3, flushCache_()=0}
2024-04-23T21:09:43,991  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c); Time taken: 0.008 seconds
2024-04-23T21:09:43,991  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c
2024-04-23T21:09:43,991  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c
2024-04-23T21:09:44,009  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:09:44,010  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:09:44,010  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:09:44,010  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:44,011  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931784, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, totalSize=0, rawDataSize=0, numFiles=0, transactional=false, numRows=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:09:44,016  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/nonacidnonbucket
2024-04-23T21:09:44,029  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:44,029  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-23T21:09:44,029  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c); Time taken: 0.019 seconds
2024-04-23T21:09:44,030  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210943_825f7980-e63b-4793-a5de-5a17b944a97c
2024-04-23T21:09:44,036  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:09:44,046  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:44,046  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:09:44,046  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where a IN (SELECT A.a from acidTbl  A)
2024-04-23T21:09:44,047  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a): delete from acidTbl where a IN (SELECT A.a from acidTbl  A)
2024-04-23T21:09:44,050  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:09:44,050  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:09:44,051  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:09:44,051  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:44,076  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:44,077  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where a IN (SELECT A.a from acidTbl  A)> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:09:44,077  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:09:44,086  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:44,086  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:44,087  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:44,093  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:44,093  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:44,093  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:44,093  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:44,100  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:44,100  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:44,100  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:44,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:44,149  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:44,149  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:44,149  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:44,150  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:44,260  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:09:44,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:44,269  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:44,269  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:44,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:44,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:09:44,287  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:44,287  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:44,288  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:09:44,288  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:44,288  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:44,403  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:44,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:44,409  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:44,423  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T21:09:44,424  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T21:09:44,427  INFO [main] parse.UpdateDeleteSemanticAnalyzer: CBO Succeeded; optimized logical plan.
2024-04-23T21:09:44,435  INFO [main] optimizer.ColumnPrunerProcFactory: RS 14 oldColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:44,435  INFO [main] optimizer.ColumnPrunerProcFactory: RS 14 newColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:44,435  INFO [main] optimizer.ColumnPrunerProcFactory: RS 12 oldColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:44,435  INFO [main] optimizer.ColumnPrunerProcFactory: RS 12 newColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:44,435  INFO [main] optimizer.ColumnPrunerProcFactory: JOIN 10 oldExprs: {1=[], 0=[Column[KEY.reducesinkkey0], Column[VALUE._col0]]}
2024-04-23T21:09:44,436  INFO [main] optimizer.ColumnPrunerProcFactory: JOIN 10 newExprs: {0=[Column[VALUE._col0]], 1=[]}
2024-04-23T21:09:44,436  INFO [main] optimizer.ColumnPrunerProcFactory: RS 8 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:09:44,436  INFO [main] optimizer.ColumnPrunerProcFactory: RS 8 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:44,436  INFO [main] optimizer.ColumnPrunerProcFactory: RS 9 oldColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:44,436  INFO [main] optimizer.ColumnPrunerProcFactory: RS 9 newColExprMap: {KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:09:44,438  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:09:44,454  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:44,460  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:44,469  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:44,470  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:09:44,470  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vector.serde.deserialize IS true]
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.mapred.SequenceFileInputFormat]
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map notVectorizedReason: Vectorized map work only works with 1 TableScanOperator
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 2
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Vectorized map work only works with 1 TableScanOperator IS false]
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 3
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:44,471  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:44,471  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed plan generation
2024-04-23T21:09:44,471  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
2024-04-23T21:09:44,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:44,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null)], properties:null)
2024-04-23T21:09:44,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:44,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=27, commitTxn_(CommitTxnRequest)=16, flushCache_()=0, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=37, getValidWriteIds_(List, String)=10, getTable_(GetTableRequest)=53, allocateTableWriteId_(long, String, String)=10, openTxn_(String, TxnType)=3, getValidTxns_(long)=0}
2024-04-23T21:09:44,472  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a); Time taken: 0.424 seconds
2024-04-23T21:09:44,472  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a
2024-04-23T21:09:44,472  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a
2024-04-23T21:09:44,498  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:09:44,498  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:09:44,505  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a): delete from acidTbl where a IN (SELECT A.a from acidTbl  A)
2024-04-23T21:09:44,506  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a
2024-04-23T21:09:44,506  INFO [main] ql.Driver: Query ID = alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a
Total jobs = 2
2024-04-23T21:09:44,506  INFO [main] ql.Driver: Total jobs = 2
Launching Job 1 out of 2
2024-04-23T21:09:44,506  INFO [main] ql.Driver: Launching Job 1 out of 2
2024-04-23T21:09:44,629  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
2024-04-23T21:09:44,629  INFO [main] exec.Utilities: Not using thread pool for getContentSummary
2024-04-23T21:09:44,630  INFO [main] exec.Utilities: BytesPerReducer=256000000 maxReducers=1009 totalInputFileSize=0
Number of reduce tasks not specified. Estimated from input data size: 1
2024-04-23T21:09:44,630  INFO [main] exec.Task: Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:44,630  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:44,630  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:44,630  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:44,630  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:44,630  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:44,630  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:44,635  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:44,635  INFO [main] exec.Utilities: Processing alias $hdt$_0:acidtbl
2024-04-23T21:09:44,635  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:44,635  INFO [main] exec.Utilities: Processing alias $hdt$_1:a
2024-04-23T21:09:44,642  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_046_4974620837143646327-1/-mr-10000/b3aeea6a-2e3a-40a3-9dbf-3c670f13af19 (false)
2024-04-23T21:09:44,651  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:44,651  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,47KB
2024-04-23T21:09:44,656  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:44,657  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,55KB
2024-04-23T21:09:44,658  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:44,664  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:44,670  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:44,675  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:44,676  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_046_4974620837143646327-1/-mr-10000/b3aeea6a-2e3a-40a3-9dbf-3c670f13af19
2024-04-23T21:09:44,676  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:09:44,676  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: null:9223372036854775807:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:09:44,676  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:09:44,680  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/0
2024-04-23T21:09:44,680  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 0). duration: 4 ms
2024-04-23T21:09:44,680  INFO [main] io.HiveInputFormat: number of splits 0
2024-04-23T21:09:44,696  INFO [main] mapreduce.JobSubmitter: number of splits:0
2024-04-23T21:09:44,716  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1484411096_0100
2024-04-23T21:09:44,716  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:44,777  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:44,777  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:44,778  INFO [Thread-8189] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:44,778  INFO [Thread-8189] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:44,779  INFO [Thread-8189] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:44,779  INFO [Thread-8189] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:44,779  INFO [Thread-8189] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:44,780  INFO [pool-481-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1484411096_0100_r_000000_0
2024-04-23T21:09:44,784  INFO [pool-481-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:44,784  INFO [pool-481-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2bf4d12d
2024-04-23T21:09:44,784  WARN [pool-481-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:44,785  INFO [pool-481-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1361575936, maxSingleShuffleLimit=340393984, mergeThreshold=898640128, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:44,786  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1484411096_0100_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:44,787  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:44,788  INFO [pool-481-thread-1] mapred.LocalJobRunner: 
2024-04-23T21:09:44,788  INFO [pool-481-thread-1] reduce.MergeManagerImpl: finalMerge called with 0 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:44,788  INFO [pool-481-thread-1] reduce.MergeManagerImpl: Merging 0 files, 0 bytes from disk
2024-04-23T21:09:44,788  INFO [pool-481-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:44,788  INFO [pool-481-thread-1] mapred.Merger: Merging 0 sorted segments
2024-04-23T21:09:44,788  INFO [pool-481-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:44,788  INFO [pool-481-thread-1] mapred.LocalJobRunner: 
2024-04-23T21:09:44,789  INFO [pool-481-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:44,789  INFO [pool-481-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,55KB
2024-04-23T21:09:44,790  INFO [pool-481-thread-1] ExecReducer: 
<JOIN>Id =10
  <Children>
    <SEL>Id =11
      <Children>
        <FS>Id =19
          <Children>
          <\Children>
          <Parent>Id = 11 null<\Parent>
        <\FS>
      <\Children>
      <Parent>Id = 10 null<\Parent>
    <\SEL>
  <\Children>
  <Parent><\Parent>
<\JOIN>
2024-04-23T21:09:44,790  INFO [pool-481-thread-1] exec.JoinOperator: Initializing Operator: JOIN[10]
2024-04-23T21:09:44,791  INFO [pool-481-thread-1] exec.CommonJoinOperator: JOIN struct<_col1:struct<writeid:bigint,bucketid:int,rowid:bigint>> totalsz = 1
2024-04-23T21:09:44,791  INFO [pool-481-thread-1] exec.SelectOperator: Initializing Operator: SEL[11]
2024-04-23T21:09:44,791  INFO [pool-481-thread-1] exec.SelectOperator: SELECT struct<_col1:struct<writeid:bigint,bucketid:int,rowid:bigint>>
2024-04-23T21:09:44,791  INFO [pool-481-thread-1] exec.FileSinkOperator: Initializing Operator: FS[19]
2024-04-23T21:09:44,791  INFO [pool-481-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@1d04bb6d, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1484411096_0100/job_local1484411096_0100.xml], properties={columns=_col0, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>, escape.delim=\, column.name.delimiter=,}, tableProperties={columns=_col0, serialization.lib=org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe, columns.types=struct<writeid:bigint,bucketid:int,rowid:bigint>, column.name.delimiter=,, escape.delim=\}, partitionProperties=Optional.empty, columnNames=[_col0], columnTypes=[struct<writeid:bigint,bucketid:int,rowid:bigint>], getClass()=class org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@5fe5d61b
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.JoinOperator: Closing Operator: JOIN[10]
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.JoinOperator: RECORDS_OUT_OPERATOR_JOIN_10:0, SKEWJOINFOLLOWUPJOBS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.SelectOperator: Closing Operator: SEL[11]
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_11:0, 
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.FileSinkOperator: Closing Operator: FS[19]
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.FileSinkOperator: FS[19]: records written - 0
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/_tmp.-mr-10001/000000_0
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/_task_tmp.-mr-10001/_tmp.000000_0
2024-04-23T21:09:44,792  INFO [pool-481-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/_tmp.-mr-10001/000000_0
2024-04-23T21:09:44,799  INFO [pool-481-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:0, RECORDS_OUT_OPERATOR_FS_19:0, 
2024-04-23T21:09:44,801  INFO [pool-481-thread-1] mapred.Task: Task:attempt_local1484411096_0100_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:44,801  INFO [pool-481-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:44,801  INFO [pool-481-thread-1] mapred.Task: Task 'attempt_local1484411096_0100_r_000000_0' done.
2024-04-23T21:09:44,801  INFO [pool-481-thread-1] mapred.Task: Final Counters for attempt_local1484411096_0100_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=2199956
		FILE: Number of bytes written=125474500
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=0
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945108480
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:44,801  INFO [pool-481-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1484411096_0100_r_000000_0
2024-04-23T21:09:44,802  INFO [Thread-8189] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:45,783 Stage-1 map = 0%,  reduce = 100%
2024-04-23T21:09:45,784  INFO [main] exec.Task: 2024-04-23 21:09:45,783 Stage-1 map = 0%,  reduce = 100%
Ended Job = job_local1484411096_0100
2024-04-23T21:09:45,784  INFO [main] exec.Task: Ended Job = job_local1484411096_0100
Launching Job 2 out of 2
2024-04-23T21:09:45,788  INFO [main] ql.Driver: Launching Job 2 out of 2
2024-04-23T21:09:45,928  INFO [main] ql.Driver: Starting task [Stage-2:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:09:45,929  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:45,929  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:45,929  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:45,929  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:45,929  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:45,929  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:45,929  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:45,931  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:45,931  INFO [main] exec.Utilities: Processing alias file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/-mr-10001
2024-04-23T21:09:45,931  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/-mr-10001
2024-04-23T21:09:45,940  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:45,941  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,46KB
2024-04-23T21:09:45,945  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:45,945  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,40KB
2024-04-23T21:09:45,946  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:45,950  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/-mr-10000
2024-04-23T21:09:45,952  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:45,958  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:45,962  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:45,963  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0
2024-04-23T21:09:45,963  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = _col0
2024-04-23T21:09:45,963  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/-mr-10001
2024-04-23T21:09:45,967  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:09:45,967  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:45,984  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:46,003  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local670348042_0101
2024-04-23T21:09:46,003  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:46,065  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:46,065  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:46,065  INFO [Thread-8227] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:46,065  INFO [Thread-8227] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:46,066  INFO [Thread-8227] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:46,067  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local670348042_0101_m_000000_0
2024-04-23T21:09:46,067  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:46,068  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.mapred.SequenceFileInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/-mr-10001/000000_0:0+96
2024-04-23T21:09:46,071  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:46,071  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,46KB
2024-04-23T21:09:46,072  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:09:46,076  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:46,076  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:46,076  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:46,076  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:46,076  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:46,077  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:46,077  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:46,077  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>
    <TS>Id =20
      <Children>
        <RS>Id =21
          <Children>
          <\Children>
          <Parent>Id = 20 null<\Parent>
        <\RS>
      <\Children>
      <Parent><\Parent>
    <\TS>
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:46,078  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[20]
2024-04-23T21:09:46,078  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[21]
2024-04-23T21:09:46,078  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:09:46,078  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:46,078  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:09:46,078  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[20]
2024-04-23T21:09:46,078  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_20:0, 
2024-04-23T21:09:46,079  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[21]
2024-04-23T21:09:46,079  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[21]: Total records written - 0. abort - false
2024-04-23T21:09:46,079  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_RS_21:0, 
2024-04-23T21:09:46,079  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:46,079  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:46,102  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local670348042_0101_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:46,103  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/-mr-10001/000000_0:0+96
2024-04-23T21:09:46,103  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local670348042_0101_m_000000_0' done.
2024-04-23T21:09:46,103  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local670348042_0101_m_000000_0: Counters: 28
	File System Counters
		FILE: Number of bytes read=2205167
		FILE: Number of bytes written=126723588
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=0
		Map output records=0
		Map output bytes=0
		Map output materialized bytes=12
		Input split bytes=334
		Combine input records=0
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945108480
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=0
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_21=0
		RECORDS_OUT_OPERATOR_TS_20=0
	File Input Format Counters 
		Bytes Read=4823
2024-04-23T21:09:46,103  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local670348042_0101_m_000000_0
2024-04-23T21:09:46,103  INFO [Thread-8227] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:46,106  INFO [Thread-8227] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:46,106  INFO [pool-484-thread-1] mapred.LocalJobRunner: Starting task: attempt_local670348042_0101_r_000000_0
2024-04-23T21:09:46,107  INFO [pool-484-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:46,107  INFO [pool-484-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@c3e170c
2024-04-23T21:09:46,107  WARN [pool-484-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:46,109  INFO [pool-484-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1361575936, maxSingleShuffleLimit=340393984, mergeThreshold=898640128, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:46,110  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local670348042_0101_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:46,112  INFO [localfetcher#134] reduce.LocalFetcher: localfetcher#134 about to shuffle output of map attempt_local670348042_0101_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:46,112  INFO [localfetcher#134] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local670348042_0101_m_000000_0
2024-04-23T21:09:46,112  INFO [localfetcher#134] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:46,113  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:46,113  INFO [pool-484-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:46,114  INFO [pool-484-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:46,124  INFO [pool-484-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:46,124  INFO [pool-484-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:46,130  INFO [pool-484-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:46,130  INFO [pool-484-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:46,130  INFO [pool-484-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:46,130  INFO [pool-484-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:46,130  INFO [pool-484-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:46,131  INFO [pool-484-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:46,132  INFO [pool-484-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:46,132  INFO [pool-484-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,40KB
2024-04-23T21:09:46,135  INFO [pool-484-thread-1] ExecReducer: 
<SEL>Id =15
  <Children>
    <FS>Id =16
      <Children>
      <\Children>
      <Parent>Id = 15 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:46,135  INFO [pool-484-thread-1] exec.SelectOperator: Initializing Operator: SEL[15]
2024-04-23T21:09:46,135  INFO [pool-484-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<>>
2024-04-23T21:09:46,135  INFO [pool-484-thread-1] exec.FileSinkOperator: Initializing Operator: FS[16]
2024-04-23T21:09:46,136  INFO [pool-484-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local670348042_0101/job_local670348042_0101.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6cc4ea22
2024-04-23T21:09:46,136  INFO [pool-484-thread-1] exec.SelectOperator: Closing Operator: SEL[15]
2024-04-23T21:09:46,136  INFO [pool-484-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_15:0, 
2024-04-23T21:09:46,136  INFO [pool-484-thread-1] exec.FileSinkOperator: Closing Operator: FS[16]
2024-04-23T21:09:46,136  INFO [pool-484-thread-1] exec.FileSinkOperator: FS[16]: records written - 0
2024-04-23T21:09:46,137  INFO [pool-484-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:46,137  INFO [pool-484-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:46,148  INFO [pool-484-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_OPERATOR_FS_16:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:46,149  INFO [pool-484-thread-1] mapred.Task: Task:attempt_local670348042_0101_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:46,150  INFO [pool-484-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:46,150  INFO [pool-484-thread-1] mapred.Task: Task 'attempt_local670348042_0101_r_000000_0' done.
2024-04-23T21:09:46,150  INFO [pool-484-thread-1] mapred.Task: Final Counters for attempt_local670348042_0101_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=2210698
		FILE: Number of bytes written=126723647
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945108480
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:46,150  INFO [pool-484-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local670348042_0101_r_000000_0
2024-04-23T21:09:46,151  INFO [pool-484-thread-1] mapred.LocalJobRunner: Starting task: attempt_local670348042_0101_r_000001_0
2024-04-23T21:09:46,152  INFO [pool-484-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:46,152  INFO [pool-484-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@d27ee0f
2024-04-23T21:09:46,152  WARN [pool-484-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:46,154  INFO [pool-484-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1361575936, maxSingleShuffleLimit=340393984, mergeThreshold=898640128, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:46,155  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local670348042_0101_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:46,159  INFO [localfetcher#135] reduce.LocalFetcher: localfetcher#135 about to shuffle output of map attempt_local670348042_0101_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:46,160  INFO [localfetcher#135] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local670348042_0101_m_000000_0
2024-04-23T21:09:46,160  INFO [localfetcher#135] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:46,161  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:46,161  INFO [pool-484-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:46,161  INFO [pool-484-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:46,171  INFO [pool-484-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:46,172  INFO [pool-484-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:46,177  INFO [pool-484-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:46,177  INFO [pool-484-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:46,177  INFO [pool-484-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:46,177  INFO [pool-484-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:46,178  INFO [pool-484-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:46,178  INFO [pool-484-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:46,179  INFO [pool-484-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:46,180  INFO [pool-484-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,40KB
2024-04-23T21:09:46,181  INFO [pool-484-thread-1] ExecReducer: 
<SEL>Id =15
  <Children>
    <FS>Id =16
      <Children>
      <\Children>
      <Parent>Id = 15 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:46,181  INFO [pool-484-thread-1] exec.SelectOperator: Initializing Operator: SEL[15]
2024-04-23T21:09:46,181  INFO [pool-484-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<>>
2024-04-23T21:09:46,182  INFO [pool-484-thread-1] exec.FileSinkOperator: Initializing Operator: FS[16]
2024-04-23T21:09:46,182  INFO [pool-484-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local670348042_0101/job_local670348042_0101.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2fdbefd7
2024-04-23T21:09:46,183  INFO [pool-484-thread-1] exec.SelectOperator: Closing Operator: SEL[15]
2024-04-23T21:09:46,183  INFO [pool-484-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_15:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:46,183  INFO [pool-484-thread-1] exec.FileSinkOperator: Closing Operator: FS[16]
2024-04-23T21:09:46,183  INFO [pool-484-thread-1] exec.FileSinkOperator: FS[16]: records written - 0
2024-04-23T21:09:46,183  INFO [pool-484-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:46,183  INFO [pool-484-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:46,194  INFO [pool-484-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_16:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:0, 
2024-04-23T21:09:46,195  INFO [pool-484-thread-1] mapred.Task: Task:attempt_local670348042_0101_r_000001_0 is done. And is in the process of committing
2024-04-23T21:09:46,196  INFO [pool-484-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:46,196  INFO [pool-484-thread-1] mapred.Task: Task 'attempt_local670348042_0101_r_000001_0' done.
2024-04-23T21:09:46,196  INFO [pool-484-thread-1] mapred.Task: Final Counters for attempt_local670348042_0101_r_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=2216223
		FILE: Number of bytes written=126723706
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945108480
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:46,196  INFO [pool-484-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local670348042_0101_r_000001_0
2024-04-23T21:09:46,196  INFO [Thread-8227] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:47,067 Stage-2 map = 100%,  reduce = 100%
2024-04-23T21:09:47,067  INFO [main] exec.Task: 2024-04-23 21:09:47,067 Stage-2 map = 100%,  reduce = 100%
Ended Job = job_local670348042_0101
2024-04-23T21:09:47,069  INFO [main] exec.Task: Ended Job = job_local670348042_0101
2024-04-23T21:09:47,071  INFO [main] FileOperations: No manifests found in directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delete_delta_0000001_0000001_0000 - query produced no output
2024-04-23T21:09:47,071  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:09:47,071  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:47,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:47,077  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:47,083  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:47,125  INFO [main] ql.Driver: Starting task [Stage-3:STATS] in serial mode
2024-04-23T21:09:47,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:47,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,131  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:47,131  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1/-mr-10000
2024-04-23T21:09:47,133  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:47,138  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,139  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 0, false: 
2024-04-23T21:09:47,139  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:09:47,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:47,158  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 0, false: 
2024-04-23T21:09:47,158  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:09:47,158  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:09:47,158  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:47,159  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:47,159  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=23, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=61}
MapReduce Jobs Launched: 
2024-04-23T21:09:47,159  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:47,159  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Stage-Stage-2:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:47,159  INFO [main] ql.Driver: Stage-Stage-2:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:47,159  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:47,159  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a); Time taken: 2.654 seconds
2024-04-23T21:09:47,159  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210944_3ae22f22-fca2-4f25-b0f5-a5466319688a
2024-04-23T21:09:47,182  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:47,182  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:09:47,182  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,2),(5,2),(1,3),(3,3),(5,3)
2024-04-23T21:09:47,183  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1
2024-04-23T21:09:47,183  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_077_6821472609054170140-1 on fs with scheme file
2024-04-23T21:09:47,183  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_046_4974620837143646327-1
2024-04-23T21:09:47,184  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-44_046_4974620837143646327-1 on fs with scheme file
2024-04-23T21:09:47,184  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081): insert into acidTbl(a,b)  values(1,2),(3,2),(5,2),(1,3),(3,3),(5,3)
2024-04-23T21:09:47,187  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T21:09:47,188  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:09:47,188  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:47,188  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:47,192  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:47,198  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,199  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:47,199  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:47,199  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:47,199  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:47,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:47,204  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,205  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:47,205  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:47,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:47,297  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:47,297  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:47,297  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:47,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:47,299  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:47,299  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:47,299  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:47,300  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:47,305  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:47,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:47,318  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 14
2024-04-23T21:09:47,318  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T21:09:47,319  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:09:47,321  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:09:47,321  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:09:47,322  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:09:47,323  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:09:47,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:47,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:47,338  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:47,338  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:09:47,338  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:47,338  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:47,339  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T21:09:47,339  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:47,339  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=23, flushCache_()=0, getTable_(GetTableRequest)=25, allocateTableWriteId_(long, String, String)=9, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, getAllTableConstraints_(AllTableConstraintsRequest)=4, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T21:09:47,339  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081); Time taken: 0.155 seconds
2024-04-23T21:09:47,339  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081
2024-04-23T21:09:47,339  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081
2024-04-23T21:09:47,358  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:09:47,358  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:09:47,361  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081): insert into acidTbl(a,b)  values(1,2),(3,2),(5,2),(1,3),(3,3),(5,3)
2024-04-23T21:09:47,362  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081
2024-04-23T21:09:47,362  INFO [main] ql.Driver: Query ID = alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081
Total jobs = 1
2024-04-23T21:09:47,362  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:09:47,362  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:09:47,485  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:09:47,485  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:47,485  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:47,485  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:47,486  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:47,486  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:47,486  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:47,486  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:47,488  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:47,488  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:09:47,488  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-47_184_7850045936978677751-1/dummy_path
2024-04-23T21:09:47,497  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:47,498  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,37KB
2024-04-23T21:09:47,502  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:47,503  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,01KB
2024-04-23T21:09:47,504  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:47,507  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-47_184_7850045936978677751-1/-mr-10000
2024-04-23T21:09:47,509  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:47,516  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:47,520  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:47,521  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:09:47,521  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:09:47,521  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-47_184_7850045936978677751-1/dummy_path
2024-04-23T21:09:47,521  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:47,550  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:47,569  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local37982103_0102
2024-04-23T21:09:47,569  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:47,644  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:47,644  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:47,644  INFO [Thread-8285] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:47,644  INFO [Thread-8285] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:47,646  INFO [Thread-8285] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:47,646  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local37982103_0102_m_000000_0
2024-04-23T21:09:47,646  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:47,647  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-47_184_7850045936978677751-1/dummy_path/null:0+1
2024-04-23T21:09:47,647  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:47,648  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,37KB
2024-04-23T21:09:47,648  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:09:47,652  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:47,652  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:47,652  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:47,652  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:47,652  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:47,652  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:47,653  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:47,653  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:09:47,654  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:09:47,655  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 6. abort - false
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:6, RECORDS_OUT_INTERMEDIATE:6, 
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 96; bufvoid = 104857600
2024-04-23T21:09:47,656  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214376(104857504); length = 21/6553600
2024-04-23T21:09:47,667  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:09:47,669  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local37982103_0102_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:47,670  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:09:47,670  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local37982103_0102_m_000000_0' done.
2024-04-23T21:09:47,670  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local37982103_0102_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=2222172
		FILE: Number of bytes written=127969757
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=6
		Map output bytes=96
		Map output materialized bytes=120
		Input split bytes=361
		Combine input records=0
		Spilled Records=6
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945632768
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=6
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=6
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=6
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=6
	File Input Format Counters 
		Bytes Read=5430
2024-04-23T21:09:47,670  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local37982103_0102_m_000000_0
2024-04-23T21:09:47,670  INFO [Thread-8285] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:47,671  INFO [Thread-8285] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:47,671  INFO [pool-488-thread-1] mapred.LocalJobRunner: Starting task: attempt_local37982103_0102_r_000000_0
2024-04-23T21:09:47,672  INFO [pool-488-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:47,672  INFO [pool-488-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@11e7e877
2024-04-23T21:09:47,672  WARN [pool-488-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:47,673  INFO [pool-488-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1361942912, maxSingleShuffleLimit=340485728, mergeThreshold=898882368, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:47,673  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local37982103_0102_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:47,674  INFO [localfetcher#136] reduce.LocalFetcher: localfetcher#136 about to shuffle output of map attempt_local37982103_0102_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:09:47,674  INFO [localfetcher#136] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local37982103_0102_m_000000_0
2024-04-23T21:09:47,674  INFO [localfetcher#136] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:09:47,674  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:47,675  INFO [pool-488-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:47,675  INFO [pool-488-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:47,680  INFO [pool-488-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:47,680  INFO [pool-488-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:09:47,683  INFO [pool-488-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:47,683  INFO [pool-488-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:09:47,683  INFO [pool-488-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:47,683  INFO [pool-488-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:47,683  INFO [pool-488-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:09:47,683  INFO [pool-488-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:47,683  INFO [pool-488-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:47,684  INFO [pool-488-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,01KB
2024-04-23T21:09:47,684  INFO [pool-488-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:47,684  INFO [pool-488-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:47,684  INFO [pool-488-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:09:47,685  INFO [pool-488-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:47,685  INFO [pool-488-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local37982103_0102/job_local37982103_0102.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@13ed186f
2024-04-23T21:09:47,685  INFO [pool-488-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:47,685  INFO [pool-488-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:47,685  INFO [pool-488-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:47,685  INFO [pool-488-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:47,685  INFO [pool-488-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:47,692  INFO [pool-488-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:47,696  INFO [pool-488-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:47,696  INFO [pool-488-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,696  INFO [pool-488-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:47,696  INFO [pool-488-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:09:47,697  INFO [pool-488-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0]
2024-04-23T21:09:47,708  INFO [pool-488-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,708  INFO [pool-488-thread-1] mapred.Task: Task:attempt_local37982103_0102_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:47,709  INFO [pool-488-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:47,709  INFO [pool-488-thread-1] mapred.Task: Task 'attempt_local37982103_0102_r_000000_0' done.
2024-04-23T21:09:47,709  INFO [pool-488-thread-1] mapred.Task: Final Counters for attempt_local37982103_0102_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=2228457
		FILE: Number of bytes written=127970825
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945632768
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:47,709  INFO [pool-488-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local37982103_0102_r_000000_0
2024-04-23T21:09:47,709  INFO [pool-488-thread-1] mapred.LocalJobRunner: Starting task: attempt_local37982103_0102_r_000001_0
2024-04-23T21:09:47,709  INFO [pool-488-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:47,709  INFO [pool-488-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@66a9723f
2024-04-23T21:09:47,709  WARN [pool-488-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:47,710  INFO [pool-488-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1361942912, maxSingleShuffleLimit=340485728, mergeThreshold=898882368, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:47,711  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local37982103_0102_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:47,713  INFO [localfetcher#137] reduce.LocalFetcher: localfetcher#137 about to shuffle output of map attempt_local37982103_0102_m_000000_0 decomp: 74 len: 78 to MEMORY
2024-04-23T21:09:47,713  INFO [localfetcher#137] reduce.InMemoryMapOutput: Read 74 bytes from map-output for attempt_local37982103_0102_m_000000_0
2024-04-23T21:09:47,713  INFO [localfetcher#137] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 74, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->74
2024-04-23T21:09:47,714  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:47,714  INFO [pool-488-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:47,714  INFO [pool-488-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:47,720  INFO [pool-488-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:47,720  INFO [pool-488-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 62 bytes
2024-04-23T21:09:47,723  INFO [pool-488-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 74 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:47,723  INFO [pool-488-thread-1] reduce.MergeManagerImpl: Merging 1 files, 78 bytes from disk
2024-04-23T21:09:47,723  INFO [pool-488-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:47,723  INFO [pool-488-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:47,723  INFO [pool-488-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 62 bytes
2024-04-23T21:09:47,723  INFO [pool-488-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:47,723  INFO [pool-488-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:47,724  INFO [pool-488-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,01KB
2024-04-23T21:09:47,724  INFO [pool-488-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:47,724  INFO [pool-488-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:47,724  INFO [pool-488-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:09:47,725  INFO [pool-488-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:47,725  INFO [pool-488-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local37982103_0102/job_local37982103_0102.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@636c9e8b
2024-04-23T21:09:47,725  INFO [pool-488-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:47,725  INFO [pool-488-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:47,725  INFO [pool-488-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse
2024-04-23T21:09:47,726  INFO [pool-488-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:47,726  INFO [pool-488-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:47,730  INFO [pool-488-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:47,730  INFO [pool-488-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:47,731  INFO [pool-488-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:47,731  INFO [pool-488-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:47,731  INFO [pool-488-thread-1] exec.FileSinkOperator: FS[6]: records written - 4
2024-04-23T21:09:47,732  INFO [pool-488-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-23T21:09:47,741  INFO [pool-488-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:4, RECORDS_OUT_OPERATOR_FS_6:4, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:4, 
2024-04-23T21:09:47,741  INFO [pool-488-thread-1] mapred.Task: Task:attempt_local37982103_0102_r_000001_0 is done. And is in the process of committing
2024-04-23T21:09:47,742  INFO [pool-488-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:47,742  INFO [pool-488-thread-1] mapred.Task: Task 'attempt_local37982103_0102_r_000001_0' done.
2024-04-23T21:09:47,742  INFO [pool-488-thread-1] mapred.Task: Final Counters for attempt_local37982103_0102_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=2234736
		FILE: Number of bytes written=127971934
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=78
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945632768
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=4
		RECORDS_OUT_OPERATOR_SEL_5=4
		TOTAL_TABLE_ROWS_WRITTEN=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:47,742  INFO [pool-488-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local37982103_0102_r_000001_0
2024-04-23T21:09:47,742  INFO [Thread-8285] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:48,647 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:09:48,647  INFO [main] exec.Task: 2024-04-23 21:09:48,647 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local37982103_0102
2024-04-23T21:09:48,649  INFO [main] exec.Task: Ended Job = job_local37982103_0102
2024-04-23T21:09:48,650  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:09:48,650  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:09:48,650  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest
2024-04-23T21:09:48,650  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-23T21:09:48,650  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-23T21:09:48,651  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T21:09:48,652  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713931540902/warehouse/acidtbl
2024-04-23T21:09:48,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:48,658  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:48,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:48,665  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:48,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:48,684  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:09:48,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:48,689  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:48,690  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:48,690  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-47_184_7850045936978677751-1/-mr-10000
2024-04-23T21:09:48,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:48,697  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:48,708  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:09:48,708  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 6, false: 
2024-04-23T21:09:48,708  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T21:09:48,708  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T21:09:48,726  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 6, false: 
2024-04-23T21:09:48,726  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T21:09:48,726  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T21:09:48,730  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=6, totalSize=1382, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:48,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:48,730  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=36, getTable_(GetTableRequest)=25, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3}
MapReduce Jobs Launched: 
2024-04-23T21:09:48,731  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:48,731  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:48,731  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:48,731  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081); Time taken: 1.369 seconds
2024-04-23T21:09:48,731  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210947_451eaf89-3c31-4eb1-ab3f-9f3c9ca90081
2024-04-23T21:09:48,746  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:48,746  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:09:48,747  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl2(a,b,c) values(1,7,17),(3,7,17)
2024-04-23T21:09:48,747  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-47_184_7850045936978677751-1
2024-04-23T21:09:48,747  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-47_184_7850045936978677751-1 on fs with scheme file
2024-04-23T21:09:48,748  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763): insert into acidTbl2(a,b,c) values(1,7,17),(3,7,17)
2024-04-23T21:09:48,751  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T21:09:48,752  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:09:48,752  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:09:48,752  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:09:48,756  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:48,756  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:48,756  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:48,756  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:48,757  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:48,757  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:48,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:48,827  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:48,827  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:48,827  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:09:48,827  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:09:48,830  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:09:48,830  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:48,830  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:09:48,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl2	
2024-04-23T21:09:48,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl2	
2024-04-23T21:09:48,840  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 15
2024-04-23T21:09:48,840  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl2 (txnIds: [15])
2024-04-23T21:09:48,841  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:09:48,844  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col0], KEY.reducesinkkey0=Column[_col2], VALUE._col1=Column[_col1]}
2024-04-23T21:09:48,845  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col1=Column[_col1], VALUE._col0=Column[_col0], KEY.reducesinkkey0=Column[_col2]}
2024-04-23T21:09:48,845  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:09:48,846  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:09:48,855  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:09:48,856  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:09:48,856  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:09:48,856  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:09:48,856  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:48,856  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null), FieldSchema(name:_col2, type:int, comment:null)], properties:null)
2024-04-23T21:09:48,856  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:48,856  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=5, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getTable_(GetTableRequest)=0, allocateTableWriteId_(long, String, String)=6, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getValidWriteIds_(List, String)=4}
2024-04-23T21:09:48,857  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763); Time taken: 0.108 seconds
2024-04-23T21:09:48,857  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763
2024-04-23T21:09:48,857  INFO [main] ql.Driver: Operation QUERY obtained 0 locks
2024-04-23T21:09:48,858  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763): insert into acidTbl2(a,b,c) values(1,7,17),(3,7,17)
2024-04-23T21:09:48,858  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763
2024-04-23T21:09:48,858  INFO [main] ql.Driver: Query ID = alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763
Total jobs = 1
2024-04-23T21:09:48,858  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:09:48,858  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:09:48,982  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:09:48,982  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:09:48,982  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:09:48,982  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:09:48,982  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:09:48,982  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:09:48,982  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:09:48,982  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:09:48,985  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:09:48,985  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:09:48,985  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-48_748_7010618139699046887-1/dummy_path
2024-04-23T21:09:48,994  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:09:48,994  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,45KB
2024-04-23T21:09:48,999  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:09:48,999  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,18KB
2024-04-23T21:09:49,000  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:49,004  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-48_748_7010618139699046887-1/-mr-10000
2024-04-23T21:09:49,006  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:49,013  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:09:49,018  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:09:49,019  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:09:49,019  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:09:49,019  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-48_748_7010618139699046887-1/dummy_path
2024-04-23T21:09:49,019  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:09:49,036  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:09:49,057  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1443505779_0103
2024-04-23T21:09:49,057  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:09:49,120  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:09:49,120  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:09:49,121  INFO [Thread-8359] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:49,121  INFO [Thread-8359] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:09:49,122  INFO [Thread-8359] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:09:49,122  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1443505779_0103_m_000000_0
2024-04-23T21:09:49,123  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:49,123  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-48_748_7010618139699046887-1/dummy_path/null:0+1
2024-04-23T21:09:49,124  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:09:49,124  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,45KB
2024-04-23T21:09:49,125  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:09:49,129  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:09:49,129  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:09:49,129  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:09:49,129  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:09:49,129  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:09:49,129  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:09:49,130  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:09:49,130  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int,col3:int>
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:09:49,131  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:09:49,132  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 34; bufvoid = 104857600
2024-04-23T21:09:49,133  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:09:49,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:09:49,147  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1443505779_0103_m_000000_0 is done. And is in the process of committing
2024-04-23T21:09:49,147  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:09:49,147  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1443505779_0103_m_000000_0' done.
2024-04-23T21:09:49,147  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1443505779_0103_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=2241289
		FILE: Number of bytes written=129227808
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=34
		Map output materialized bytes=50
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945632768
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5510
2024-04-23T21:09:49,147  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1443505779_0103_m_000000_0
2024-04-23T21:09:49,147  INFO [Thread-8359] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:09:49,149  INFO [Thread-8359] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:09:49,149  INFO [pool-493-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1443505779_0103_r_000000_0
2024-04-23T21:09:49,149  INFO [pool-493-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:49,149  INFO [pool-493-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@23bfadc8
2024-04-23T21:09:49,149  WARN [pool-493-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:49,150  INFO [pool-493-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1361942912, maxSingleShuffleLimit=340485728, mergeThreshold=898882368, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:49,151  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1443505779_0103_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:49,151  INFO [localfetcher#138] reduce.LocalFetcher: localfetcher#138 about to shuffle output of map attempt_local1443505779_0103_m_000000_0 decomp: 40 len: 44 to MEMORY
2024-04-23T21:09:49,151  INFO [localfetcher#138] reduce.InMemoryMapOutput: Read 40 bytes from map-output for attempt_local1443505779_0103_m_000000_0
2024-04-23T21:09:49,151  INFO [localfetcher#138] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 40, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->40
2024-04-23T21:09:49,152  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:49,152  INFO [pool-493-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:49,152  INFO [pool-493-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:49,158  INFO [pool-493-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:49,158  INFO [pool-493-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T21:09:49,160  INFO [pool-493-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 40 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:49,161  INFO [pool-493-thread-1] reduce.MergeManagerImpl: Merging 1 files, 44 bytes from disk
2024-04-23T21:09:49,161  INFO [pool-493-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:49,161  INFO [pool-493-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:49,161  INFO [pool-493-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T21:09:49,161  INFO [pool-493-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:49,161  INFO [pool-493-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:49,162  INFO [pool-493-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,18KB
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1443505779_0103/job_local1443505779_0103.xml], properties={name=default.acidtbl2, transactional=true, columns.types=int:int:int, bucket_field_name=c, serialization.format=1, columns=a,b,c, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e, column.name.delimiter=,}, tableProperties={name=default.acidtbl2, transactional=true, columns.types=int:int:int, bucket_field_name=c, serialization.format=1, columns=a,b,c, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b, c], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5102c591
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e
2024-04-23T21:09:49,163  INFO [pool-493-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db
2024-04-23T21:09:49,164  INFO [pool-493-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:09:49,164  INFO [pool-493-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:09:49,171  INFO [pool-493-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:09:49,176  INFO [pool-493-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:49,176  INFO [pool-493-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:09:49,176  INFO [pool-493-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:49,176  INFO [pool-493-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:09:49,178  INFO [pool-493-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T21:09:49,189  INFO [pool-493-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl2:2, 
2024-04-23T21:09:49,190  INFO [pool-493-thread-1] mapred.Task: Task:attempt_local1443505779_0103_r_000000_0 is done. And is in the process of committing
2024-04-23T21:09:49,190  INFO [pool-493-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:49,190  INFO [pool-493-thread-1] mapred.Task: Task 'attempt_local1443505779_0103_r_000000_0' done.
2024-04-23T21:09:49,190  INFO [pool-493-thread-1] mapred.Task: Final Counters for attempt_local1443505779_0103_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=2247687
		FILE: Number of bytes written=129228610
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=44
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945632768
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl2=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:49,190  INFO [pool-493-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1443505779_0103_r_000000_0
2024-04-23T21:09:49,190  INFO [pool-493-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1443505779_0103_r_000001_0
2024-04-23T21:09:49,191  INFO [pool-493-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:09:49,191  INFO [pool-493-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@459654b1
2024-04-23T21:09:49,191  WARN [pool-493-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:09:49,192  INFO [pool-493-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1361942912, maxSingleShuffleLimit=340485728, mergeThreshold=898882368, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:09:49,192  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1443505779_0103_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:09:49,195  INFO [localfetcher#139] reduce.LocalFetcher: localfetcher#139 about to shuffle output of map attempt_local1443505779_0103_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:09:49,195  INFO [localfetcher#139] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1443505779_0103_m_000000_0
2024-04-23T21:09:49,195  INFO [localfetcher#139] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:09:49,195  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:09:49,196  INFO [pool-493-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:49,196  INFO [pool-493-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:09:49,201  INFO [pool-493-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:49,202  INFO [pool-493-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:49,204  INFO [pool-493-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:09:49,204  INFO [pool-493-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:09:49,204  INFO [pool-493-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:09:49,204  INFO [pool-493-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:09:49,204  INFO [pool-493-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:09:49,205  INFO [pool-493-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:09:49,205  INFO [pool-493-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:09:49,206  INFO [pool-493-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,18KB
2024-04-23T21:09:49,207  INFO [pool-493-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:09:49,207  INFO [pool-493-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:09:49,207  INFO [pool-493-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:09:49,207  INFO [pool-493-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:09:49,207  INFO [pool-493-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@10c75546, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommandsWithSplitUpdateAndVectorization/mapred/local/localRunner/alex/job_local1443505779_0103/job_local1443505779_0103.xml], properties={name=default.acidtbl2, transactional=true, columns.types=int:int:int, bucket_field_name=c, serialization.format=1, columns=a,b,c, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e, column.name.delimiter=,}, tableProperties={name=default.acidtbl2, transactional=true, columns.types=int:int:int, bucket_field_name=c, serialization.format=1, columns=a,b,c, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b, c], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6eac981c
2024-04-23T21:09:49,208  INFO [pool-493-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:09:49,208  INFO [pool-493-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:0, 
2024-04-23T21:09:49,208  INFO [pool-493-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:09:49,208  INFO [pool-493-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-23T21:09:49,208  INFO [pool-493-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e
2024-04-23T21:09:49,208  INFO [pool-493-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e
2024-04-23T21:09:49,208  INFO [pool-493-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db
2024-04-23T21:09:49,214  INFO [pool-493-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl2:0, 
2024-04-23T21:09:49,214  INFO [pool-493-thread-1] mapred.Task: Task:attempt_local1443505779_0103_r_000001_0 is done. And is in the process of committing
2024-04-23T21:09:49,215  INFO [pool-493-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:09:49,215  INFO [pool-493-thread-1] mapred.Task: Task 'attempt_local1443505779_0103_r_000001_0' done.
2024-04-23T21:09:49,215  INFO [pool-493-thread-1] mapred.Task: Final Counters for attempt_local1443505779_0103_r_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=2254003
		FILE: Number of bytes written=129228670
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1945632768
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:09:49,215  INFO [pool-493-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1443505779_0103_r_000001_0
2024-04-23T21:09:49,215  INFO [Thread-8359] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:09:50,123 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:09:50,124  INFO [main] exec.Task: 2024-04-23 21:09:50,123 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1443505779_0103
2024-04-23T21:09:50,126  INFO [main] exec.Task: Ended Job = job_local1443505779_0103
2024-04-23T21:09:50,127  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T21:09:50,127  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T21:09:50,127  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e/_tmp.delta_0000001_0000001_0000
2024-04-23T21:09:50,128  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl2
2024-04-23T21:09:50,128  INFO [main] exec.Task: Loading data to table default.acidtbl2 from file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/795c523f-0e89-4759-9f46-45d20dedab6b/_tmp_space.db/5aa25f67-9a44-4f66-8ea1-b6fb27d7d80e
2024-04-23T21:09:50,129  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidtbl2
2024-04-23T21:09:50,129  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:09:50,129  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:09:50,129  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-48_748_7010618139699046887-1/-mr-10000
2024-04-23T21:09:50,138  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:09:50,139  INFO [main] FileOperations: Read stats for default.acidtbl2/, numRows, true, 2, false: 
2024-04-23T21:09:50,139  INFO [main] FileOperations: Read stats for default.acidtbl2/, rawDataSize, true, 0, false: 
2024-04-23T21:09:50,139  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidtbl2
2024-04-23T21:09:50,139  INFO [main] FileOperations: Read stats for default.acidtbl2/, insertCount, true, 2, false: 
2024-04-23T21:09:50,139  INFO [main] FileOperations: Read stats for default.acidtbl2/, updateCount, true, 0, false: 
2024-04-23T21:09:50,139  INFO [main] FileOperations: Read stats for default.acidtbl2/, deleteCount, true, 0, false: 
2024-04-23T21:09:50,139  INFO [main] stats.BasicStatsTask: Table default.acidtbl2 stats: [numFiles=1, numRows=2, totalSize=387, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:09:50,140  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:50,140  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=1}
MapReduce Jobs Launched: 
2024-04-23T21:09:50,140  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:09:50,140  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:50,140  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:09:50,140  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763); Time taken: 1.282 seconds
2024-04-23T21:09:50,140  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210948_9bd878e9-ab48-42d1-83f2-f35d5bc64763
2024-04-23T21:09:50,150  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:09:50,161  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:50,161  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:09:50,162  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where a in(select a from acidTbl2)
2024-04-23T21:09:50,162  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-48_748_7010618139699046887-1
2024-04-23T21:09:50,163  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/795c523f-0e89-4759-9f46-45d20dedab6b/hive_2024-04-23_21-09-48_748_7010618139699046887-1 on fs with scheme file
2024-04-23T21:09:50,163  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210950_be5a244b-ba5c-4d95-a698-bba1b6be8803): delete from acidTbl where a in(select a from acidTbl2)
2024-04-23T21:09:50,168  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T21:09:50,168  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:09:50,169  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T21:09:50,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:50,175  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,175  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where a in(select a from acidTbl2)> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T21:09:50,176  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T21:09:50,179  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T21:09:50,179  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:50,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:50,186  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,186  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:50,186  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:50,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:50,192  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,192  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T21:09:50,192  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:09:50,204  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T21:09:50,208  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:50,209  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:50,209  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:50,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl2	
2024-04-23T21:09:50,312  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:09:50,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:50,320  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T21:09:50,329  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T21:09:50,336  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:50,336  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T21:09:50,336  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl2, projIndxSet: [0], allowMissingStats: true
2024-04-23T21:09:50,336  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl2, Columns: a
No Stats for default@acidtbl2, Columns: a
2024-04-23T21:09:50,336  INFO [main] SessionState: No Stats for default@acidtbl2, Columns: a
2024-04-23T21:09:50,451  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:50,451  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:50,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:50,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:50,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:50,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T21:09:50,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T21:09:50,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:50,452  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T21:09:50,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:50,459  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,463 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:935) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:09:50,465 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T21:09:50,465  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T21:09:50,465 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<rowid:bigint,writeid:int,bucketid:bigint>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:935)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:09:50,465  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:50,466  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=25, getValidTxns_(long)=1, getTableColumnStatistics_(String, String, List, String)=24, getAllTableConstraints_(AllTableConstraintsRequest)=9, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=22}
2024-04-23T21:09:50,466  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210950_be5a244b-ba5c-4d95-a698-bba1b6be8803); Time taken: 0.302 seconds
2024-04-23T21:09:50,466  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:09:50,472  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:50,482  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:09:50,483  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e): drop table if exists acidTbl
2024-04-23T21:09:50,485  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T21:09:50,486  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:09:50,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:50,492  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,492  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:50,492  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:50,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:50,492  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=16, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=6, getValidTxns_(long)=0}
2024-04-23T21:09:50,493  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e); Time taken: 0.009 seconds
2024-04-23T21:09:50,493  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e
2024-04-23T21:09:50,493  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e
2024-04-23T21:09:50,513  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:09:50,513  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:50,513  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e): drop table if exists acidTbl
2024-04-23T21:09:50,513  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:50,514  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:50,519  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:50,526  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:09:50,663  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:50,663  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=143, isCompatibleWith_(Configuration)=0}
2024-04-23T21:09:50,663  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e); Time taken: 0.15 seconds
2024-04-23T21:09:50,663  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210950_4e1f1f78-a416-4d2d-8b12-836fc78fe78e
2024-04-23T21:09:50,668  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:09:50,677  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:50,679  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:09:50,680  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:09:50,680  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e): drop table if exists acidTblPart
2024-04-23T21:09:50,682  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T21:09:50,682  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:09:50,683  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:50,689  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,689  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:50,689  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:50,689  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:50,689  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, getValidTxns_(long)=0}
2024-04-23T21:09:50,690  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e); Time taken: 0.009 seconds
2024-04-23T21:09:50,690  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e
2024-04-23T21:09:50,690  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e
2024-04-23T21:09:50,708  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:09:50,708  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:50,708  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e): drop table if exists acidTblPart
2024-04-23T21:09:50,708  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:50,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:50,714  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:50,720  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,720  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:09:50,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:50,759  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=5, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=45}
2024-04-23T21:09:50,760  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e); Time taken: 0.051 seconds
2024-04-23T21:09:50,760  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210950_52fc09a3-cd42-4a8f-a68c-8310bbfc874e
2024-04-23T21:09:50,765  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:09:50,774  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:50,774  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:09:50,775  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:09:50,775  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210950_f02e23e1-cf9e-4643-bf3c-f6c656524cc6): drop table if exists acidTbl2
2024-04-23T21:09:50,777  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T21:09:50,777  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:09:50,778  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:50,778  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:50,778  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:50,778  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:09:50,778  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210950_f02e23e1-cf9e-4643-bf3c-f6c656524cc6); Time taken: 0.003 seconds
2024-04-23T21:09:50,779  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423210950_f02e23e1-cf9e-4643-bf3c-f6c656524cc6
2024-04-23T21:09:50,779  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:09:50,779  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210950_f02e23e1-cf9e-4643-bf3c-f6c656524cc6): drop table if exists acidTbl2
2024-04-23T21:09:50,779  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:50,779  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:09:50,780  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:50,780  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T21:09:50,780  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210950_f02e23e1-cf9e-4643-bf3c-f6c656524cc6); Time taken: 0.001 seconds
2024-04-23T21:09:50,780  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210950_f02e23e1-cf9e-4643-bf3c-f6c656524cc6
2024-04-23T21:09:50,788  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:09:50,796  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:50,796  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:09:50,797  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:09:50,797  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:50,799  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T21:09:50,799  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:09:50,800  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:50,825  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,825  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:50,825  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:50,825  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:50,825  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, getTable_(GetTableRequest)=25, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:09:50,825  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2); Time taken: 0.028 seconds
2024-04-23T21:09:50,826  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2
2024-04-23T21:09:50,826  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2
2024-04-23T21:09:50,844  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:09:50,844  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:50,844  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2): drop table if exists nonAcidOrcTbl
2024-04-23T21:09:50,845  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:50,845  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:50,857  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:50,867  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:50,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:09:50,974  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:50,975  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12, dropTable_(String, String, boolean, boolean, boolean)=117}
2024-04-23T21:09:50,975  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2); Time taken: 0.13 seconds
2024-04-23T21:09:50,975  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210950_99d1acf1-a9b7-4653-9451-1bcad9c92ca2
2024-04-23T21:09:50,981  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:09:50,991  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:50,991  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:09:50,992  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:50,992  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:50,995  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T21:09:50,995  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:09:50,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:51,004  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:51,004  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:51,004  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:51,004  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:51,004  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=17, getValidTxns_(long)=0}
2024-04-23T21:09:51,005  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646); Time taken: 0.012 seconds
2024-04-23T21:09:51,005  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646
2024-04-23T21:09:51,005  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646
2024-04-23T21:09:51,030  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:09:51,030  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:51,030  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646): drop table if exists nonAcidOrcTbl2
2024-04-23T21:09:51,030  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:51,030  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:51,038  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:51,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:51,046  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:51,046  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:09:51,074  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:51,074  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=36}
2024-04-23T21:09:51,074  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646); Time taken: 0.044 seconds
2024-04-23T21:09:51,074  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210950_1dc46dcb-2d9c-4fbf-92cc-58128468e646
2024-04-23T21:09:51,079  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:09:51,088  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:51,088  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:09:51,089  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:09:51,089  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85): drop table if exists nonAcidNonBucket
2024-04-23T21:09:51,091  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 16
2024-04-23T21:09:51,092  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:09:51,093  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:51,101  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:51,101  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:09:51,101  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:09:51,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:09:51,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T21:09:51,102  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85); Time taken: 0.012 seconds
2024-04-23T21:09:51,102  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85
2024-04-23T21:09:51,102  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85
2024-04-23T21:09:51,123  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:09:51,123  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:09:51,123  INFO [main] ql.Driver: Executing command(queryId=alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85): drop table if exists nonAcidNonBucket
2024-04-23T21:09:51,123  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:09:51,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:51,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:51,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:51,138  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:09:51,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:09:51,166  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:09:51,166  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=35, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T21:09:51,167  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85); Time taken: 0.043 seconds
2024-04-23T21:09:51,167  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423210951_04c5a6c7-5c78-4f62-a450-373ec64c1a85
2024-04-23T21:09:51,173  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:09:51,182  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:09:51,182  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:09:51,183  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMmExim" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="11.219"/>
  <testcase name="testExplicitRollback" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="3.863"/>
  <testcase name="testNonAcidInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommandsWithSplitUpdateAndVectorization" time="0">
    <skipped message="not needed but useful for testing"/>
  </testcase>
</testsuite>