<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.hadoop.hive.ql.TestTxnCommands" time="249.093" tests="49" errors="18" skipped="2" failures="0">
  <properties>
    <property name="build.test.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="test.tmp.dir.uri" value="file:///home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="qfile" value=""/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="test.warehouse.dir" value="pfile:///home/alex/Repositories/hive/ql/target/warehouse"/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="run_disabled" value=""/>
    <property name="nondexPrintstack" value="false"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="http://java.oracle.com/"/>
    <property name="user.country.format" value="PT"/>
    <property name="test.tmp.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/alex/Repositories/hive/ql/target/surefire/surefirebooter3884255790056491472.jar /home/alex/Repositories/hive/ql/target/surefire 2024-04-23T21-59-46_173-jvmRun1 surefire4668999804940283284tmp surefire_21017680810787624684619tmp"/>
    <property name="nondexExecid" value="P8gC2Wt6DD1QwiZ4NJDRegC4uh59IgmR4jnrq+hRsc="/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/java-8-openjdk-amd64/jre"/>
    <property name="basedir" value="/home/alex/Repositories/hive/ql"/>
    <property name="file.separator" value="/"/>
    <property name="nondexEnd" value="9223372036854775807"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="derby.stream.error.file" value="/home/alex/Repositories/hive/ql/target/tmp/derby.log"/>
    <property name="log4j.debug" value="true"/>
    <property name="sun.boot.class.path" value="/home/alex/Repositories/hive/ql/.nondex/nondex-instr.jar:/home/alex/.m2/repository/edu/illinois/nondex-common/2.1.7/nondex-common-2.1.7.jar:/home/alex/.m2/repository/edu/illinois/nondex-annotations/2.1.7/nondex-annotations-2.1.7.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="spark.home" value=""/>
    <property name="java.runtime.version" value="1.8.0_402-8u402-ga-2ubuntu1~22.04-b06"/>
    <property name="user.name" value="alex"/>
    <property name="test.src.tables" value=""/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="qfile_regex" value=""/>
    <property name="hadoop.bin.path" value="/home/alex/Repositories/hive/ql/../testutils/hadoop"/>
    <property name="localRepository" value="/home/alex/.m2/repository"/>
    <property name="nondexDir" value="/home/alex/Repositories/hive/ql/.nondex"/>
    <property name="build.dir" value="/home/alex/Repositories/hive/ql/target"/>
    <property name="nondexJarDir" value="/home/alex/Repositories/hive/ql/.nondex"/>
    <property name="mapred.job.tracker" value="local"/>
    <property name="java.io.tmpdir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="com.zaxxer.hikari.pool_number" value="3"/>
    <property name="java.version" value="1.8.0_402"/>
    <property name="hive.version" value="4.0.0-SNAPSHOT"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib"/>
    <property name="test.data.dir" value="/home/alex/Repositories/hive/ql/../data/files"/>
    <property name="java.vendor" value="Private Build"/>
    <property name="java.specification.maintenance.version" value="5"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="initScript" value=""/>
    <property name="sun.desktop" value="gnome"/>
    <property name="calcite.enable.rexnode.digest.normalize" value="false"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="nondexStart" value="0"/>
    <property name="log4j.configurationFile" value="file:///home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties"/>
    <property name="java.class.path" value="/home/alex/Repositories/hive/ql/target/test-classes:/home/alex/Repositories/hive/ql/target/classes:/home/alex/.m2/repository/org/apache/atlas/atlas-client-v2/2.1.0/atlas-client-v2-2.1.0.jar:/home/alex/.m2/repository/cglib/cglib/2.2.2/cglib-2.2.2.jar:/home/alex/.m2/repository/asm/asm/3.3.1/asm-3.3.1.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-client-common/2.1.0/atlas-client-common-2.1.0.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-intg/2.1.0/atlas-intg-2.1.0.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/alex/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/org/springframework/spring-context/4.3.20.RELEASE/spring-context-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-aop/4.3.20.RELEASE/spring-aop-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-beans/4.3.20.RELEASE/spring-beans-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-core/4.3.20.RELEASE/spring-core-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-expression/4.3.20.RELEASE/spring-expression-4.3.20.RELEASE.jar:/home/alex/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/alex/Repositories/hive/vector-code-gen/target/classes:/home/alex/.m2/repository/org/apache/velocity/velocity/1.5/velocity-1.5.jar:/home/alex/Repositories/hive/common/target/classes:/home/alex/Repositories/hive/classification/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/commons-cli/commons-cli/1.4/commons-cli-1.4.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.27.v20190418/jetty-http-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-rewrite/9.3.27.v20190418/jetty-rewrite-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-client/9.3.27.v20190418/jetty-client-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.27.v20190418/jetty-server-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.27.v20190418/jetty-io-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.27.v20190418/jetty-servlet-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.27.v20190418/jetty-security-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.27.v20190418/jetty-webapp-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.27.v20190418/jetty-xml-9.3.27.v20190418.jar:/home/alex/.m2/repository/joda-time/joda-time/2.9.9/joda-time-2.9.9.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-web/2.13.2/log4j-web-2.13.2.jar:/home/alex/.m2/repository/net/sf/jpam/jpam/1.1/jpam-1.1.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/Repositories/hive/metastore/target/classes:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/Repositories/hive/serde/target/classes:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-vector/0.15.1/arrow-vector-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-format/0.15.1/arrow-format-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-memory/0.15.1/arrow-memory-0.15.1.jar:/home/alex/.m2/repository/com/google/flatbuffers/flatbuffers-java/1.9.0/flatbuffers-java-1.9.0.jar:/home/alex/.m2/repository/com/carrotsearch/hppc/0.7.2/hppc-0.7.2.jar:/home/alex/.m2/repository/com/github/davidmoten/flatbuffers-java/1.6.0.1/flatbuffers-java-1.6.0.1.jar:/home/alex/Repositories/hive/parser/target/classes:/home/alex/Repositories/hive/udf/target/classes:/home/alex/Repositories/hive/service-rpc/target/classes:/home/alex/Repositories/hive/llap-client/target/classes:/home/alex/Repositories/hive/llap-common/target/classes:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-api/0.10.5/jjwt-api-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-impl/0.10.5/jjwt-impl-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.10.5/jjwt-jackson-0.10.5.jar:/home/alex/Repositories/hive/llap-tez/target/classes:/home/alex/Repositories/hive/shims/aggregator/target/classes:/home/alex/Repositories/hive/shims/common/target/classes:/home/alex/Repositories/hive/shims/0.23/target/classes:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-resourcemanager/3.1.0/hadoop-yarn-server-resourcemanager-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-applicationhistoryservice/3.1.0/hadoop-yarn-server-applicationhistoryservice-3.1.0.jar:/home/alex/.m2/repository/de/ruedigermoeller/fst/2.50/fst-2.50.jar:/home/alex/.m2/repository/com/cedarsoftware/java-util/1.9.0/java-util-1.9.0.jar:/home/alex/.m2/repository/com/cedarsoftware/json-io/2.5.1/json-io-2.5.1.jar:/home/alex/Repositories/hive/shims/scheduler/target/classes:/home/alex/Repositories/hive/spark-client/target/classes:/home/alex/.m2/repository/io/netty/netty-all/4.1.65.Final/netty-all-4.1.65.Final.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-scala_2.12/2.12.0/jackson-module-scala_2.12-2.12.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-yarn_2.12/2.4.5/spark-yarn_2.12-2.4.5.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/com/amazonaws/aws-java-sdk-bundle/1.11.901/aws-java-sdk-bundle-1.11.901.jar:/home/alex/.m2/repository/com/amazonaws/secretsmanager/aws-secretsmanager-caching-java/1.0.1/aws-secretsmanager-caching-java-1.0.1.jar:/home/alex/.m2/repository/com/esotericsoftware/kryo/5.0.3/kryo-5.0.3.jar:/home/alex/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/minlog/1.3.1/minlog-1.3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/reflectasm/1.11.9/reflectasm-1.11.9.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/alex/.m2/repository/org/apache/hbase/hbase-common/2.0.0-alpha4/hbase-common-2.0.0-alpha4.jar:/home/alex/.m2/repository/org/apache/hbase/thirdparty/hbase-shaded-miscellaneous/1.0.1/hbase-shaded-miscellaneous-1.0.1.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core/3.2.0-incubating/htrace-core-3.2.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-crypto/1.0.0/commons-crypto-1.0.0.jar:/home/alex/.m2/repository/com/github/stephenc/findbugs/findbugs-annotations/1.3.9-1/findbugs-annotations-1.3.9-1.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-hadoop-bundle/1.11.1/parquet-hadoop-bundle-1.11.1.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/alex/.m2/repository/commons-io/commons-io/2.6/commons-io-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/commons/commons-text/1.8/commons-text-1.8.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.8.2/avro-1.8.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.8/paranamer-2.8.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.1.4/snappy-java-1.1.4.jar:/home/alex/.m2/repository/org/tukaani/xz/1.5/xz-1.5.jar:/home/alex/.m2/repository/org/apache/avro/avro-mapred/1.8.2/avro-mapred-1.8.2-hadoop2.jar:/home/alex/.m2/repository/org/apache/avro/avro-ipc/1.8.2/avro-ipc-1.8.2.jar:/home/alex/.m2/repository/org/mortbay/jetty/jetty/6.1.26/jetty-6.1.26.jar:/home/alex/.m2/repository/org/apache/ant/ant/1.9.1/ant-1.9.1.jar:/home/alex/.m2/repository/org/apache/ant/ant-launcher/1.9.1/ant-launcher-1.9.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.27.v20190418/jetty-util-9.3.27.v20190418.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-archives/3.1.0/hadoop-archives-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-registry/3.1.0/hadoop-yarn-registry-3.1.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-common/3.1.0/hadoop-mapreduce-client-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/orc/orc-tools/1.6.9/orc-tools-1.6.9.jar:/home/alex/.m2/repository/com/opencsv/opencsv/3.9/opencsv-3.9.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/org/threeten/threetenbp/1.3.5/threetenbp-1.3.5.jar:/home/alex/.m2/repository/org/apache/ivy/ivy/2.4.0/ivy-2.4.0.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-hive/1.1.0-incubating/datasketches-hive-1.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-java/1.3.0-incubating/datasketches-java-1.3.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-memory/1.2.0-incubating/datasketches-memory-1.2.0-incubating.jar:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar:/home/alex/.m2/repository/com/lmax/disruptor/3.3.7/disruptor-3.3.7.jar:/home/alex/.m2/repository/org/codehaus/groovy/groovy-all/2.4.11/groovy-all-2.4.11.jar:/home/alex/.m2/repository/org/jodd/jodd-util/6.0.0/jodd-util-6.0.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.12.0/jackson-dataformat-yaml-2.12.0.jar:/home/alex/.m2/repository/org/yaml/snakeyaml/1.27/snakeyaml-1.27.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-core/1.25.0/calcite-core-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-linq4j/1.25.0/calcite-linq4j-1.25.0.jar:/home/alex/.m2/repository/org/apiguardian/apiguardian-api/1.1.0/apiguardian-api-1.1.0.jar:/home/alex/.m2/repository/com/esri/geometry/esri-geometry-api/2.2.0/esri-geometry-api-2.2.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/sketches-core/0.9.0/sketches-core-0.9.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/memory/0.9.0/memory-0.9.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-druid/1.25.0/calcite-druid-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/avatica/avatica/1.12.0/avatica-1.12.0.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/googlecode/javaewah/JavaEWAH/0.3.2/JavaEWAH-0.3.2.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/com/tdunning/json/1.8/json-1.8.jar:/home/alex/.m2/repository/stax/stax-api/1.0.1/stax-api-1.0.1.jar:/home/alex/.m2/repository/net/sf/opencsv/opencsv/2.3/opencsv-2.3.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/Repositories/hive/common/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/test-classes:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/.m2/repository/org/apache/parquet/parquet-column/1.11.1/parquet-column-1.11.1-tests.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-common/1.11.1/parquet-common-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-format-structures/1.11.1/parquet-format-structures-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-encoding/1.11.1/parquet-encoding-1.11.1.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.6.2/junit-jupiter-engine-5.6.2.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-engine/1.6.2/junit-platform-engine-1.6.2.jar:/home/alex/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-commons/1.6.2/junit-platform-commons-1.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.6.2/junit-jupiter-api-5.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.6.2/junit-jupiter-params-5.6.2.jar:/home/alex/.m2/repository/org/junit/vintage/junit-vintage-engine/5.6.2/junit-vintage-engine-5.6.2.jar:/home/alex/.m2/repository/org/apache/tez/tez-api/0.10.1/tez-api-0.10.1.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-library/0.10.1/tez-runtime-library-0.10.1.jar:/home/alex/.m2/repository/org/roaringbitmap/RoaringBitmap/0.5.21/RoaringBitmap-0.5.21.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/alex/.m2/repository/io/netty/netty-buffer/4.1.48.Final/netty-buffer-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-http/4.1.48.Final/netty-codec-http-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-common/4.1.48.Final/netty-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport/4.1.48.Final/netty-transport-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec/4.1.48.Final/netty-codec-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler/4.1.48.Final/netty-handler-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-resolver/4.1.48.Final/netty-resolver-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-socks/4.1.48.Final/netty-codec-socks-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler-proxy/4.1.48.Final/netty-handler-proxy-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-epoll/4.1.48.Final/netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.48.Final/netty-transport-native-unix-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-kqueue/4.1.48.Final/netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/alex/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/alex/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.4/netty-reactive-streams-2.0.4.jar:/home/alex/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/alex/.m2/repository/org/apache/tez/tez-common/0.10.1/tez-common-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-internals/0.10.1/tez-runtime-internals-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/hadoop-shim/0.10.1/hadoop-shim-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-mapreduce/0.10.1/tez-mapreduce-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-dag/0.10.1/tez-dag-0.10.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-web-proxy/3.1.0/hadoop-yarn-server-web-proxy-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-common/3.1.0/hadoop-yarn-server-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/geronimo/specs/geronimo-jcache_1.0_spec/1.0-alpha-1/geronimo-jcache_1.0_spec-1.0-alpha-1.jar:/home/alex/.m2/repository/org/ehcache/ehcache/3.3.1/ehcache-3.3.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP-java7/2.4.12/HikariCP-java7-2.4.12.jar:/home/alex/.m2/repository/org/apache/spark/spark-core_2.12/2.4.5/spark-core_2.12-2.4.5.jar:/home/alex/.m2/repository/com/twitter/chill_2.12/0.9.3/chill_2.12-0.9.3.jar:/home/alex/.m2/repository/com/twitter/chill-java/0.9.3/chill-java-0.9.3.jar:/home/alex/.m2/repository/org/apache/xbean/xbean-asm6-shaded/4.8/xbean-asm6-shaded-4.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-client/3.1.0/hadoop-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-jobclient/3.1.0/hadoop-mapreduce-client-jobclient-3.1.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-launcher_2.12/2.4.5/spark-launcher_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-kvstore_2.12/2.4.5/spark-kvstore_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-common_2.12/2.4.5/spark-network-common_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-shuffle_2.12/2.4.5/spark-network-shuffle_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-unsafe_2.12/2.4.5/spark-unsafe_2.12-2.4.5.jar:/home/alex/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/alex/.m2/repository/org/slf4j/jul-to-slf4j/1.7.16/jul-to-slf4j-1.7.16.jar:/home/alex/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.16/jcl-over-slf4j-1.7.16.jar:/home/alex/.m2/repository/com/ning/compress-lzf/1.0.3/compress-lzf-1.0.3.jar:/home/alex/.m2/repository/org/lz4/lz4-java/1.4.0/lz4-java-1.4.0.jar:/home/alex/.m2/repository/com/github/luben/zstd-jni/1.3.2-2/zstd-jni-1.3.2-2.jar:/home/alex/.m2/repository/org/scala-lang/scala-library/2.12.10/scala-library-2.12.10.jar:/home/alex/.m2/repository/org/json4s/json4s-jackson_2.12/3.5.3/json4s-jackson_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-core_2.12/3.5.3/json4s-core_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-ast_2.12/3.5.3/json4s-ast_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-scalap_2.12/3.5.3/json4s-scalap_2.12-3.5.3.jar:/home/alex/.m2/repository/org/scala-lang/modules/scala-xml_2.12/1.0.6/scala-xml_2.12-1.0.6.jar:/home/alex/.m2/repository/com/clearspring/analytics/stream/2.7.0/stream-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-graphite/3.1.5/metrics-graphite-3.1.5.jar:/home/alex/.m2/repository/oro/oro/2.0.8/oro-2.0.8.jar:/home/alex/.m2/repository/net/razorvine/pyrolite/4.13/pyrolite-4.13.jar:/home/alex/.m2/repository/net/sf/py4j/py4j/0.10.7/py4j-0.10.7.jar:/home/alex/.m2/repository/org/apache/spark/spark-tags_2.12/2.4.5/spark-tags_2.12-2.4.5.jar:/home/alex/.m2/repository/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-server/2.22.2/jersey-server-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-common/2.22.2/jersey-common-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/bundles/repackaged/jersey-guava/2.22.2/jersey-guava-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-client/2.22.2/jersey-client-2.22.2.jar:/home/alex/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.22.2/jersey-media-jaxb-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-api/2.4.0-b34/hk2-api-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-utils/2.4.0-b34/hk2-utils-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.4.0-b34/aopalliance-repackaged-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/javax.inject/2.4.0-b34/javax.inject-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-locator/2.4.0-b34/hk2-locator-2.4.0-b34.jar:/home/alex/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/alex/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.22.2/jersey-container-servlet-core-2.22.2.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4/2.0.2/powermock-module-junit4-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4-common/2.0.2/powermock-module-junit4-common-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-reflect/2.0.2/powermock-reflect-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-core/2.0.2/powermock-core-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-mockito2/2.0.2/powermock-api-mockito2-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-support/2.0.2/powermock-api-support-2.0.2.jar:/home/alex/.m2/repository/com/google/guava/guava-testlib/19.0/guava-testlib-19.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.0.2/error_prone_annotations-2.0.2.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.2/re2j-1.2.jar:/home/alex/.m2/repository/org/reflections/reflections/0.9.10/reflections-0.9.10.jar:/home/alex/.m2/repository/org/javassist/javassist/3.19.0-GA/javassist-3.19.0-GA.jar:/home/alex/.m2/repository/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/org/codehaus/janino/commons-compiler/3.0.11/commons-compiler-3.0.11.jar:/home/alex/.m2/repository/org/codehaus/janino/janino/3.0.11/janino-3.0.11.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-multipart/1.19/jersey-multipart-1.19.jar:/home/alex/.m2/repository/org/jvnet/mimepull/mimepull/1.9.3/mimepull-1.9.3.jar:/home/alex/.m2/repository/org/apache/kafka/kafka-clients/2.5.0/kafka-clients-2.5.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.4.4/mockito-core-3.4.4.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.13/byte-buddy-1.10.13.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.13/byte-buddy-agent-1.10.13.jar:/home/alex/Repositories/hive/ql/target/testconf:/home/alex/Repositories/hive/ql/../conf:"/>
    <property name="java.vm.vendor" value="Private Build"/>
    <property name="hadoop.version" value="3.1.0"/>
    <property name="user.timezone" value="US/Pacific"/>
    <property name="test.local.warehouse.dir" value="pfile:///home/alex/Repositories/hive/ql/target/localfs/warehouse"/>
    <property name="os.name" value="Linux"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="clustermode" value=""/>
    <property name="test.build.data" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="user.country" value="US"/>
    <property name="test.data.files" value="/home/alex/Repositories/hive/ql/../data/files"/>
    <property name="nondexLogging" value="CONFIG"/>
    <property name="surefire.test.class.path" value="/home/alex/Repositories/hive/ql/target/test-classes:/home/alex/Repositories/hive/ql/target/classes:/home/alex/.m2/repository/org/apache/atlas/atlas-client-v2/2.1.0/atlas-client-v2-2.1.0.jar:/home/alex/.m2/repository/cglib/cglib/2.2.2/cglib-2.2.2.jar:/home/alex/.m2/repository/asm/asm/3.3.1/asm-3.3.1.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-client-common/2.1.0/atlas-client-common-2.1.0.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/org/apache/atlas/atlas-intg/2.1.0/atlas-intg-2.1.0.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/alex/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/org/springframework/spring-context/4.3.20.RELEASE/spring-context-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-aop/4.3.20.RELEASE/spring-aop-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-beans/4.3.20.RELEASE/spring-beans-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-core/4.3.20.RELEASE/spring-core-4.3.20.RELEASE.jar:/home/alex/.m2/repository/org/springframework/spring-expression/4.3.20.RELEASE/spring-expression-4.3.20.RELEASE.jar:/home/alex/.m2/repository/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:/home/alex/Repositories/hive/vector-code-gen/target/classes:/home/alex/.m2/repository/org/apache/velocity/velocity/1.5/velocity-1.5.jar:/home/alex/Repositories/hive/common/target/classes:/home/alex/Repositories/hive/classification/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/commons-cli/commons-cli/1.4/commons-cli-1.4.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.27.v20190418/jetty-http-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-rewrite/9.3.27.v20190418/jetty-rewrite-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-client/9.3.27.v20190418/jetty-client-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.27.v20190418/jetty-server-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.27.v20190418/jetty-io-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.27.v20190418/jetty-servlet-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.27.v20190418/jetty-security-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.27.v20190418/jetty-webapp-9.3.27.v20190418.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.27.v20190418/jetty-xml-9.3.27.v20190418.jar:/home/alex/.m2/repository/joda-time/joda-time/2.9.9/joda-time-2.9.9.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-web/2.13.2/log4j-web-2.13.2.jar:/home/alex/.m2/repository/net/sf/jpam/jpam/1.1/jpam-1.1.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/Repositories/hive/metastore/target/classes:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/Repositories/hive/serde/target/classes:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-vector/0.15.1/arrow-vector-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-format/0.15.1/arrow-format-0.15.1.jar:/home/alex/.m2/repository/org/apache/arrow/arrow-memory/0.15.1/arrow-memory-0.15.1.jar:/home/alex/.m2/repository/com/google/flatbuffers/flatbuffers-java/1.9.0/flatbuffers-java-1.9.0.jar:/home/alex/.m2/repository/com/carrotsearch/hppc/0.7.2/hppc-0.7.2.jar:/home/alex/.m2/repository/com/github/davidmoten/flatbuffers-java/1.6.0.1/flatbuffers-java-1.6.0.1.jar:/home/alex/Repositories/hive/parser/target/classes:/home/alex/Repositories/hive/udf/target/classes:/home/alex/Repositories/hive/service-rpc/target/classes:/home/alex/Repositories/hive/llap-client/target/classes:/home/alex/Repositories/hive/llap-common/target/classes:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-api/0.10.5/jjwt-api-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-impl/0.10.5/jjwt-impl-0.10.5.jar:/home/alex/.m2/repository/io/jsonwebtoken/jjwt-jackson/0.10.5/jjwt-jackson-0.10.5.jar:/home/alex/Repositories/hive/llap-tez/target/classes:/home/alex/Repositories/hive/shims/aggregator/target/classes:/home/alex/Repositories/hive/shims/common/target/classes:/home/alex/Repositories/hive/shims/0.23/target/classes:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-resourcemanager/3.1.0/hadoop-yarn-server-resourcemanager-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-applicationhistoryservice/3.1.0/hadoop-yarn-server-applicationhistoryservice-3.1.0.jar:/home/alex/.m2/repository/de/ruedigermoeller/fst/2.50/fst-2.50.jar:/home/alex/.m2/repository/com/cedarsoftware/java-util/1.9.0/java-util-1.9.0.jar:/home/alex/.m2/repository/com/cedarsoftware/json-io/2.5.1/json-io-2.5.1.jar:/home/alex/Repositories/hive/shims/scheduler/target/classes:/home/alex/Repositories/hive/spark-client/target/classes:/home/alex/.m2/repository/io/netty/netty-all/4.1.65.Final/netty-all-4.1.65.Final.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-scala_2.12/2.12.0/jackson-module-scala_2.12-2.12.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-yarn_2.12/2.4.5/spark-yarn_2.12-2.4.5.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/com/amazonaws/aws-java-sdk-bundle/1.11.901/aws-java-sdk-bundle-1.11.901.jar:/home/alex/.m2/repository/com/amazonaws/secretsmanager/aws-secretsmanager-caching-java/1.0.1/aws-secretsmanager-caching-java-1.0.1.jar:/home/alex/.m2/repository/com/esotericsoftware/kryo/5.0.3/kryo-5.0.3.jar:/home/alex/.m2/repository/org/objenesis/objenesis/3.1/objenesis-3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/minlog/1.3.1/minlog-1.3.1.jar:/home/alex/.m2/repository/com/esotericsoftware/reflectasm/1.11.9/reflectasm-1.11.9.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/alex/.m2/repository/org/apache/hbase/hbase-common/2.0.0-alpha4/hbase-common-2.0.0-alpha4.jar:/home/alex/.m2/repository/org/apache/hbase/thirdparty/hbase-shaded-miscellaneous/1.0.1/hbase-shaded-miscellaneous-1.0.1.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core/3.2.0-incubating/htrace-core-3.2.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-crypto/1.0.0/commons-crypto-1.0.0.jar:/home/alex/.m2/repository/com/github/stephenc/findbugs/findbugs-annotations/1.3.9-1/findbugs-annotations-1.3.9-1.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-hadoop-bundle/1.11.1/parquet-hadoop-bundle-1.11.1.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:/home/alex/.m2/repository/commons-io/commons-io/2.6/commons-io-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-collections4/4.1/commons-collections4-4.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/commons/commons-text/1.8/commons-text-1.8.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.8.2/avro-1.8.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.8/paranamer-2.8.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.1.4/snappy-java-1.1.4.jar:/home/alex/.m2/repository/org/tukaani/xz/1.5/xz-1.5.jar:/home/alex/.m2/repository/org/apache/avro/avro-mapred/1.8.2/avro-mapred-1.8.2-hadoop2.jar:/home/alex/.m2/repository/org/apache/avro/avro-ipc/1.8.2/avro-ipc-1.8.2.jar:/home/alex/.m2/repository/org/mortbay/jetty/jetty/6.1.26/jetty-6.1.26.jar:/home/alex/.m2/repository/org/apache/ant/ant/1.9.1/ant-1.9.1.jar:/home/alex/.m2/repository/org/apache/ant/ant-launcher/1.9.1/ant-launcher-1.9.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.27.v20190418/jetty-util-9.3.27.v20190418.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-archives/3.1.0/hadoop-archives-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-registry/3.1.0/hadoop-yarn-registry-3.1.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-common/3.1.0/hadoop-mapreduce-client-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/orc/orc-tools/1.6.9/orc-tools-1.6.9.jar:/home/alex/.m2/repository/com/opencsv/opencsv/3.9/opencsv-3.9.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/org/threeten/threetenbp/1.3.5/threetenbp-1.3.5.jar:/home/alex/.m2/repository/org/apache/ivy/ivy/2.4.0/ivy-2.4.0.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-hive/1.1.0-incubating/datasketches-hive-1.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-java/1.3.0-incubating/datasketches-java-1.3.0-incubating.jar:/home/alex/.m2/repository/org/apache/datasketches/datasketches-memory/1.2.0-incubating/datasketches-memory-1.2.0-incubating.jar:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar:/home/alex/.m2/repository/com/lmax/disruptor/3.3.7/disruptor-3.3.7.jar:/home/alex/.m2/repository/org/codehaus/groovy/groovy-all/2.4.11/groovy-all-2.4.11.jar:/home/alex/.m2/repository/org/jodd/jodd-util/6.0.0/jodd-util-6.0.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-yaml/2.12.0/jackson-dataformat-yaml-2.12.0.jar:/home/alex/.m2/repository/org/yaml/snakeyaml/1.27/snakeyaml-1.27.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-core/1.25.0/calcite-core-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-linq4j/1.25.0/calcite-linq4j-1.25.0.jar:/home/alex/.m2/repository/org/apiguardian/apiguardian-api/1.1.0/apiguardian-api-1.1.0.jar:/home/alex/.m2/repository/com/esri/geometry/esri-geometry-api/2.2.0/esri-geometry-api-2.2.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/sketches-core/0.9.0/sketches-core-0.9.0.jar:/home/alex/.m2/repository/com/yahoo/datasketches/memory/0.9.0/memory-0.9.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/org/apache/calcite/calcite-druid/1.25.0/calcite-druid-1.25.0.jar:/home/alex/.m2/repository/org/apache/calcite/avatica/avatica/1.12.0/avatica-1.12.0.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/googlecode/javaewah/JavaEWAH/0.3.2/JavaEWAH-0.3.2.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/com/tdunning/json/1.8/json-1.8.jar:/home/alex/.m2/repository/stax/stax-api/1.0.1/stax-api-1.0.1.jar:/home/alex/.m2/repository/net/sf/opencsv/opencsv/2.3/opencsv-2.3.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/Repositories/hive/common/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/test-classes:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/.m2/repository/org/apache/parquet/parquet-column/1.11.1/parquet-column-1.11.1-tests.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-common/1.11.1/parquet-common-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-format-structures/1.11.1/parquet-format-structures-1.11.1.jar:/home/alex/.m2/repository/org/apache/parquet/parquet-encoding/1.11.1/parquet-encoding-1.11.1.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.6.2/junit-jupiter-engine-5.6.2.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-engine/1.6.2/junit-platform-engine-1.6.2.jar:/home/alex/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/alex/.m2/repository/org/junit/platform/junit-platform-commons/1.6.2/junit-platform-commons-1.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.6.2/junit-jupiter-api-5.6.2.jar:/home/alex/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.6.2/junit-jupiter-params-5.6.2.jar:/home/alex/.m2/repository/org/junit/vintage/junit-vintage-engine/5.6.2/junit-vintage-engine-5.6.2.jar:/home/alex/.m2/repository/org/apache/tez/tez-api/0.10.1/tez-api-0.10.1.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-library/0.10.1/tez-runtime-library-0.10.1.jar:/home/alex/.m2/repository/org/roaringbitmap/RoaringBitmap/0.5.21/RoaringBitmap-0.5.21.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client/2.12.1/async-http-client-2.12.1.jar:/home/alex/.m2/repository/org/asynchttpclient/async-http-client-netty-utils/2.12.1/async-http-client-netty-utils-2.12.1.jar:/home/alex/.m2/repository/io/netty/netty-buffer/4.1.48.Final/netty-buffer-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-http/4.1.48.Final/netty-codec-http-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-common/4.1.48.Final/netty-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport/4.1.48.Final/netty-transport-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec/4.1.48.Final/netty-codec-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler/4.1.48.Final/netty-handler-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-resolver/4.1.48.Final/netty-resolver-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-codec-socks/4.1.48.Final/netty-codec-socks-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-handler-proxy/4.1.48.Final/netty-handler-proxy-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-epoll/4.1.48.Final/netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.48.Final/netty-transport-native-unix-common-4.1.48.Final.jar:/home/alex/.m2/repository/io/netty/netty-transport-native-kqueue/4.1.48.Final/netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/alex/.m2/repository/org/reactivestreams/reactive-streams/1.0.3/reactive-streams-1.0.3.jar:/home/alex/.m2/repository/com/typesafe/netty/netty-reactive-streams/2.0.4/netty-reactive-streams-2.0.4.jar:/home/alex/.m2/repository/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar:/home/alex/.m2/repository/org/apache/tez/tez-common/0.10.1/tez-common-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-runtime-internals/0.10.1/tez-runtime-internals-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/hadoop-shim/0.10.1/hadoop-shim-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-mapreduce/0.10.1/tez-mapreduce-0.10.1.jar:/home/alex/.m2/repository/org/apache/tez/tez-dag/0.10.1/tez-dag-0.10.1.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-web-proxy/3.1.0/hadoop-yarn-server-web-proxy-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-server-common/3.1.0/hadoop-yarn-server-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/geronimo/specs/geronimo-jcache_1.0_spec/1.0-alpha-1/geronimo-jcache_1.0_spec-1.0-alpha-1.jar:/home/alex/.m2/repository/org/ehcache/ehcache/3.3.1/ehcache-3.3.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP-java7/2.4.12/HikariCP-java7-2.4.12.jar:/home/alex/.m2/repository/org/apache/spark/spark-core_2.12/2.4.5/spark-core_2.12-2.4.5.jar:/home/alex/.m2/repository/com/twitter/chill_2.12/0.9.3/chill_2.12-0.9.3.jar:/home/alex/.m2/repository/com/twitter/chill-java/0.9.3/chill-java-0.9.3.jar:/home/alex/.m2/repository/org/apache/xbean/xbean-asm6-shaded/4.8/xbean-asm6-shaded-4.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-client/3.1.0/hadoop-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-jobclient/3.1.0/hadoop-mapreduce-client-jobclient-3.1.0.jar:/home/alex/.m2/repository/org/apache/spark/spark-launcher_2.12/2.4.5/spark-launcher_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-kvstore_2.12/2.4.5/spark-kvstore_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-common_2.12/2.4.5/spark-network-common_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-network-shuffle_2.12/2.4.5/spark-network-shuffle_2.12-2.4.5.jar:/home/alex/.m2/repository/org/apache/spark/spark-unsafe_2.12/2.4.5/spark-unsafe_2.12-2.4.5.jar:/home/alex/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/alex/.m2/repository/org/slf4j/jul-to-slf4j/1.7.16/jul-to-slf4j-1.7.16.jar:/home/alex/.m2/repository/org/slf4j/jcl-over-slf4j/1.7.16/jcl-over-slf4j-1.7.16.jar:/home/alex/.m2/repository/com/ning/compress-lzf/1.0.3/compress-lzf-1.0.3.jar:/home/alex/.m2/repository/org/lz4/lz4-java/1.4.0/lz4-java-1.4.0.jar:/home/alex/.m2/repository/com/github/luben/zstd-jni/1.3.2-2/zstd-jni-1.3.2-2.jar:/home/alex/.m2/repository/org/scala-lang/scala-library/2.12.10/scala-library-2.12.10.jar:/home/alex/.m2/repository/org/json4s/json4s-jackson_2.12/3.5.3/json4s-jackson_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-core_2.12/3.5.3/json4s-core_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-ast_2.12/3.5.3/json4s-ast_2.12-3.5.3.jar:/home/alex/.m2/repository/org/json4s/json4s-scalap_2.12/3.5.3/json4s-scalap_2.12-3.5.3.jar:/home/alex/.m2/repository/org/scala-lang/modules/scala-xml_2.12/1.0.6/scala-xml_2.12-1.0.6.jar:/home/alex/.m2/repository/com/clearspring/analytics/stream/2.7.0/stream-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-graphite/3.1.5/metrics-graphite-3.1.5.jar:/home/alex/.m2/repository/oro/oro/2.0.8/oro-2.0.8.jar:/home/alex/.m2/repository/net/razorvine/pyrolite/4.13/pyrolite-4.13.jar:/home/alex/.m2/repository/net/sf/py4j/py4j/0.10.7/py4j-0.10.7.jar:/home/alex/.m2/repository/org/apache/spark/spark-tags_2.12/2.4.5/spark-tags_2.12-2.4.5.jar:/home/alex/.m2/repository/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-server/2.22.2/jersey-server-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-common/2.22.2/jersey-common-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/jersey/bundles/repackaged/jersey-guava/2.22.2/jersey-guava-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/core/jersey-client/2.22.2/jersey-client-2.22.2.jar:/home/alex/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar:/home/alex/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.22.2/jersey-media-jaxb-2.22.2.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-api/2.4.0-b34/hk2-api-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-utils/2.4.0-b34/hk2-utils-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.4.0-b34/aopalliance-repackaged-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/external/javax.inject/2.4.0-b34/javax.inject-2.4.0-b34.jar:/home/alex/.m2/repository/org/glassfish/hk2/hk2-locator/2.4.0-b34/hk2-locator-2.4.0-b34.jar:/home/alex/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/alex/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.22.2/jersey-container-servlet-core-2.22.2.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4/2.0.2/powermock-module-junit4-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-module-junit4-common/2.0.2/powermock-module-junit4-common-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-reflect/2.0.2/powermock-reflect-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-core/2.0.2/powermock-core-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-mockito2/2.0.2/powermock-api-mockito2-2.0.2.jar:/home/alex/.m2/repository/org/powermock/powermock-api-support/2.0.2/powermock-api-support-2.0.2.jar:/home/alex/.m2/repository/com/google/guava/guava-testlib/19.0/guava-testlib-19.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.0.2/error_prone_annotations-2.0.2.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.2/re2j-1.2.jar:/home/alex/.m2/repository/org/reflections/reflections/0.9.10/reflections-0.9.10.jar:/home/alex/.m2/repository/org/javassist/javassist/3.19.0-GA/javassist-3.19.0-GA.jar:/home/alex/.m2/repository/com/jayway/jsonpath/json-path/2.4.0/json-path-2.4.0.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/org/codehaus/janino/commons-compiler/3.0.11/commons-compiler-3.0.11.jar:/home/alex/.m2/repository/org/codehaus/janino/janino/3.0.11/janino-3.0.11.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-multipart/1.19/jersey-multipart-1.19.jar:/home/alex/.m2/repository/org/jvnet/mimepull/mimepull/1.9.3/mimepull-1.9.3.jar:/home/alex/.m2/repository/org/apache/kafka/kafka-clients/2.5.0/kafka-clients-2.5.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.4.4/mockito-core-3.4.4.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.13/byte-buddy-1.10.13.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.13/byte-buddy-agent-1.10.13.jar:/home/alex/Repositories/hive/ql/target/testconf:/home/alex/Repositories/hive/ql/../conf:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/alex"/>
    <property name="user.language" value="en"/>
    <property name="java.security.krb5.conf" value="/home/alex/Repositories/hive/ql/target/testconf/krb5.conf"/>
    <property name="test.dfs.mkdir" value=""/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="nondexFilter" value=".*"/>
    <property name="nondexSeed" value="933178"/>
    <property name="surefire.real.class.path" value="/home/alex/Repositories/hive/ql/target/surefire/surefirebooter3884255790056491472.jar"/>
    <property name="hadoop.log.dir" value="/home/alex/Repositories/hive/ql/target/tmp"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="6.5.0-28-generic"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="hive.test.console.log.level" value="INFO"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="java.vendor.url.bug" value="http://bugreport.sun.com/bugreport/"/>
    <property name="maven.local.repository" value="/home/alex/.m2/repository"/>
    <property name="user.dir" value="/home/alex/Repositories/hive/ql"/>
    <property name="os.arch" value="amd64"/>
    <property name="nondexMode" value="FULL"/>
    <property name="user.language.format" value="pt"/>
    <property name="antlr.version" value="3.5.2"/>
    <property name="derby.version" value="10.14.1.0"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vm.version" value="25.402-b06"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="java.class.version" value="52.0"/>
    <property name="test.output.overwrite" value=""/>
    <property name="hive.root" value="/home/alex/Repositories/hive/ql/../"/>
  </properties>
  <testcase name="testMergeUpdateDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="17.9">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-out><![CDATA[log4j: Trying to find [log4j.xml] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@2b9f74d0.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@2b9f74d0.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
]]></system-out>
    <system-err><![CDATA[SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,076372 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@433defed]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@433defed) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@72c8e7b
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,019649 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(PatternSelector=null, Replace=null, footer="null", noConsoleNoAnsi="null", header="null", disableAnsi="null", Configuration(HiveLog4j2Test), charset="null", alwaysWriteExceptions="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(follow="null", target="SYSTEM_ERR", direct="null", bufferedIo="null", immediateFlush="null", bufferSize="null", name="console", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ignoreExceptions="null", Configuration(HiveLog4j2Test), ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(alwaysWriteExceptions="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", header="null", PatternSelector=null, charset="null", Replace=null, noConsoleNoAnsi="null", disableAnsi="null", Configuration(HiveLog4j2Test), footer="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(interval="1", maxRandomDelay="null", modulate="true")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(fileIndex="null", stopCustomActionsOnError="null", min="null", max="30", tempCompressedFilePattern="null", Configuration(HiveLog4j2Test), compressionLevel="null", ={})
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(advertiseURI="null", fileOwner="null", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), advertise="null", filePermissions="null", filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", fileGroup="null", fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", append="null", bufferSize="null", bufferedIo="null", immediateFlush="null", Configuration(HiveLog4j2Test), name="DRFA", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ignoreExceptions="null", ={}, Filter=null)
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 3274722971
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T22:24:06.960-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-22:24:08.831, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-22:24:08.832, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@7fb4f2a9 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@394a2528...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@394a2528 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@3401a114
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@433defed
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@433defed) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@433defed] started OK.
2024-04-23T22:24:08,930  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T22:24:09,297  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-23T22:24:09,353  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:24:09,353  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:24:09,354  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:24:09,354  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:24:09,354  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:24:09,354  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:24:09,354  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:24:09,355  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:24:09,355  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:24:09,355  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:24:09,356  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:24:09,434  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T22:24:09,439  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-23T22:24:10,005  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T22:24:10,016  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
2024-04-23T22:24:10,019  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T22:24:10,023  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-23T22:24:10,043  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T22:24:10,051  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-23T22:24:10,259  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
2024-04-23T22:24:10,267  INFO [main] utils.TestTxnDbUtil: Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/ql/target/tmp/junit_metastore_db;create=true
Hive Session ID = c3a6c92d-281a-4a20-9ccc-a7df8739a935
2024-04-23T22:24:11,206  INFO [main] SessionState: Hive Session ID = c3a6c92d-281a-4a20-9ccc-a7df8739a935
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:24:11,217  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
log4j:WARN No appenders could be found for logger (org.apache.htrace.core.Tracer).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-23T22:24:11,571  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c3a6c92d-281a-4a20-9ccc-a7df8739a935
2024-04-23T22:24:11,574  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935
2024-04-23T22:24:11,577  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c3a6c92d-281a-4a20-9ccc-a7df8739a935/_tmp_space.db
2024-04-23T22:24:11,600  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=c3a6c92d-281a-4a20-9ccc-a7df8739a935, clientType=HIVECLI]
2024-04-23T22:24:11,647  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T22:24:11,772  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T22:24:11,803  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T22:24:11,806  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-23T22:24:11,807  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-23T22:24:11,809  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T22:24:11,812  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-23T22:24:11,813  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T22:24:11,814  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-23T22:24:12,231  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-23T22:24:12,231  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a481728, with PersistenceManager: null will be shutdown
2024-04-23T22:24:12,259  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a481728, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@63300c4b created in the thread with id: 1
2024-04-23T22:24:14,440  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4a481728 from thread id: 1
2024-04-23T22:24:14,454  INFO [main] metastore.HMSHandler: Setting location of default catalog, as it hasn't been done after upgrade
2024-04-23T22:24:14,481  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-23T22:24:14,525  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-23T22:24:14,544  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-23T22:24:14,547  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-23T22:24:14,621  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-23T22:24:14,627  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-23T22:24:14,628  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-23T22:24:14,631  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-23T22:24:14,636  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-23T22:24:14,638  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-23T22:24:14,639  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-23T22:24:14,642  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T22:24:14,779  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T22:24:14,823  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:24:14,854  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222414_74b235a1-8089-42fb-8f11-5e7ef9f67916): drop table if exists acidTbl
2024-04-23T22:24:15,813  INFO [main] reflections.Reflections: Reflections took 214 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T22:24:15,965  INFO [main] reflections.Reflections: Reflections took 121 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T22:24:16,095  INFO [main] reflections.Reflections: Reflections took 121 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T22:24:16,127  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:24:16,140  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:24:16,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:16,298  INFO [main] reflections.Reflections: Reflections took 121 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T22:24:16,345  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:16,347  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:16,349  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:16,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=36, flushCache_()=0, getValidTxns_(long)=11}
2024-04-23T22:24:16,350  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222414_74b235a1-8089-42fb-8f11-5e7ef9f67916); Time taken: 1.497 seconds
2024-04-23T22:24:16,352  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222414_74b235a1-8089-42fb-8f11-5e7ef9f67916
2024-04-23T22:24:16,353  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:16,355  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222414_74b235a1-8089-42fb-8f11-5e7ef9f67916): drop table if exists acidTbl
2024-04-23T22:24:16,358  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:16,360  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:16,376  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:16,376  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:16,377  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222414_74b235a1-8089-42fb-8f11-5e7ef9f67916); Time taken: 0.021 seconds
2024-04-23T22:24:16,377  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222414_74b235a1-8089-42fb-8f11-5e7ef9f67916
2024-04-23T22:24:16,388  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:24:16,402  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:16,405  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:24:16,407  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:24:16,408  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222416_1e56f964-fd37-4aec-a645-39c6888bc2b5): drop table if exists acidTblPart
2024-04-23T22:24:16,412  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:24:16,413  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:24:16,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:16,419  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:16,419  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:16,419  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:16,420  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=4, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=29}
2024-04-23T22:24:16,420  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222416_1e56f964-fd37-4aec-a645-39c6888bc2b5); Time taken: 0.011 seconds
2024-04-23T22:24:16,420  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222416_1e56f964-fd37-4aec-a645-39c6888bc2b5
2024-04-23T22:24:16,420  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:16,420  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222416_1e56f964-fd37-4aec-a645-39c6888bc2b5): drop table if exists acidTblPart
2024-04-23T22:24:16,421  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:16,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:16,426  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:16,426  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:16,426  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222416_1e56f964-fd37-4aec-a645-39c6888bc2b5); Time taken: 0.006 seconds
2024-04-23T22:24:16,426  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222416_1e56f964-fd37-4aec-a645-39c6888bc2b5
2024-04-23T22:24:16,434  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:24:16,443  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:16,443  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:24:16,445  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:24:16,445  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222416_f43f2f38-7be0-40bd-8800-4de766cfcc62): drop table if exists acidTbl2
2024-04-23T22:24:16,450  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:24:16,451  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:24:16,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:24:16,459  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:16,459  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:16,459  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:16,459  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=17, flushCache_()=0}
2024-04-23T22:24:16,459  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222416_f43f2f38-7be0-40bd-8800-4de766cfcc62); Time taken: 0.014 seconds
2024-04-23T22:24:16,460  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222416_f43f2f38-7be0-40bd-8800-4de766cfcc62
2024-04-23T22:24:16,460  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:16,460  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222416_f43f2f38-7be0-40bd-8800-4de766cfcc62): drop table if exists acidTbl2
2024-04-23T22:24:16,460  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:16,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:24:16,465  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:16,465  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:16,465  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222416_f43f2f38-7be0-40bd-8800-4de766cfcc62); Time taken: 0.005 seconds
2024-04-23T22:24:16,466  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222416_f43f2f38-7be0-40bd-8800-4de766cfcc62
2024-04-23T22:24:16,473  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:24:16,482  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:16,483  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:24:16,484  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:24:16,485  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222416_62a5c239-eed4-4ca4-a0ea-04f409f9dcf4): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:16,489  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:24:16,489  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:24:16,491  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:16,496  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:16,496  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:16,496  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:16,496  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, openTxn_(String, TxnType)=3}
2024-04-23T22:24:16,497  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222416_62a5c239-eed4-4ca4-a0ea-04f409f9dcf4); Time taken: 0.011 seconds
2024-04-23T22:24:16,497  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222416_62a5c239-eed4-4ca4-a0ea-04f409f9dcf4
2024-04-23T22:24:16,497  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:16,498  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222416_62a5c239-eed4-4ca4-a0ea-04f409f9dcf4): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:16,498  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:16,499  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:16,504  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:16,504  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:16,504  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222416_62a5c239-eed4-4ca4-a0ea-04f409f9dcf4); Time taken: 0.006 seconds
2024-04-23T22:24:16,504  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222416_62a5c239-eed4-4ca4-a0ea-04f409f9dcf4
2024-04-23T22:24:16,514  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:24:16,525  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:16,525  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:24:16,526  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:16,527  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222416_f07c5f1d-5f01-4fc3-8661-e5be3115f2e4): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:16,533  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:24:16,533  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:24:16,535  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:16,541  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:16,541  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:16,542  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:16,542  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=21, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=4}
2024-04-23T22:24:16,542  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222416_f07c5f1d-5f01-4fc3-8661-e5be3115f2e4); Time taken: 0.014 seconds
2024-04-23T22:24:16,542  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222416_f07c5f1d-5f01-4fc3-8661-e5be3115f2e4
2024-04-23T22:24:16,542  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:16,542  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222416_f07c5f1d-5f01-4fc3-8661-e5be3115f2e4): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:16,543  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:16,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:16,548  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:16,548  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:16,548  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222416_f07c5f1d-5f01-4fc3-8661-e5be3115f2e4); Time taken: 0.006 seconds
2024-04-23T22:24:16,548  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222416_f07c5f1d-5f01-4fc3-8661-e5be3115f2e4
2024-04-23T22:24:16,557  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:24:16,568  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:16,568  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:24:16,569  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:24:16,569  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222416_0c4da020-c773-44c7-bdf2-9c4d0bcdb522): drop table if exists nonAcidNonBucket
2024-04-23T22:24:16,574  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:24:16,575  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:24:16,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:16,582  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:16,582  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:16,582  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:16,582  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=20, isCompatibleWith_(Configuration)=1}
2024-04-23T22:24:16,582  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222416_0c4da020-c773-44c7-bdf2-9c4d0bcdb522); Time taken: 0.013 seconds
2024-04-23T22:24:16,583  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222416_0c4da020-c773-44c7-bdf2-9c4d0bcdb522
2024-04-23T22:24:16,583  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:16,583  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222416_0c4da020-c773-44c7-bdf2-9c4d0bcdb522): drop table if exists nonAcidNonBucket
2024-04-23T22:24:16,583  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:16,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:16,590  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:16,590  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:16,590  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222416_0c4da020-c773-44c7-bdf2-9c4d0bcdb522); Time taken: 0.007 seconds
2024-04-23T22:24:16,590  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222416_0c4da020-c773-44c7-bdf2-9c4d0bcdb522
2024-04-23T22:24:16,600  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:24:16,611  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:16,611  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:24:16,612  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:16,613  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:16,684  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:24:16,684  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:24:16,686  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:16,689  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:16,706  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:24:16,748  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:16,758  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:16,758  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:16,759  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:16,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:16,759  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=11, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=21, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=3, flushCache_()=0, getDatabase_(String)=4}
2024-04-23T22:24:16,759  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c); Time taken: 0.146 seconds
2024-04-23T22:24:16,760  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c
2024-04-23T22:24:16,767  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c
2024-04-23T22:24:16,828  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:24:16,828  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:16,831  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:16,831  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:16,940  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936256, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, rawDataSize=0, totalSize=0, bucketing_version=2, transactional=true, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:24:16,954  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:17,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:17,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=140}
2024-04-23T22:24:17,080  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c); Time taken: 0.249 seconds
2024-04-23T22:24:17,080  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222416_b0c08fc9-a689-4b72-bc97-9e844f2d493c
2024-04-23T22:24:17,087  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:24:17,098  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:17,099  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:24:17,099  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:17,100  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:17,107  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:24:17,107  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:24:17,109  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:17,109  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:17,113  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:24:17,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:17,117  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:17,117  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:17,117  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:17,117  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:17,117  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=19, flushCache_()=0, getValidWriteIds_(List, String)=3, getValidTxns_(long)=2}
2024-04-23T22:24:17,118  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92); Time taken: 0.017 seconds
2024-04-23T22:24:17,118  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92
2024-04-23T22:24:17,119  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92
2024-04-23T22:24:17,155  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:24:17,155  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:17,157  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:17,157  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:17,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936257, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:24:17,171  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:24:17,202  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:17,202  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=1}
2024-04-23T22:24:17,203  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92); Time taken: 0.045 seconds
2024-04-23T22:24:17,203  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222417_02511f0c-b535-429a-9ee9-be492bfc3f92
2024-04-23T22:24:17,209  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:24:17,218  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:17,220  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:24:17,221  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,222  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,227  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 2
2024-04-23T22:24:17,227  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:24:17,228  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:17,228  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:17,232  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:24:17,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:17,235  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:17,235  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:17,235  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:17,235  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:17,235  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, getDatabase_(String)=3, openTxn_(String, TxnType)=4, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=3}
2024-04-23T22:24:17,235  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914); Time taken: 0.013 seconds
2024-04-23T22:24:17,236  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914
2024-04-23T22:24:17,236  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914
2024-04-23T22:24:17,264  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:24:17,264  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:17,264  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,264  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:17,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936257, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, transactional=false, bucketing_version=2, totalSize=0, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:24:17,274  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:24:17,309  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:17,310  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=43}
2024-04-23T22:24:17,310  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914); Time taken: 0.045 seconds
2024-04-23T22:24:17,310  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222417_b0120165-7b4c-460e-add8-8a2d0b570914
2024-04-23T22:24:17,316  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:24:17,327  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:17,327  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:24:17,329  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,329  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,335  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 2
2024-04-23T22:24:17,336  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:24:17,337  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:17,337  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:17,341  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:24:17,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:17,343  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:17,343  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:17,344  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:17,344  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:17,344  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, openTxn_(String, TxnType)=4, getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T22:24:17,344  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa); Time taken: 0.015 seconds
2024-04-23T22:24:17,344  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa
2024-04-23T22:24:17,345  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa
2024-04-23T22:24:17,379  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:24:17,380  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:17,380  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,380  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:17,382  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936257, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, bucketing_version=2, totalSize=0, transactional=false, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:24:17,395  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:24:17,432  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:17,432  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=49, isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:17,432  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa); Time taken: 0.051 seconds
2024-04-23T22:24:17,432  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222417_124b6ad6-63ee-43f3-b168-e38e4d9501fa
2024-04-23T22:24:17,439  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:24:17,450  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:17,451  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:24:17,452  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:17,453  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:17,458  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 4
2024-04-23T22:24:17,459  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:24:17,460  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:17,460  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:17,465  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:24:17,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:17,469  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:17,469  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:17,469  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:17,470  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:17,470  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=19, getDatabase_(String)=3, getValidWriteIds_(List, String)=4, flushCache_()=0}
2024-04-23T22:24:17,470  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7); Time taken: 0.017 seconds
2024-04-23T22:24:17,471  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7
2024-04-23T22:24:17,471  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7
2024-04-23T22:24:17,507  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:24:17,507  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:17,509  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:17,509  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:17,512  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c3a6c92d-281a-4a20-9ccc-a7df8739a935/_tmp_space.db/1e34580a-2e55-4d29-a6c3-2cdcb1ec7627
2024-04-23T22:24:17,516  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:17,517  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=5}
2024-04-23T22:24:17,517  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7); Time taken: 0.007 seconds
2024-04-23T22:24:17,517  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222417_b68463e2-5c67-4ab1-bc91-8366c81315b7
2024-04-23T22:24:17,522  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:24:17,531  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:17,531  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:24:17,532  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,533  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,538  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 6
2024-04-23T22:24:17,539  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:24:17,540  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:17,540  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:17,545  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:24:17,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:17,549  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:17,549  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:17,549  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:17,549  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:17,549  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=5, getValidTxns_(long)=1, getDatabase_(String)=3, getValidWriteIds_(List, String)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=15}
2024-04-23T22:24:17,549  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694); Time taken: 0.016 seconds
2024-04-23T22:24:17,550  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694
2024-04-23T22:24:17,550  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694
2024-04-23T22:24:17,584  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:24:17,584  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:17,584  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:17,585  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:17,586  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936257, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, totalSize=0, rawDataSize=0, numFilesErasureCoded=0, transactional=false, numRows=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:24:17,596  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:24:17,625  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:17,625  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=38}
2024-04-23T22:24:17,625  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694); Time taken: 0.04 seconds
2024-04-23T22:24:17,625  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222417_015a4720-4420-4a27-8cd0-0bbb06288694
2024-04-23T22:24:17,631  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:24:17,640  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:17,640  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:24:17,642  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Initializing local cache in HiveMetaStoreClient...
2024-04-23T22:24:17,666  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Local cache initialized in HiveMetaStoreClient: com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedLocalManualCache@5891b7c5
2024-04-23T22:24:17,672  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:24:17,672  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:24:17,680  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 7
2024-04-23T22:24:17,681  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:24:17,682  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:17,682  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:18,307  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T22:24:18,309  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T22:24:18,311  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T22:24:18,311  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T22:24:18,311  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T22:24:18,312  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T22:24:18,316  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T22:24:18,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:18,447  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:18,448  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:24:18,448  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:18,448  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:18,448  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:18,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:18,467  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:18,468  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:24:18,468  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:24:19,628  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:20,258  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:20,258  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:20,258  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:20,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:20,263  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:20,263  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:20,265  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:20,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:20,281  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:20,314  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1
2024-04-23T22:24:20,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:20,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:20,336  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:24:20,388  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:24:20,388  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:24:20,397  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:24:20,410  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:24:20,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:20,462  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:20,472  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:24:20,472  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:20,472  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:20,472  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:24:20,472  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:20,473  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=2, getCheckConstraints_(CheckConstraintsRequest)=3, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, getAllTableConstraints_(AllTableConstraintsRequest)=55, commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=124}
2024-04-23T22:24:20,473  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f); Time taken: 2.8 seconds
2024-04-23T22:24:20,474  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f
2024-04-23T22:24:20,474  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f
2024-04-23T22:24:20,509  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:24:20,510  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:24:20,510  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:24:20,510  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f
2024-04-23T22:24:20,511  INFO [main] ql.Driver: Query ID = alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f
Total jobs = 1
2024-04-23T22:24:20,511  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:24:20,511  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:24:20,659  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:24:20,659  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:24:20,659  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:24:20,659  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:24:20,659  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:24:20,659  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:24:20,659  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:24:20,659  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:24:20,667  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:24:20,672  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:24:20,672  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-17_672_5284939447504443106-1/dummy_path
2024-04-23T22:24:20,744  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:24:20,767  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,00KB
2024-04-23T22:24:20,774  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:24:20,782  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:24:20,885  INFO [main] beanutils.FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2024-04-23T22:24:20,898  WARN [main] impl.MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-jobtracker.properties,hadoop-metrics2.properties
2024-04-23T22:24:20,911  INFO [main] impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-04-23T22:24:20,912  INFO [main] impl.MetricsSystemImpl: JobTracker metrics system started
2024-04-23T22:24:20,923  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-17_672_5284939447504443106-1/-mr-10001
2024-04-23T22:24:20,937  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:20,978  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:24:20,985  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:24:20,990  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:24:20,990  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:24:20,990  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-17_672_5284939447504443106-1/dummy_path
2024-04-23T22:24:20,990  INFO [main] io.NullRowsInputFormat$NullRowsRecordReader: Using null rows input format
2024-04-23T22:24:20,994  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:24:21,023  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:24:21,100  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1500368692_0001
2024-04-23T22:24:21,101  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:24:21,235  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:24:21,237  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:24:21,237  INFO [Thread-74] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:21,239  INFO [Thread-74] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:21,252  INFO [Thread-74] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:24:21,256  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1500368692_0001_m_000000_0
2024-04-23T22:24:21,291  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:21,299  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-17_672_5284939447504443106-1/dummy_path/null:0+1
2024-04-23T22:24:21,304  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:24:21,326  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,00KB
2024-04-23T22:24:21,333  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:24:21,348  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:24:21,348  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:24:21,348  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:24:21,348  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:24:21,348  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:24:21,352  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:24:21,359  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:24:21,361  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:24:21,363  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:24:21,364  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:24:21,367  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:24:21,367  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:24:21,368  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:24:21,368  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:24:21,368  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:24:21,368  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:24:21,387  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:24:21,389  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:24:21,389  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:24:21,390  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:24:21,390  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:24:21,390  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:24:21,390  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:24:21,390  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T22:24:21,391  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-23T22:24:21,397  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:24:21,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:24:21,398  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:24:21,398  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T22:24:21,398  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T22:24:21,414  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:24:21,426  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1500368692_0001_m_000000_0 is done. And is in the process of committing
2024-04-23T22:24:21,429  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:24:21,429  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1500368692_0001_m_000000_0' done.
2024-04-23T22:24:21,431  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1500368692_0001_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=5458
		FILE: Number of bytes written=1179707
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=918028288
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5053
2024-04-23T22:24:21,431  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1500368692_0001_m_000000_0
2024-04-23T22:24:21,432  INFO [Thread-74] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:24:21,440  INFO [Thread-74] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:24:21,440  INFO [pool-8-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1500368692_0001_r_000000_0
2024-04-23T22:24:21,450  INFO [pool-8-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:21,453  INFO [pool-8-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@501fa065
2024-04-23T22:24:21,455  WARN [pool-8-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:21,471  INFO [pool-8-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:21,473  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1500368692_0001_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:21,508  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local1500368692_0001_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:24:21,510  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1500368692_0001_m_000000_0
2024-04-23T22:24:21,512  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:24:21,514  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:21,514  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:21,514  INFO [pool-8-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:21,526  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:21,526  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:24:21,529  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:21,529  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:24:21,530  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:21,530  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:21,530  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:24:21,531  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:21,533  INFO [pool-8-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:21,537  INFO [pool-8-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:24:21,540  INFO [pool-8-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:21,540  INFO [pool-8-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:21,540  INFO [pool-8-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:21,540  INFO [pool-8-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:21,542  INFO [pool-8-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1500368692_0001/job_local1500368692_0001.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7e8e15e0
2024-04-23T22:24:21,546  INFO [pool-8-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_tmp.-ext-10000/000000_0
2024-04-23T22:24:21,547  INFO [pool-8-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T22:24:21,547  INFO [pool-8-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_tmp.-ext-10000/000000_0
2024-04-23T22:24:21,559  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:21,572  INFO [pool-8-thread-1] impl.HadoopShimsPre2_7: Can't get KeyProvider for ORC encryption from hadoop.security.key.provider.path.
2024-04-23T22:24:21,577  INFO [pool-8-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T22:24:21,634  INFO [pool-8-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T22:24:21,641  INFO [pool-8-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:21,641  INFO [pool-8-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:21,641  INFO [pool-8-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:21,642  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:21,690  INFO [pool-8-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.nonacidorctbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:24:21,691  INFO [pool-8-thread-1] mapred.Task: Task:attempt_local1500368692_0001_r_000000_0 is done. And is in the process of committing
2024-04-23T22:24:21,692  INFO [pool-8-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:21,692  INFO [pool-8-thread-1] mapred.Task: Task 'attempt_local1500368692_0001_r_000000_0' done.
2024-04-23T22:24:21,692  INFO [pool-8-thread-1] mapred.Task: Final Counters for attempt_local1500368692_0001_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=12034
		FILE: Number of bytes written=1180073
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=918028288
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:21,692  INFO [pool-8-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1500368692_0001_r_000000_0
2024-04-23T22:24:21,692  INFO [pool-8-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1500368692_0001_r_000001_0
2024-04-23T22:24:21,693  INFO [pool-8-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:21,693  INFO [pool-8-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@507aabd9
2024-04-23T22:24:21,693  WARN [pool-8-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:21,708  INFO [pool-8-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:21,710  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1500368692_0001_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:21,714  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local1500368692_0001_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-23T22:24:21,714  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local1500368692_0001_m_000000_0
2024-04-23T22:24:21,714  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-23T22:24:21,714  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:21,715  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:21,715  INFO [pool-8-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:21,722  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:21,722  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T22:24:21,725  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:21,725  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-23T22:24:21,725  INFO [pool-8-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:21,725  INFO [pool-8-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:21,726  INFO [pool-8-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T22:24:21,726  INFO [pool-8-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:21,727  INFO [pool-8-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:21,728  INFO [pool-8-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:24:21,730  INFO [pool-8-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:21,730  INFO [pool-8-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:21,730  INFO [pool-8-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:21,730  INFO [pool-8-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:21,731  INFO [pool-8-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1500368692_0001/job_local1500368692_0001.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5baa01fd
2024-04-23T22:24:21,731  INFO [pool-8-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_tmp.-ext-10000/000001_0
2024-04-23T22:24:21,731  INFO [pool-8-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T22:24:21,731  INFO [pool-8-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_tmp.-ext-10000/000001_0
2024-04-23T22:24:21,732  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:21,732  INFO [pool-8-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T22:24:21,737  INFO [pool-8-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T22:24:21,738  INFO [pool-8-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:21,738  INFO [pool-8-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:3, 
2024-04-23T22:24:21,738  INFO [pool-8-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:21,738  INFO [pool-8-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-23T22:24:21,746  INFO [pool-8-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:3, TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_1_default.nonacidorctbl:3, 
2024-04-23T22:24:21,746  INFO [pool-8-thread-1] mapred.Task: Task:attempt_local1500368692_0001_r_000001_0 is done. And is in the process of committing
2024-04-23T22:24:21,747  INFO [pool-8-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:21,747  INFO [pool-8-thread-1] mapred.Task: Task 'attempt_local1500368692_0001_r_000001_0' done.
2024-04-23T22:24:21,748  INFO [pool-8-thread-1] mapred.Task: Final Counters for attempt_local1500368692_0001_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=18622
		FILE: Number of bytes written=1180492
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=12
		Total committed heap usage (bytes)=920125440
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:21,748  INFO [pool-8-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1500368692_0001_r_000001_0
2024-04-23T22:24:21,748  INFO [Thread-74] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:24:22,256 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:24:22,256  INFO [main] exec.Task: 2024-04-23 22:24:22,256 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1500368692_0001
2024-04-23T22:24:22,259  INFO [main] exec.Task: Ended Job = job_local1500368692_0001
2024-04-23T22:24:22,293  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-23T22:24:22,294  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1/-ext-10000
2024-04-23T22:24:22,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:22,309  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:22,324  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,334  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T22:24:22,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T22:24:22,388  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:24:22,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:22,402  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,402  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:24:22,402  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-17_672_5284939447504443106-1/-mr-10001
2024-04-23T22:24:22,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:22,420  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,423  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-23T22:24:22,423  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-23T22:24:22,424  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T22:24:22,424  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T22:24:22,462  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-23T22:24:22,462  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:22,462  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=58, alter_table_(String, String, String, Table, EnvironmentContext, String)=89}
MapReduce Jobs Launched: 
2024-04-23T22:24:22,463  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:24:22,469  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:22,469  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:22,469  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f); Time taken: 1.952 seconds
2024-04-23T22:24:22,469  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222417_3cc772a7-159e-4fb4-9e9a-3a504fd0108f
2024-04-23T22:24:22,474  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:24:22,483  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:22,485  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:24:22,486  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:24:22,486  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1
2024-04-23T22:24:22,487  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-17_672_5284939447504443106-1 on fs with scheme file
2024-04-23T22:24:22,487  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-17_672_5284939447504443106-1
2024-04-23T22:24:22,487  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-17_672_5284939447504443106-1 on fs with scheme file
2024-04-23T22:24:22,488  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:24:22,501  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:24:22,502  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:24:22,505  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:22,505  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:22,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:22,519  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,519  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:24:22,519  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:22,519  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:22,519  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:22,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:22,530  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,531  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:24:22,531  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:24:22,553  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:22,661  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:22,661  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:22,661  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:22,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:22,666  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:22,666  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:22,666  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:22,667  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:22,678  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:24:22,683  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:24:22,696  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-23T22:24:22,696  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T22:24:22,699  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:24:22,703  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:24:22,703  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:24:22,705  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:24:22,706  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:24:22,716  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:22,730  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:22,731  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:24:22,731  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:22,731  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:22,731  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:24:22,731  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:22,731  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=12, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=3, getNotNullConstraints_(NotNullConstraintsRequest)=2, getCheckConstraints_(CheckConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=15, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=9, getValidWriteIds_(List, String)=5, getTable_(GetTableRequest)=46, allocateTableWriteId_(long, String, String)=13}
2024-04-23T22:24:22,731  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578); Time taken: 0.243 seconds
2024-04-23T22:24:22,732  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578
2024-04-23T22:24:22,732  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578
2024-04-23T22:24:22,760  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:24:22,760  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:24:22,764  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:24:22,764  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578
2024-04-23T22:24:22,764  INFO [main] ql.Driver: Query ID = alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578
Total jobs = 1
2024-04-23T22:24:22,764  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:24:22,765  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:24:22,899  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:24:22,899  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:24:22,899  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:24:22,899  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:24:22,899  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:24:22,899  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:24:22,899  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:24:22,900  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:24:22,902  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:24:22,902  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:24:22,902  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-22_488_8924938299573985564-1/dummy_path
2024-04-23T22:24:22,913  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:24:22,914  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:24:22,919  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:24:22,928  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:24:22,930  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:22,934  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-22_488_8924938299573985564-1/-mr-10000
2024-04-23T22:24:22,936  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:22,944  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:24:22,948  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:24:22,950  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:24:22,950  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:24:22,950  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-22_488_8924938299573985564-1/dummy_path
2024-04-23T22:24:22,951  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:24:22,970  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:24:22,995  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1839949742_0002
2024-04-23T22:24:22,995  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:24:23,073  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:24:23,073  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:24:23,074  INFO [Thread-139] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:23,074  INFO [Thread-139] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:23,075  INFO [Thread-139] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:24:23,075  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1839949742_0002_m_000000_0
2024-04-23T22:24:23,076  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:23,077  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-22_488_8924938299573985564-1/dummy_path/null:0+1
2024-04-23T22:24:23,078  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:24:23,080  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:24:23,080  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:24:23,085  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:24:23,085  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:24:23,085  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:24:23,085  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:24:23,085  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:24:23,086  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:24:23,086  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:24:23,087  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:24:23,087  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:24:23,088  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:24:23,088  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:24:23,089  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:24:23,089  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:24:23,089  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:24:23,089  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:24:23,089  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:24:23,090  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:24:23,090  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:24:23,090  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:24:23,091  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T22:24:23,092  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:24:23,092  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T22:24:23,092  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T22:24:23,093  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:24:23,093  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:24:23,093  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:24:23,093  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T22:24:23,093  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T22:24:23,105  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:24:23,108  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1839949742_0002_m_000000_0 is done. And is in the process of committing
2024-04-23T22:24:23,109  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:24:23,109  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1839949742_0002_m_000000_0' done.
2024-04-23T22:24:23,109  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1839949742_0002_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=24291
		FILE: Number of bytes written=2361108
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=920125440
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5078
2024-04-23T22:24:23,109  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1839949742_0002_m_000000_0
2024-04-23T22:24:23,109  INFO [Thread-139] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:24:23,111  INFO [Thread-139] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:24:23,111  INFO [pool-13-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1839949742_0002_r_000000_0
2024-04-23T22:24:23,112  INFO [pool-13-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:23,112  INFO [pool-13-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@d44ac0c
2024-04-23T22:24:23,112  WARN [pool-13-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:23,113  INFO [pool-13-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:23,114  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1839949742_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:23,115  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local1839949742_0002_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:24:23,115  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1839949742_0002_m_000000_0
2024-04-23T22:24:23,115  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:24:23,116  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:23,116  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:23,116  INFO [pool-13-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:23,123  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:23,123  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:23,126  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:23,126  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:24:23,126  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:23,126  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:23,126  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:23,126  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:23,127  INFO [pool-13-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:23,130  INFO [pool-13-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:24:23,131  INFO [pool-13-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:23,131  INFO [pool-13-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:23,131  INFO [pool-13-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:23,131  INFO [pool-13-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:23,132  INFO [pool-13-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1839949742_0002/job_local1839949742_0002.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@567c142e
2024-04-23T22:24:23,133  INFO [pool-13-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:23,133  INFO [pool-13-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:23,133  INFO [pool-13-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:24:23,138  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:23,138  INFO [pool-13-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:24:23,146  INFO [pool-13-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:24:23,152  INFO [pool-13-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:23,153  INFO [pool-13-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:24:23,153  INFO [pool-13-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:23,153  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:24:23,158  INFO [pool-13-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:24:23,173  INFO [pool-13-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T22:24:23,173  INFO [pool-13-thread-1] mapred.Task: Task:attempt_local1839949742_0002_r_000000_0 is done. And is in the process of committing
2024-04-23T22:24:23,174  INFO [pool-13-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:23,174  INFO [pool-13-thread-1] mapred.Task: Task 'attempt_local1839949742_0002_r_000000_0' done.
2024-04-23T22:24:23,175  INFO [pool-13-thread-1] mapred.Task: Final Counters for attempt_local1839949742_0002_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=30493
		FILE: Number of bytes written=2362177
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=920125440
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:23,175  INFO [pool-13-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1839949742_0002_r_000000_0
2024-04-23T22:24:23,175  INFO [pool-13-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1839949742_0002_r_000001_0
2024-04-23T22:24:23,176  INFO [pool-13-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:23,176  INFO [pool-13-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6bb75f01
2024-04-23T22:24:23,176  WARN [pool-13-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:23,177  INFO [pool-13-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:23,178  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1839949742_0002_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:23,181  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local1839949742_0002_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:24:23,182  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1839949742_0002_m_000000_0
2024-04-23T22:24:23,182  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:24:23,182  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:23,183  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:23,183  INFO [pool-13-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:23,189  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:23,189  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:23,192  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:23,193  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:24:23,193  INFO [pool-13-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:23,193  INFO [pool-13-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:23,193  INFO [pool-13-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:23,193  INFO [pool-13-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:23,194  INFO [pool-13-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:23,196  INFO [pool-13-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:24:23,197  INFO [pool-13-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:23,197  INFO [pool-13-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:23,197  INFO [pool-13-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:23,197  INFO [pool-13-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:23,198  INFO [pool-13-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1839949742_0002/job_local1839949742_0002.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@11cc0c
2024-04-23T22:24:23,199  INFO [pool-13-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:23,199  INFO [pool-13-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:23,199  INFO [pool-13-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:24:23,200  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:23,200  INFO [pool-13-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:24:23,207  INFO [pool-13-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:24:23,207  INFO [pool-13-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:23,207  INFO [pool-13-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:23,207  INFO [pool-13-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:23,207  INFO [pool-13-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:24:23,211  INFO [pool-13-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:24:23,223  INFO [pool-13-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T22:24:23,223  INFO [pool-13-thread-1] mapred.Task: Task:attempt_local1839949742_0002_r_000001_0 is done. And is in the process of committing
2024-04-23T22:24:23,224  INFO [pool-13-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:23,224  INFO [pool-13-thread-1] mapred.Task: Task 'attempt_local1839949742_0002_r_000001_0' done.
2024-04-23T22:24:23,224  INFO [pool-13-thread-1] mapred.Task: Final Counters for attempt_local1839949742_0002_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=36653
		FILE: Number of bytes written=2363247
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=920125440
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:23,224  INFO [pool-13-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1839949742_0002_r_000001_0
2024-04-23T22:24:23,225  INFO [Thread-139] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:24:24,079 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:24:24,079  INFO [main] exec.Task: 2024-04-23 22:24:24,079 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1839949742_0002
2024-04-23T22:24:24,081  INFO [main] exec.Task: Ended Job = job_local1839949742_0002
2024-04-23T22:24:24,083  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:24:24,083  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:24:24,083  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:24:24,084  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:24:24,085  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:24:24,087  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:24:24,088  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:24,088  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,098  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:24:24,152  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:24:24,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,165  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,165  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:24:24,166  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-22_488_8924938299573985564-1/-mr-10000
2024-04-23T22:24:24,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,181  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,201  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:24:24,201  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T22:24:24,201  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:24:24,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:24:24,237  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T22:24:24,237  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:24:24,237  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:24:24,241  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:24:24,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:24,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=46, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=4, alter_table_(String, String, String, Table, EnvironmentContext, String)=77, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:24:24,242  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:24:24,242  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:24,242  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:24,242  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578); Time taken: 1.477 seconds
2024-04-23T22:24:24,242  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222422_b0a452ef-765c-470f-b2cd-ae788727b578
2024-04-23T22:24:24,255  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:24,256  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:24:24,256  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T22:24:24,257  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-22_488_8924938299573985564-1
2024-04-23T22:24:24,257  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-22_488_8924938299573985564-1 on fs with scheme file
2024-04-23T22:24:24,258  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222424_2125a369-bbaa-432e-b222-17bfd8a98cf1): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T22:24:24,266  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:24:24,267  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:24:24,268  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:24:24,269  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:24,279  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T22:24:24,308  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c3a6c92d-281a-4a20-9ccc-a7df8739a935/_tmp_space.db/merge_tmp_table
2024-04-23T22:24:24,311  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `t`.`a` > 3 and `t`.`a` < 5 AND NOT(`s`.`a` < 3)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T22:24:24,317  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:24:24,325  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:24:24,325  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:24,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,339  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:24,354  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,354  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:24,354  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:24,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:24,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:24,374  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:24,384  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:24,393  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,393  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:24:24,393  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:24:24,396  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:24,397  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:24,397  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:24,411  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,420  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:24,625  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:24:24,631  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,643  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:24,657  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:24:24,676  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:24:24,676  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:24:24,677  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:24:24,678  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:24,694  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:24,711  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,711  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T22:24:24,735  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a, b
No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T22:24:24,735  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T22:24:24,987  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:24,987  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:24,987  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:24,987  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:24,988  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:24,989  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:24,998  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:24,998  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:25,008  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,009  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:25,018  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:25,027  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,049 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:24:25,050 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:24:25,051  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:24:25,052 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDelete(TestTxnCommands.java:1242)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:24:25,053  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:25,053  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getAllTableConstraints_(AllTableConstraintsRequest)=15, getTableColumnStatistics_(String, String, List, String)=100, getValidWriteIds_(List, String)=8, isCompatibleWith_(Configuration)=1, createTable_(Table)=3, getValidTxns_(long)=1, flushCache_()=1, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=114}
2024-04-23T22:24:25,054  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222424_2125a369-bbaa-432e-b222-17bfd8a98cf1); Time taken: 0.795 seconds
2024-04-23T22:24:25,054  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:24:25,060  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:25,069  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:24:25,069  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c3a6c92d-281a-4a20-9ccc-a7df8739a935/hive_2024-04-23_22-24-24_310_573950277496143676-1
2024-04-23T22:24:25,070  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c): drop table if exists acidTbl
2024-04-23T22:24:25,074  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T22:24:25,074  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:24:25,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:25,085  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,085  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:25,085  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:25,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:25,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=1, rollbackTxn_(long)=14, getValidTxns_(long)=1}
2024-04-23T22:24:25,085  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c); Time taken: 0.016 seconds
2024-04-23T22:24:25,086  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c
2024-04-23T22:24:25,087  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c
2024-04-23T22:24:25,108  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:24:25,108  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:25,109  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c): drop table if exists acidTbl
2024-04-23T22:24:25,109  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:25,109  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:25,118  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:25,129  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:25,336  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:25,337  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=217}
2024-04-23T22:24:25,337  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c); Time taken: 0.228 seconds
2024-04-23T22:24:25,337  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222425_d47f8f1c-ada6-4eff-8695-7c3d35c0c13c
2024-04-23T22:24:25,342  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:24:25,350  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:25,352  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:24:25,353  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:24:25,353  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c): drop table if exists acidTblPart
2024-04-23T22:24:25,365  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T22:24:25,365  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:24:25,368  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:25,393  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,393  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:25,394  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:25,394  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:25,394  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, flushCache_()=0, getTable_(GetTableRequest)=25, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=3, openTxn_(String, TxnType)=11}
2024-04-23T22:24:25,394  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c); Time taken: 0.041 seconds
2024-04-23T22:24:25,394  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c
2024-04-23T22:24:25,395  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c
2024-04-23T22:24:25,417  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:24:25,417  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:25,417  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c): drop table if exists acidTblPart
2024-04-23T22:24:25,418  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:25,418  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:25,428  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,428  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:25,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:25,509  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:25,509  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=81}
2024-04-23T22:24:25,510  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c); Time taken: 0.092 seconds
2024-04-23T22:24:25,510  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222425_f25e6378-925e-4fce-a616-ea34d0cb778c
2024-04-23T22:24:25,516  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:24:25,525  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:25,525  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:24:25,526  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:24:25,527  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222425_b9f70b31-b986-4857-81ad-f654f9ee66d4): drop table if exists acidTbl2
2024-04-23T22:24:25,531  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T22:24:25,531  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:24:25,533  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:25,533  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:25,534  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:25,534  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=16}
2024-04-23T22:24:25,534  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222425_b9f70b31-b986-4857-81ad-f654f9ee66d4); Time taken: 0.007 seconds
2024-04-23T22:24:25,534  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222425_b9f70b31-b986-4857-81ad-f654f9ee66d4
2024-04-23T22:24:25,535  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:25,535  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222425_b9f70b31-b986-4857-81ad-f654f9ee66d4): drop table if exists acidTbl2
2024-04-23T22:24:25,535  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:25,535  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:24:25,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:25,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1}
2024-04-23T22:24:25,536  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222425_b9f70b31-b986-4857-81ad-f654f9ee66d4); Time taken: 0.001 seconds
2024-04-23T22:24:25,537  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222425_b9f70b31-b986-4857-81ad-f654f9ee66d4
2024-04-23T22:24:25,544  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:24:25,553  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:25,553  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:24:25,554  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:24:25,555  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:25,558  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T22:24:25,559  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:24:25,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:25,591  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,592  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:25,592  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:25,592  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:25,592  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=17, getTable_(GetTableRequest)=31, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4}
2024-04-23T22:24:25,592  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f); Time taken: 0.037 seconds
2024-04-23T22:24:25,592  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f
2024-04-23T22:24:25,593  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f
2024-04-23T22:24:25,625  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:24:25,625  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:25,625  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:25,625  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:25,625  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:25,639  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,639  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:25,653  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,654  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:25,784  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:25,784  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, dropTable_(String, String, boolean, boolean, boolean)=144}
2024-04-23T22:24:25,784  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f); Time taken: 0.159 seconds
2024-04-23T22:24:25,784  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222425_84c7c6e0-6a67-4fde-985a-edca69b4982f
2024-04-23T22:24:25,789  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:24:25,797  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:25,798  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:24:25,799  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:25,799  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:25,803  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T22:24:25,803  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:24:25,804  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:25,817  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,817  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:25,817  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:25,817  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:25,817  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=13}
2024-04-23T22:24:25,818  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec); Time taken: 0.018 seconds
2024-04-23T22:24:25,818  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec
2024-04-23T22:24:25,819  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec
2024-04-23T22:24:25,838  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:24:25,838  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:25,838  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:25,838  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:25,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:25,851  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:25,864  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:25,911  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:25,911  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=60, getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=1}
2024-04-23T22:24:25,912  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec); Time taken: 0.073 seconds
2024-04-23T22:24:25,912  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222425_fbba1b74-4312-4eb1-9f1f-2cd3f389e4ec
2024-04-23T22:24:25,918  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:24:25,928  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:25,928  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:24:25,929  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:24:25,930  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28): drop table if exists nonAcidNonBucket
2024-04-23T22:24:25,935  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T22:24:25,936  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:24:25,937  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:25,957  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:25,958  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:25,958  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:25,958  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:25,958  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=20, openTxn_(String, TxnType)=5, flushCache_()=0, commitTxn_(CommitTxnRequest)=17, getValidTxns_(long)=1}
2024-04-23T22:24:25,958  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28); Time taken: 0.028 seconds
2024-04-23T22:24:25,959  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28
2024-04-23T22:24:25,959  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28
2024-04-23T22:24:25,988  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:24:25,988  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:25,988  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28): drop table if exists nonAcidNonBucket
2024-04-23T22:24:25,989  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:25,989  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:26,004  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:26,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:26,016  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:26,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:26,064  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:26,064  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=59, getTable_(GetTableRequest)=15}
2024-04-23T22:24:26,065  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28); Time taken: 0.076 seconds
2024-04-23T22:24:26,065  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222425_f29b498d-cc66-449a-90c8-941a2857ba28
2024-04-23T22:24:26,070  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:24:26,078  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:26,078  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:24:26,079  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeCase" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.24"/>
  <testcase name="testSetClauseFakeColumn" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.673"/>
  <testcase name="testBadOnClause" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.467"/>
  <testcase name="testSimpleAcidInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="9.067"/>
  <testcase name="testTxnStatsOnOff" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="6.841"/>
  <testcase name="testMergeUpdateDeleteNoCardCheck" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.829">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:24:50,462  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:24:50,463  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:24:50,463  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:24:50,465  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = bd662390-bdf6-4c0f-bcbd-b4e5850cd121
2024-04-23T22:24:50,467  INFO [main] SessionState: Hive Session ID = bd662390-bdf6-4c0f-bcbd-b4e5850cd121
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:24:50,468  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:24:50,473  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bd662390-bdf6-4c0f-bcbd-b4e5850cd121
2024-04-23T22:24:50,476  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121
2024-04-23T22:24:50,478  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/_tmp_space.db
2024-04-23T22:24:50,478  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=bd662390-bdf6-4c0f-bcbd-b4e5850cd121, clientType=HIVECLI]
2024-04-23T22:24:50,479  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:24:50,479  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_113a77b6-4878-4e29-b697-ede06adfa93d): drop table if exists acidTbl
2024-04-23T22:24:50,487  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:24:50,487  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:24:50,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:50,493  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,493  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,493  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,493  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, openTxn_(String, TxnType)=7, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T22:24:50,494  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_113a77b6-4878-4e29-b697-ede06adfa93d); Time taken: 0.014 seconds
2024-04-23T22:24:50,494  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222450_113a77b6-4878-4e29-b697-ede06adfa93d
2024-04-23T22:24:50,494  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:50,494  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_113a77b6-4878-4e29-b697-ede06adfa93d): drop table if exists acidTbl
2024-04-23T22:24:50,494  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:50,498  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,498  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:50,498  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_113a77b6-4878-4e29-b697-ede06adfa93d); Time taken: 0.003 seconds
2024-04-23T22:24:50,498  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_113a77b6-4878-4e29-b697-ede06adfa93d
2024-04-23T22:24:50,504  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:24:50,510  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,511  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:24:50,511  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:24:50,512  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_1a74ec59-9d28-47cd-9256-39a51572ad89): drop table if exists acidTblPart
2024-04-23T22:24:50,514  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:24:50,515  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:24:50,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:50,519  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,519  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,519  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,519  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T22:24:50,519  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_1a74ec59-9d28-47cd-9256-39a51572ad89); Time taken: 0.007 seconds
2024-04-23T22:24:50,519  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222450_1a74ec59-9d28-47cd-9256-39a51572ad89
2024-04-23T22:24:50,519  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:50,519  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_1a74ec59-9d28-47cd-9256-39a51572ad89): drop table if exists acidTblPart
2024-04-23T22:24:50,520  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:50,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:50,523  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_1a74ec59-9d28-47cd-9256-39a51572ad89); Time taken: 0.004 seconds
2024-04-23T22:24:50,523  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_1a74ec59-9d28-47cd-9256-39a51572ad89
2024-04-23T22:24:50,529  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:24:50,535  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,535  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:24:50,536  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:24:50,536  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_c627e615-33ad-41e5-b706-9bc7492665e3): drop table if exists acidTbl2
2024-04-23T22:24:50,539  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:24:50,539  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:24:50,540  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:24:50,543  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,543  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,544  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,544  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:24:50,544  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_c627e615-33ad-41e5-b706-9bc7492665e3); Time taken: 0.007 seconds
2024-04-23T22:24:50,544  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222450_c627e615-33ad-41e5-b706-9bc7492665e3
2024-04-23T22:24:50,544  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:50,544  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_c627e615-33ad-41e5-b706-9bc7492665e3): drop table if exists acidTbl2
2024-04-23T22:24:50,545  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:24:50,548  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,548  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:50,549  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_c627e615-33ad-41e5-b706-9bc7492665e3); Time taken: 0.004 seconds
2024-04-23T22:24:50,549  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_c627e615-33ad-41e5-b706-9bc7492665e3
2024-04-23T22:24:50,554  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:24:50,559  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,559  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:24:50,560  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:24:50,560  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_8ea80e04-c7d6-47e1-8f71-147c059e25ce): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:50,563  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:24:50,563  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:24:50,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:50,567  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,567  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,567  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,567  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T22:24:50,567  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_8ea80e04-c7d6-47e1-8f71-147c059e25ce); Time taken: 0.007 seconds
2024-04-23T22:24:50,568  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222450_8ea80e04-c7d6-47e1-8f71-147c059e25ce
2024-04-23T22:24:50,568  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:50,568  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_8ea80e04-c7d6-47e1-8f71-147c059e25ce): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:50,568  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,568  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:50,571  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,571  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:50,571  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_8ea80e04-c7d6-47e1-8f71-147c059e25ce); Time taken: 0.003 seconds
2024-04-23T22:24:50,572  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_8ea80e04-c7d6-47e1-8f71-147c059e25ce
2024-04-23T22:24:50,576  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:24:50,582  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,582  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:24:50,583  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:50,583  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_b287a5e0-66d9-47d2-859e-554e8671fdad): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:50,585  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:24:50,586  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:24:50,586  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:50,589  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,589  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,590  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,590  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:24:50,590  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_b287a5e0-66d9-47d2-859e-554e8671fdad); Time taken: 0.007 seconds
2024-04-23T22:24:50,590  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222450_b287a5e0-66d9-47d2-859e-554e8671fdad
2024-04-23T22:24:50,590  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:50,590  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_b287a5e0-66d9-47d2-859e-554e8671fdad): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:50,590  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:50,594  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,594  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T22:24:50,594  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_b287a5e0-66d9-47d2-859e-554e8671fdad); Time taken: 0.004 seconds
2024-04-23T22:24:50,594  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_b287a5e0-66d9-47d2-859e-554e8671fdad
2024-04-23T22:24:50,599  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:24:50,605  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,605  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:24:50,605  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:24:50,606  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_37317e7e-8b51-4e38-9f55-41e5d02322f0): drop table if exists nonAcidNonBucket
2024-04-23T22:24:50,608  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:24:50,608  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:24:50,609  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:50,612  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,612  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,612  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,612  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:24:50,612  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_37317e7e-8b51-4e38-9f55-41e5d02322f0); Time taken: 0.006 seconds
2024-04-23T22:24:50,613  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222450_37317e7e-8b51-4e38-9f55-41e5d02322f0
2024-04-23T22:24:50,613  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:50,613  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_37317e7e-8b51-4e38-9f55-41e5d02322f0): drop table if exists nonAcidNonBucket
2024-04-23T22:24:50,613  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,613  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:50,616  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,616  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:50,616  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_37317e7e-8b51-4e38-9f55-41e5d02322f0); Time taken: 0.003 seconds
2024-04-23T22:24:50,616  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_37317e7e-8b51-4e38-9f55-41e5d02322f0
2024-04-23T22:24:50,621  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:24:50,627  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,627  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:24:50,628  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,628  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,631  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:24:50,631  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:24:50,632  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:50,632  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:50,637  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:24:50,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:50,639  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:50,640  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,640  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,640  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,640  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=1, getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:24:50,640  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea); Time taken: 0.012 seconds
2024-04-23T22:24:50,640  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea
2024-04-23T22:24:50,641  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea
2024-04-23T22:24:50,658  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:24:50,658  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:50,659  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,659  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936290, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, transactional=true, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFiles=0, bucketing_version=2, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:24:50,666  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:50,701  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,701  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=41}
2024-04-23T22:24:50,701  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea); Time taken: 0.042 seconds
2024-04-23T22:24:50,701  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_82ce3231-375a-4791-868e-07c6d8bc2aea
2024-04-23T22:24:50,706  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:24:50,712  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,712  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:24:50,712  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,713  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,722  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:24:50,723  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:24:50,725  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:50,725  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:50,728  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:24:50,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:50,730  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:50,730  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,730  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,730  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=3, flushCache_()=0}
2024-04-23T22:24:50,731  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24); Time taken: 0.017 seconds
2024-04-23T22:24:50,731  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24
2024-04-23T22:24:50,731  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24
2024-04-23T22:24:50,747  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:24:50,747  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:50,748  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,748  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936290, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:24:50,755  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:24:50,772  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,772  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=1}
2024-04-23T22:24:50,772  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24); Time taken: 0.024 seconds
2024-04-23T22:24:50,772  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_52822b95-5a77-4a25-9cc3-e5ee7fea1c24
2024-04-23T22:24:50,777  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:24:50,784  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,784  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:24:50,785  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,785  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,788  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:24:50,788  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:24:50,789  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:50,789  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:50,792  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:24:50,792  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:50,794  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:50,794  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,794  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,794  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,794  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0}
2024-04-23T22:24:50,794  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa); Time taken: 0.009 seconds
2024-04-23T22:24:50,795  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa
2024-04-23T22:24:50,795  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa
2024-04-23T22:24:50,811  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:24:50,811  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:50,811  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,811  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936290, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numFiles=0, totalSize=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numRows=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:24:50,819  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:24:50,839  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,840  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=27}
2024-04-23T22:24:50,840  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa); Time taken: 0.028 seconds
2024-04-23T22:24:50,840  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_2d34a512-488c-43a2-aeed-38aabcdea1aa
2024-04-23T22:24:50,844  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:24:50,851  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,851  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:24:50,851  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,852  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,854  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:24:50,854  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:24:50,855  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:50,855  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:50,858  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:24:50,858  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:50,860  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:50,860  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,860  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T22:24:50,860  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0); Time taken: 0.008 seconds
2024-04-23T22:24:50,860  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0
2024-04-23T22:24:50,861  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0
2024-04-23T22:24:50,876  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:24:50,876  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:50,876  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,876  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936290, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, transactional=false, rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numRows=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:24:50,883  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:24:50,899  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,899  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T22:24:50,899  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0); Time taken: 0.023 seconds
2024-04-23T22:24:50,899  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_b03d7311-7501-446f-9c61-16267b4349f0
2024-04-23T22:24:50,904  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:24:50,910  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,910  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:24:50,911  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,911  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,914  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:24:50,914  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:24:50,915  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:50,915  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:50,917  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:24:50,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:50,920  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:50,920  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,920  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,920  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,920  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=3, flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-23T22:24:50,920  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9); Time taken: 0.009 seconds
2024-04-23T22:24:50,920  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9
2024-04-23T22:24:50,921  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9
2024-04-23T22:24:50,937  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:24:50,937  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:50,938  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:24:50,938  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,939  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/_tmp_space.db/8e6892bf-ace5-48b4-8ccc-dad3caef9c5b
2024-04-23T22:24:50,942  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,942  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:50,942  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9); Time taken: 0.004 seconds
2024-04-23T22:24:50,942  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_12c3ffb5-5691-4387-a44c-b5c48eae96c9
2024-04-23T22:24:50,947  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:24:50,953  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:50,953  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:24:50,953  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,954  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,956  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:24:50,956  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:24:50,957  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:24:50,957  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:50,960  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:24:50,960  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:24:50,962  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:24:50,962  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:50,962  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:50,962  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:50,962  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=2, getDatabase_(String)=2, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:24:50,962  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec); Time taken: 0.008 seconds
2024-04-23T22:24:50,962  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec
2024-04-23T22:24:50,963  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec
2024-04-23T22:24:50,978  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:24:50,978  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:24:50,978  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:24:50,978  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:50,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936290, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, numRows=0, rawDataSize=0, transactional=false, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:24:50,984  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:24:50,998  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:50,999  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T22:24:50,999  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec); Time taken: 0.02 seconds
2024-04-23T22:24:50,999  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222450_219edff3-6510-44bf-84dc-b411b32d9eec
2024-04-23T22:24:51,003  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:24:51,009  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:51,009  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:24:51,012  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:24:51,012  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:24:51,015  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:24:51,015  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:24:51,016  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:51,016  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:51,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:51,055  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:51,055  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:24:51,055  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:51,055  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:51,055  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:51,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:51,064  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:51,065  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:24:51,065  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:24:51,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:51,159  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:51,159  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:51,159  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:51,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:51,162  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:51,162  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:51,162  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:51,164  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1
2024-04-23T22:24:51,167  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:51,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:51,171  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:24:51,175  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:24:51,175  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:24:51,175  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:24:51,176  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:24:51,186  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:51,196  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:51,197  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:24:51,197  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:51,197  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:51,197  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:24:51,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:51,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=27, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=55, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T22:24:51,197  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.185 seconds
2024-04-23T22:24:51,198  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:51,198  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:51,219  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:24:51,219  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:24:51,219  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:24:51,219  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:51,219  INFO [main] ql.Driver: Query ID = alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
Total jobs = 1
2024-04-23T22:24:51,219  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:24:51,219  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:24:51,354  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:24:51,355  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:24:51,355  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:24:51,355  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:24:51,355  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:24:51,355  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:24:51,355  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:24:51,355  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:24:51,357  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:24:51,358  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:24:51,358  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-51_012_1374611397994224201-1/dummy_path
2024-04-23T22:24:51,368  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:24:51,369  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,01KB
2024-04-23T22:24:51,374  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:24:51,375  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:24:51,376  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:51,379  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-51_012_1374611397994224201-1/-mr-10001
2024-04-23T22:24:51,384  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:51,391  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:24:51,396  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:24:51,398  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:24:51,398  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:24:51,398  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-51_012_1374611397994224201-1/dummy_path
2024-04-23T22:24:51,398  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:24:51,417  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:24:51,440  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1073516052_0013
2024-04-23T22:24:51,440  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:24:51,508  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:24:51,508  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:24:51,509  INFO [Thread-1078] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:51,509  INFO [Thread-1078] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:51,510  INFO [Thread-1078] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:24:51,510  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1073516052_0013_m_000000_0
2024-04-23T22:24:51,513  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:51,514  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-51_012_1374611397994224201-1/dummy_path/null:0+1
2024-04-23T22:24:51,516  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:24:51,516  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,01KB
2024-04-23T22:24:51,517  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:24:51,521  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:24:51,521  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:24:51,521  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:24:51,521  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:24:51,521  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:24:51,522  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:24:51,522  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:24:51,522  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:24:51,523  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:24:51,523  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:24:51,523  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:24:51,523  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:24:51,524  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:24:51,524  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:24:51,524  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:24:51,524  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:24:51,524  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:24:51,524  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:24:51,524  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T22:24:51,525  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T22:24:51,527  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:24:51,527  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:24:51,527  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:24:51,527  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T22:24:51,527  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T22:24:51,538  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:24:51,543  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1073516052_0013_m_000000_0 is done. And is in the process of committing
2024-04-23T22:24:51,543  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:24:51,543  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1073516052_0013_m_000000_0' done.
2024-04-23T22:24:51,543  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1073516052_0013_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=293255
		FILE: Number of bytes written=15336718
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1124073472
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5058
2024-04-23T22:24:51,543  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1073516052_0013_m_000000_0
2024-04-23T22:24:51,543  INFO [Thread-1078] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:24:51,544  INFO [Thread-1078] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:24:51,545  INFO [pool-66-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1073516052_0013_r_000000_0
2024-04-23T22:24:51,547  INFO [pool-66-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:51,547  INFO [pool-66-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@260a4249
2024-04-23T22:24:51,547  WARN [pool-66-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:51,548  INFO [pool-66-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:51,549  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1073516052_0013_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:51,551  INFO [localfetcher#18] reduce.LocalFetcher: localfetcher#18 about to shuffle output of map attempt_local1073516052_0013_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:24:51,551  INFO [localfetcher#18] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1073516052_0013_m_000000_0
2024-04-23T22:24:51,551  INFO [localfetcher#18] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:24:51,551  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:51,552  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:51,552  INFO [pool-66-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:51,558  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:51,558  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:24:51,560  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:51,560  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:24:51,560  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:51,560  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:51,560  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:24:51,561  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:51,561  INFO [pool-66-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:51,561  INFO [pool-66-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:24:51,562  INFO [pool-66-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:51,562  INFO [pool-66-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:51,562  INFO [pool-66-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:51,562  INFO [pool-66-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:51,563  INFO [pool-66-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1073516052_0013/job_local1073516052_0013.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@25579921
2024-04-23T22:24:51,563  INFO [pool-66-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_tmp.-ext-10000/000000_0
2024-04-23T22:24:51,563  INFO [pool-66-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T22:24:51,563  INFO [pool-66-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_tmp.-ext-10000/000000_0
2024-04-23T22:24:51,563  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:51,564  INFO [pool-66-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T22:24:51,571  INFO [pool-66-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T22:24:51,571  INFO [pool-66-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:51,571  INFO [pool-66-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:51,571  INFO [pool-66-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:51,571  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:51,578  INFO [pool-66-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.nonacidorctbl:1, RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-23T22:24:51,579  INFO [pool-66-thread-1] mapred.Task: Task:attempt_local1073516052_0013_r_000000_0 is done. And is in the process of committing
2024-04-23T22:24:51,579  INFO [pool-66-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:51,579  INFO [pool-66-thread-1] mapred.Task: Task 'attempt_local1073516052_0013_r_000000_0' done.
2024-04-23T22:24:51,579  INFO [pool-66-thread-1] mapred.Task: Final Counters for attempt_local1073516052_0013_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=299836
		FILE: Number of bytes written=15337084
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1124073472
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:51,579  INFO [pool-66-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1073516052_0013_r_000000_0
2024-04-23T22:24:51,579  INFO [pool-66-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1073516052_0013_r_000001_0
2024-04-23T22:24:51,580  INFO [pool-66-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:51,580  INFO [pool-66-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@41065a58
2024-04-23T22:24:51,580  WARN [pool-66-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:51,581  INFO [pool-66-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:51,581  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1073516052_0013_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:51,584  INFO [localfetcher#19] reduce.LocalFetcher: localfetcher#19 about to shuffle output of map attempt_local1073516052_0013_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-23T22:24:51,584  INFO [localfetcher#19] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local1073516052_0013_m_000000_0
2024-04-23T22:24:51,584  INFO [localfetcher#19] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-23T22:24:51,585  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:51,585  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:51,585  INFO [pool-66-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:51,591  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:51,591  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T22:24:51,593  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:51,594  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-23T22:24:51,594  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:51,594  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:51,594  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T22:24:51,594  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:51,594  INFO [pool-66-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:51,596  INFO [pool-66-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:24:51,597  INFO [pool-66-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:51,597  INFO [pool-66-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:51,597  INFO [pool-66-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:51,597  INFO [pool-66-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:51,597  INFO [pool-66-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1073516052_0013/job_local1073516052_0013.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@538e514d
2024-04-23T22:24:51,598  INFO [pool-66-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_tmp.-ext-10000/000001_0
2024-04-23T22:24:51,598  INFO [pool-66-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T22:24:51,598  INFO [pool-66-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_tmp.-ext-10000/000001_0
2024-04-23T22:24:51,598  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:51,598  INFO [pool-66-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T22:24:51,604  INFO [pool-66-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T22:24:51,604  INFO [pool-66-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:51,604  INFO [pool-66-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:3, 
2024-04-23T22:24:51,604  INFO [pool-66-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:51,604  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-23T22:24:51,611  INFO [pool-66-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:3, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_1_default.nonacidorctbl:3, 
2024-04-23T22:24:51,611  INFO [pool-66-thread-1] mapred.Task: Task:attempt_local1073516052_0013_r_000001_0 is done. And is in the process of committing
2024-04-23T22:24:51,611  INFO [pool-66-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:51,612  INFO [pool-66-thread-1] mapred.Task: Task 'attempt_local1073516052_0013_r_000001_0' done.
2024-04-23T22:24:51,612  INFO [pool-66-thread-1] mapred.Task: Final Counters for attempt_local1073516052_0013_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=306429
		FILE: Number of bytes written=15337503
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1124073472
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:51,612  INFO [pool-66-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1073516052_0013_r_000001_0
2024-04-23T22:24:51,612  INFO [Thread-1078] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:24:52,512 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:24:52,512  INFO [main] exec.Task: 2024-04-23 22:24:52,512 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1073516052_0013
2024-04-23T22:24:52,513  INFO [main] exec.Task: Ended Job = job_local1073516052_0013
2024-04-23T22:24:52,516  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-23T22:24:52,516  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1/-ext-10000
2024-04-23T22:24:52,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:52,526  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:52,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:52,536  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:52,538  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T22:24:52,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T22:24:52,570  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:24:52,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:52,582  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:52,582  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:24:52,582  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-51_012_1374611397994224201-1/-mr-10001
2024-04-23T22:24:52,584  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:52,596  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:52,596  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-23T22:24:52,597  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-23T22:24:52,597  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T22:24:52,597  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T22:24:52,621  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-23T22:24:52,621  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:52,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=56, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=44}
MapReduce Jobs Launched: 
2024-04-23T22:24:52,622  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:24:52,622  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:52,622  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:52,622  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 1.402 seconds
2024-04-23T22:24:52,622  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:52,625  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:24:52,631  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:52,631  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:24:52,632  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:24:52,632  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1
2024-04-23T22:24:52,633  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-24-51_012_1374611397994224201-1 on fs with scheme file
2024-04-23T22:24:52,633  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-51_012_1374611397994224201-1
2024-04-23T22:24:52,633  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-51_012_1374611397994224201-1 on fs with scheme file
2024-04-23T22:24:52,633  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:24:52,636  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:24:52,636  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:24:52,637  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:52,637  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:24:52,640  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:52,645  INFO [main] metastore.ObjectStore: Removed COLUMN_STATS_ACCURATE from Table's parameters.
2024-04-23T22:24:52,647  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:52,647  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:24:52,647  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:52,647  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:52,647  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:52,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:52,654  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:52,654  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:24:52,654  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:24:52,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:52,724  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:52,724  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:52,724  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:24:52,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:24:52,726  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:24:52,726  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:52,726  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:24:52,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:24:52,730  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:24:52,738  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-23T22:24:52,738  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T22:24:52,739  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:24:52,743  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:24:52,743  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:24:52,744  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:24:52,745  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:24:52,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:52,761  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:52,762  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:24:52,762  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:52,762  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:52,762  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:24:52,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:52,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=6, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=22, allocateTableWriteId_(long, String, String)=7, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=1}
2024-04-23T22:24:52,762  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.129 seconds
2024-04-23T22:24:52,763  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:52,763  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:52,784  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:24:52,784  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:24:52,788  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:24:52,789  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:52,789  INFO [main] ql.Driver: Query ID = alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
Total jobs = 1
2024-04-23T22:24:52,789  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:24:52,789  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:24:52,930  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:24:52,930  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:24:52,930  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:24:52,930  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:24:52,930  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:24:52,930  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:24:52,930  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:24:52,930  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:24:52,933  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:24:52,933  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:24:52,933  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-52_633_2965598125204082760-1/dummy_path
2024-04-23T22:24:52,942  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:24:52,943  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:24:52,948  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:24:52,948  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:24:52,949  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:52,953  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-52_633_2965598125204082760-1/-mr-10000
2024-04-23T22:24:52,955  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:52,962  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:24:52,966  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:24:52,968  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:24:52,968  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:24:52,968  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-52_633_2965598125204082760-1/dummy_path
2024-04-23T22:24:52,968  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:24:52,985  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:24:53,012  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1016790235_0014
2024-04-23T22:24:53,012  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:24:53,073  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:24:53,073  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:24:53,073  INFO [Thread-1141] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:53,073  INFO [Thread-1141] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:24:53,075  INFO [Thread-1141] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:24:53,075  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1016790235_0014_m_000000_0
2024-04-23T22:24:53,076  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:53,076  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-52_633_2965598125204082760-1/dummy_path/null:0+1
2024-04-23T22:24:53,077  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:24:53,077  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:24:53,077  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:24:53,081  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:24:53,081  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:24:53,081  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:24:53,081  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:24:53,081  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:24:53,082  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:24:53,082  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:24:53,082  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:24:53,083  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:24:53,083  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:24:53,083  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:24:53,084  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:24:53,084  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:24:53,084  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:24:53,084  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:24:53,084  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:24:53,084  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:24:53,085  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:24:53,085  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:24:53,085  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:24:53,085  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:24:53,085  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T22:24:53,086  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-23T22:24:53,087  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:24:53,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:24:53,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:24:53,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T22:24:53,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T22:24:53,099  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:24:53,101  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1016790235_0014_m_000000_0 is done. And is in the process of committing
2024-04-23T22:24:53,102  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:24:53,102  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1016790235_0014_m_000000_0' done.
2024-04-23T22:24:53,102  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1016790235_0014_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=312098
		FILE: Number of bytes written=16519279
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1123024896
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5078
2024-04-23T22:24:53,102  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1016790235_0014_m_000000_0
2024-04-23T22:24:53,102  INFO [Thread-1141] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:24:53,103  INFO [Thread-1141] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:24:53,103  INFO [pool-71-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1016790235_0014_r_000000_0
2024-04-23T22:24:53,104  INFO [pool-71-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:53,104  INFO [pool-71-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7e785c82
2024-04-23T22:24:53,104  WARN [pool-71-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:53,105  INFO [pool-71-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:53,106  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1016790235_0014_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:53,107  INFO [localfetcher#20] reduce.LocalFetcher: localfetcher#20 about to shuffle output of map attempt_local1016790235_0014_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:24:53,107  INFO [localfetcher#20] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1016790235_0014_m_000000_0
2024-04-23T22:24:53,107  INFO [localfetcher#20] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:24:53,108  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:53,108  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:53,108  INFO [pool-71-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:53,115  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:53,115  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:53,117  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:53,117  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:24:53,117  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:53,117  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:53,118  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:53,118  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:53,118  INFO [pool-71-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:53,119  INFO [pool-71-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:24:53,120  INFO [pool-71-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:53,120  INFO [pool-71-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:53,120  INFO [pool-71-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:53,120  INFO [pool-71-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:53,120  INFO [pool-71-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1016790235_0014/job_local1016790235_0014.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6eb707d2
2024-04-23T22:24:53,120  INFO [pool-71-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:53,121  INFO [pool-71-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:53,121  INFO [pool-71-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:24:53,121  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:53,121  INFO [pool-71-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:24:53,128  INFO [pool-71-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:24:53,133  INFO [pool-71-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:53,133  INFO [pool-71-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:24:53,133  INFO [pool-71-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:53,133  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:24:53,136  INFO [pool-71-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:24:53,147  INFO [pool-71-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T22:24:53,148  INFO [pool-71-thread-1] mapred.Task: Task:attempt_local1016790235_0014_r_000000_0 is done. And is in the process of committing
2024-04-23T22:24:53,148  INFO [pool-71-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:53,148  INFO [pool-71-thread-1] mapred.Task: Task 'attempt_local1016790235_0014_r_000000_0' done.
2024-04-23T22:24:53,148  INFO [pool-71-thread-1] mapred.Task: Final Counters for attempt_local1016790235_0014_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=318300
		FILE: Number of bytes written=16520348
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1123024896
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:53,148  INFO [pool-71-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1016790235_0014_r_000000_0
2024-04-23T22:24:53,148  INFO [pool-71-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1016790235_0014_r_000001_0
2024-04-23T22:24:53,149  INFO [pool-71-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:24:53,149  INFO [pool-71-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3ddb3097
2024-04-23T22:24:53,149  WARN [pool-71-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:24:53,150  INFO [pool-71-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:24:53,151  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1016790235_0014_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:24:53,154  INFO [localfetcher#21] reduce.LocalFetcher: localfetcher#21 about to shuffle output of map attempt_local1016790235_0014_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:24:53,154  INFO [localfetcher#21] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1016790235_0014_m_000000_0
2024-04-23T22:24:53,154  INFO [localfetcher#21] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:24:53,154  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:24:53,155  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:53,155  INFO [pool-71-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:24:53,161  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:53,161  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:53,163  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:24:53,163  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:24:53,164  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:24:53,164  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:24:53,164  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:24:53,164  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:24:53,164  INFO [pool-71-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:24:53,165  INFO [pool-71-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:24:53,165  INFO [pool-71-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:24:53,165  INFO [pool-71-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:24:53,165  INFO [pool-71-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:24:53,166  INFO [pool-71-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:24:53,166  INFO [pool-71-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1016790235_0014/job_local1016790235_0014.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@591b3c15
2024-04-23T22:24:53,166  INFO [pool-71-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:53,166  INFO [pool-71-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:53,166  INFO [pool-71-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:24:53,167  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:24:53,167  INFO [pool-71-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:24:53,172  INFO [pool-71-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:24:53,172  INFO [pool-71-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:24:53,172  INFO [pool-71-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:24:53,172  INFO [pool-71-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:24:53,172  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:24:53,174  INFO [pool-71-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:24:53,183  INFO [pool-71-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T22:24:53,184  INFO [pool-71-thread-1] mapred.Task: Task:attempt_local1016790235_0014_r_000001_0 is done. And is in the process of committing
2024-04-23T22:24:53,184  INFO [pool-71-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:24:53,184  INFO [pool-71-thread-1] mapred.Task: Task 'attempt_local1016790235_0014_r_000001_0' done.
2024-04-23T22:24:53,184  INFO [pool-71-thread-1] mapred.Task: Final Counters for attempt_local1016790235_0014_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=324460
		FILE: Number of bytes written=16521418
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1123024896
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:24:53,184  INFO [pool-71-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1016790235_0014_r_000001_0
2024-04-23T22:24:53,184  INFO [Thread-1141] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:24:54,074 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:24:54,074  INFO [main] exec.Task: 2024-04-23 22:24:54,074 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1016790235_0014
2024-04-23T22:24:54,075  INFO [main] exec.Task: Ended Job = job_local1016790235_0014
2024-04-23T22:24:54,077  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:24:54,077  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:24:54,077  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:24:54,077  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:24:54,078  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:24:54,079  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:24:54,079  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:24:54,079  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,086  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,095  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:24:54,125  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:24:54,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,132  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,132  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:24:54,132  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-52_633_2965598125204082760-1/-mr-10000
2024-04-23T22:24:54,134  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,140  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,152  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:24:54,152  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T22:24:54,152  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:24:54,153  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:24:54,179  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T22:24:54,179  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:24:54,179  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:24:54,182  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:24:54,183  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:54,183  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=30, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=55}
MapReduce Jobs Launched: 
2024-04-23T22:24:54,183  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:24:54,183  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:54,183  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:24:54,183  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 1.395 seconds
2024-04-23T22:24:54,184  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,195  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:54,195  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:24:54,196  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE 
2024-04-23T22:24:54,196  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-52_633_2965598125204082760-1
2024-04-23T22:24:54,197  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-52_633_2965598125204082760-1 on fs with scheme file
2024-04-23T22:24:54,197  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE 
2024-04-23T22:24:54,200  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:24:54,200  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:24:54,201  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:54,210  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,211  INFO [main] parse.RewriteSemanticAnalyzer: Merge statement cardinality violation check is disabled: hive.merge.cardinality.check
2024-04-23T22:24:54,211  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN MATCHED and t.a > 3 and t.a < 5 THEN DELETE > as 
<FROM
  `default`.`acidTbl` `t`
  INNER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `t`.`a` > 3 and `t`.`a` < 5 AND NOT(`s`.`a` < 3)
 SORT BY `t`.ROW__ID 
>
2024-04-23T22:24:54,214  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:24:54,218  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:24:54,218  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:54,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,224  INFO [main] metastore.ObjectStore: Removed COLUMN_STATS_ACCURATE from Table's parameters.
2024-04-23T22:24:54,225  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:54,238  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,238  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:54,238  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:54,239  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:24:54,239  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:24:54,240  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:54,240  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:54,240  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:54,252  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:54,296  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:24:54,296  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,306  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:24:54,315  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,315  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:24:54,325  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:24:54,325  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:24:54,326  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:24:54,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:54,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:24:54,349  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,349  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T22:24:54,360  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a
No Stats for default@nonacidorctbl, Columns: a
2024-04-23T22:24:54,360  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:54,559  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:24:54,560  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:24:54,560  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:54,560  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:54,560  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:24:54,574  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 15
2024-04-23T22:24:54,574  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-23T22:24:54,579 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:24:54,580 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:24:54,580  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:24:54,581 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeUpdateDeleteNoCardCheck(TestTxnCommands.java:1264)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:24:54,581  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:54,581  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=4, getAllTableConstraints_(AllTableConstraintsRequest)=11, isCompatibleWith_(Configuration)=0, getTableColumnStatistics_(String, String, List, String)=63, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=1, getTable_(GetTableRequest)=29, allocateTableWriteId_(long, String, String)=6}
2024-04-23T22:24:54,581  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.384 seconds
2024-04-23T22:24:54,581  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,584  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:54,591  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:24:54,591  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bd662390-bdf6-4c0f-bcbd-b4e5850cd121/hive_2024-04-23_22-24-54_211_4303112390822298444-1
2024-04-23T22:24:54,591  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists acidTbl
2024-04-23T22:24:54,594  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T22:24:54,594  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:24:54,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:54,601  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,601  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:54,601  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:54,602  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:54,602  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, rollbackTxn_(long)=9, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=6}
2024-04-23T22:24:54,602  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.011 seconds
2024-04-23T22:24:54,602  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,603  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,616  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:24:54,617  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:54,617  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists acidTbl
2024-04-23T22:24:54,617  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:54,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:54,624  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,624  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:54,630  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:24:54,734  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:54,734  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=109}
2024-04-23T22:24:54,734  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.117 seconds
2024-04-23T22:24:54,734  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,738  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:24:54,745  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:54,747  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:24:54,748  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:24:54,748  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists acidTblPart
2024-04-23T22:24:54,757  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T22:24:54,757  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:24:54,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:54,771  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,772  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:54,772  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:54,772  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:54,772  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=12, openTxn_(String, TxnType)=8, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=14}
2024-04-23T22:24:54,772  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.024 seconds
2024-04-23T22:24:54,772  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,773  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,793  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:24:54,793  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:54,793  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists acidTblPart
2024-04-23T22:24:54,793  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:54,793  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:54,801  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,801  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:54,808  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:24:54,853  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:54,853  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=51, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:24:54,853  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.059 seconds
2024-04-23T22:24:54,853  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,857  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:24:54,864  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:54,864  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:24:54,865  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:24:54,865  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists acidTbl2
2024-04-23T22:24:54,868  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T22:24:54,868  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:24:54,869  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:54,869  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:54,869  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:54,869  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:24:54,869  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.004 seconds
2024-04-23T22:24:54,870  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,870  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:24:54,870  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists acidTbl2
2024-04-23T22:24:54,870  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:54,870  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:24:54,871  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:54,871  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T22:24:54,871  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.001 seconds
2024-04-23T22:24:54,871  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,877  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:24:54,884  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:54,884  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:24:54,885  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:24:54,885  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:54,887  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T22:24:54,888  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:24:54,888  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:54,910  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,910  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:54,910  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:54,910  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:54,910  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=22, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-23T22:24:54,910  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.025 seconds
2024-04-23T22:24:54,911  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,911  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:54,927  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:24:54,927  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:54,927  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists nonAcidOrcTbl
2024-04-23T22:24:54,927  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:54,927  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:54,945  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:54,955  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:54,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:24:55,030  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:55,030  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=85, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=18}
2024-04-23T22:24:55,031  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.103 seconds
2024-04-23T22:24:55,031  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:55,035  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:24:55,041  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:55,041  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:24:55,042  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:55,042  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:55,045  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T22:24:55,045  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:24:55,046  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:55,055  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:55,055  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:55,055  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:55,055  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:55,055  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0}
2024-04-23T22:24:55,056  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.013 seconds
2024-04-23T22:24:55,056  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:55,056  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:55,072  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:24:55,072  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:55,072  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists nonAcidOrcTbl2
2024-04-23T22:24:55,072  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:55,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:55,081  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:55,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:55,090  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:55,090  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:24:55,121  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:55,121  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T22:24:55,122  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.049 seconds
2024-04-23T22:24:55,122  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:55,126  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:24:55,132  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:55,132  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:24:55,133  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:24:55,133  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists nonAcidNonBucket
2024-04-23T22:24:55,136  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T22:24:55,136  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:24:55,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:55,146  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:55,146  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:24:55,146  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:24:55,146  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:24:55,146  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:24:55,147  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.013 seconds
2024-04-23T22:24:55,147  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:55,147  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:55,163  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:24:55,163  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:24:55,163  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a): drop table if exists nonAcidNonBucket
2024-04-23T22:24:55,163  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:24:55,164  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:55,172  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:55,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:55,181  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:24:55,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:24:55,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:24:55,215  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-23T22:24:55,216  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a); Time taken: 0.052 seconds
2024-04-23T22:24:55,216  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222451_adac0eb5-1072-455f-994d-acb0e2cdfd9a
2024-04-23T22:24:55,220  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:24:55,227  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:24:55,227  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:24:55,227  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testNonAcidToAcidConversion01" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="15.058"/>
  <testcase name="testMoreBucketsThanReducers2" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="0">
    <skipped message="Moved to Tez"/>
  </testcase>
  <testcase name="testMergeDeleteUpdate" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.241">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:25:10,353  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:25:10,353  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:25:10,353  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:25:10,353  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:25:10,353  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:25:10,353  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:25:10,354  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:25:10,354  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:25:10,354  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:25:10,354  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:25:10,354  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:25:10,357  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 9840b252-7357-4baf-a7cf-ee150aede66b
2024-04-23T22:25:10,359  INFO [main] SessionState: Hive Session ID = 9840b252-7357-4baf-a7cf-ee150aede66b
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:10,360  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:10,366  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9840b252-7357-4baf-a7cf-ee150aede66b
2024-04-23T22:25:10,368  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b
2024-04-23T22:25:10,371  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9840b252-7357-4baf-a7cf-ee150aede66b/_tmp_space.db
2024-04-23T22:25:10,371  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9840b252-7357-4baf-a7cf-ee150aede66b, clientType=HIVECLI]
2024-04-23T22:25:10,371  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:10,372  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_f65ac679-287c-4ef9-8a16-974f49b910e9): drop table if exists acidTbl
2024-04-23T22:25:10,381  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:25:10,381  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:25:10,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:10,387  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,387  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,387  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,387  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, openTxn_(String, TxnType)=9, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,388  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_f65ac679-287c-4ef9-8a16-974f49b910e9); Time taken: 0.015 seconds
2024-04-23T22:25:10,388  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222510_f65ac679-287c-4ef9-8a16-974f49b910e9
2024-04-23T22:25:10,388  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:10,388  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_f65ac679-287c-4ef9-8a16-974f49b910e9): drop table if exists acidTbl
2024-04-23T22:25:10,388  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:10,392  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,392  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,392  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_f65ac679-287c-4ef9-8a16-974f49b910e9); Time taken: 0.004 seconds
2024-04-23T22:25:10,392  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_f65ac679-287c-4ef9-8a16-974f49b910e9
2024-04-23T22:25:10,399  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:25:10,407  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,407  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:25:10,408  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:10,408  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_3186104d-dd89-4167-8f3f-f6f0d32a61fe): drop table if exists acidTblPart
2024-04-23T22:25:10,410  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:25:10,410  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:25:10,411  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:10,414  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,414  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,414  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,414  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:25:10,414  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_3186104d-dd89-4167-8f3f-f6f0d32a61fe); Time taken: 0.006 seconds
2024-04-23T22:25:10,415  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222510_3186104d-dd89-4167-8f3f-f6f0d32a61fe
2024-04-23T22:25:10,415  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:10,415  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_3186104d-dd89-4167-8f3f-f6f0d32a61fe): drop table if exists acidTblPart
2024-04-23T22:25:10,415  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:10,418  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,418  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,419  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_3186104d-dd89-4167-8f3f-f6f0d32a61fe); Time taken: 0.003 seconds
2024-04-23T22:25:10,419  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_3186104d-dd89-4167-8f3f-f6f0d32a61fe
2024-04-23T22:25:10,424  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:25:10,431  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,431  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:25:10,432  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:10,432  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_61d93f23-44ec-401d-880c-99b0350de677): drop table if exists acidTbl2
2024-04-23T22:25:10,434  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:25:10,434  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:25:10,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:10,438  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,438  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,438  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,438  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T22:25:10,438  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_61d93f23-44ec-401d-880c-99b0350de677); Time taken: 0.006 seconds
2024-04-23T22:25:10,438  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222510_61d93f23-44ec-401d-880c-99b0350de677
2024-04-23T22:25:10,438  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:10,439  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_61d93f23-44ec-401d-880c-99b0350de677): drop table if exists acidTbl2
2024-04-23T22:25:10,439  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:10,442  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,442  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,442  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_61d93f23-44ec-401d-880c-99b0350de677); Time taken: 0.003 seconds
2024-04-23T22:25:10,442  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_61d93f23-44ec-401d-880c-99b0350de677
2024-04-23T22:25:10,448  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:25:10,454  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,454  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:25:10,455  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:10,455  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_fe341299-e80b-4a5b-a3b0-ec3fe2a3bb24): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:10,458  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:25:10,458  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:25:10,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:10,462  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,462  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,462  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,462  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,462  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_fe341299-e80b-4a5b-a3b0-ec3fe2a3bb24); Time taken: 0.007 seconds
2024-04-23T22:25:10,463  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222510_fe341299-e80b-4a5b-a3b0-ec3fe2a3bb24
2024-04-23T22:25:10,463  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:10,463  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_fe341299-e80b-4a5b-a3b0-ec3fe2a3bb24): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:10,463  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:10,466  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,466  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,466  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_fe341299-e80b-4a5b-a3b0-ec3fe2a3bb24); Time taken: 0.003 seconds
2024-04-23T22:25:10,467  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_fe341299-e80b-4a5b-a3b0-ec3fe2a3bb24
2024-04-23T22:25:10,472  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:25:10,479  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,479  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:25:10,479  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:10,480  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_c90bc1c2-3d61-4318-b866-1ae83c6db564): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:10,482  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:25:10,483  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:25:10,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:10,486  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,486  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,486  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,487  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,487  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_c90bc1c2-3d61-4318-b866-1ae83c6db564); Time taken: 0.006 seconds
2024-04-23T22:25:10,487  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222510_c90bc1c2-3d61-4318-b866-1ae83c6db564
2024-04-23T22:25:10,487  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:10,487  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_c90bc1c2-3d61-4318-b866-1ae83c6db564): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:10,487  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:10,490  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,490  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,491  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_c90bc1c2-3d61-4318-b866-1ae83c6db564); Time taken: 0.003 seconds
2024-04-23T22:25:10,491  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_c90bc1c2-3d61-4318-b866-1ae83c6db564
2024-04-23T22:25:10,496  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:25:10,503  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,503  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:25:10,504  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:10,504  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_8b286d81-baa5-499e-a0d2-84638a3997fa): drop table if exists nonAcidNonBucket
2024-04-23T22:25:10,506  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:25:10,507  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:25:10,507  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:10,510  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,510  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,510  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,510  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:25:10,511  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_8b286d81-baa5-499e-a0d2-84638a3997fa); Time taken: 0.006 seconds
2024-04-23T22:25:10,511  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222510_8b286d81-baa5-499e-a0d2-84638a3997fa
2024-04-23T22:25:10,511  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:10,511  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_8b286d81-baa5-499e-a0d2-84638a3997fa): drop table if exists nonAcidNonBucket
2024-04-23T22:25:10,511  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,511  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:10,514  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,515  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_8b286d81-baa5-499e-a0d2-84638a3997fa); Time taken: 0.003 seconds
2024-04-23T22:25:10,515  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_8b286d81-baa5-499e-a0d2-84638a3997fa
2024-04-23T22:25:10,520  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:25:10,527  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,527  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:25:10,528  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,528  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,530  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:25:10,531  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:25:10,532  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:10,532  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:10,538  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:25:10,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:10,540  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:10,540  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,540  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,540  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,541  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=1, getValidWriteIds_(List, String)=6, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T22:25:10,541  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1); Time taken: 0.012 seconds
2024-04-23T22:25:10,541  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1
2024-04-23T22:25:10,541  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1
2024-04-23T22:25:10,567  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:25:10,567  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:10,568  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,568  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936310, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numFiles=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numRows=0, transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:10,579  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:10,622  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,622  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=51}
2024-04-23T22:25:10,622  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1); Time taken: 0.054 seconds
2024-04-23T22:25:10,622  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_d1296d30-9313-4029-b4d3-509201c1c4f1
2024-04-23T22:25:10,628  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:25:10,634  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,634  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:25:10,635  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,635  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,638  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:25:10,639  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:25:10,639  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:10,639  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:10,642  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:25:10,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:10,644  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:10,644  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,644  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,644  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,644  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-23T22:25:10,645  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f); Time taken: 0.009 seconds
2024-04-23T22:25:10,645  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f
2024-04-23T22:25:10,645  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f
2024-04-23T22:25:10,664  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:25:10,664  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:10,665  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,665  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936310, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:10,675  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:25:10,689  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,689  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T22:25:10,690  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f); Time taken: 0.024 seconds
2024-04-23T22:25:10,690  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_6c5e7ac2-ad94-4ca6-a0ec-dc83b4107f7f
2024-04-23T22:25:10,693  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:25:10,699  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,699  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:25:10,700  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,700  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,703  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:25:10,703  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:25:10,704  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:10,704  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:10,706  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:25:10,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:10,708  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:10,708  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,708  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,708  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,708  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, getValidTxns_(long)=1}
2024-04-23T22:25:10,708  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d); Time taken: 0.008 seconds
2024-04-23T22:25:10,709  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d
2024-04-23T22:25:10,709  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d
2024-04-23T22:25:10,724  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:25:10,724  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:10,724  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,724  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936310, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:10,730  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:25:10,750  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-23T22:25:10,750  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d); Time taken: 0.026 seconds
2024-04-23T22:25:10,750  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_fff2bc42-6dcb-4b07-8dda-e015a6eb3e1d
2024-04-23T22:25:10,754  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:25:10,761  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,761  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:25:10,761  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,762  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,764  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:25:10,764  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:25:10,765  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:10,765  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:10,767  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:25:10,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:10,769  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:10,769  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,769  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,769  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,769  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, getDatabase_(String)=2}
2024-04-23T22:25:10,770  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804); Time taken: 0.008 seconds
2024-04-23T22:25:10,770  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804
2024-04-23T22:25:10,770  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804
2024-04-23T22:25:10,785  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:25:10,785  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:10,785  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,785  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936310, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:10,791  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:25:10,805  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,805  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,806  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804); Time taken: 0.02 seconds
2024-04-23T22:25:10,806  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_d6ac3102-f8a0-4384-b2fa-36f74b042804
2024-04-23T22:25:10,810  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:25:10,817  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,817  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:25:10,818  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,818  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,821  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:25:10,821  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:25:10,822  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:10,822  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:10,825  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:25:10,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:10,827  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:10,827  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,827  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,827  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,827  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2}
2024-04-23T22:25:10,827  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb); Time taken: 0.009 seconds
2024-04-23T22:25:10,827  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb
2024-04-23T22:25:10,828  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb
2024-04-23T22:25:10,843  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:25:10,844  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:10,844  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:10,844  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,845  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9840b252-7357-4baf-a7cf-ee150aede66b/_tmp_space.db/703f1c95-96dc-4c21-baea-cf191d5ea47e
2024-04-23T22:25:10,848  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,849  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:25:10,849  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb); Time taken: 0.004 seconds
2024-04-23T22:25:10,849  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_4e7ff90e-5d14-41a9-aa78-c23046ae6afb
2024-04-23T22:25:10,853  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:25:10,861  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,861  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:25:10,861  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,862  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,864  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:25:10,864  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:25:10,865  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:10,865  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:10,868  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:25:10,868  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:10,870  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:10,870  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:10,870  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:10,870  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:10,870  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:25:10,870  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b); Time taken: 0.008 seconds
2024-04-23T22:25:10,870  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b
2024-04-23T22:25:10,871  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b
2024-04-23T22:25:10,887  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:25:10,888  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:10,888  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:10,888  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:10,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936310, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, rawDataSize=0, transactional=false, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:10,895  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:25:10,911  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:10,911  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:10,912  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b); Time taken: 0.023 seconds
2024-04-23T22:25:10,912  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_7a8b914e-6853-4e07-ba03-647013afb69b
2024-04-23T22:25:10,916  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:25:10,923  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:10,923  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:25:10,924  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:25:10,924  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:25:10,927  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:25:10,927  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:25:10,928  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:10,928  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:10,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:10,970  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:10,970  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:10,970  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:10,970  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:10,970  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:10,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:10,980  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:10,980  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:10,980  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:11,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:11,080  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:11,080  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:11,080  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:11,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:11,083  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:11,083  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:11,083  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:11,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:11,092  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:11,095  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1
2024-04-23T22:25:11,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:11,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:11,101  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:11,104  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:11,104  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:25:11,105  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:25:11,106  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:11,115  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:11,124  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:11,125  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:11,125  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:11,125  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:11,125  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:25:11,125  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:11,125  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=67, getValidWriteIds_(List, String)=4, getNotNullConstraints_(NotNullConstraintsRequest)=2, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=30, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:25:11,125  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5); Time taken: 0.201 seconds
2024-04-23T22:25:11,126  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5
2024-04-23T22:25:11,126  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5
2024-04-23T22:25:11,146  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:25:11,146  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:11,146  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5): insert into nonAcidOrcTbl  values(2,2),(4,44),(5,5),(11,11)
2024-04-23T22:25:11,146  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5
2024-04-23T22:25:11,146  INFO [main] ql.Driver: Query ID = alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5
Total jobs = 1
2024-04-23T22:25:11,146  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:11,146  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:11,279  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:25:11,279  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:11,279  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:11,279  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:11,279  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:11,279  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:11,279  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:11,279  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:11,282  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:11,282  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:25:11,282  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-10_924_2634053410952155489-1/dummy_path
2024-04-23T22:25:11,292  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:11,293  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,01KB
2024-04-23T22:25:11,298  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:11,298  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:25:11,299  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:11,303  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-10_924_2634053410952155489-1/-mr-10001
2024-04-23T22:25:11,307  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:11,314  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:11,319  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:11,320  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:25:11,320  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:25:11,320  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-10_924_2634053410952155489-1/dummy_path
2024-04-23T22:25:11,320  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:25:11,338  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:25:11,358  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2085601313_0021
2024-04-23T22:25:11,358  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:11,422  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:11,422  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:11,422  INFO [Thread-1673] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:11,423  INFO [Thread-1673] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:11,424  INFO [Thread-1673] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:11,424  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2085601313_0021_m_000000_0
2024-04-23T22:25:11,427  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:11,428  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-10_924_2634053410952155489-1/dummy_path/null:0+1
2024-04-23T22:25:11,430  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:11,431  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,01KB
2024-04-23T22:25:11,431  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:25:11,437  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:11,437  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:11,437  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:11,437  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:11,437  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:11,437  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:11,438  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:11,438  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:11,439  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:11,439  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:11,439  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:25:11,440  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:25:11,440  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:11,440  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:25:11,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:25:11,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:11,441  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T22:25:11,442  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-23T22:25:11,445  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:11,445  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:11,445  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:11,445  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T22:25:11,445  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T22:25:11,455  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:11,460  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2085601313_0021_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:11,461  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:25:11,461  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2085601313_0021_m_000000_0' done.
2024-04-23T22:25:11,461  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2085601313_0021_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=446604
		FILE: Number of bytes written=24750952
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1127219200
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5058
2024-04-23T22:25:11,461  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2085601313_0021_m_000000_0
2024-04-23T22:25:11,461  INFO [Thread-1673] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:11,462  INFO [Thread-1673] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:11,462  INFO [pool-103-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2085601313_0021_r_000000_0
2024-04-23T22:25:11,465  INFO [pool-103-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:11,465  INFO [pool-103-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@8dc4525
2024-04-23T22:25:11,465  WARN [pool-103-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:11,466  INFO [pool-103-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:11,466  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2085601313_0021_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:11,469  INFO [localfetcher#30] reduce.LocalFetcher: localfetcher#30 about to shuffle output of map attempt_local2085601313_0021_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:25:11,469  INFO [localfetcher#30] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local2085601313_0021_m_000000_0
2024-04-23T22:25:11,469  INFO [localfetcher#30] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:25:11,469  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:11,470  INFO [pool-103-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:11,470  INFO [pool-103-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:11,476  INFO [pool-103-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:11,476  INFO [pool-103-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:11,478  INFO [pool-103-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:11,478  INFO [pool-103-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:25:11,478  INFO [pool-103-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:11,478  INFO [pool-103-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:11,479  INFO [pool-103-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:11,479  INFO [pool-103-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:11,479  INFO [pool-103-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:11,480  INFO [pool-103-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:25:11,481  INFO [pool-103-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:11,481  INFO [pool-103-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:11,481  INFO [pool-103-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:11,481  INFO [pool-103-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:11,481  INFO [pool-103-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2085601313_0021/job_local2085601313_0021.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@1a7155b1
2024-04-23T22:25:11,482  INFO [pool-103-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_tmp.-ext-10000/000000_0
2024-04-23T22:25:11,482  INFO [pool-103-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T22:25:11,482  INFO [pool-103-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_tmp.-ext-10000/000000_0
2024-04-23T22:25:11,482  INFO [pool-103-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:11,482  INFO [pool-103-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T22:25:11,489  INFO [pool-103-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_task_tmp.-ext-10000/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T22:25:11,490  INFO [pool-103-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:11,490  INFO [pool-103-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T22:25:11,490  INFO [pool-103-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:11,490  INFO [pool-103-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:11,497  INFO [pool-103-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.nonacidorctbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:11,497  INFO [pool-103-thread-1] mapred.Task: Task:attempt_local2085601313_0021_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:11,498  INFO [pool-103-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:11,498  INFO [pool-103-thread-1] mapred.Task: Task 'attempt_local2085601313_0021_r_000000_0' done.
2024-04-23T22:25:11,498  INFO [pool-103-thread-1] mapred.Task: Final Counters for attempt_local2085601313_0021_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=453185
		FILE: Number of bytes written=24751318
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1127219200
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:11,498  INFO [pool-103-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2085601313_0021_r_000000_0
2024-04-23T22:25:11,498  INFO [pool-103-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2085601313_0021_r_000001_0
2024-04-23T22:25:11,498  INFO [pool-103-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:11,498  INFO [pool-103-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6343f8fe
2024-04-23T22:25:11,499  WARN [pool-103-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:11,500  INFO [pool-103-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:11,500  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2085601313_0021_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:11,503  INFO [localfetcher#31] reduce.LocalFetcher: localfetcher#31 about to shuffle output of map attempt_local2085601313_0021_m_000000_0 decomp: 56 len: 60 to MEMORY
2024-04-23T22:25:11,503  INFO [localfetcher#31] reduce.InMemoryMapOutput: Read 56 bytes from map-output for attempt_local2085601313_0021_m_000000_0
2024-04-23T22:25:11,503  INFO [localfetcher#31] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 56, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->56
2024-04-23T22:25:11,504  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:11,504  INFO [pool-103-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:11,504  INFO [pool-103-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:11,511  INFO [pool-103-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:11,511  INFO [pool-103-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T22:25:11,513  INFO [pool-103-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 56 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:11,514  INFO [pool-103-thread-1] reduce.MergeManagerImpl: Merging 1 files, 60 bytes from disk
2024-04-23T22:25:11,514  INFO [pool-103-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:11,514  INFO [pool-103-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:11,514  INFO [pool-103-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 44 bytes
2024-04-23T22:25:11,514  INFO [pool-103-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:11,514  INFO [pool-103-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:11,515  INFO [pool-103-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,35KB
2024-04-23T22:25:11,516  INFO [pool-103-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:11,516  INFO [pool-103-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:11,516  INFO [pool-103-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:11,516  INFO [pool-103-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:11,516  INFO [pool-103-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2085601313_0021/job_local2085601313_0021.xml], properties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, column.name.delimiter=,}, tableProperties={name=default.nonacidorctbl, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7c183abc
2024-04-23T22:25:11,517  INFO [pool-103-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_tmp.-ext-10000/000001_0
2024-04-23T22:25:11,517  INFO [pool-103-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T22:25:11,517  INFO [pool-103-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_tmp.-ext-10000/000001_0
2024-04-23T22:25:11,517  INFO [pool-103-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:11,517  INFO [pool-103-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T22:25:11,522  INFO [pool-103-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T22:25:11,522  INFO [pool-103-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:11,522  INFO [pool-103-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:11,522  INFO [pool-103-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:11,522  INFO [pool-103-thread-1] exec.FileSinkOperator: FS[6]: records written - 3
2024-04-23T22:25:11,530  INFO [pool-103-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:3, TOTAL_TABLE_ROWS_WRITTEN:3, RECORDS_OUT_1_default.nonacidorctbl:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:11,530  INFO [pool-103-thread-1] mapred.Task: Task:attempt_local2085601313_0021_r_000001_0 is done. And is in the process of committing
2024-04-23T22:25:11,531  INFO [pool-103-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:11,531  INFO [pool-103-thread-1] mapred.Task: Task 'attempt_local2085601313_0021_r_000001_0' done.
2024-04-23T22:25:11,531  INFO [pool-103-thread-1] mapred.Task: Final Counters for attempt_local2085601313_0021_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=459778
		FILE: Number of bytes written=24751737
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=3
		Reduce shuffle bytes=60
		Reduce input records=3
		Reduce output records=0
		Spilled Records=3
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1127219200
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.nonacidorctbl=3
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=3
		RECORDS_OUT_OPERATOR_SEL_5=3
		TOTAL_TABLE_ROWS_WRITTEN=3
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:11,531  INFO [pool-103-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2085601313_0021_r_000001_0
2024-04-23T22:25:11,531  INFO [Thread-1673] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:12,424 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:12,424  INFO [main] exec.Task: 2024-04-23 22:25:12,424 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2085601313_0021
2024-04-23T22:25:12,425  INFO [main] exec.Task: Ended Job = job_local2085601313_0021
2024-04-23T22:25:12,428  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.nonacidorctbl
2024-04-23T22:25:12,428  INFO [main] exec.Task: Loading data to table default.nonacidorctbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1/-ext-10000
2024-04-23T22:25:12,429  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:12,442  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,443  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:12,455  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,457  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T22:25:12,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T22:25:12,489  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:25:12,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:12,498  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,498  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:25:12,498  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-10_924_2634053410952155489-1/-mr-10001
2024-04-23T22:25:12,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:12,509  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,509  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, numRows, true, 4, false: 
2024-04-23T22:25:12,509  INFO [main] FileOperations: Read stats for default.nonacidorctbl/, rawDataSize, true, 32, false: 
2024-04-23T22:25:12,510  WARN [main] metadata.Hive: Cannot get a table snapshot for nonacidorctbl
2024-04-23T22:25:12,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.nonacidorctbl newtbl=nonacidorctbl	
2024-04-23T22:25:12,535  INFO [main] stats.BasicStatsTask: Table default.nonacidorctbl stats: [numFiles=2, numRows=4, totalSize=499, rawDataSize=32, numFilesErasureCoded=0]
2024-04-23T22:25:12,535  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:12,535  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=44, alter_table_(String, String, String, Table, EnvironmentContext, String)=57, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:25:12,536  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:12,536  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:12,536  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:12,536  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5); Time taken: 1.389 seconds
2024-04-23T22:25:12,536  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222510_c14281fa-1752-424b-94c8-9038f4b371c5
2024-04-23T22:25:12,540  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:25:12,548  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:12,548  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:25:12,549  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:25:12,550  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-10_924_2634053410952155489-1
2024-04-23T22:25:12,551  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-10_924_2634053410952155489-1 on fs with scheme file
2024-04-23T22:25:12,551  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1
2024-04-23T22:25:12,551  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl/.hive-staging_hive_2024-04-23_22-25-10_924_2634053410952155489-1 on fs with scheme file
2024-04-23T22:25:12,551  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:25:12,555  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:25:12,555  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:25:12,556  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:12,556  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:12,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:12,567  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,567  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:12,567  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:12,567  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:12,567  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:12,568  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:12,574  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,574  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:12,574  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:12,597  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:12,681  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:12,681  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:12,681  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:12,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:12,685  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:12,686  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:12,686  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:12,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:12,696  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:12,701  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:12,714  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 14
2024-04-23T22:25:12,714  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T22:25:12,716  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:12,721  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:12,722  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:25:12,723  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:25:12,724  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:12,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:12,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:12,752  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:12,752  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:12,752  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:12,752  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:25:12,752  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:12,753  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=2, getNotNullConstraints_(NotNullConstraintsRequest)=2, commitTxn_(CommitTxnRequest)=13, getAllTableConstraints_(AllTableConstraintsRequest)=9, isCompatibleWith_(Configuration)=3, getValidTxns_(long)=0, getValidWriteIds_(List, String)=4, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=39, allocateTableWriteId_(long, String, String)=12}
2024-04-23T22:25:12,753  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d); Time taken: 0.201 seconds
2024-04-23T22:25:12,753  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d
2024-04-23T22:25:12,753  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d
2024-04-23T22:25:12,771  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:25:12,771  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:12,774  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d): insert into acidTbl  values(2,1),(4,3),(5,6),(7,8)
2024-04-23T22:25:12,775  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d
2024-04-23T22:25:12,775  INFO [main] ql.Driver: Query ID = alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d
Total jobs = 1
2024-04-23T22:25:12,775  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:12,775  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:12,903  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:25:12,903  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:12,903  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:12,903  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:12,903  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:12,903  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:12,903  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:12,903  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:12,906  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:12,906  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:25:12,906  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-12_551_5079298892398905392-1/dummy_path
2024-04-23T22:25:12,916  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:12,917  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:25:12,921  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:12,922  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:25:12,923  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:12,927  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-12_551_5079298892398905392-1/-mr-10000
2024-04-23T22:25:12,930  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:12,940  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:12,945  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:12,946  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:25:12,946  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:25:12,946  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-12_551_5079298892398905392-1/dummy_path
2024-04-23T22:25:12,947  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:25:12,967  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:25:12,988  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2045474583_0022
2024-04-23T22:25:12,988  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:13,051  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:13,052  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:13,052  INFO [Thread-1736] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:13,052  INFO [Thread-1736] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:13,054  INFO [Thread-1736] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:13,054  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2045474583_0022_m_000000_0
2024-04-23T22:25:13,054  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:13,055  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-12_551_5079298892398905392-1/dummy_path/null:0+1
2024-04-23T22:25:13,055  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:13,056  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:25:13,056  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:25:13,072  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:13,072  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:13,072  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:13,072  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:13,072  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:13,073  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:13,073  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:13,073  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:13,074  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:13,074  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:13,074  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:25:13,074  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:25:13,075  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:13,075  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:25:13,075  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:25:13,075  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:13,075  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:25:13,075  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:25:13,075  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T22:25:13,076  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:4, RECORDS_OUT_INTERMEDIATE:4, 
2024-04-23T22:25:13,077  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:13,077  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:13,077  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:13,077  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T22:25:13,077  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T22:25:13,088  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:13,091  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2045474583_0022_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:13,092  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:25:13,092  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2045474583_0022_m_000000_0' done.
2024-04-23T22:25:13,092  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2045474583_0022_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=465447
		FILE: Number of bytes written=25931959
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=10
		Total committed heap usage (bytes)=1124073472
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5078
2024-04-23T22:25:13,092  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2045474583_0022_m_000000_0
2024-04-23T22:25:13,092  INFO [Thread-1736] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:13,093  INFO [Thread-1736] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:13,093  INFO [pool-108-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2045474583_0022_r_000000_0
2024-04-23T22:25:13,094  INFO [pool-108-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:13,094  INFO [pool-108-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7010372e
2024-04-23T22:25:13,094  WARN [pool-108-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:13,095  INFO [pool-108-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:13,096  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2045474583_0022_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:13,097  INFO [localfetcher#32] reduce.LocalFetcher: localfetcher#32 about to shuffle output of map attempt_local2045474583_0022_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:25:13,097  INFO [localfetcher#32] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local2045474583_0022_m_000000_0
2024-04-23T22:25:13,097  INFO [localfetcher#32] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:25:13,097  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:13,098  INFO [pool-108-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:13,098  INFO [pool-108-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:13,104  INFO [pool-108-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:13,104  INFO [pool-108-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:13,107  INFO [pool-108-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:13,107  INFO [pool-108-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:25:13,107  INFO [pool-108-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:13,107  INFO [pool-108-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:13,107  INFO [pool-108-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:13,107  INFO [pool-108-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:13,108  INFO [pool-108-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:13,108  INFO [pool-108-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:25:13,109  INFO [pool-108-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:13,109  INFO [pool-108-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:13,109  INFO [pool-108-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:13,109  INFO [pool-108-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:13,110  INFO [pool-108-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2045474583_0022/job_local2045474583_0022.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2da93abb
2024-04-23T22:25:13,110  INFO [pool-108-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:13,110  INFO [pool-108-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:13,110  INFO [pool-108-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:13,111  INFO [pool-108-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:13,111  INFO [pool-108-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:13,118  INFO [pool-108-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:13,124  INFO [pool-108-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:13,124  INFO [pool-108-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:25:13,124  INFO [pool-108-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:13,124  INFO [pool-108-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:25:13,126  INFO [pool-108-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:25:13,139  INFO [pool-108-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T22:25:13,139  INFO [pool-108-thread-1] mapred.Task: Task:attempt_local2045474583_0022_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:13,140  INFO [pool-108-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:13,140  INFO [pool-108-thread-1] mapred.Task: Task 'attempt_local2045474583_0022_r_000000_0' done.
2024-04-23T22:25:13,140  INFO [pool-108-thread-1] mapred.Task: Final Counters for attempt_local2045474583_0022_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=471649
		FILE: Number of bytes written=25933028
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1124073472
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:13,140  INFO [pool-108-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2045474583_0022_r_000000_0
2024-04-23T22:25:13,140  INFO [pool-108-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2045474583_0022_r_000001_0
2024-04-23T22:25:13,140  INFO [pool-108-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:13,140  INFO [pool-108-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@807d6e6
2024-04-23T22:25:13,141  WARN [pool-108-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:13,142  INFO [pool-108-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:13,142  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2045474583_0022_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:13,145  INFO [localfetcher#33] reduce.LocalFetcher: localfetcher#33 about to shuffle output of map attempt_local2045474583_0022_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:25:13,145  INFO [localfetcher#33] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local2045474583_0022_m_000000_0
2024-04-23T22:25:13,145  INFO [localfetcher#33] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:25:13,146  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:13,146  INFO [pool-108-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:13,146  INFO [pool-108-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:13,153  INFO [pool-108-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:13,153  INFO [pool-108-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:13,156  INFO [pool-108-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:13,156  INFO [pool-108-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:25:13,156  INFO [pool-108-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:13,156  INFO [pool-108-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:13,156  INFO [pool-108-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:13,156  INFO [pool-108-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:13,157  INFO [pool-108-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:13,157  INFO [pool-108-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:25:13,158  INFO [pool-108-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:13,158  INFO [pool-108-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:13,158  INFO [pool-108-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:13,158  INFO [pool-108-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:13,159  INFO [pool-108-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2045474583_0022/job_local2045474583_0022.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5e227098
2024-04-23T22:25:13,159  INFO [pool-108-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:13,159  INFO [pool-108-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:13,159  INFO [pool-108-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:13,160  INFO [pool-108-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:13,160  INFO [pool-108-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:13,167  INFO [pool-108-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:13,167  INFO [pool-108-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:13,167  INFO [pool-108-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:25:13,167  INFO [pool-108-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:13,167  INFO [pool-108-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:25:13,170  INFO [pool-108-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:25:13,180  INFO [pool-108-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T22:25:13,181  INFO [pool-108-thread-1] mapred.Task: Task:attempt_local2045474583_0022_r_000001_0 is done. And is in the process of committing
2024-04-23T22:25:13,181  INFO [pool-108-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:13,181  INFO [pool-108-thread-1] mapred.Task: Task 'attempt_local2045474583_0022_r_000001_0' done.
2024-04-23T22:25:13,181  INFO [pool-108-thread-1] mapred.Task: Final Counters for attempt_local2045474583_0022_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=477809
		FILE: Number of bytes written=25934098
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1124073472
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:13,181  INFO [pool-108-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2045474583_0022_r_000001_0
2024-04-23T22:25:13,181  INFO [Thread-1736] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:14,053 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:14,054  INFO [main] exec.Task: 2024-04-23 22:25:14,053 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2045474583_0022
2024-04-23T22:25:14,055  INFO [main] exec.Task: Ended Job = job_local2045474583_0022
2024-04-23T22:25:14,056  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:25:14,056  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:25:14,056  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:25:14,057  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:25:14,057  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:25:14,058  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:25:14,058  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:14,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,066  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,066  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,072  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:14,099  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:25:14,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,105  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,105  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:25:14,105  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-12_551_5079298892398905392-1/-mr-10000
2024-04-23T22:25:14,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,113  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,125  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:25:14,125  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T22:25:14,125  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:25:14,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:14,150  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T22:25:14,150  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:25:14,150  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:25:14,153  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1380, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:25:14,153  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:14,154  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, getTable_(GetTableRequest)=26, alter_table_(String, String, String, Table, EnvironmentContext, String)=51}
MapReduce Jobs Launched: 
2024-04-23T22:25:14,154  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:14,154  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:14,154  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:14,154  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d); Time taken: 1.379 seconds
2024-04-23T22:25:14,154  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222512_2912cca8-efc2-4cac-a621-9b4f531d706d
2024-04-23T22:25:14,167  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:14,167  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:25:14,168  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T22:25:14,168  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-12_551_5079298892398905392-1
2024-04-23T22:25:14,168  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-12_551_5079298892398905392-1 on fs with scheme file
2024-04-23T22:25:14,169  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222514_b6443f94-bf47-45b3-af30-c0836f8dcdc2): merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T22:25:14,171  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:25:14,172  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:25:14,172  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:25:14,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,179  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T22:25:14,184  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9840b252-7357-4baf-a7cf-ee150aede66b/_tmp_space.db/merge_tmp_table
2024-04-23T22:25:14,187  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED and s.a < 5 THEN DELETE WHEN MATCHED AND s.a < 3 THEN update set b = 0 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 5
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 0
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3 AND NOT(`s`.`a` < 5)
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` < 3 AND NOT(`s`.`a` < 5)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T22:25:14,190  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:25:14,194  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:14,194  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:14,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,201  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:14,212  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,213  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:14,213  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:14,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,222  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,230  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,238  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,238  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,246  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,246  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:14,246  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:14,246  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:14,247  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:14,247  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:14,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:14,300  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:25:14,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,310  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:14,321  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:25:14,333  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:25:14,333  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:25:14,334  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:25:14,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:14,346  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:25:14,358  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T22:25:14,375  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a, b
No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T22:25:14,375  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:14,586  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:14,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,595  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,603  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,603  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,610  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,617  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,625 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:25:14,626 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:25:14,626  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:25:14,627 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeDeleteUpdate(TestTxnCommands.java:1281)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:25:14,627  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:14,627  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=73, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=86, createTable_(Table)=3, getValidWriteIds_(List, String)=4, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=13, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T22:25:14,627  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222514_b6443f94-bf47-45b3-af30-c0836f8dcdc2); Time taken: 0.458 seconds
2024-04-23T22:25:14,627  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:25:14,631  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:14,639  INFO [Metastore Scheduled Worker 1] metastore.HMSHandler: 3: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T22:25:14,640  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:14,640  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9840b252-7357-4baf-a7cf-ee150aede66b/hive_2024-04-23_22-25-14_187_7445060878579238135-1
2024-04-23T22:25:14,640  INFO [Metastore Scheduled Worker 1] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4e72d329, with PersistenceManager: null will be shutdown
2024-04-23T22:25:14,640  INFO [Metastore Scheduled Worker 1] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4e72d329, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@66390ae9 created in the thread with id: 45
2024-04-23T22:25:14,640  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f): drop table if exists acidTbl
2024-04-23T22:25:14,644  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T22:25:14,645  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:25:14,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,656  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,657  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:14,657  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:14,657  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:14,657  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, rollbackTxn_(long)=11, openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=11, getValidTxns_(long)=1}
2024-04-23T22:25:14,657  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f); Time taken: 0.017 seconds
2024-04-23T22:25:14,657  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f
2024-04-23T22:25:14,658  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f
2024-04-23T22:25:14,670  INFO [Metastore Scheduled Worker 1] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4e72d329 from thread id: 45
2024-04-23T22:25:14,684  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:25:14,684  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:14,684  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f): drop table if exists acidTbl
2024-04-23T22:25:14,684  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:14,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,828  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,835  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:14,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:14,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:14,957  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=144, dropTable_(String, String, boolean, boolean, boolean)=129, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:14,957  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f); Time taken: 0.273 seconds
2024-04-23T22:25:14,957  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222514_f68b1a0e-fdbf-4fb6-be47-d6d602f70f2f
2024-04-23T22:25:14,965  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:25:14,975  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:14,975  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:25:14,976  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:14,977  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3): drop table if exists acidTblPart
2024-04-23T22:25:14,988  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T22:25:14,988  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:25:14,991  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:15,000  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,001  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,001  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,001  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,001  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=3, openTxn_(String, TxnType)=11, flushCache_()=0, getTable_(GetTableRequest)=10}
2024-04-23T22:25:15,001  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3); Time taken: 0.024 seconds
2024-04-23T22:25:15,001  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3
2024-04-23T22:25:15,002  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3
2024-04-23T22:25:15,025  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:25:15,025  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:15,025  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3): drop table if exists acidTblPart
2024-04-23T22:25:15,025  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,025  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:15,033  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,033  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:15,041  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:15,092  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,092  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=59}
2024-04-23T22:25:15,092  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3); Time taken: 0.067 seconds
2024-04-23T22:25:15,092  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222514_cb92dad0-fa9e-4e11-8513-9f8870e5d1d3
2024-04-23T22:25:15,097  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:25:15,104  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,105  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:25:15,105  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:15,105  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_8721e809-d65a-4c5e-b320-8470b0370d4e): drop table if exists acidTbl2
2024-04-23T22:25:15,108  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T22:25:15,108  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:25:15,109  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,109  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,109  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,110  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=0}
2024-04-23T22:25:15,110  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_8721e809-d65a-4c5e-b320-8470b0370d4e); Time taken: 0.004 seconds
2024-04-23T22:25:15,110  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222515_8721e809-d65a-4c5e-b320-8470b0370d4e
2024-04-23T22:25:15,110  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:15,110  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_8721e809-d65a-4c5e-b320-8470b0370d4e): drop table if exists acidTbl2
2024-04-23T22:25:15,110  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,111  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:25:15,111  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,112  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T22:25:15,112  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_8721e809-d65a-4c5e-b320-8470b0370d4e); Time taken: 0.001 seconds
2024-04-23T22:25:15,112  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_8721e809-d65a-4c5e-b320-8470b0370d4e
2024-04-23T22:25:15,119  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:25:15,127  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,127  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:25:15,128  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:15,128  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:15,131  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T22:25:15,131  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:25:15,132  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:15,157  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,157  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,157  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,157  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,158  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=25, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=2}
2024-04-23T22:25:15,158  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9); Time taken: 0.029 seconds
2024-04-23T22:25:15,158  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9
2024-04-23T22:25:15,158  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9
2024-04-23T22:25:15,180  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:25:15,180  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:15,181  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:15,181  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:15,194  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:15,208  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,208  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:15,314  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,314  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=120, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=13}
2024-04-23T22:25:15,314  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9); Time taken: 0.134 seconds
2024-04-23T22:25:15,314  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_69a1f553-0a2e-4d15-ac2d-3ca8cf637aa9
2024-04-23T22:25:15,319  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:25:15,325  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,325  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:25:15,326  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:15,326  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:15,328  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T22:25:15,329  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:25:15,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:15,338  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,338  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,339  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,339  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,339  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T22:25:15,339  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726); Time taken: 0.013 seconds
2024-04-23T22:25:15,339  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726
2024-04-23T22:25:15,340  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726
2024-04-23T22:25:15,355  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:25:15,355  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:15,355  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:15,355  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:15,365  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:15,376  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:15,409  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,409  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,409  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726); Time taken: 0.054 seconds
2024-04-23T22:25:15,409  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_1cccb593-8a10-477a-b526-565970a16726
2024-04-23T22:25:15,414  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:25:15,421  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,421  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:25:15,421  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:15,422  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4): drop table if exists nonAcidNonBucket
2024-04-23T22:25:15,424  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T22:25:15,424  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:25:15,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:15,437  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,437  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,437  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,438  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,438  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,438  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4); Time taken: 0.016 seconds
2024-04-23T22:25:15,438  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4
2024-04-23T22:25:15,439  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4
2024-04-23T22:25:15,457  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:25:15,457  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:15,458  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4): drop table if exists nonAcidNonBucket
2024-04-23T22:25:15,458  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,458  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:15,468  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:15,477  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:15,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:15,511  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,511  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=43, getTable_(GetTableRequest)=10}
2024-04-23T22:25:15,511  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4); Time taken: 0.053 seconds
2024-04-23T22:25:15,511  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_2a3273d2-f346-4dee-a944-17a6d7dde5d4
2024-04-23T22:25:15,516  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:25:15,523  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,523  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:25:15,523  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testQuotedIdentifier" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="2.202">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: 
merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz') failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:25:15,615  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:25:15,615  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:25:15,615  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:25:15,615  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:25:15,615  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:25:15,616  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:25:15,616  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:25:15,616  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:25:15,616  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:25:15,616  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:25:15,616  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:25:15,619  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 9e275a5a-3d43-462c-8c0d-6299b7bc84db
2024-04-23T22:25:15,633  INFO [main] SessionState: Hive Session ID = 9e275a5a-3d43-462c-8c0d-6299b7bc84db
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:15,633  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:15,642  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9e275a5a-3d43-462c-8c0d-6299b7bc84db
2024-04-23T22:25:15,646  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9e275a5a-3d43-462c-8c0d-6299b7bc84db
2024-04-23T22:25:15,648  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9e275a5a-3d43-462c-8c0d-6299b7bc84db/_tmp_space.db
2024-04-23T22:25:15,649  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9e275a5a-3d43-462c-8c0d-6299b7bc84db, clientType=HIVECLI]
2024-04-23T22:25:15,649  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:15,650  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_5892c612-7b99-4c3f-8878-a7b72237f0b1): drop table if exists acidTbl
2024-04-23T22:25:15,664  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:25:15,664  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:25:15,668  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:15,672  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,672  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,672  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,673  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=14, flushCache_()=0}
2024-04-23T22:25:15,673  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_5892c612-7b99-4c3f-8878-a7b72237f0b1); Time taken: 0.022 seconds
2024-04-23T22:25:15,673  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222515_5892c612-7b99-4c3f-8878-a7b72237f0b1
2024-04-23T22:25:15,673  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:15,673  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_5892c612-7b99-4c3f-8878-a7b72237f0b1): drop table if exists acidTbl
2024-04-23T22:25:15,674  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,674  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:15,679  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,679  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,680  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_5892c612-7b99-4c3f-8878-a7b72237f0b1); Time taken: 0.006 seconds
2024-04-23T22:25:15,680  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_5892c612-7b99-4c3f-8878-a7b72237f0b1
2024-04-23T22:25:15,689  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:25:15,699  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,699  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:25:15,700  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:15,701  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_80a7635d-46c4-405d-9c12-eed7bbf76004): drop table if exists acidTblPart
2024-04-23T22:25:15,704  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:25:15,705  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:25:15,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:15,710  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,710  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,710  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,710  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=20, openTxn_(String, TxnType)=4, flushCache_()=0}
2024-04-23T22:25:15,711  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_80a7635d-46c4-405d-9c12-eed7bbf76004); Time taken: 0.009 seconds
2024-04-23T22:25:15,711  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222515_80a7635d-46c4-405d-9c12-eed7bbf76004
2024-04-23T22:25:15,711  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:15,711  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_80a7635d-46c4-405d-9c12-eed7bbf76004): drop table if exists acidTblPart
2024-04-23T22:25:15,711  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:15,717  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,717  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T22:25:15,717  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_80a7635d-46c4-405d-9c12-eed7bbf76004); Time taken: 0.006 seconds
2024-04-23T22:25:15,717  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_80a7635d-46c4-405d-9c12-eed7bbf76004
2024-04-23T22:25:15,726  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:25:15,736  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,736  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:25:15,737  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:15,737  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_9dbfad5d-02d3-4085-a7c9-58f56492fa95): drop table if exists acidTbl2
2024-04-23T22:25:15,740  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:25:15,740  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:25:15,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:15,745  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,745  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,745  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,745  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=19}
2024-04-23T22:25:15,745  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_9dbfad5d-02d3-4085-a7c9-58f56492fa95); Time taken: 0.008 seconds
2024-04-23T22:25:15,745  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222515_9dbfad5d-02d3-4085-a7c9-58f56492fa95
2024-04-23T22:25:15,746  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:15,746  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_9dbfad5d-02d3-4085-a7c9-58f56492fa95): drop table if exists acidTbl2
2024-04-23T22:25:15,746  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,746  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:15,749  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,749  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,749  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_9dbfad5d-02d3-4085-a7c9-58f56492fa95); Time taken: 0.003 seconds
2024-04-23T22:25:15,749  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_9dbfad5d-02d3-4085-a7c9-58f56492fa95
2024-04-23T22:25:15,756  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:25:15,764  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,764  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:25:15,765  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:15,765  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_812244b3-00bd-4cff-8e50-7e2dd7987892): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:15,768  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:25:15,768  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:25:15,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:15,772  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,772  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,772  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,773  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=2, flushCache_()=1, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T22:25:15,773  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_812244b3-00bd-4cff-8e50-7e2dd7987892); Time taken: 0.007 seconds
2024-04-23T22:25:15,773  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222515_812244b3-00bd-4cff-8e50-7e2dd7987892
2024-04-23T22:25:15,773  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:15,773  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_812244b3-00bd-4cff-8e50-7e2dd7987892): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:15,773  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:15,777  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,777  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,778  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_812244b3-00bd-4cff-8e50-7e2dd7987892); Time taken: 0.004 seconds
2024-04-23T22:25:15,778  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_812244b3-00bd-4cff-8e50-7e2dd7987892
2024-04-23T22:25:15,784  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:25:15,790  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,790  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:25:15,790  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:15,791  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_694b9e64-5c43-420a-9fc1-bb83b1d8475b): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:15,793  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:25:15,793  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:25:15,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:15,797  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,797  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,797  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,797  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_694b9e64-5c43-420a-9fc1-bb83b1d8475b); Time taken: 0.006 seconds
2024-04-23T22:25:15,797  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222515_694b9e64-5c43-420a-9fc1-bb83b1d8475b
2024-04-23T22:25:15,798  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:15,798  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_694b9e64-5c43-420a-9fc1-bb83b1d8475b): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:15,798  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:15,801  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,801  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,801  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_694b9e64-5c43-420a-9fc1-bb83b1d8475b); Time taken: 0.003 seconds
2024-04-23T22:25:15,801  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_694b9e64-5c43-420a-9fc1-bb83b1d8475b
2024-04-23T22:25:15,807  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:25:15,812  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,812  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:25:15,813  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:15,813  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_6dcbf111-1d9f-4be8-8b54-851fadb61607): drop table if exists nonAcidNonBucket
2024-04-23T22:25:15,816  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:25:15,816  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:25:15,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:15,820  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,820  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,820  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,820  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2}
2024-04-23T22:25:15,820  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_6dcbf111-1d9f-4be8-8b54-851fadb61607); Time taken: 0.007 seconds
2024-04-23T22:25:15,820  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222515_6dcbf111-1d9f-4be8-8b54-851fadb61607
2024-04-23T22:25:15,820  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:15,820  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_6dcbf111-1d9f-4be8-8b54-851fadb61607): drop table if exists nonAcidNonBucket
2024-04-23T22:25:15,821  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,821  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:15,824  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,824  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,824  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_6dcbf111-1d9f-4be8-8b54-851fadb61607); Time taken: 0.004 seconds
2024-04-23T22:25:15,824  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_6dcbf111-1d9f-4be8-8b54-851fadb61607
2024-04-23T22:25:15,829  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:25:15,835  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,835  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:25:15,835  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:15,836  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:15,838  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:25:15,838  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:25:15,839  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:15,839  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:15,845  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:25:15,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:15,848  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:15,848  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,848  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,848  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,848  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=1, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=1, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:25:15,848  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2); Time taken: 0.012 seconds
2024-04-23T22:25:15,848  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2
2024-04-23T22:25:15,849  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2
2024-04-23T22:25:15,866  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:25:15,866  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:15,867  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:15,867  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,868  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936315, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true, numRows=0, numFilesErasureCoded=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:15,873  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:15,911  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,911  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,911  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2); Time taken: 0.044 seconds
2024-04-23T22:25:15,911  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_a35d87bd-7ed7-4073-bedc-aa90d059e7a2
2024-04-23T22:25:15,916  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:25:15,923  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,923  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:25:15,924  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:15,924  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:15,927  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:25:15,927  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:25:15,928  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:15,928  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:15,931  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:25:15,931  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:15,933  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:15,933  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,934  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,934  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,934  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T22:25:15,934  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b); Time taken: 0.01 seconds
2024-04-23T22:25:15,934  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b
2024-04-23T22:25:15,935  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b
2024-04-23T22:25:15,950  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:25:15,950  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:15,951  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:15,951  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:15,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936315, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:15,957  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:25:15,972  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:15,972  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,972  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b); Time taken: 0.021 seconds
2024-04-23T22:25:15,972  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_0712d05d-a188-42c0-bdeb-224437cf826b
2024-04-23T22:25:15,976  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:25:15,982  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:15,982  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:25:15,983  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:15,983  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:15,986  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:25:15,986  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:25:15,987  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:15,987  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:15,990  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:25:15,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:15,992  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:15,992  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:15,992  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:15,992  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:15,992  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:15,992  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8); Time taken: 0.009 seconds
2024-04-23T22:25:15,993  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8
2024-04-23T22:25:15,993  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8
2024-04-23T22:25:16,009  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:25:16,009  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:16,009  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:16,010  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,011  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936316, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, numFilesErasureCoded=0, numRows=0, rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:16,016  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:25:16,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,038  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=27}
2024-04-23T22:25:16,038  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8); Time taken: 0.028 seconds
2024-04-23T22:25:16,038  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222515_b251c79b-8a3b-4ef9-84dc-92d400794aa8
2024-04-23T22:25:16,042  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:25:16,049  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,049  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:25:16,050  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:16,050  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:16,053  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:25:16,053  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:25:16,053  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:16,054  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:16,057  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:25:16,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:16,059  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:16,059  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,059  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,059  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,059  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:16,059  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863); Time taken: 0.009 seconds
2024-04-23T22:25:16,060  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863
2024-04-23T22:25:16,060  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863
2024-04-23T22:25:16,076  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:25:16,076  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:16,076  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:16,076  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936316, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, numFiles=0, numRows=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:16,083  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:25:16,097  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T22:25:16,097  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863); Time taken: 0.021 seconds
2024-04-23T22:25:16,097  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_49bef699-38a5-4205-930a-2a278ddad863
2024-04-23T22:25:16,102  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:25:16,109  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,109  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:25:16,110  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:16,110  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:16,113  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:25:16,113  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:25:16,114  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:16,114  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:16,117  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:25:16,117  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:16,119  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:16,119  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,119  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,120  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,120  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:25:16,120  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7); Time taken: 0.009 seconds
2024-04-23T22:25:16,120  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7
2024-04-23T22:25:16,120  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7
2024-04-23T22:25:16,136  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:25:16,136  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:16,136  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:16,137  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,138  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9e275a5a-3d43-462c-8c0d-6299b7bc84db/_tmp_space.db/7a57f4c6-03b8-4c5c-ab5a-18637b02e851
2024-04-23T22:25:16,141  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,141  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:25:16,141  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7); Time taken: 0.005 seconds
2024-04-23T22:25:16,141  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_3382360a-2536-4f3d-a18f-42abd85c4ef7
2024-04-23T22:25:16,145  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:25:16,153  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,153  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:25:16,154  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:16,154  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:16,157  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:25:16,158  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:25:16,158  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:16,158  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:16,161  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:25:16,162  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:16,164  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:16,164  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,164  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,164  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,164  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=3}
2024-04-23T22:25:16,164  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe); Time taken: 0.01 seconds
2024-04-23T22:25:16,165  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe
2024-04-23T22:25:16,165  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe
2024-04-23T22:25:16,181  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:25:16,181  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:16,181  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:16,181  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,182  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936316, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, totalSize=0, numFilesErasureCoded=0, bucketing_version=2, transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:16,188  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:25:16,203  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,203  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=21}
2024-04-23T22:25:16,203  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe); Time taken: 0.022 seconds
2024-04-23T22:25:16,203  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_6480fdce-a6ec-4eea-8a83-d50d4c716fbe
2024-04-23T22:25:16,207  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:25:16,214  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,214  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:25:16,214  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `aci/d_u/ami`
2024-04-23T22:25:16,215  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_0ab009ce-ee58-4f16-b380-5464f8b5ae37): drop table if exists `aci/d_u/ami`
2024-04-23T22:25:16,217  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:25:16,218  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:25:16,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,222  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,222  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:25:16,222  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_0ab009ce-ee58-4f16-b380-5464f8b5ae37); Time taken: 0.007 seconds
2024-04-23T22:25:16,223  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222516_0ab009ce-ee58-4f16-b380-5464f8b5ae37
2024-04-23T22:25:16,223  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:16,223  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_0ab009ce-ee58-4f16-b380-5464f8b5ae37): drop table if exists `aci/d_u/ami`
2024-04-23T22:25:16,223  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,226  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,226  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:16,226  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_0ab009ce-ee58-4f16-b380-5464f8b5ae37); Time taken: 0.003 seconds
2024-04-23T22:25:16,226  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_0ab009ce-ee58-4f16-b380-5464f8b5ae37
2024-04-23T22:25:16,232  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:25:16,240  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,241  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:25:16,241  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `src/name`
2024-04-23T22:25:16,242  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_f7bf4f86-7617-45ec-be07-4772221030f8): drop table if exists `src/name`
2024-04-23T22:25:16,244  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:25:16,244  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:25:16,245  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:25:16,248  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,248  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,248  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,248  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T22:25:16,249  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_f7bf4f86-7617-45ec-be07-4772221030f8); Time taken: 0.007 seconds
2024-04-23T22:25:16,249  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222516_f7bf4f86-7617-45ec-be07-4772221030f8
2024-04-23T22:25:16,249  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:16,249  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_f7bf4f86-7617-45ec-be07-4772221030f8): drop table if exists `src/name`
2024-04-23T22:25:16,249  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,249  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:25:16,252  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,252  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:16,253  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_f7bf4f86-7617-45ec-be07-4772221030f8); Time taken: 0.003 seconds
2024-04-23T22:25:16,253  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_f7bf4f86-7617-45ec-be07-4772221030f8
2024-04-23T22:25:16,258  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:25:16,264  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,265  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:25:16,265  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:16,265  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:16,268  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T22:25:16,269  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:25:16,269  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:16,270  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:16,276  INFO [main] parse.CalcitePlanner: Creating table default.aci/d_u/ami position=13
2024-04-23T22:25:16,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:16,279  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:16,279  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,279  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,279  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,279  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=1}
2024-04-23T22:25:16,279  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd); Time taken: 0.014 seconds
2024-04-23T22:25:16,279  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd
2024-04-23T22:25:16,280  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd
2024-04-23T22:25:16,301  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:25:16,301  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:16,301  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:16,301  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,303  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:aci/d_u/ami, dbName:default, owner:alex, createTime:1713936316, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i, type:int, comment:null), FieldSchema(name:d?*de e, type:decimal(5,2), comment:null), FieldSchema(name:vc, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[i], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"d?*de e":"true","i":"true","vc":"true"}}, numFilesErasureCoded=0, transactional=true, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:16,308  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/aci-47-d_u-47-ami
2024-04-23T22:25:16,341  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,341  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=39}
2024-04-23T22:25:16,341  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd); Time taken: 0.04 seconds
2024-04-23T22:25:16,342  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_3001e023-0303-4169-93e2-0903633769fd
2024-04-23T22:25:16,346  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:25:16,352  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,353  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:25:16,353  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-23T22:25:16,354  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821): create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-23T22:25:16,357  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T22:25:16,357  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:25:16,358  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:16,358  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:16,361  INFO [main] parse.CalcitePlanner: Creating table default.src/name position=13
2024-04-23T22:25:16,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:16,363  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:16,363  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,363  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,363  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,363  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3, flushCache_()=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=3}
2024-04-23T22:25:16,363  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821); Time taken: 0.01 seconds
2024-04-23T22:25:16,364  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821
2024-04-23T22:25:16,364  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821
2024-04-23T22:25:16,380  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:25:16,380  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:16,380  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821): create table `src/name`(gh int, j decimal(5,2), k varchar(128))
2024-04-23T22:25:16,380  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,381  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:src/name, dbName:default, owner:alex, createTime:1713936316, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:gh, type:int, comment:null), FieldSchema(name:j, type:decimal(5,2), comment:null), FieldSchema(name:k, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"gh":"true","j":"true","k":"true"}}, bucketing_version=2, numFilesErasureCoded=0, numRows=0, numFiles=0, totalSize=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:16,387  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/src-47-name
2024-04-23T22:25:16,402  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:16,402  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:16,402  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821); Time taken: 0.022 seconds
2024-04-23T22:25:16,402  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_951282d7-4e48-44ee-b908-b793025d6821
2024-04-23T22:25:16,407  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:25:16,415  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,415  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:25:16,416  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')
2024-04-23T22:25:16,416  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_afb8bb86-f41b-4456-b05b-286f53626ad8): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')
2024-04-23T22:25:16,420  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T22:25:16,421  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:25:16,422  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:25:16,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,448  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T22:25:16,454  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9e275a5a-3d43-462c-8c0d-6299b7bc84db/_tmp_space.db/merge_tmp_table
2024-04-23T22:25:16,457  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=gh 
when matched and i > 5 then delete 
when matched then update set vc='blah' 
when not matched then insert values(1,2.1,'baz')> as 
<FROM
  `default`.`aci/d_u/ami` `d/8`
  RIGHT OUTER JOIN
  `default`.`src/name` `a/b`
  ON `i`=`gh`
INSERT INTO `default`.`aci/d_u/ami`    -- delete clause
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`gh` AND `i` > 5
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- update clause(insert part)
 SELECT `d/8`.`i`, `d/8`.`d?*de e`, 'blah'
   WHERE `i`=`gh` AND NOT(`i` > 5)
INSERT INTO `default`.`aci/d_u/ami`    -- update clause (delete part)
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`gh` AND NOT(`i` > 5)
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- insert clause
  SELECT 1,2.1,'baz'
   WHERE `d/8`.`i` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`d/8`.ROW__ID)
 WHERE `i`=`gh` GROUP BY `d/8`.ROW__ID HAVING count(*) > 1>
2024-04-23T22:25:16,460  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:25:16,465  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:16,465  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:16,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,476  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:25:16,508  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,509  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:16,509  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:16,509  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,516  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,524  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,531  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,532  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,539  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,539  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:16,539  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:16,539  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:16,540  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:16,540  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:16,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.src/name	
2024-04-23T22:25:16,617  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.aci/d_u/ami, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:25:16,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,628  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,629  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,642  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,655  WARN [main] calcite.RelOptHiveTable: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T22:25:16,655  INFO [main] SessionState: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T22:25:16,656  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.src/name, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:25:16,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:25:16,670  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,670  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:25:16,682  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.src/name	
2024-04-23T22:25:16,694  WARN [main] calcite.RelOptHiveTable: No Stats for default@src/name, Columns: gh
No Stats for default@src/name, Columns: gh
2024-04-23T22:25:16,694  INFO [main] SessionState: No Stats for default@src/name, Columns: gh
2024-04-23T22:25:16,859  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:16,859  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:16,859  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:16,859  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:16,859  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:16,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:16,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:16,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:16,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:16,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:16,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:16,860  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:16,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,867  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,873  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,881  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:25:16,888  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,894 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:25:16,895 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:25:16,895  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:25:16,895 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier(TestTxnCommands.java:1070)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:25:16,896  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,896  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=7, getTableColumnStatistics_(String, String, List, String)=74, commitTxn_(CommitTxnRequest)=14, createTable_(Table)=3, getAllTableConstraints_(AllTableConstraintsRequest)=34, getTable_(GetTableRequest)=126, flushCache_()=1}
2024-04-23T22:25:16,896  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_afb8bb86-f41b-4456-b05b-286f53626ad8); Time taken: 0.48 seconds
2024-04-23T22:25:16,896  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:25:16,900  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:16,906  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:16,906  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9e275a5a-3d43-462c-8c0d-6299b7bc84db/hive_2024-04-23_22-25-16_457_471914501297578728-1
2024-04-23T22:25:16,907  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651): drop table if exists acidTbl
2024-04-23T22:25:16,909  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 8
2024-04-23T22:25:16,909  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:25:16,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:16,916  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,916  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:16,916  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:16,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:16,917  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, rollbackTxn_(long)=10}
2024-04-23T22:25:16,917  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651); Time taken: 0.009 seconds
2024-04-23T22:25:16,917  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651
2024-04-23T22:25:16,917  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651
2024-04-23T22:25:16,931  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:25:16,931  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:16,931  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651): drop table if exists acidTbl
2024-04-23T22:25:16,932  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:16,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:16,938  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:16,944  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:16,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:17,056  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:17,056  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=118}
2024-04-23T22:25:17,056  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651); Time taken: 0.125 seconds
2024-04-23T22:25:17,056  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222516_304ba948-7fd4-48de-a798-60616268b651
2024-04-23T22:25:17,061  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:25:17,068  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:17,070  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:25:17,070  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:17,071  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef): drop table if exists acidTblPart
2024-04-23T22:25:17,073  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 11
2024-04-23T22:25:17,073  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:25:17,074  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:17,081  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,081  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:17,081  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:17,081  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:17,082  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=7, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:17,082  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef); Time taken: 0.01 seconds
2024-04-23T22:25:17,082  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef
2024-04-23T22:25:17,082  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef
2024-04-23T22:25:17,098  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:25:17,098  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:17,098  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef): drop table if exists acidTblPart
2024-04-23T22:25:17,098  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:17,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:17,105  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,105  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:17,112  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:17,156  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:17,156  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=51}
2024-04-23T22:25:17,156  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef); Time taken: 0.058 seconds
2024-04-23T22:25:17,156  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222517_203e5988-0689-4f21-92e7-1b119c5b7bef
2024-04-23T22:25:17,160  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:25:17,168  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:17,168  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:25:17,169  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:17,169  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222517_933d050f-9a66-4ec1-ae64-81451041a857): drop table if exists acidTbl2
2024-04-23T22:25:17,172  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 13
2024-04-23T22:25:17,172  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:25:17,173  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:17,173  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:17,173  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:17,173  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:25:17,173  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222517_933d050f-9a66-4ec1-ae64-81451041a857); Time taken: 0.004 seconds
2024-04-23T22:25:17,173  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222517_933d050f-9a66-4ec1-ae64-81451041a857
2024-04-23T22:25:17,173  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:17,174  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222517_933d050f-9a66-4ec1-ae64-81451041a857): drop table if exists acidTbl2
2024-04-23T22:25:17,174  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:17,174  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:25:17,175  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:17,175  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T22:25:17,175  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222517_933d050f-9a66-4ec1-ae64-81451041a857); Time taken: 0.001 seconds
2024-04-23T22:25:17,175  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222517_933d050f-9a66-4ec1-ae64-81451041a857
2024-04-23T22:25:17,181  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:25:17,188  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:17,188  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:25:17,189  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:17,189  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:17,192  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 13
2024-04-23T22:25:17,192  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:25:17,193  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:17,217  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,218  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:17,218  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:17,218  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:17,218  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=26}
2024-04-23T22:25:17,218  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743); Time taken: 0.029 seconds
2024-04-23T22:25:17,218  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743
2024-04-23T22:25:17,219  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743
2024-04-23T22:25:17,235  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:25:17,235  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:17,235  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:17,235  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:17,235  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:17,244  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:17,253  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:17,360  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:17,360  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=116}
2024-04-23T22:25:17,360  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743); Time taken: 0.125 seconds
2024-04-23T22:25:17,360  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222517_63d91f19-09d9-4668-b4cd-37d649e9b743
2024-04-23T22:25:17,365  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:25:17,373  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:17,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:25:17,374  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:17,374  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:17,377  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 17
2024-04-23T22:25:17,377  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T22:25:17,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:17,387  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,387  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:17,387  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:17,387  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:17,388  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T22:25:17,388  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10); Time taken: 0.013 seconds
2024-04-23T22:25:17,388  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10
2024-04-23T22:25:17,389  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10
2024-04-23T22:25:17,405  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:25:17,405  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:17,405  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:17,405  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:17,405  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:17,415  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:17,439  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:17,474  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:17,474  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=59, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:17,475  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10); Time taken: 0.069 seconds
2024-04-23T22:25:17,475  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222517_b6d3692f-22d9-436b-8c7c-6cc5f13f6c10
2024-04-23T22:25:17,479  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T22:25:17,487  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:17,487  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T22:25:17,488  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:17,488  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f): drop table if exists nonAcidNonBucket
2024-04-23T22:25:17,492  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-23T22:25:17,492  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T22:25:17,493  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:17,502  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,502  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:17,502  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:17,502  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:17,502  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T22:25:17,503  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f); Time taken: 0.014 seconds
2024-04-23T22:25:17,503  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f
2024-04-23T22:25:17,503  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f
2024-04-23T22:25:17,519  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:25:17,519  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:17,519  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f): drop table if exists nonAcidNonBucket
2024-04-23T22:25:17,520  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:17,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:17,529  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:17,538  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:17,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:17,572  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:17,572  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-23T22:25:17,572  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f); Time taken: 0.053 seconds
2024-04-23T22:25:17,572  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222517_d3469fe2-a051-44dc-96e7-ec5bccaa495f
2024-04-23T22:25:17,726  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T22:25:17,732  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:17,732  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T22:25:17,733  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testParallelTruncateAnalyzeStats" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="8.237"/>
  <testcase name="testMergeCardinalityViolation" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.117"/>
  <testcase name="testUpdateOfInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.677">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = 1 where b != 1 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:25:33,148  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:25:33,148  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:25:33,148  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:25:33,148  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:25:33,148  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:25:33,148  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:25:33,148  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:25:33,149  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:25:33,149  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:25:33,149  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:25:33,149  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:25:33,150  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = c5069233-64a3-45a9-8671-4b739bbf58a0
2024-04-23T22:25:33,153  INFO [main] SessionState: Hive Session ID = c5069233-64a3-45a9-8671-4b739bbf58a0
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:33,154  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:33,159  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c5069233-64a3-45a9-8671-4b739bbf58a0
2024-04-23T22:25:33,161  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0
2024-04-23T22:25:33,164  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c5069233-64a3-45a9-8671-4b739bbf58a0/_tmp_space.db
2024-04-23T22:25:33,164  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=c5069233-64a3-45a9-8671-4b739bbf58a0, clientType=HIVECLI]
2024-04-23T22:25:33,164  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:33,165  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_4a5f6ef9-4259-493a-9d19-f6e5a28fa60d): drop table if exists acidTbl
2024-04-23T22:25:33,172  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:25:33,173  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:25:33,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:33,178  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,178  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,178  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,178  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=8}
2024-04-23T22:25:33,178  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_4a5f6ef9-4259-493a-9d19-f6e5a28fa60d); Time taken: 0.013 seconds
2024-04-23T22:25:33,178  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222533_4a5f6ef9-4259-493a-9d19-f6e5a28fa60d
2024-04-23T22:25:33,179  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:33,179  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_4a5f6ef9-4259-493a-9d19-f6e5a28fa60d): drop table if exists acidTbl
2024-04-23T22:25:33,179  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,179  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:33,182  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,182  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,182  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_4a5f6ef9-4259-493a-9d19-f6e5a28fa60d); Time taken: 0.003 seconds
2024-04-23T22:25:33,182  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_4a5f6ef9-4259-493a-9d19-f6e5a28fa60d
2024-04-23T22:25:33,187  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:25:33,192  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,192  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:25:33,193  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:33,193  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_321347f6-20d7-4fc9-9b35-8055407b5dfd): drop table if exists acidTblPart
2024-04-23T22:25:33,195  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:25:33,196  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:25:33,196  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:33,199  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,199  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,199  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,200  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_321347f6-20d7-4fc9-9b35-8055407b5dfd); Time taken: 0.006 seconds
2024-04-23T22:25:33,200  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222533_321347f6-20d7-4fc9-9b35-8055407b5dfd
2024-04-23T22:25:33,200  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:33,200  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_321347f6-20d7-4fc9-9b35-8055407b5dfd): drop table if exists acidTblPart
2024-04-23T22:25:33,200  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,200  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:33,203  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,203  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,204  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_321347f6-20d7-4fc9-9b35-8055407b5dfd); Time taken: 0.003 seconds
2024-04-23T22:25:33,204  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_321347f6-20d7-4fc9-9b35-8055407b5dfd
2024-04-23T22:25:33,208  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:25:33,215  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,215  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:25:33,216  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:33,216  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_d4f231bf-e068-4d71-bc88-7ee3bdbbf29d): drop table if exists acidTbl2
2024-04-23T22:25:33,218  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:25:33,218  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:25:33,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:33,222  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,222  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-23T22:25:33,222  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_d4f231bf-e068-4d71-bc88-7ee3bdbbf29d); Time taken: 0.006 seconds
2024-04-23T22:25:33,223  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222533_d4f231bf-e068-4d71-bc88-7ee3bdbbf29d
2024-04-23T22:25:33,223  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:33,223  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_d4f231bf-e068-4d71-bc88-7ee3bdbbf29d): drop table if exists acidTbl2
2024-04-23T22:25:33,223  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:33,226  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,226  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,227  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_d4f231bf-e068-4d71-bc88-7ee3bdbbf29d); Time taken: 0.003 seconds
2024-04-23T22:25:33,227  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_d4f231bf-e068-4d71-bc88-7ee3bdbbf29d
2024-04-23T22:25:33,231  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:25:33,236  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,236  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:25:33,237  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:33,237  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_442f779b-3435-45fe-8a1e-a0bcaebc8500): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:33,239  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:25:33,239  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:25:33,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:33,244  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,244  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,244  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,245  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=1, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T22:25:33,245  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_442f779b-3435-45fe-8a1e-a0bcaebc8500); Time taken: 0.007 seconds
2024-04-23T22:25:33,245  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222533_442f779b-3435-45fe-8a1e-a0bcaebc8500
2024-04-23T22:25:33,245  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:33,246  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_442f779b-3435-45fe-8a1e-a0bcaebc8500): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:33,246  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:33,249  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,249  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,249  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_442f779b-3435-45fe-8a1e-a0bcaebc8500); Time taken: 0.003 seconds
2024-04-23T22:25:33,249  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_442f779b-3435-45fe-8a1e-a0bcaebc8500
2024-04-23T22:25:33,254  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:25:33,259  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,259  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:25:33,260  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:33,261  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_c7bbf74e-500b-44e1-beef-446d7d992cfb): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:33,265  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:25:33,265  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:25:33,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:33,269  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,269  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,269  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,269  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=2, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T22:25:33,269  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_c7bbf74e-500b-44e1-beef-446d7d992cfb); Time taken: 0.008 seconds
2024-04-23T22:25:33,269  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222533_c7bbf74e-500b-44e1-beef-446d7d992cfb
2024-04-23T22:25:33,269  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:33,269  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_c7bbf74e-500b-44e1-beef-446d7d992cfb): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:33,270  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,270  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:33,273  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,273  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,273  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_c7bbf74e-500b-44e1-beef-446d7d992cfb); Time taken: 0.004 seconds
2024-04-23T22:25:33,273  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_c7bbf74e-500b-44e1-beef-446d7d992cfb
2024-04-23T22:25:33,277  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:25:33,282  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,282  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:25:33,283  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:33,283  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_25a18cbc-727f-4243-80c9-f3f8d7cd8df8): drop table if exists nonAcidNonBucket
2024-04-23T22:25:33,285  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:25:33,285  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:25:33,286  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:33,290  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,290  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,290  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,290  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,290  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_25a18cbc-727f-4243-80c9-f3f8d7cd8df8); Time taken: 0.007 seconds
2024-04-23T22:25:33,290  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222533_25a18cbc-727f-4243-80c9-f3f8d7cd8df8
2024-04-23T22:25:33,290  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:33,290  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_25a18cbc-727f-4243-80c9-f3f8d7cd8df8): drop table if exists nonAcidNonBucket
2024-04-23T22:25:33,291  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:33,293  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,294  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,294  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_25a18cbc-727f-4243-80c9-f3f8d7cd8df8); Time taken: 0.003 seconds
2024-04-23T22:25:33,294  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_25a18cbc-727f-4243-80c9-f3f8d7cd8df8
2024-04-23T22:25:33,298  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:25:33,303  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,303  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:25:33,303  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,304  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,306  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:25:33,307  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:25:33,307  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:33,307  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:33,312  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:25:33,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:33,314  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:33,314  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,314  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,314  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,314  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getDatabase_(String)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,314  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93); Time taken: 0.01 seconds
2024-04-23T22:25:33,314  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93
2024-04-23T22:25:33,315  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93
2024-04-23T22:25:33,331  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:25:33,331  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:33,332  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,332  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,333  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936333, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, numFiles=0, numFilesErasureCoded=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:33,338  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:33,367  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,367  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=34, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,367  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93); Time taken: 0.035 seconds
2024-04-23T22:25:33,367  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_8ba157f8-837d-4a79-988f-4dbc9e8efa93
2024-04-23T22:25:33,370  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:25:33,375  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,375  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:25:33,376  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,376  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,378  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:25:33,379  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:25:33,379  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:33,379  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:33,381  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:25:33,381  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:33,383  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:33,383  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,383  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,383  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,383  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=0, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2}
2024-04-23T22:25:33,383  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992); Time taken: 0.007 seconds
2024-04-23T22:25:33,384  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992
2024-04-23T22:25:33,384  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992
2024-04-23T22:25:33,396  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:25:33,396  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:33,397  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,397  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936333, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:33,403  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:25:33,420  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,421  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,421  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992); Time taken: 0.023 seconds
2024-04-23T22:25:33,421  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_1a79b77e-7109-4ff7-ab52-aa4a4259f992
2024-04-23T22:25:33,425  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:25:33,430  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,430  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:25:33,431  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,431  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,435  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:25:33,435  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:25:33,436  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:33,436  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:33,439  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:25:33,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:33,441  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:33,441  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,441  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,441  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,441  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:25:33,441  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496); Time taken: 0.01 seconds
2024-04-23T22:25:33,442  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496
2024-04-23T22:25:33,442  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496
2024-04-23T22:25:33,457  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:25:33,457  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:33,457  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,458  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,459  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936333, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, transactional=false, rawDataSize=0, numFiles=0, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:33,465  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:25:33,481  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,481  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,482  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496); Time taken: 0.024 seconds
2024-04-23T22:25:33,482  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_26479ec3-027d-4039-bb7c-ad3619bb7496
2024-04-23T22:25:33,486  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:25:33,493  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,493  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:25:33,493  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,494  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,497  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:25:33,497  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:25:33,497  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:33,497  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:33,500  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:25:33,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:33,503  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:33,503  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,503  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,503  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,503  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=2, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=3}
2024-04-23T22:25:33,503  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e); Time taken: 0.009 seconds
2024-04-23T22:25:33,503  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e
2024-04-23T22:25:33,504  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e
2024-04-23T22:25:33,519  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:25:33,519  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:33,519  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,519  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,520  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936333, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, totalSize=0, numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:33,526  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:25:33,540  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,540  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:33,540  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e); Time taken: 0.021 seconds
2024-04-23T22:25:33,541  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_537a4ae7-3e8c-45f7-b1f1-d53fab46fa9e
2024-04-23T22:25:33,544  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:25:33,550  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,550  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:25:33,551  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,551  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,554  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:25:33,554  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:25:33,555  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:33,555  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:33,558  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:25:33,558  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:33,560  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:33,560  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,560  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,560  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,560  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1}
2024-04-23T22:25:33,561  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1); Time taken: 0.009 seconds
2024-04-23T22:25:33,561  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1
2024-04-23T22:25:33,561  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1
2024-04-23T22:25:33,576  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:25:33,576  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:33,577  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:33,577  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,578  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c5069233-64a3-45a9-8671-4b739bbf58a0/_tmp_space.db/0e9206ff-52a5-4ce9-8ec0-9d4515e8ce7d
2024-04-23T22:25:33,581  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,581  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:25:33,581  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1); Time taken: 0.004 seconds
2024-04-23T22:25:33,581  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_5c7fac7e-0842-4690-be4f-a5c9e7f8b9a1
2024-04-23T22:25:33,586  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:25:33,592  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,592  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:25:33,593  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,593  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,595  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:25:33,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:25:33,596  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:33,596  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:33,599  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:25:33,599  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:33,601  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:33,601  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,601  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:33,601  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,601  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T22:25:33,602  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301); Time taken: 0.008 seconds
2024-04-23T22:25:33,602  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301
2024-04-23T22:25:33,602  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301
2024-04-23T22:25:33,618  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:25:33,618  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:33,618  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:33,618  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:33,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936333, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0, totalSize=0, transactional=false, rawDataSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:33,625  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:25:33,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:33,641  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T22:25:33,641  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301); Time taken: 0.023 seconds
2024-04-23T22:25:33,641  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_2a4b6fc3-f023-4401-bc9d-4471b216e301
2024-04-23T22:25:33,645  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:25:33,651  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:33,651  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:25:33,652  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:25:33,652  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:25:33,655  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:25:33,655  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:25:33,656  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:33,656  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:33,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:33,683  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:33,683  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:33,683  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:33,683  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:33,683  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:33,683  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:33,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:33,691  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:33,691  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:33,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:33,789  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:33,789  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:33,789  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:33,790  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:33,792  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:33,793  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:33,793  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:33,793  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:33,801  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:33,804  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:33,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:33,814  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T22:25:33,814  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T22:25:33,815  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:33,818  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:33,819  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:25:33,820  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:25:33,820  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:33,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:33,836  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:33,836  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:33,836  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:33,836  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:33,836  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:25:33,837  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:33,837  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=2, openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=29, getValidTxns_(long)=1, getTable_(GetTableRequest)=44, getValidWriteIds_(List, String)=7, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-23T22:25:33,837  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7); Time taken: 0.185 seconds
2024-04-23T22:25:33,837  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7
2024-04-23T22:25:33,837  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7
2024-04-23T22:25:33,857  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:25:33,857  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:33,859  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:25:33,859  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7
2024-04-23T22:25:33,860  INFO [main] ql.Driver: Query ID = alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7
Total jobs = 1
2024-04-23T22:25:33,860  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:33,860  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:33,990  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:25:33,990  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:33,990  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:33,990  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:33,990  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:33,990  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:33,990  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:33,990  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:33,993  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:33,993  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:25:33,993  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-33_652_802866249031627490-1/dummy_path
2024-04-23T22:25:34,003  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:34,004  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:25:34,009  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:34,010  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,91KB
2024-04-23T22:25:34,011  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:34,016  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-33_652_802866249031627490-1/-mr-10000
2024-04-23T22:25:34,018  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:34,025  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:34,030  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:34,031  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:25:34,031  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:25:34,031  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-33_652_802866249031627490-1/dummy_path
2024-04-23T22:25:34,031  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:25:34,050  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:25:34,070  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1886889755_0030
2024-04-23T22:25:34,070  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:34,136  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:34,136  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:34,136  INFO [Thread-2417] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:34,137  INFO [Thread-2417] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:34,138  INFO [Thread-2417] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:34,138  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1886889755_0030_m_000000_0
2024-04-23T22:25:34,141  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:34,142  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-33_652_802866249031627490-1/dummy_path/null:0+1
2024-04-23T22:25:34,144  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:34,145  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:25:34,145  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:25:34,151  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:34,152  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:34,152  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:34,152  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:34,152  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:34,152  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:34,153  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:34,153  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:25:34,154  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:25:34,155  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T22:25:34,158  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:34,158  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:34,158  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:34,158  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:25:34,158  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:25:34,169  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:34,176  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1886889755_0030_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:34,176  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:25:34,177  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1886889755_0030_m_000000_0' done.
2024-04-23T22:25:34,177  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1886889755_0030_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=607570
		FILE: Number of bytes written=35375866
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=360
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5017
2024-04-23T22:25:34,177  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1886889755_0030_m_000000_0
2024-04-23T22:25:34,177  INFO [Thread-2417] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:34,178  INFO [Thread-2417] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:34,178  INFO [pool-153-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1886889755_0030_r_000000_0
2024-04-23T22:25:34,181  INFO [pool-153-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:34,181  INFO [pool-153-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@717517c1
2024-04-23T22:25:34,181  WARN [pool-153-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:34,182  INFO [pool-153-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:34,182  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1886889755_0030_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:34,185  INFO [localfetcher#43] reduce.LocalFetcher: localfetcher#43 about to shuffle output of map attempt_local1886889755_0030_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:25:34,186  INFO [localfetcher#43] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1886889755_0030_m_000000_0
2024-04-23T22:25:34,186  INFO [localfetcher#43] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:25:34,186  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:34,186  INFO [pool-153-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:34,186  INFO [pool-153-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:34,193  INFO [pool-153-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:34,193  INFO [pool-153-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:34,196  INFO [pool-153-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:34,196  INFO [pool-153-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:25:34,196  INFO [pool-153-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:34,196  INFO [pool-153-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:34,196  INFO [pool-153-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:34,196  INFO [pool-153-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:34,197  INFO [pool-153-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:34,198  INFO [pool-153-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1886889755_0030/job_local1886889755_0030.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@54a3e1bf
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:34,199  INFO [pool-153-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:34,200  INFO [pool-153-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:34,200  INFO [pool-153-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:34,207  INFO [pool-153-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:34,212  INFO [pool-153-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:34,212  INFO [pool-153-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:34,212  INFO [pool-153-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:34,212  INFO [pool-153-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:34,215  INFO [pool-153-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:25:34,228  INFO [pool-153-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:25:34,228  INFO [pool-153-thread-1] mapred.Task: Task:attempt_local1886889755_0030_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:34,229  INFO [pool-153-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:34,229  INFO [pool-153-thread-1] mapred.Task: Task 'attempt_local1886889755_0030_r_000000_0' done.
2024-04-23T22:25:34,229  INFO [pool-153-thread-1] mapred.Task: Final Counters for attempt_local1886889755_0030_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=613672
		FILE: Number of bytes written=35376905
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:34,229  INFO [pool-153-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1886889755_0030_r_000000_0
2024-04-23T22:25:34,229  INFO [pool-153-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1886889755_0030_r_000001_0
2024-04-23T22:25:34,230  INFO [pool-153-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:34,230  INFO [pool-153-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@40fb3cf2
2024-04-23T22:25:34,230  WARN [pool-153-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:34,231  INFO [pool-153-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:34,231  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1886889755_0030_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:34,234  INFO [localfetcher#44] reduce.LocalFetcher: localfetcher#44 about to shuffle output of map attempt_local1886889755_0030_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:25:34,234  INFO [localfetcher#44] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1886889755_0030_m_000000_0
2024-04-23T22:25:34,234  INFO [localfetcher#44] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:25:34,237  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:34,237  INFO [pool-153-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:34,237  INFO [pool-153-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:34,244  INFO [pool-153-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:34,244  INFO [pool-153-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:34,247  INFO [pool-153-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:34,247  INFO [pool-153-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:25:34,247  INFO [pool-153-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:34,247  INFO [pool-153-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:34,247  INFO [pool-153-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:34,247  INFO [pool-153-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:34,248  INFO [pool-153-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:34,249  INFO [pool-153-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-23T22:25:34,250  INFO [pool-153-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:34,250  INFO [pool-153-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:34,250  INFO [pool-153-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:34,250  INFO [pool-153-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:34,251  INFO [pool-153-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1886889755_0030/job_local1886889755_0030.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6e0f92ac
2024-04-23T22:25:34,251  INFO [pool-153-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:34,251  INFO [pool-153-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:34,251  INFO [pool-153-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:34,252  INFO [pool-153-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:34,252  INFO [pool-153-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:34,258  INFO [pool-153-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:34,258  INFO [pool-153-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:34,259  INFO [pool-153-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:34,259  INFO [pool-153-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:34,259  INFO [pool-153-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:34,261  INFO [pool-153-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:25:34,272  INFO [pool-153-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-23T22:25:34,273  INFO [pool-153-thread-1] mapred.Task: Task:attempt_local1886889755_0030_r_000001_0 is done. And is in the process of committing
2024-04-23T22:25:34,273  INFO [pool-153-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:34,273  INFO [pool-153-thread-1] mapred.Task: Task 'attempt_local1886889755_0030_r_000001_0' done.
2024-04-23T22:25:34,273  INFO [pool-153-thread-1] mapred.Task: Final Counters for attempt_local1886889755_0030_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=619750
		FILE: Number of bytes written=35377933
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:34,273  INFO [pool-153-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1886889755_0030_r_000001_0
2024-04-23T22:25:34,273  INFO [Thread-2417] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:35,139 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:35,139  INFO [main] exec.Task: 2024-04-23 22:25:35,139 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1886889755_0030
2024-04-23T22:25:35,141  INFO [main] exec.Task: Ended Job = job_local1886889755_0030
2024-04-23T22:25:35,142  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:25:35,142  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:25:35,142  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:25:35,142  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:25:35,142  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:25:35,143  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:25:35,144  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:35,144  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,152  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:35,152  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,159  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:35,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:35,191  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:25:35,191  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,197  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:35,197  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:25:35,197  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-33_652_802866249031627490-1/-mr-10000
2024-04-23T22:25:35,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,205  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:35,217  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:25:35,217  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:25:35,217  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:25:35,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:35,243  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:25:35,243  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:25:35,243  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:25:35,245  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:25:35,245  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:35,245  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=57, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, getTable_(GetTableRequest)=27, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:25:35,246  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:35,246  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:35,246  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:35,246  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7); Time taken: 1.386 seconds
2024-04-23T22:25:35,246  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222533_5724195d-1774-4d81-b0de-f967cb7721b7
2024-04-23T22:25:35,256  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:35,256  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:25:35,257  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T22:25:35,257  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-33_652_802866249031627490-1
2024-04-23T22:25:35,258  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-33_652_802866249031627490-1 on fs with scheme file
2024-04-23T22:25:35,258  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211): select a,b from acidTbl order by a,b
2024-04-23T22:25:35,261  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:25:35,261  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:25:35,262  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:35,262  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:35,265  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:35,265  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:35,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:35,277  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:35,277  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:35,277  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:35,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,310  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:25:35,311  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,325  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:35,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:35,340  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:35,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:25:35,356  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:35,356  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:35,402  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:35,402  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:35,402  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:35,403  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-35_258_8481509909647327461-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-35_258_8481509909647327461-1
2024-04-23T22:25:35,411  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:35,413  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:35,413  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:35,414  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:35,424  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:35,424  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:35,424  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:35,424  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T22:25:35,425  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T22:25:35,425  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:35,425  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=11, getAllTableConstraints_(AllTableConstraintsRequest)=8, getTableColumnStatistics_(String, String, List, String)=44, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:25:35,425  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211); Time taken: 0.167 seconds
2024-04-23T22:25:35,425  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211
2024-04-23T22:25:35,426  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211
2024-04-23T22:25:35,441  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:25:35,441  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:35,442  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211): select a,b from acidTbl order by a,b
2024-04-23T22:25:35,442  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211
2024-04-23T22:25:35,442  INFO [main] ql.Driver: Query ID = alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211
Total jobs = 1
2024-04-23T22:25:35,442  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:35,442  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:35,580  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:25:35,580  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:35,580  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:35,580  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:35,580  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:35,580  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:35,580  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:35,580  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:35,582  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:35,582  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T22:25:35,582  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:35,592  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:35,593  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:25:35,598  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:35,599  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:25:35,600  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:35,606  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:35,614  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:35,618  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:35,619  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T22:25:35,620  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T22:25:35,620  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:35,620  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T22:25:35,620  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T22:25:35,620  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T22:25:35,634  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T22:25:35,634  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 14 ms
2024-04-23T22:25:35,634  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T22:25:35,654  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T22:25:35,684  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1049793208_0031
2024-04-23T22:25:35,684  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:35,750  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:35,751  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:35,751  INFO [Thread-2494] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:35,751  INFO [Thread-2494] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:35,753  INFO [Thread-2494] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:35,753  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1049793208_0031_m_000000_0
2024-04-23T22:25:35,754  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:35,755  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:35,755  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:35,756  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:25:35,758  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:35,758  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:35,759  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:35,759  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:35,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:35,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:35,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:35,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:35,764  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:35,765  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:35,765  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:35,766  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:25:35,767  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:1, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:25:35,768  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:25:35,778  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:35,782  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1049793208_0031_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:35,782  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:35,782  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1049793208_0031_m_000000_0' done.
2024-04-23T22:25:35,782  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1049793208_0031_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=628929
		FILE: Number of bytes written=36554696
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7474
2024-04-23T22:25:35,782  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1049793208_0031_m_000000_0
2024-04-23T22:25:35,782  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1049793208_0031_m_000001_0
2024-04-23T22:25:35,783  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:35,783  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:35,784  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:35,784  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:25:35,786  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:35,786  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:35,787  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:35,787  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:35,793  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:35,793  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:35,793  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:35,793  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:35,793  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:35,794  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:35,794  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:35,795  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:35,796  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:35,796  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:35,796  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:35,796  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:35,796  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, 
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:25:35,797  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-23T22:25:35,798  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:35,798  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:35,798  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:35,798  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:25:35,798  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:25:35,806  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:35,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1049793208_0031_m_000001_0 is done. And is in the process of committing
2024-04-23T22:25:35,810  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:35,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1049793208_0031_m_000001_0' done.
2024-04-23T22:25:35,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1049793208_0031_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=637408
		FILE: Number of bytes written=36554755
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7466
2024-04-23T22:25:35,810  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1049793208_0031_m_000001_0
2024-04-23T22:25:35,810  INFO [Thread-2494] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:35,811  INFO [Thread-2494] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:35,811  INFO [pool-158-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1049793208_0031_r_000000_0
2024-04-23T22:25:35,812  INFO [pool-158-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:35,812  INFO [pool-158-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@49e606bd
2024-04-23T22:25:35,812  WARN [pool-158-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:35,813  INFO [pool-158-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:35,813  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1049793208_0031_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:35,814  INFO [localfetcher#45] reduce.LocalFetcher: localfetcher#45 about to shuffle output of map attempt_local1049793208_0031_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:25:35,814  INFO [localfetcher#45] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1049793208_0031_m_000001_0
2024-04-23T22:25:35,814  INFO [localfetcher#45] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T22:25:35,817  INFO [localfetcher#45] reduce.LocalFetcher: localfetcher#45 about to shuffle output of map attempt_local1049793208_0031_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:25:35,817  INFO [localfetcher#45] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1049793208_0031_m_000000_0
2024-04-23T22:25:35,817  INFO [localfetcher#45] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T22:25:35,817  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:35,817  INFO [pool-158-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:25:35,817  INFO [pool-158-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:35,824  INFO [pool-158-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T22:25:35,824  INFO [pool-158-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-23T22:25:35,827  INFO [pool-158-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:35,827  INFO [pool-158-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-23T22:25:35,827  INFO [pool-158-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:35,827  INFO [pool-158-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:35,827  INFO [pool-158-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-23T22:25:35,828  INFO [pool-158-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:25:35,828  INFO [pool-158-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:35,829  INFO [pool-158-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:25:35,830  INFO [pool-158-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:35,830  INFO [pool-158-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:35,830  INFO [pool-158-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T22:25:35,830  INFO [pool-158-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:25:35,831  INFO [pool-158-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@2ffe8a1f, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1cec106a, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@1c94262c
2024-04-23T22:25:35,831  INFO [pool-158-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-35_258_8481509909647327461-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-35_258_8481509909647327461-1/_tmp.-ext-10002/000000_0
2024-04-23T22:25:35,831  INFO [pool-158-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-35_258_8481509909647327461-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-35_258_8481509909647327461-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:25:35,831  INFO [pool-158-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-35_258_8481509909647327461-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-35_258_8481509909647327461-1/_tmp.-ext-10002/000000_0
2024-04-23T22:25:35,839  INFO [pool-158-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:25:35,839  INFO [pool-158-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:35,839  INFO [pool-158-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T22:25:35,839  INFO [pool-158-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:25:35,839  INFO [pool-158-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T22:25:35,840  INFO [pool-158-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_0:2, 
2024-04-23T22:25:35,840  INFO [pool-158-thread-1] mapred.Task: Task:attempt_local1049793208_0031_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:35,841  INFO [pool-158-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:35,841  INFO [pool-158-thread-1] mapred.Task: Task 'attempt_local1049793208_0031_r_000000_0' done.
2024-04-23T22:25:35,841  INFO [pool-158-thread-1] mapred.Task: Final Counters for attempt_local1049793208_0031_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=643221
		FILE: Number of bytes written=36554934
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:35,841  INFO [pool-158-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1049793208_0031_r_000000_0
2024-04-23T22:25:35,841  INFO [Thread-2494] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:36,753 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:36,753  INFO [main] exec.Task: 2024-04-23 22:25:36,753 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1049793208_0031
2024-04-23T22:25:36,754  INFO [main] exec.Task: Ended Job = job_local1049793208_0031
2024-04-23T22:25:36,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:36,759  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T22:25:36,760  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:36,760  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:36,760  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:36,760  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211); Time taken: 1.317 seconds
2024-04-23T22:25:36,760  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222535_3d122f73-82e3-40f0-aedc-606f0f60a211
2024-04-23T22:25:36,772  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:25:36,785  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:36,786  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:25:36,793  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T22:25:36,794  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T22:25:36,794  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:36,794  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T22:25:36,795  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-35_258_8481509909647327461-1
2024-04-23T22:25:36,796  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-35_258_8481509909647327461-1 on fs with scheme file
2024-04-23T22:25:36,796  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222536_dd39711c-cc68-47b7-86f7-f8c9a801e786): START TRANSACTION
2024-04-23T22:25:36,799  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:25:36,799  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:25:36,800  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:36,800  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:36,800  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:36,800  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:36,800  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:36,800  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:36,800  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=25, isCompatibleWith_(Configuration)=2, getValidWriteIds_(List, String)=0, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T22:25:36,800  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222536_dd39711c-cc68-47b7-86f7-f8c9a801e786); Time taken: 0.004 seconds
2024-04-23T22:25:36,801  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222536_dd39711c-cc68-47b7-86f7-f8c9a801e786
2024-04-23T22:25:36,801  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T22:25:36,801  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222536_dd39711c-cc68-47b7-86f7-f8c9a801e786): START TRANSACTION
2024-04-23T22:25:36,801  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:36,801  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T22:25:36,801  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222536_dd39711c-cc68-47b7-86f7-f8c9a801e786); Time taken: 0.0 seconds
2024-04-23T22:25:36,801  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:25:36,802  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:25:36,802  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:36,802  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:36,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:36,813  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:36,813  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:36,813  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:36,813  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:36,813  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:36,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:36,820  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:36,820  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:36,820  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:36,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:36,892  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:36,892  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:36,892  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:36,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:36,895  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:36,895  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:36,895  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:36,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:36,901  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:36,903  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:36,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:36,910  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 15
2024-04-23T22:25:36,910  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-23T22:25:36,911  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:36,914  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:36,914  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:25:36,915  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:25:36,915  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:36,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:36,930  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:36,930  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:36,930  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:36,930  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:36,931  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:25:36,931  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:36,931  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=4, flushCache_()=0, getTable_(GetTableRequest)=28, getAllTableConstraints_(AllTableConstraintsRequest)=5, allocateTableWriteId_(long, String, String)=5}
2024-04-23T22:25:36,931  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112); Time taken: 0.13 seconds
2024-04-23T22:25:36,931  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112
2024-04-23T22:25:36,931  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112
2024-04-23T22:25:36,944  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:25:36,944  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:36,946  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:25:36,947  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112
2024-04-23T22:25:36,947  INFO [main] ql.Driver: Query ID = alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112
Total jobs = 1
2024-04-23T22:25:36,947  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:36,947  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:37,068  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:25:37,069  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:37,069  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:37,069  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:37,069  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:37,069  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:37,069  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:37,069  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:37,071  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:37,071  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:25:37,071  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-36_801_8572787956027936425-1/dummy_path
2024-04-23T22:25:37,081  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:37,081  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:25:37,086  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:37,087  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:25:37,088  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:37,091  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-36_801_8572787956027936425-1/-mr-10000
2024-04-23T22:25:37,093  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:37,100  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:37,104  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:37,105  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:25:37,105  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:25:37,105  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-36_801_8572787956027936425-1/dummy_path
2024-04-23T22:25:37,105  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:25:37,122  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:25:37,141  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1950640688_0032
2024-04-23T22:25:37,141  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:37,200  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:37,200  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:37,201  INFO [Thread-2547] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:37,201  INFO [Thread-2547] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:37,202  INFO [Thread-2547] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:37,202  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1950640688_0032_m_000000_0
2024-04-23T22:25:37,203  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:37,203  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-36_801_8572787956027936425-1/dummy_path/null:0+1
2024-04-23T22:25:37,204  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:37,205  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:25:37,205  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:25:37,209  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:37,209  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:37,209  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:37,209  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:37,209  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:37,210  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:37,210  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:37,211  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:37,211  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:37,211  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:37,211  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:25:37,212  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:25:37,212  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:37,212  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:25:37,212  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:25:37,212  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:37,212  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:25:37,212  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:25:37,213  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T22:25:37,214  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:37,214  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:37,214  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:37,214  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:25:37,214  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:25:37,226  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:37,229  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1950640688_0032_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:37,229  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:25:37,229  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1950640688_0032_m_000000_0' done.
2024-04-23T22:25:37,229  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1950640688_0032_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=648776
		FILE: Number of bytes written=37734982
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-23T22:25:37,229  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1950640688_0032_m_000000_0
2024-04-23T22:25:37,230  INFO [Thread-2547] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:37,231  INFO [Thread-2547] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:37,231  INFO [pool-161-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1950640688_0032_r_000000_0
2024-04-23T22:25:37,232  INFO [pool-161-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:37,232  INFO [pool-161-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4db47ccf
2024-04-23T22:25:37,232  WARN [pool-161-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:37,233  INFO [pool-161-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:37,233  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1950640688_0032_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:37,234  INFO [localfetcher#46] reduce.LocalFetcher: localfetcher#46 about to shuffle output of map attempt_local1950640688_0032_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:25:37,234  INFO [localfetcher#46] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1950640688_0032_m_000000_0
2024-04-23T22:25:37,234  INFO [localfetcher#46] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:25:37,234  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:37,235  INFO [pool-161-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:37,235  INFO [pool-161-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:37,241  INFO [pool-161-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:37,241  INFO [pool-161-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:37,243  INFO [pool-161-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:37,243  INFO [pool-161-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:25:37,243  INFO [pool-161-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:37,243  INFO [pool-161-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:37,243  INFO [pool-161-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:37,243  INFO [pool-161-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:37,244  INFO [pool-161-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:37,244  INFO [pool-161-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:25:37,245  INFO [pool-161-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:37,245  INFO [pool-161-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:37,245  INFO [pool-161-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:37,245  INFO [pool-161-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:37,245  INFO [pool-161-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1950640688_0032/job_local1950640688_0032.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@fd475ac
2024-04-23T22:25:37,246  INFO [pool-161-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:37,246  INFO [pool-161-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:37,246  INFO [pool-161-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:37,246  INFO [pool-161-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:37,246  INFO [pool-161-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:37,253  INFO [pool-161-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:37,258  INFO [pool-161-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:37,258  INFO [pool-161-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:37,258  INFO [pool-161-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:37,258  INFO [pool-161-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:37,259  INFO [pool-161-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0]
2024-04-23T22:25:37,271  INFO [pool-161-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:37,271  INFO [pool-161-thread-1] mapred.Task: Task:attempt_local1950640688_0032_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:37,272  INFO [pool-161-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:37,272  INFO [pool-161-thread-1] mapred.Task: Task 'attempt_local1950640688_0032_r_000000_0' done.
2024-04-23T22:25:37,272  INFO [pool-161-thread-1] mapred.Task: Final Counters for attempt_local1950640688_0032_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=654881
		FILE: Number of bytes written=37736022
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:37,272  INFO [pool-161-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1950640688_0032_r_000000_0
2024-04-23T22:25:37,272  INFO [pool-161-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1950640688_0032_r_000001_0
2024-04-23T22:25:37,272  INFO [pool-161-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:37,273  INFO [pool-161-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@40daf292
2024-04-23T22:25:37,273  WARN [pool-161-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:37,273  INFO [pool-161-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:37,274  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1950640688_0032_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:37,277  INFO [localfetcher#47] reduce.LocalFetcher: localfetcher#47 about to shuffle output of map attempt_local1950640688_0032_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:25:37,277  INFO [localfetcher#47] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1950640688_0032_m_000000_0
2024-04-23T22:25:37,277  INFO [localfetcher#47] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:25:37,278  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:37,278  INFO [pool-161-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:37,278  INFO [pool-161-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:37,285  INFO [pool-161-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:37,285  INFO [pool-161-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:37,292  INFO [pool-161-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:37,292  INFO [pool-161-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:25:37,292  INFO [pool-161-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:37,292  INFO [pool-161-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:37,292  INFO [pool-161-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:25:37,293  INFO [pool-161-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:37,294  INFO [pool-161-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:37,295  INFO [pool-161-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:25:37,297  INFO [pool-161-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:37,298  INFO [pool-161-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:37,298  INFO [pool-161-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:37,298  INFO [pool-161-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:37,299  INFO [pool-161-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1950640688_0032/job_local1950640688_0032.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@4b699009
2024-04-23T22:25:37,300  INFO [pool-161-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:37,300  INFO [pool-161-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:37,300  INFO [pool-161-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:37,301  INFO [pool-161-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:37,302  INFO [pool-161-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:37,314  INFO [pool-161-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:37,315  INFO [pool-161-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:37,315  INFO [pool-161-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T22:25:37,315  INFO [pool-161-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:37,315  INFO [pool-161-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:37,320  INFO [pool-161-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-23T22:25:37,339  INFO [pool-161-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:25:37,339  INFO [pool-161-thread-1] mapred.Task: Task:attempt_local1950640688_0032_r_000001_0 is done. And is in the process of committing
2024-04-23T22:25:37,340  INFO [pool-161-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:37,340  INFO [pool-161-thread-1] mapred.Task: Task 'attempt_local1950640688_0032_r_000001_0' done.
2024-04-23T22:25:37,340  INFO [pool-161-thread-1] mapred.Task: Final Counters for attempt_local1950640688_0032_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=660962
		FILE: Number of bytes written=37737056
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1244659712
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:37,340  INFO [pool-161-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1950640688_0032_r_000001_0
2024-04-23T22:25:37,340  INFO [Thread-2547] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:38,202 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:38,202  INFO [main] exec.Task: 2024-04-23 22:25:38,202 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1950640688_0032
2024-04-23T22:25:38,202  INFO [main] exec.Task: Ended Job = job_local1950640688_0032
2024-04-23T22:25:38,203  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:25:38,203  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:25:38,204  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest
2024-04-23T22:25:38,204  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-23T22:25:38,204  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-23T22:25:38,205  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:25:38,205  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:38,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,212  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:38,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,219  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:38,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:38,242  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:25:38,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,249  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:38,249  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:25:38,249  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-36_801_8572787956027936425-1/-mr-10000
2024-04-23T22:25:38,251  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,261  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:38,283  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:25:38,284  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:25:38,284  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:25:38,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:38,314  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:25:38,314  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:25:38,314  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:25:38,314  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2695, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:25:38,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:38,315  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=31, alter_table_(String, String, String, Table, EnvironmentContext, String)=52, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=0, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:25:38,316  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:38,316  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:38,316  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:38,316  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222536_3854f149-cf26-4803-af13-4b4beb93f112); Time taken: 1.369 seconds
2024-04-23T22:25:38,316  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T22:25:38,316  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-36_801_8572787956027936425-1
2024-04-23T22:25:38,317  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-36_801_8572787956027936425-1 on fs with scheme file
2024-04-23T22:25:38,318  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1): select a,b from acidTbl order by a,b
2024-04-23T22:25:38,318  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:38,318  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:38,319  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:38,319  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:38,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,329  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:38,329  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:38,330  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:38,330  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:38,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,359  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:25:38,360  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,368  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:38,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:38,377  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:38,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:25:38,386  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:38,386  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:38,428  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:38,429  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:38,429  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:38,430  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-38_317_6249945857886757951-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-38_317_6249945857886757951-1
2024-04-23T22:25:38,437  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:38,440  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T22:25:38,440  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:38,441  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:38,450  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:38,450  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:38,450  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:38,450  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T22:25:38,451  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T22:25:38,451  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:38,451  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, flushCache_()=0, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=7, getTableColumnStatistics_(String, String, List, String)=26}
2024-04-23T22:25:38,452  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1); Time taken: 0.133 seconds
2024-04-23T22:25:38,452  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1
2024-04-23T22:25:38,452  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1
2024-04-23T22:25:38,465  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:25:38,465  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:38,466  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1): select a,b from acidTbl order by a,b
2024-04-23T22:25:38,466  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1
2024-04-23T22:25:38,466  INFO [main] ql.Driver: Query ID = alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1
Total jobs = 1
2024-04-23T22:25:38,466  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:38,466  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:38,617  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:25:38,617  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:38,617  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:38,617  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:38,617  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:38,617  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:38,617  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:38,617  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:38,640  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:38,640  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T22:25:38,640  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:38,652  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:38,652  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:25:38,657  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:38,658  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,60KB
2024-04-23T22:25:38,659  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:38,665  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:38,674  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:38,679  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:38,680  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T22:25:38,680  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T22:25:38,680  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:38,681  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T22:25:38,681  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:2:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T22:25:38,681  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T22:25:38,709  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/4
2024-04-23T22:25:38,709  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 4). duration: 28 ms
2024-04-23T22:25:38,709  INFO [main] io.HiveInputFormat: number of splits 4
2024-04-23T22:25:38,728  INFO [main] mapreduce.JobSubmitter: number of splits:4
2024-04-23T22:25:38,747  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1899287174_0033
2024-04-23T22:25:38,747  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:38,806  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:38,806  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:38,807  INFO [Thread-2632] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:38,807  INFO [Thread-2632] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:38,809  INFO [Thread-2632] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:38,809  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1899287174_0033_m_000000_0
2024-04-23T22:25:38,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:38,810  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,811  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:38,811  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:25:38,812  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:38,812  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 679, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:38,813  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:38,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:38,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:38,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:38,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:38,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:38,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:38,818  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:38,819  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:38,820  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:38,820  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:38,820  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:38,820  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:38,820  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, DESERIALIZE_ERRORS:0, 
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:25:38,821  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-23T22:25:38,822  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:38,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:38,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:38,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:25:38,822  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:25:38,835  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:38,842  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1899287174_0033_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:38,843  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,844  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1899287174_0033_m_000000_0' done.
2024-04-23T22:25:38,844  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1899287174_0033_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=671283
		FILE: Number of bytes written=38914945
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1245708288
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7584
2024-04-23T22:25:38,844  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1899287174_0033_m_000000_0
2024-04-23T22:25:38,844  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1899287174_0033_m_000001_0
2024-04-23T22:25:38,845  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:38,846  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,847  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:38,848  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:25:38,851  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:38,851  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:38,853  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:38,853  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:38,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:38,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:38,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:38,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:38,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:38,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:38,865  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:38,867  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:38,868  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:25:38,869  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:25:38,878  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:38,881  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1899287174_0033_m_000001_0 is done. And is in the process of committing
2024-04-23T22:25:38,882  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,882  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1899287174_0033_m_000001_0' done.
2024-04-23T22:25:38,882  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1899287174_0033_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=680854
		FILE: Number of bytes written=38915004
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1245708288
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7560
2024-04-23T22:25:38,882  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1899287174_0033_m_000001_0
2024-04-23T22:25:38,882  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1899287174_0033_m_000002_0
2024-04-23T22:25:38,882  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:38,883  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,883  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:38,884  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:25:38,885  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:38,885  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 672, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:38,886  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:38,886  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:38,890  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:38,890  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:38,890  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:38,890  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:38,890  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:38,891  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:38,891  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:38,892  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:25:38,893  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, 
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:25:38,894  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:25:38,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1899287174_0033_m_000002_0 is done. And is in the process of committing
2024-04-23T22:25:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1899287174_0033_m_000002_0' done.
2024-04-23T22:25:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1899287174_0033_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=689909
		FILE: Number of bytes written=38915063
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1245708288
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7556
2024-04-23T22:25:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1899287174_0033_m_000002_0
2024-04-23T22:25:38,906  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1899287174_0033_m_000003_0
2024-04-23T22:25:38,907  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:38,907  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,908  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:38,908  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:25:38,909  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:38,909  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:38,910  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:38,910  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:38,914  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:38,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:38,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:38,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:38,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:38,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:38,916  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:38,917  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:38,918  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:25:38,919  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:25:38,927  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:38,930  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1899287174_0033_m_000003_0 is done. And is in the process of committing
2024-04-23T22:25:38,930  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:38,930  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1899287174_0033_m_000003_0' done.
2024-04-23T22:25:38,930  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1899287174_0033_m_000003_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=698448
		FILE: Number of bytes written=38915122
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1245708288
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7552
2024-04-23T22:25:38,930  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1899287174_0033_m_000003_0
2024-04-23T22:25:38,930  INFO [Thread-2632] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:38,931  INFO [Thread-2632] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:38,931  INFO [pool-166-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1899287174_0033_r_000000_0
2024-04-23T22:25:38,932  INFO [pool-166-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:38,932  INFO [pool-166-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@bedc0b6
2024-04-23T22:25:38,932  WARN [pool-166-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:38,933  INFO [pool-166-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:38,933  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1899287174_0033_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:38,934  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1899287174_0033_m_000003_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:25:38,935  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1899287174_0033_m_000003_0
2024-04-23T22:25:38,935  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T22:25:38,937  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1899287174_0033_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:25:38,937  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1899287174_0033_m_000001_0
2024-04-23T22:25:38,937  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T22:25:38,939  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1899287174_0033_m_000002_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:25:38,939  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1899287174_0033_m_000002_0
2024-04-23T22:25:38,939  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 3, commitMemory -> 46, usedMemory ->69
2024-04-23T22:25:38,941  INFO [localfetcher#48] reduce.LocalFetcher: localfetcher#48 about to shuffle output of map attempt_local1899287174_0033_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:25:38,941  INFO [localfetcher#48] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1899287174_0033_m_000000_0
2024-04-23T22:25:38,942  INFO [localfetcher#48] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 4, commitMemory -> 69, usedMemory ->92
2024-04-23T22:25:38,942  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:38,942  INFO [pool-166-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T22:25:38,942  INFO [pool-166-thread-1] reduce.MergeManagerImpl: finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:38,949  INFO [pool-166-thread-1] mapred.Merger: Merging 4 sorted segments
2024-04-23T22:25:38,949  INFO [pool-166-thread-1] mapred.Merger: Down to the last merge-pass, with 4 segments left of total size: 24 bytes
2024-04-23T22:25:38,955  INFO [pool-166-thread-1] reduce.MergeManagerImpl: Merged 4 segments, 92 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:38,956  INFO [pool-166-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-23T22:25:38,956  INFO [pool-166-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:38,956  INFO [pool-166-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:38,956  INFO [pool-166-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-23T22:25:38,956  INFO [pool-166-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T22:25:38,958  INFO [pool-166-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:38,959  INFO [pool-166-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,60KB
2024-04-23T22:25:38,961  INFO [pool-166-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:38,961  INFO [pool-166-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:38,961  INFO [pool-166-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T22:25:38,962  INFO [pool-166-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:25:38,963  INFO [pool-166-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@50786f19, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@69d5b874, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@42fa466c
2024-04-23T22:25:38,964  INFO [pool-166-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-38_317_6249945857886757951-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-38_317_6249945857886757951-1/_tmp.-ext-10002/000000_0
2024-04-23T22:25:38,964  INFO [pool-166-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-38_317_6249945857886757951-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-38_317_6249945857886757951-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:25:38,964  INFO [pool-166-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-38_317_6249945857886757951-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-38_317_6249945857886757951-1/_tmp.-ext-10002/000000_0
2024-04-23T22:25:38,982  INFO [pool-166-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:25:38,982  INFO [pool-166-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:38,983  INFO [pool-166-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:38,983  INFO [pool-166-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:25:38,983  INFO [pool-166-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T22:25:38,984  INFO [pool-166-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:38,985  INFO [pool-166-thread-1] mapred.Task: Task:attempt_local1899287174_0033_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:38,985  INFO [pool-166-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:38,986  INFO [pool-166-thread-1] mapred.Task: Task 'attempt_local1899287174_0033_r_000000_0' done.
2024-04-23T22:25:38,986  INFO [pool-166-thread-1] mapred.Task: Final Counters for attempt_local1899287174_0033_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=704429
		FILE: Number of bytes written=38915375
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=108
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =4
		Failed Shuffles=0
		Merged Map outputs=4
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1245708288
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:38,986  INFO [pool-166-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1899287174_0033_r_000000_0
2024-04-23T22:25:38,986  INFO [Thread-2632] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:39,810 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:39,810  INFO [main] exec.Task: 2024-04-23 22:25:39,810 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1899287174_0033
2024-04-23T22:25:39,813  INFO [main] exec.Task: Ended Job = job_local1899287174_0033
2024-04-23T22:25:39,815  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:39,815  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T22:25:39,816  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:39,816  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:39,816  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:39,816  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1); Time taken: 1.349 seconds
2024-04-23T22:25:39,819  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T22:25:39,820  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T22:25:39,820  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:39,820  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = 1 where b != 1
2024-04-23T22:25:39,820  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-38_317_6249945857886757951-1
2024-04-23T22:25:39,821  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c5069233-64a3-45a9-8671-4b739bbf58a0/hive_2024-04-23_22-25-38_317_6249945857886757951-1 on fs with scheme file
2024-04-23T22:25:39,821  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222539_d90aeb27-af4e-4527-9611-87e2beda6eb2): update acidTbl set b = 1 where b != 1
2024-04-23T22:25:39,822  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:25:39,822  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:39,829  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:39,829  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = 1 where b != 1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:25:39,830  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:25:39,831  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:39,839  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:39,839  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:39,839  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:39,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:39,847  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:39,847  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:39,847  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:39,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:39,854  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:39,854  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:39,854  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:39,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:39,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:39,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:39,937  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:25:39,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:39,947  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:39,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:39,956  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:39,957  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:25:39,965  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:39,965  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:40,054  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:40,054  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:40,054  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:40,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:40,065  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,069 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:25:40,070 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:25:40,070  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:25:40,071 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateOfInserts(TestTxnCommands.java:862)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:25:40,071  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:40,071  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getTableColumnStatistics_(String, String, List, String)=27, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=39, getValidWriteIds_(List, String)=1, getCheckConstraints_(CheckConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5}
2024-04-23T22:25:40,072  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222539_d90aeb27-af4e-4527-9611-87e2beda6eb2); Time taken: 0.25 seconds
2024-04-23T22:25:40,072  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222538_5e12c324-d780-427d-ad0b-0f4f5e78c5a1
2024-04-23T22:25:40,074  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:40,082  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:40,083  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b): drop table if exists acidTbl
2024-04-23T22:25:40,086  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T22:25:40,086  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:25:40,087  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:40,097  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,097  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:40,097  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:40,097  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:40,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getTable_(GetTableRequest)=10, openTxn_(String, TxnType)=3, flushCache_()=0, rollbackTxn_(long)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:40,098  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b); Time taken: 0.015 seconds
2024-04-23T22:25:40,098  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b
2024-04-23T22:25:40,099  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b
2024-04-23T22:25:40,118  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:25:40,118  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:40,118  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b): drop table if exists acidTbl
2024-04-23T22:25:40,118  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:40,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:40,128  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:40,138  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,138  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:40,275  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:40,275  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=147, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:40,275  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b); Time taken: 0.157 seconds
2024-04-23T22:25:40,275  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222540_2f1bdd6a-116e-43ed-8fa7-2e6b19bfb92b
2024-04-23T22:25:40,279  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:25:40,286  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:40,286  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:25:40,286  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:40,286  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222540_f50b4546-178f-4d21-866e-615868321575): drop table if exists acidTblPart
2024-04-23T22:25:40,289  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T22:25:40,289  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:25:40,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:40,297  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,298  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:40,298  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:40,298  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:40,298  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:25:40,298  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222540_f50b4546-178f-4d21-866e-615868321575); Time taken: 0.012 seconds
2024-04-23T22:25:40,298  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222540_f50b4546-178f-4d21-866e-615868321575
2024-04-23T22:25:40,299  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222540_f50b4546-178f-4d21-866e-615868321575
2024-04-23T22:25:40,317  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222540_f50b4546-178f-4d21-866e-615868321575 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:25:40,317  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:40,317  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222540_f50b4546-178f-4d21-866e-615868321575): drop table if exists acidTblPart
2024-04-23T22:25:40,318  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:40,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:40,326  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:40,333  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,333  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:40,373  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:40,373  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=47, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:40,374  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222540_f50b4546-178f-4d21-866e-615868321575); Time taken: 0.056 seconds
2024-04-23T22:25:40,374  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222540_f50b4546-178f-4d21-866e-615868321575
2024-04-23T22:25:40,377  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:25:40,384  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:40,384  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:25:40,384  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:40,385  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222540_9d6d6d20-9cdc-4d44-9e0c-128ebdcd3eba): drop table if exists acidTbl2
2024-04-23T22:25:40,387  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T22:25:40,387  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:25:40,388  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:40,388  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:40,388  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:40,388  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T22:25:40,388  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222540_9d6d6d20-9cdc-4d44-9e0c-128ebdcd3eba); Time taken: 0.003 seconds
2024-04-23T22:25:40,389  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222540_9d6d6d20-9cdc-4d44-9e0c-128ebdcd3eba
2024-04-23T22:25:40,389  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:40,389  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222540_9d6d6d20-9cdc-4d44-9e0c-128ebdcd3eba): drop table if exists acidTbl2
2024-04-23T22:25:40,389  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:40,390  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:25:40,390  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:40,390  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:40,390  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222540_9d6d6d20-9cdc-4d44-9e0c-128ebdcd3eba); Time taken: 0.001 seconds
2024-04-23T22:25:40,391  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222540_9d6d6d20-9cdc-4d44-9e0c-128ebdcd3eba
2024-04-23T22:25:40,395  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:25:40,402  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:40,402  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:25:40,402  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:40,403  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:40,405  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T22:25:40,405  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:25:40,406  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:40,430  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,430  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:40,430  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:40,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:40,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=24, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T22:25:40,430  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2); Time taken: 0.027 seconds
2024-04-23T22:25:40,431  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2
2024-04-23T22:25:40,431  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2
2024-04-23T22:25:40,446  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:25:40,446  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:40,446  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:40,446  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:40,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:40,472  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:40,491  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,492  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:40,582  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:40,582  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=109, getTable_(GetTableRequest)=26}
2024-04-23T22:25:40,582  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2); Time taken: 0.135 seconds
2024-04-23T22:25:40,582  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222540_a3450e18-baa7-4ae1-8932-6ca12138cba2
2024-04-23T22:25:40,586  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:25:40,592  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:40,592  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:25:40,593  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:40,593  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:40,595  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T22:25:40,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:25:40,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:40,609  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,609  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:40,609  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:40,609  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:40,609  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:25:40,610  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433); Time taken: 0.016 seconds
2024-04-23T22:25:40,610  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433
2024-04-23T22:25:40,611  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433
2024-04-23T22:25:40,625  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T22:25:40,625  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:40,625  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:40,625  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:40,626  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:40,634  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,634  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:40,643  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:40,671  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:40,671  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=37, isCompatibleWith_(Configuration)=1}
2024-04-23T22:25:40,671  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433); Time taken: 0.046 seconds
2024-04-23T22:25:40,671  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222540_14484bde-b322-414e-bee0-dccf307de433
2024-04-23T22:25:40,674  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:25:40,679  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:40,679  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:25:40,680  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:40,680  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a): drop table if exists nonAcidNonBucket
2024-04-23T22:25:40,682  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T22:25:40,682  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:25:40,683  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:40,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,691  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:40,691  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:40,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:40,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=8, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=1}
2024-04-23T22:25:40,692  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a); Time taken: 0.011 seconds
2024-04-23T22:25:40,692  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a
2024-04-23T22:25:40,692  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a
2024-04-23T22:25:40,705  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T22:25:40,705  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:40,705  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a): drop table if exists nonAcidNonBucket
2024-04-23T22:25:40,705  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:40,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:40,713  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:40,722  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:40,722  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:40,760  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:40,760  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=46, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:40,760  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a); Time taken: 0.055 seconds
2024-04-23T22:25:40,760  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222540_9a3b9a77-e791-42f7-9643-41a1b9d5ca0a
2024-04-23T22:25:40,764  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:25:40,768  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:40,769  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:25:40,769  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="exchangePartitionShouldNotWorkForTransactionalTables" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.528"/>
  <testcase name="testMergeNegative2" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.252"/>
  <testcase name="testCompactionBlocking" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="6.133"/>
  <testcase name="testVersioningVersionFileDisabled" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.12">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update T set a=3 where b=2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:25:49,739  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:25:49,739  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:25:49,739  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:25:49,739  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:25:49,739  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:25:49,740  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:25:49,740  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:25:49,740  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:25:49,740  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:25:49,740  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:25:49,740  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:25:49,742  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = dca82eec-e14a-4371-b604-3b0d8edf3f27
2024-04-23T22:25:49,744  INFO [main] SessionState: Hive Session ID = dca82eec-e14a-4371-b604-3b0d8edf3f27
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:49,744  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:49,749  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dca82eec-e14a-4371-b604-3b0d8edf3f27
2024-04-23T22:25:49,752  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27
2024-04-23T22:25:49,754  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dca82eec-e14a-4371-b604-3b0d8edf3f27/_tmp_space.db
2024-04-23T22:25:49,754  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=dca82eec-e14a-4371-b604-3b0d8edf3f27, clientType=HIVECLI]
2024-04-23T22:25:49,754  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:49,755  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_f71a4d5a-d302-436f-8aac-ba73113326d8): drop table if exists acidTbl
2024-04-23T22:25:49,762  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:25:49,762  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:25:49,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:49,768  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,768  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,768  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,768  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=3, flushCache_()=0, openTxn_(String, TxnType)=7, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,768  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_f71a4d5a-d302-436f-8aac-ba73113326d8); Time taken: 0.013 seconds
2024-04-23T22:25:49,768  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222549_f71a4d5a-d302-436f-8aac-ba73113326d8
2024-04-23T22:25:49,768  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:49,768  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_f71a4d5a-d302-436f-8aac-ba73113326d8): drop table if exists acidTbl
2024-04-23T22:25:49,769  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:49,772  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:49,772  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,772  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_f71a4d5a-d302-436f-8aac-ba73113326d8); Time taken: 0.004 seconds
2024-04-23T22:25:49,772  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_f71a4d5a-d302-436f-8aac-ba73113326d8
2024-04-23T22:25:49,778  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:25:49,784  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:49,784  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:25:49,785  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:49,785  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_63b28350-9978-47f0-b74e-d2e86835015b): drop table if exists acidTblPart
2024-04-23T22:25:49,787  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:25:49,788  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:25:49,788  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:49,791  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,791  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,791  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,791  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:25:49,792  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_63b28350-9978-47f0-b74e-d2e86835015b); Time taken: 0.006 seconds
2024-04-23T22:25:49,792  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222549_63b28350-9978-47f0-b74e-d2e86835015b
2024-04-23T22:25:49,792  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:49,792  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_63b28350-9978-47f0-b74e-d2e86835015b): drop table if exists acidTblPart
2024-04-23T22:25:49,792  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,792  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:49,795  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:49,795  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,795  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_63b28350-9978-47f0-b74e-d2e86835015b); Time taken: 0.003 seconds
2024-04-23T22:25:49,795  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_63b28350-9978-47f0-b74e-d2e86835015b
2024-04-23T22:25:49,800  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:25:49,805  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:49,805  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:25:49,806  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:49,806  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_1641d639-d034-46a2-b296-f49c11509912): drop table if exists acidTbl2
2024-04-23T22:25:49,808  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:25:49,808  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:25:49,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:49,811  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,811  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,811  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,812  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:25:49,812  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_1641d639-d034-46a2-b296-f49c11509912); Time taken: 0.005 seconds
2024-04-23T22:25:49,812  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222549_1641d639-d034-46a2-b296-f49c11509912
2024-04-23T22:25:49,812  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:49,812  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_1641d639-d034-46a2-b296-f49c11509912): drop table if exists acidTbl2
2024-04-23T22:25:49,812  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:49,815  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:49,816  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,816  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_1641d639-d034-46a2-b296-f49c11509912); Time taken: 0.003 seconds
2024-04-23T22:25:49,816  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_1641d639-d034-46a2-b296-f49c11509912
2024-04-23T22:25:49,820  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:25:49,825  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:49,825  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:25:49,826  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:49,826  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_52d8c4f2-eec2-4031-937d-5932886cb923): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:49,828  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:25:49,828  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:25:49,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:49,832  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,832  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,832  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,832  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,832  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_52d8c4f2-eec2-4031-937d-5932886cb923); Time taken: 0.006 seconds
2024-04-23T22:25:49,832  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222549_52d8c4f2-eec2-4031-937d-5932886cb923
2024-04-23T22:25:49,832  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:49,832  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_52d8c4f2-eec2-4031-937d-5932886cb923): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:49,833  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:49,835  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:49,836  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,836  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_52d8c4f2-eec2-4031-937d-5932886cb923); Time taken: 0.003 seconds
2024-04-23T22:25:49,836  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_52d8c4f2-eec2-4031-937d-5932886cb923
2024-04-23T22:25:49,840  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:25:49,845  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:49,845  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:25:49,846  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:49,846  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_7576c8ac-bf52-412d-bafc-10694e18f9a8): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:49,848  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:25:49,848  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:25:49,849  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:49,852  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,852  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,852  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,852  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:25:49,852  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_7576c8ac-bf52-412d-bafc-10694e18f9a8); Time taken: 0.006 seconds
2024-04-23T22:25:49,852  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222549_7576c8ac-bf52-412d-bafc-10694e18f9a8
2024-04-23T22:25:49,852  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:49,852  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_7576c8ac-bf52-412d-bafc-10694e18f9a8): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:49,853  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,853  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:49,855  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:49,855  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,856  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_7576c8ac-bf52-412d-bafc-10694e18f9a8); Time taken: 0.003 seconds
2024-04-23T22:25:49,856  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_7576c8ac-bf52-412d-bafc-10694e18f9a8
2024-04-23T22:25:49,860  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:25:49,865  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:49,865  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:25:49,866  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:49,866  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_91d83cf2-05ce-4a99-8dd5-86d0d7dd24b4): drop table if exists nonAcidNonBucket
2024-04-23T22:25:49,868  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:25:49,868  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:25:49,869  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:49,872  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,872  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,872  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,872  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:25:49,872  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_91d83cf2-05ce-4a99-8dd5-86d0d7dd24b4); Time taken: 0.006 seconds
2024-04-23T22:25:49,872  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222549_91d83cf2-05ce-4a99-8dd5-86d0d7dd24b4
2024-04-23T22:25:49,872  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:49,872  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_91d83cf2-05ce-4a99-8dd5-86d0d7dd24b4): drop table if exists nonAcidNonBucket
2024-04-23T22:25:49,872  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:49,875  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:49,875  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,876  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_91d83cf2-05ce-4a99-8dd5-86d0d7dd24b4); Time taken: 0.003 seconds
2024-04-23T22:25:49,876  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_91d83cf2-05ce-4a99-8dd5-86d0d7dd24b4
2024-04-23T22:25:49,880  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:25:49,885  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:49,885  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:25:49,886  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:49,886  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:49,888  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:25:49,888  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:25:49,889  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:49,889  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:49,893  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:25:49,894  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:49,895  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:49,895  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,895  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,896  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,896  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=1, flushCache_()=0, openTxn_(String, TxnType)=1, getValidTxns_(long)=0}
2024-04-23T22:25:49,896  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270); Time taken: 0.01 seconds
2024-04-23T22:25:49,896  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270
2024-04-23T22:25:49,896  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270
2024-04-23T22:25:49,918  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:25:49,918  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:49,919  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:49,919  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,920  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936349, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFilesErasureCoded=0, numFiles=0, totalSize=0, numRows=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:49,926  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:49,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:49,958  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=37, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:49,958  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270); Time taken: 0.038 seconds
2024-04-23T22:25:49,958  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_0ceb880e-1714-4340-a6a1-b0d3e407c270
2024-04-23T22:25:49,962  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:25:49,967  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:49,967  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:25:49,968  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:49,968  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:49,971  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:25:49,971  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:25:49,972  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:49,972  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:49,974  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:25:49,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:49,976  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:49,976  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:49,976  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:49,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:49,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2}
2024-04-23T22:25:49,977  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2); Time taken: 0.008 seconds
2024-04-23T22:25:49,977  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2
2024-04-23T22:25:49,977  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2
2024-04-23T22:25:49,991  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:25:49,991  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:49,992  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:49,992  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:49,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936349, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:49,998  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:25:50,026  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:50,026  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=33, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:50,027  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2); Time taken: 0.034 seconds
2024-04-23T22:25:50,027  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222549_45f160c6-4efa-4a1a-8dd5-b4a23dfaa6b2
2024-04-23T22:25:50,030  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:25:50,036  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:50,036  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:25:50,037  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,037  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,040  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:25:50,040  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:25:50,041  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:50,041  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:50,044  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:25:50,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:50,046  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:50,046  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:50,046  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:50,046  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:50,046  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:25:50,046  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a); Time taken: 0.009 seconds
2024-04-23T22:25:50,047  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a
2024-04-23T22:25:50,047  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a
2024-04-23T22:25:50,061  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:25:50,061  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:50,061  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,061  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:50,062  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936350, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numRows=0, bucketing_version=2, numFiles=0, rawDataSize=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:50,068  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:25:50,086  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:50,086  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:50,086  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a); Time taken: 0.025 seconds
2024-04-23T22:25:50,086  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222550_6376ddcf-9c41-46bf-a877-99c260626b2a
2024-04-23T22:25:50,090  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:25:50,096  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:50,096  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:25:50,096  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,097  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,099  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:25:50,099  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:25:50,100  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:50,100  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:50,102  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:25:50,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:50,104  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:50,104  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:50,104  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:50,104  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:50,104  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-23T22:25:50,104  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52); Time taken: 0.007 seconds
2024-04-23T22:25:50,105  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52
2024-04-23T22:25:50,105  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52
2024-04-23T22:25:50,118  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:25:50,118  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:50,119  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,119  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:50,120  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936350, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, bucketing_version=2, numFilesErasureCoded=0, rawDataSize=0, totalSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:50,125  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:25:50,138  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:50,138  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:50,139  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52); Time taken: 0.019 seconds
2024-04-23T22:25:50,139  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222550_78d89ea4-93fc-4fff-a37f-aa0a7aa8dd52
2024-04-23T22:25:50,142  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:25:50,148  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:50,148  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:25:50,148  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:50,149  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:50,151  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:25:50,151  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:25:50,152  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:50,152  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:50,154  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:25:50,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:50,156  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:50,156  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:50,156  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:50,156  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:50,156  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:50,156  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255); Time taken: 0.007 seconds
2024-04-23T22:25:50,157  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255
2024-04-23T22:25:50,157  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255
2024-04-23T22:25:50,172  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:25:50,172  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:50,173  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:50,173  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:50,174  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dca82eec-e14a-4371-b604-3b0d8edf3f27/_tmp_space.db/d2491b7d-e7f0-4140-abe6-acbc75c362c2
2024-04-23T22:25:50,177  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:50,177  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:25:50,177  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255); Time taken: 0.004 seconds
2024-04-23T22:25:50,177  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222550_2d3b592c-c5c2-4d89-8022-776a959d9255
2024-04-23T22:25:50,182  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:25:50,188  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:50,188  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:25:50,188  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,189  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,191  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:25:50,191  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:25:50,192  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:50,192  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:50,195  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:25:50,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:50,197  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:50,197  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:50,197  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:50,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:50,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0}
2024-04-23T22:25:50,197  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4); Time taken: 0.008 seconds
2024-04-23T22:25:50,197  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4
2024-04-23T22:25:50,198  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4
2024-04-23T22:25:50,211  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:25:50,211  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:50,211  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:50,212  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:50,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936350, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, transactional=false, rawDataSize=0, numFilesErasureCoded=0, bucketing_version=2, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:50,218  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:25:50,234  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:50,234  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T22:25:50,234  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4); Time taken: 0.023 seconds
2024-04-23T22:25:50,234  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222550_b460b6e8-af10-47dd-a5e5-0db218b1c5f4
2024-04-23T22:25:50,238  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:25:50,245  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:50,245  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:25:50,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T22:25:50,246  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@70c6851, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@321fe2e5 will be shutdown
2024-04-23T22:25:50,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T22:25:50,246  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -8
2024-04-23T22:25:50,246  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T22:25:50,246  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222550_81738098-92aa-4205-b8e8-df09031ab0d3): drop table if exists T
2024-04-23T22:25:50,247  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T22:25:50,248  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T22:25:50,248  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T22:25:50,248  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@66e8867e, with PersistenceManager: null will be shutdown
2024-04-23T22:25:50,249  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@66e8867e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@29e509b0 created in the thread with id: 1
2024-04-23T22:25:50,271  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@66e8867e from thread id: 1
2024-04-23T22:25:50,271  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T22:25:50,271  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T22:25:50,273  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:25:50,273  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:25:50,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:50,276  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:50,276  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:50,276  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:50,276  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:50,277  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222550_81738098-92aa-4205-b8e8-df09031ab0d3); Time taken: 0.03 seconds
2024-04-23T22:25:50,277  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222550_81738098-92aa-4205-b8e8-df09031ab0d3
2024-04-23T22:25:50,277  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:50,277  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222550_81738098-92aa-4205-b8e8-df09031ab0d3): drop table if exists T
2024-04-23T22:25:50,277  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:50,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:50,279  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:50,279  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:50,280  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222550_81738098-92aa-4205-b8e8-df09031ab0d3); Time taken: 0.002 seconds
2024-04-23T22:25:50,280  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222550_81738098-92aa-4205-b8e8-df09031ab0d3
2024-04-23T22:25:50,285  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:25:50,291  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:50,291  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:25:50,292  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) stored as orc
2024-04-23T22:25:50,292  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145): create table T (a int, b int) stored as orc
2024-04-23T22:25:50,294  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:25:50,294  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:25:50,295  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:50,295  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:50,301  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T22:25:50,301  INFO [main] parse.CalcitePlanner: Automatically chose to make default.T acid.
2024-04-23T22:25:50,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:50,302  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:50,302  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:50,302  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:50,303  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:50,303  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=1, getValidWriteIds_(List, String)=6, getDatabase_(String)=1, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1}
2024-04-23T22:25:50,303  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145); Time taken: 0.011 seconds
2024-04-23T22:25:50,303  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145
2024-04-23T22:25:50,303  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145
2024-04-23T22:25:50,321  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:25:50,321  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:50,321  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145): create table T (a int, b int) stored as orc
2024-04-23T22:25:50,321  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:50,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713936350, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, transactional=true, totalSize=0, transactional_properties=default, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:50,328  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:25:50,360  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:50,360  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=38}
2024-04-23T22:25:50,361  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145); Time taken: 0.039 seconds
2024-04-23T22:25:50,361  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222550_24a96785-17eb-4d44-bd89-2dd5a210b145
2024-04-23T22:25:50,365  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:25:50,373  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:50,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:25:50,374  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into T values(1,2)
2024-04-23T22:25:50,374  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab): insert into T values(1,2)
2024-04-23T22:25:50,376  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T22:25:50,377  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:25:50,377  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:50,377  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:50,381  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:50,402  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:50,402  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:50,402  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:50,402  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:50,402  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:50,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:50,410  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:50,410  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:50,410  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:50,431  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:50,506  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:50,506  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:50,506  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:50,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:50,508  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:50,508  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:50,508  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:50,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:50,515  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:50,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T22:25:50,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T22:25:50,525  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 15
2024-04-23T22:25:50,526  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [15])
2024-04-23T22:25:50,526  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:50,529  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:25:50,529  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:50,538  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:50,545  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:50,546  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:50,546  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:50,546  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:50,546  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:25:50,546  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:50,546  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=43, allocateTableWriteId_(long, String, String)=8, getAllTableConstraints_(AllTableConstraintsRequest)=30, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13}
2024-04-23T22:25:50,546  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab); Time taken: 0.172 seconds
2024-04-23T22:25:50,546  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab
2024-04-23T22:25:50,546  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab
2024-04-23T22:25:50,562  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:25:50,562  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:50,565  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab): insert into T values(1,2)
2024-04-23T22:25:50,565  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab
2024-04-23T22:25:50,565  INFO [main] ql.Driver: Query ID = alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab
Total jobs = 1
2024-04-23T22:25:50,566  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:50,566  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:50,696  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:25:50,696  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:25:50,698  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:50,698  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:25:50,698  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27/hive_2024-04-23_22-25-50_374_1792564568050359452-1/dummy_path
2024-04-23T22:25:50,707  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:50,708  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T22:25:50,709  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:50,713  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27/hive_2024-04-23_22-25-50_374_1792564568050359452-1/-mr-10000
2024-04-23T22:25:50,715  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:50,721  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:50,725  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:50,727  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:25:50,727  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:25:50,727  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27/hive_2024-04-23_22-25-50_374_1792564568050359452-1/dummy_path
2024-04-23T22:25:50,727  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:25:50,745  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:25:50,763  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1362331328_0034
2024-04-23T22:25:50,763  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:50,827  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:50,827  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:50,827  INFO [Thread-2826] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:50,828  INFO [Thread-2826] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:50,829  INFO [Thread-2826] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:50,829  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1362331328_0034_m_000000_0
2024-04-23T22:25:50,832  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:50,832  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27/hive_2024-04-23_22-25-50_374_1792564568050359452-1/dummy_path/null:0+1
2024-04-23T22:25:50,834  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:50,835  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T22:25:50,835  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T22:25:50,837  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:50,837  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:25:50,838  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1362331328_0034/job_local1362331328_0034.xml], properties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@105a684
2024-04-23T22:25:50,839  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:25:50,839  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:25:50,839  INFO [LocalJobRunner Map Task Executor #0] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:50,841  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:25:50,841  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:25:50,848  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:50,849  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:25:50,849  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:25:50,849  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:50,849  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:50,849  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:50,849  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:25:50,849  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:25:50,850  INFO [LocalJobRunner Map Task Executor #0] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:25:50,861  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.t:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_4:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:50,862  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:50,864  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1362331328_0034_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:50,864  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:25:50,864  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1362331328_0034_m_000000_0' done.
2024-04-23T22:25:50,864  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1362331328_0034_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=710400
		FILE: Number of bytes written=40090151
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1247281152
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.t=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	File Input Format Counters 
		Bytes Read=5403
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:50,864  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1362331328_0034_m_000000_0
2024-04-23T22:25:50,864  INFO [Thread-2826] mapred.LocalJobRunner: map task executor complete.
2024-04-23 22:25:51,830 Stage-1 map = 100%,  reduce = 0%
2024-04-23T22:25:51,830  INFO [main] exec.Task: 2024-04-23 22:25:51,830 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1362331328_0034
2024-04-23T22:25:51,831  INFO [main] exec.Task: Ended Job = job_local1362331328_0034
2024-04-23T22:25:51,832  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:25:51,833  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:25:51,833  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000
2024-04-23T22:25:51,834  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.t
2024-04-23T22:25:51,834  INFO [main] exec.Task: Loading data to table default.t from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:25:51,834  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:51,840  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:51,847  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T22:25:51,875  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:25:51,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:51,880  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,881  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:25:51,881  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27/hive_2024-04-23_22-25-50_374_1792564568050359452-1/-mr-10000
2024-04-23T22:25:51,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:51,888  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,894  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:25:51,894  INFO [main] FileOperations: Read stats for default.t/, numRows, true, 1, false: 
2024-04-23T22:25:51,894  INFO [main] FileOperations: Read stats for default.t/, rawDataSize, true, 0, false: 
2024-04-23T22:25:51,894  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T22:25:51,914  INFO [main] FileOperations: Read stats for default.t/, insertCount, true, 1, false: 
2024-04-23T22:25:51,914  INFO [main] FileOperations: Read stats for default.t/, updateCount, true, 0, false: 
2024-04-23T22:25:51,914  INFO [main] FileOperations: Read stats for default.t/, deleteCount, true, 0, false: 
2024-04-23T22:25:51,916  INFO [main] stats.BasicStatsTask: Table default.t stats: [numFiles=1, numRows=1, totalSize=666, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:25:51,917  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:51,917  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, getTable_(GetTableRequest)=25, alter_table_(String, String, String, Table, EnvironmentContext, String)=47, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:25:51,917  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:51,917  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:51,918  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:51,918  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab); Time taken: 1.352 seconds
2024-04-23T22:25:51,918  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222550_891d2a18-8969-4c8d-9b9a-0ed752b8afab
2024-04-23T22:25:51,928  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:51,928  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:25:51,928  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update T set a=3 where b=2
2024-04-23T22:25:51,929  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27/hive_2024-04-23_22-25-50_374_1792564568050359452-1
2024-04-23T22:25:51,929  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dca82eec-e14a-4371-b604-3b0d8edf3f27/hive_2024-04-23_22-25-50_374_1792564568050359452-1 on fs with scheme file
2024-04-23T22:25:51,930  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222551_6842a9ad-9bd1-41bd-8371-c0b75fef3633): update T set a=3 where b=2
2024-04-23T22:25:51,933  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T22:25:51,934  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:25:51,934  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:25:51,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:51,942  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,942  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update T set a=3 where b=2> as 
<insert into table `default`.`T` select ROW__ID,`a`,`b` from `default`.`T` sort by ROW__ID >
2024-04-23T22:25:51,943  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:25:51,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:51,953  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,954  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:51,954  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:51,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:51,961  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,962  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:51,962  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:51,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:51,970  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:51,970  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:51,970  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:51,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T22:25:51,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T22:25:51,991  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T22:25:52,022  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [1], allowMissingStats: true
2024-04-23T22:25:52,022  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:52,032  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,033  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:25:52,042  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.t	
2024-04-23T22:25:52,053  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b
No Stats for default@t, Columns: b
2024-04-23T22:25:52,053  INFO [main] SessionState: No Stats for default@t, Columns: b
2024-04-23T22:25:52,119  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:52,119  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:52,119  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:52,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:25:52,126  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,129 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:25:52,130 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:25:52,130  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:25:52,131 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileDisabled(TestTxnCommands.java:1467)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:25:52,131  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,131  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=37, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=4, getAllTableConstraints_(AllTableConstraintsRequest)=5, getValidTxns_(long)=0, getTableColumnStatistics_(String, String, List, String)=31}
2024-04-23T22:25:52,131  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222551_6842a9ad-9bd1-41bd-8371-c0b75fef3633); Time taken: 0.201 seconds
2024-04-23T22:25:52,131  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:25:52,135  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:52,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b): drop table if exists acidTbl
2024-04-23T22:25:52,144  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T22:25:52,144  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:25:52,145  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:52,152  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,152  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,152  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,152  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,152  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=7, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T22:25:52,152  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b); Time taken: 0.01 seconds
2024-04-23T22:25:52,153  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b
2024-04-23T22:25:52,153  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b
2024-04-23T22:25:52,169  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:25:52,169  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:52,169  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b): drop table if exists acidTbl
2024-04-23T22:25:52,169  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:52,175  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:52,182  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,182  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:52,284  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,285  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=108, getTable_(GetTableRequest)=6}
2024-04-23T22:25:52,285  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b); Time taken: 0.115 seconds
2024-04-23T22:25:52,285  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_c9b86045-9fe2-4cca-b75f-ad61e44fe12b
2024-04-23T22:25:52,289  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:25:52,296  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,299  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:25:52,300  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:52,300  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83): drop table if exists acidTblPart
2024-04-23T22:25:52,303  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T22:25:52,304  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:25:52,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:52,316  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,316  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,316  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,316  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,316  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T22:25:52,317  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83); Time taken: 0.016 seconds
2024-04-23T22:25:52,317  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83
2024-04-23T22:25:52,318  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83
2024-04-23T22:25:52,341  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:25:52,341  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:52,341  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83): drop table if exists acidTblPart
2024-04-23T22:25:52,341  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:52,352  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,352  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:52,361  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,362  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:52,409  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,409  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=11, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=57}
2024-04-23T22:25:52,410  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83); Time taken: 0.068 seconds
2024-04-23T22:25:52,410  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_1a3d33e9-48a0-4ee1-a358-140c2870eb83
2024-04-23T22:25:52,414  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:25:52,421  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,421  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:25:52,421  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:52,422  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_b201d9f2-1475-44bd-903e-8b323dcc8b6f): drop table if exists acidTbl2
2024-04-23T22:25:52,424  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T22:25:52,425  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:25:52,425  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,425  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,425  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,426  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getTable_(GetTableRequest)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:52,426  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_b201d9f2-1475-44bd-903e-8b323dcc8b6f); Time taken: 0.003 seconds
2024-04-23T22:25:52,426  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222552_b201d9f2-1475-44bd-903e-8b323dcc8b6f
2024-04-23T22:25:52,426  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:52,426  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_b201d9f2-1475-44bd-903e-8b323dcc8b6f): drop table if exists acidTbl2
2024-04-23T22:25:52,426  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,427  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:25:52,427  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,427  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=0}
2024-04-23T22:25:52,428  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_b201d9f2-1475-44bd-903e-8b323dcc8b6f); Time taken: 0.001 seconds
2024-04-23T22:25:52,428  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_b201d9f2-1475-44bd-903e-8b323dcc8b6f
2024-04-23T22:25:52,433  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:25:52,443  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,443  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:25:52,444  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:52,444  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:52,447  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T22:25:52,448  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:25:52,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:52,473  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,473  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,473  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,473  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,474  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=25, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=16}
2024-04-23T22:25:52,474  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c); Time taken: 0.029 seconds
2024-04-23T22:25:52,474  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c
2024-04-23T22:25:52,475  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c
2024-04-23T22:25:52,488  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:25:52,489  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:52,489  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:52,489  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:52,497  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:52,506  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:52,595  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,596  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=97}
2024-04-23T22:25:52,596  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c); Time taken: 0.106 seconds
2024-04-23T22:25:52,596  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_43303f3f-9eca-4e92-8216-b18fc522198c
2024-04-23T22:25:52,600  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:25:52,605  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,605  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:25:52,606  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:52,606  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:52,614  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T22:25:52,615  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:25:52,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:52,626  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,626  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,626  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,626  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,626  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=9, flushCache_()=0, getValidTxns_(long)=2}
2024-04-23T22:25:52,626  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33); Time taken: 0.02 seconds
2024-04-23T22:25:52,627  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33
2024-04-23T22:25:52,627  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33
2024-04-23T22:25:52,642  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:25:52,642  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:52,642  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:52,642  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:52,651  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,651  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:52,659  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:52,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=40}
2024-04-23T22:25:52,691  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33); Time taken: 0.049 seconds
2024-04-23T22:25:52,691  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_9a021301-8274-47a4-a7e2-9330751a4e33
2024-04-23T22:25:52,695  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:25:52,703  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,703  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:25:52,704  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:52,704  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512): drop table if exists nonAcidNonBucket
2024-04-23T22:25:52,707  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 16
2024-04-23T22:25:52,707  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T22:25:52,708  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:52,717  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,718  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,718  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,718  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,718  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1}
2024-04-23T22:25:52,718  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512); Time taken: 0.014 seconds
2024-04-23T22:25:52,718  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512
2024-04-23T22:25:52,719  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512
2024-04-23T22:25:52,735  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:25:52,735  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:52,735  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512): drop table if exists nonAcidNonBucket
2024-04-23T22:25:52,736  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,736  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:52,745  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,745  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:52,755  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:52,755  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:52,789  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,789  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-23T22:25:52,789  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512); Time taken: 0.054 seconds
2024-04-23T22:25:52,789  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_59407dc8-73aa-4893-9f93-60a0a4292512
2024-04-23T22:25:52,793  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T22:25:52,799  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,799  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T22:25:52,800  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMultipleDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.419">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 8 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:25:52,860  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:25:52,860  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:25:52,860  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:25:52,861  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:25:52,863  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 2f63e2c5-2707-4403-aaf6-63b03fff9599
2024-04-23T22:25:52,866  INFO [main] SessionState: Hive Session ID = 2f63e2c5-2707-4403-aaf6-63b03fff9599
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:52,866  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:25:52,871  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/2f63e2c5-2707-4403-aaf6-63b03fff9599
2024-04-23T22:25:52,874  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599
2024-04-23T22:25:52,876  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/2f63e2c5-2707-4403-aaf6-63b03fff9599/_tmp_space.db
2024-04-23T22:25:52,876  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=2f63e2c5-2707-4403-aaf6-63b03fff9599, clientType=HIVECLI]
2024-04-23T22:25:52,877  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:52,877  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_ba9ab546-03c2-48bc-b4e8-fb281ee15d31): drop table if exists acidTbl
2024-04-23T22:25:52,884  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:25:52,884  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:25:52,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:52,890  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,891  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,891  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,891  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=7, flushCache_()=0}
2024-04-23T22:25:52,891  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_ba9ab546-03c2-48bc-b4e8-fb281ee15d31); Time taken: 0.014 seconds
2024-04-23T22:25:52,891  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222552_ba9ab546-03c2-48bc-b4e8-fb281ee15d31
2024-04-23T22:25:52,891  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:52,892  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_ba9ab546-03c2-48bc-b4e8-fb281ee15d31): drop table if exists acidTbl
2024-04-23T22:25:52,892  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,892  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:52,895  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,895  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:52,896  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_ba9ab546-03c2-48bc-b4e8-fb281ee15d31); Time taken: 0.004 seconds
2024-04-23T22:25:52,896  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_ba9ab546-03c2-48bc-b4e8-fb281ee15d31
2024-04-23T22:25:52,901  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:25:52,906  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,907  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:25:52,907  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:52,907  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_35f616f1-6e12-4a1e-91ba-cd3e6b99d319): drop table if exists acidTblPart
2024-04-23T22:25:52,909  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:25:52,910  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:25:52,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:52,913  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,913  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,913  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,913  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T22:25:52,914  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_35f616f1-6e12-4a1e-91ba-cd3e6b99d319); Time taken: 0.006 seconds
2024-04-23T22:25:52,914  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222552_35f616f1-6e12-4a1e-91ba-cd3e6b99d319
2024-04-23T22:25:52,914  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:52,914  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_35f616f1-6e12-4a1e-91ba-cd3e6b99d319): drop table if exists acidTblPart
2024-04-23T22:25:52,914  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:52,918  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,918  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:52,918  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_35f616f1-6e12-4a1e-91ba-cd3e6b99d319); Time taken: 0.004 seconds
2024-04-23T22:25:52,918  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_35f616f1-6e12-4a1e-91ba-cd3e6b99d319
2024-04-23T22:25:52,923  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:25:52,928  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,928  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:25:52,929  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:52,929  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_198147a4-6aef-4bd8-9f5e-9a71e1a16fca): drop table if exists acidTbl2
2024-04-23T22:25:52,931  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:25:52,931  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:25:52,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:52,934  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,934  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,934  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,934  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:25:52,935  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_198147a4-6aef-4bd8-9f5e-9a71e1a16fca); Time taken: 0.005 seconds
2024-04-23T22:25:52,935  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222552_198147a4-6aef-4bd8-9f5e-9a71e1a16fca
2024-04-23T22:25:52,935  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:52,935  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_198147a4-6aef-4bd8-9f5e-9a71e1a16fca): drop table if exists acidTbl2
2024-04-23T22:25:52,935  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:25:52,938  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,938  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:52,938  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_198147a4-6aef-4bd8-9f5e-9a71e1a16fca); Time taken: 0.003 seconds
2024-04-23T22:25:52,938  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_198147a4-6aef-4bd8-9f5e-9a71e1a16fca
2024-04-23T22:25:52,943  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:25:52,948  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,948  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:25:52,948  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:52,948  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_70a3d5a8-c03b-4a78-9b84-7acd40667025): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:52,950  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:25:52,951  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:25:52,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:52,955  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,955  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:25:52,955  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_70a3d5a8-c03b-4a78-9b84-7acd40667025); Time taken: 0.007 seconds
2024-04-23T22:25:52,955  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222552_70a3d5a8-c03b-4a78-9b84-7acd40667025
2024-04-23T22:25:52,955  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:52,956  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_70a3d5a8-c03b-4a78-9b84-7acd40667025): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:52,956  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,956  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:52,959  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,959  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:52,959  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_70a3d5a8-c03b-4a78-9b84-7acd40667025); Time taken: 0.003 seconds
2024-04-23T22:25:52,959  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_70a3d5a8-c03b-4a78-9b84-7acd40667025
2024-04-23T22:25:52,965  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:25:52,970  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,970  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:25:52,970  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:52,971  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_bfc67b29-035d-4fbd-bf63-ad1f00847899): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:52,973  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:25:52,973  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:25:52,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:52,976  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:52,977  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:52,977  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:52,977  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:52,977  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_bfc67b29-035d-4fbd-bf63-ad1f00847899); Time taken: 0.006 seconds
2024-04-23T22:25:52,977  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222552_bfc67b29-035d-4fbd-bf63-ad1f00847899
2024-04-23T22:25:52,977  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:52,977  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_bfc67b29-035d-4fbd-bf63-ad1f00847899): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:52,978  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:52,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:52,981  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:52,981  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:52,981  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_bfc67b29-035d-4fbd-bf63-ad1f00847899); Time taken: 0.004 seconds
2024-04-23T22:25:52,981  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_bfc67b29-035d-4fbd-bf63-ad1f00847899
2024-04-23T22:25:52,986  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:25:52,992  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:52,992  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:25:52,993  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:52,993  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222552_5a409a84-ccea-4d82-9756-61465db4d6f2): drop table if exists nonAcidNonBucket
2024-04-23T22:25:52,995  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:25:52,996  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:25:52,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:53,000  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,000  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:53,000  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,000  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:53,000  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222552_5a409a84-ccea-4d82-9756-61465db4d6f2); Time taken: 0.007 seconds
2024-04-23T22:25:53,001  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222552_5a409a84-ccea-4d82-9756-61465db4d6f2
2024-04-23T22:25:53,001  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:53,001  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222552_5a409a84-ccea-4d82-9756-61465db4d6f2): drop table if exists nonAcidNonBucket
2024-04-23T22:25:53,001  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:53,001  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:53,004  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:53,005  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:53,005  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222552_5a409a84-ccea-4d82-9756-61465db4d6f2); Time taken: 0.003 seconds
2024-04-23T22:25:53,005  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222552_5a409a84-ccea-4d82-9756-61465db4d6f2
2024-04-23T22:25:53,010  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:25:53,015  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:53,015  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:25:53,016  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,016  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,018  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:25:53,018  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:25:53,019  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:53,019  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:53,024  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:25:53,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:53,026  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:53,026  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,026  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:53,026  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,026  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:53,026  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929); Time taken: 0.01 seconds
2024-04-23T22:25:53,027  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929
2024-04-23T22:25:53,027  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929
2024-04-23T22:25:53,044  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:25:53,044  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:53,045  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,045  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:53,046  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936353, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFilesErasureCoded=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:53,050  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:53,081  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:53,082  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=36}
2024-04-23T22:25:53,082  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929); Time taken: 0.036 seconds
2024-04-23T22:25:53,082  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222553_9677d378-095e-4c0c-93e0-9fa2692d2929
2024-04-23T22:25:53,085  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:25:53,090  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:53,090  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:25:53,091  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,091  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,093  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:25:53,094  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:25:53,094  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:53,094  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:53,097  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:25:53,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:53,099  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:53,099  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,099  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:53,099  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,099  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:53,099  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc); Time taken: 0.008 seconds
2024-04-23T22:25:53,099  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc
2024-04-23T22:25:53,100  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc
2024-04-23T22:25:53,113  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:25:53,113  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:53,113  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,114  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:53,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936353, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:25:53,119  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:25:53,136  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:53,136  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T22:25:53,136  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc); Time taken: 0.023 seconds
2024-04-23T22:25:53,137  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222553_64a836e8-9d09-425e-be29-7f37093f75cc
2024-04-23T22:25:53,141  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:25:53,147  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:53,147  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:25:53,147  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,148  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,150  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:25:53,150  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:25:53,151  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:53,151  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:53,153  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:25:53,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:53,155  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:53,155  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,155  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:53,156  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,156  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2}
2024-04-23T22:25:53,156  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a); Time taken: 0.008 seconds
2024-04-23T22:25:53,156  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a
2024-04-23T22:25:53,157  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a
2024-04-23T22:25:53,170  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:25:53,170  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:53,170  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,171  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:53,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936353, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2, transactional=false, numFiles=0, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:53,176  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:25:53,190  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:53,190  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=19}
2024-04-23T22:25:53,190  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a); Time taken: 0.02 seconds
2024-04-23T22:25:53,190  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222553_e6e8b3ee-ee94-4e10-9113-e4cd1a901c3a
2024-04-23T22:25:53,194  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:25:53,199  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:53,199  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:25:53,200  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,200  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,202  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:25:53,203  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:25:53,203  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:53,203  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:53,206  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:25:53,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:53,208  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:53,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:53,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,208  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T22:25:53,208  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4); Time taken: 0.008 seconds
2024-04-23T22:25:53,209  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4
2024-04-23T22:25:53,209  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4
2024-04-23T22:25:53,223  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:25:53,223  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:53,223  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,223  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:53,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936353, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2, numFilesErasureCoded=0, numFiles=0, transactional=false, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:53,228  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:25:53,243  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:53,243  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:53,244  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4); Time taken: 0.02 seconds
2024-04-23T22:25:53,244  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222553_08c5faef-6220-4628-a985-866d79d47ca4
2024-04-23T22:25:53,247  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:25:53,252  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:53,253  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:25:53,253  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,253  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,256  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:25:53,256  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:25:53,256  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:53,257  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:53,259  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:25:53,260  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:53,262  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:53,262  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,262  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:53,262  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,262  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getDatabase_(String)=1, getValidWriteIds_(List, String)=2}
2024-04-23T22:25:53,262  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce); Time taken: 0.009 seconds
2024-04-23T22:25:53,262  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce
2024-04-23T22:25:53,263  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce
2024-04-23T22:25:53,277  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:25:53,277  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:53,277  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:25:53,278  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:53,279  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/2f63e2c5-2707-4403-aaf6-63b03fff9599/_tmp_space.db/6252ef19-da6a-4500-a8a4-215fc170cc40
2024-04-23T22:25:53,281  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:53,281  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:53,282  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce); Time taken: 0.004 seconds
2024-04-23T22:25:53,282  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222553_9de7400b-a9f5-41c7-a6be-f9a4bc92a1ce
2024-04-23T22:25:53,285  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:25:53,290  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:53,290  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:25:53,291  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,291  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,294  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:25:53,294  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:25:53,295  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:53,295  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:53,297  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:25:53,298  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:25:53,299  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:53,299  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,299  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:53,300  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,300  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2}
2024-04-23T22:25:53,300  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90); Time taken: 0.009 seconds
2024-04-23T22:25:53,300  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90
2024-04-23T22:25:53,301  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90
2024-04-23T22:25:53,315  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:25:53,315  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:25:53,315  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:25:53,316  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:53,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936353, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, transactional=false, numFilesErasureCoded=0, totalSize=0, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:25:53,322  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:25:53,335  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:53,335  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:53,335  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90); Time taken: 0.02 seconds
2024-04-23T22:25:53,335  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222553_f33f50b2-ab74-40cf-97c5-d9093d616c90
2024-04-23T22:25:53,339  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:25:53,345  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:53,346  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:25:53,346  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-23T22:25:53,346  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307): insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-23T22:25:53,349  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:25:53,349  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:25:53,350  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:53,350  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:53,353  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:53,375  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:53,375  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:53,375  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:53,375  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:53,375  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:53,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:53,385  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:53,385  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:53,385  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:53,405  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:53,480  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:53,480  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:53,480  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:53,481  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:25:53,484  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:53,484  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:53,484  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:53,484  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:53,490  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:53,492  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:53,494  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:53,503  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T22:25:53,503  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T22:25:53,504  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:53,507  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:25:53,507  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:53,508  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:25:53,509  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:53,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:53,524  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:53,525  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:53,525  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:53,525  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:53,525  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:25:53,525  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:53,525  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=45, allocateTableWriteId_(long, String, String)=9, getCheckConstraints_(CheckConstraintsRequest)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=4, getAllTableConstraints_(AllTableConstraintsRequest)=31}
2024-04-23T22:25:53,525  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307); Time taken: 0.179 seconds
2024-04-23T22:25:53,526  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307
2024-04-23T22:25:53,526  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307
2024-04-23T22:25:53,546  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:25:53,546  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:53,549  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307): insert into acidTbl(a,b)  values(1,2),(3,4),(5,6),(7,8)
2024-04-23T22:25:53,549  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307
2024-04-23T22:25:53,549  INFO [main] ql.Driver: Query ID = alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307
Total jobs = 1
2024-04-23T22:25:53,549  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:53,549  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:53,671  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:25:53,671  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:53,671  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:53,671  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:53,671  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:53,671  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:53,671  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:53,671  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:53,674  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:53,674  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:25:53,674  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-53_346_7271635340763706491-1/dummy_path
2024-04-23T22:25:53,683  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:53,684  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:25:53,688  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:53,689  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:25:53,690  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:53,694  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-53_346_7271635340763706491-1/-mr-10000
2024-04-23T22:25:53,696  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:53,702  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:53,707  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:53,708  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:25:53,708  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:25:53,708  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-53_346_7271635340763706491-1/dummy_path
2024-04-23T22:25:53,708  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:25:53,725  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:25:53,745  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1808146770_0035
2024-04-23T22:25:53,745  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:53,804  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:53,804  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:53,805  INFO [Thread-2901] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:53,805  INFO [Thread-2901] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:53,806  INFO [Thread-2901] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:53,806  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1808146770_0035_m_000000_0
2024-04-23T22:25:53,810  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:53,810  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-53_346_7271635340763706491-1/dummy_path/null:0+1
2024-04-23T22:25:53,812  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:53,812  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,03KB
2024-04-23T22:25:53,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:25:53,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:53,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:53,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:53,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:53,827  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:53,828  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:53,828  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:53,828  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:53,829  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:53,829  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:53,830  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:25:53,830  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:25:53,830  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:53,830  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:25:53,830  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:25:53,830  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:53,831  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:4, 
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 4. abort - false
2024-04-23T22:25:53,832  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:4, RECORDS_OUT_OPERATOR_RS_4:4, 
2024-04-23T22:25:53,835  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:53,835  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:53,835  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:53,835  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 64; bufvoid = 104857600
2024-04-23T22:25:53,835  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214384(104857536); length = 13/6553600
2024-04-23T22:25:53,845  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:53,850  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1808146770_0035_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:53,850  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:25:53,850  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1808146770_0035_m_000000_0' done.
2024-04-23T22:25:53,850  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1808146770_0035_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=716195
		FILE: Number of bytes written=41270401
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=4
		Map output bytes=64
		Map output materialized bytes=84
		Input split bytes=361
		Combine input records=0
		Spilled Records=4
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=10
		Total committed heap usage (bytes)=1243086848
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=4
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=4
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=4
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=4
	File Input Format Counters 
		Bytes Read=5083
2024-04-23T22:25:53,850  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1808146770_0035_m_000000_0
2024-04-23T22:25:53,850  INFO [Thread-2901] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:53,851  INFO [Thread-2901] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:53,852  INFO [pool-174-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1808146770_0035_r_000000_0
2024-04-23T22:25:53,854  INFO [pool-174-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:53,854  INFO [pool-174-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6a4fcdc
2024-04-23T22:25:53,854  WARN [pool-174-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:53,855  INFO [pool-174-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:53,856  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1808146770_0035_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:53,858  INFO [localfetcher#49] reduce.LocalFetcher: localfetcher#49 about to shuffle output of map attempt_local1808146770_0035_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:25:53,858  INFO [localfetcher#49] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1808146770_0035_m_000000_0
2024-04-23T22:25:53,858  INFO [localfetcher#49] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:25:53,859  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:53,859  INFO [pool-174-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:53,859  INFO [pool-174-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:53,865  INFO [pool-174-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:53,865  INFO [pool-174-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:53,868  INFO [pool-174-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:53,868  INFO [pool-174-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:25:53,868  INFO [pool-174-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:53,868  INFO [pool-174-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:53,868  INFO [pool-174-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:53,869  INFO [pool-174-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:53,869  INFO [pool-174-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:53,870  INFO [pool-174-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:25:53,871  INFO [pool-174-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:53,871  INFO [pool-174-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:53,871  INFO [pool-174-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:53,871  INFO [pool-174-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:53,872  INFO [pool-174-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1808146770_0035/job_local1808146770_0035.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@71064916
2024-04-23T22:25:53,872  INFO [pool-174-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:53,872  INFO [pool-174-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:53,873  INFO [pool-174-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:53,873  INFO [pool-174-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:53,873  INFO [pool-174-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:53,881  INFO [pool-174-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:53,886  INFO [pool-174-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:53,886  INFO [pool-174-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:25:53,886  INFO [pool-174-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:53,886  INFO [pool-174-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:25:53,887  INFO [pool-174-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:25:53,899  INFO [pool-174-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T22:25:53,899  INFO [pool-174-thread-1] mapred.Task: Task:attempt_local1808146770_0035_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:53,899  INFO [pool-174-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:53,899  INFO [pool-174-thread-1] mapred.Task: Task 'attempt_local1808146770_0035_r_000000_0' done.
2024-04-23T22:25:53,899  INFO [pool-174-thread-1] mapred.Task: Final Counters for attempt_local1808146770_0035_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=722398
		FILE: Number of bytes written=41271477
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1243086848
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:53,899  INFO [pool-174-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1808146770_0035_r_000000_0
2024-04-23T22:25:53,899  INFO [pool-174-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1808146770_0035_r_000001_0
2024-04-23T22:25:53,900  INFO [pool-174-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:53,900  INFO [pool-174-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2a8053b6
2024-04-23T22:25:53,900  WARN [pool-174-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:53,901  INFO [pool-174-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:53,901  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1808146770_0035_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:53,904  INFO [localfetcher#50] reduce.LocalFetcher: localfetcher#50 about to shuffle output of map attempt_local1808146770_0035_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:25:53,904  INFO [localfetcher#50] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1808146770_0035_m_000000_0
2024-04-23T22:25:53,904  INFO [localfetcher#50] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:25:53,904  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:53,905  INFO [pool-174-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:53,905  INFO [pool-174-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:53,911  INFO [pool-174-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:53,911  INFO [pool-174-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:53,913  INFO [pool-174-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:53,914  INFO [pool-174-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:25:53,914  INFO [pool-174-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:53,914  INFO [pool-174-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:53,914  INFO [pool-174-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:25:53,914  INFO [pool-174-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:25:53,914  INFO [pool-174-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:53,915  INFO [pool-174-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T22:25:53,915  INFO [pool-174-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:53,915  INFO [pool-174-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:25:53,915  INFO [pool-174-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:25:53,916  INFO [pool-174-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:25:53,916  INFO [pool-174-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1808146770_0035/job_local1808146770_0035.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@ffeb80a
2024-04-23T22:25:53,916  INFO [pool-174-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:53,916  INFO [pool-174-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:53,916  INFO [pool-174-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:25:53,917  INFO [pool-174-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:25:53,917  INFO [pool-174-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:25:53,922  INFO [pool-174-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:25:53,922  INFO [pool-174-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:25:53,922  INFO [pool-174-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:53,922  INFO [pool-174-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:25:53,922  INFO [pool-174-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:25:53,924  INFO [pool-174-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:25:53,934  INFO [pool-174-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.acidtbl:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-23T22:25:53,935  INFO [pool-174-thread-1] mapred.Task: Task:attempt_local1808146770_0035_r_000001_0 is done. And is in the process of committing
2024-04-23T22:25:53,935  INFO [pool-174-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:53,935  INFO [pool-174-thread-1] mapred.Task: Task 'attempt_local1808146770_0035_r_000001_0' done.
2024-04-23T22:25:53,935  INFO [pool-174-thread-1] mapred.Task: Final Counters for attempt_local1808146770_0035_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=728559
		FILE: Number of bytes written=41272549
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1243086848
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:53,935  INFO [pool-174-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1808146770_0035_r_000001_0
2024-04-23T22:25:53,935  INFO [Thread-2901] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:54,807 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:54,808  INFO [main] exec.Task: 2024-04-23 22:25:54,807 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1808146770_0035
2024-04-23T22:25:54,810  INFO [main] exec.Task: Ended Job = job_local1808146770_0035
2024-04-23T22:25:54,812  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:25:54,812  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:25:54,812  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:25:54,813  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:25:54,813  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:25:54,817  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:25:54,817  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:54,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:54,837  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:54,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:54,850  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:54,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:54,895  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:25:54,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:54,901  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:54,901  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:25:54,901  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-53_346_7271635340763706491-1/-mr-10000
2024-04-23T22:25:54,903  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:54,909  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:54,919  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:25:54,920  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 4, false: 
2024-04-23T22:25:54,920  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:25:54,920  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:25:54,940  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 4, false: 
2024-04-23T22:25:54,940  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:25:54,940  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:25:54,942  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=4, totalSize=1389, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:25:54,942  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:54,942  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, getTable_(GetTableRequest)=45, alter_table_(String, String, String, Table, EnvironmentContext, String)=63}
MapReduce Jobs Launched: 
2024-04-23T22:25:54,943  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:54,943  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:54,943  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:54,943  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307); Time taken: 1.393 seconds
2024-04-23T22:25:54,943  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222553_caf18c6a-0977-4dae-b8d3-e391bcc89307
2024-04-23T22:25:54,953  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:54,953  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:25:54,954  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T22:25:54,954  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-53_346_7271635340763706491-1
2024-04-23T22:25:54,955  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-53_346_7271635340763706491-1 on fs with scheme file
2024-04-23T22:25:54,955  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5): select a,b from acidTbl order by a,b
2024-04-23T22:25:54,960  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:25:54,960  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:25:54,961  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:54,961  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:54,964  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:54,964  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:54,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:54,972  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:54,972  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:54,972  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:54,972  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:54,985  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:55,007  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:25:55,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:55,017  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:55,017  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:55,026  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:55,027  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:25:55,041  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:55,041  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:25:55,086  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:25:55,086  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:25:55,086  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:25:55,087  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-54_955_5329271025206255118-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-54_955_5329271025206255118-1
2024-04-23T22:25:55,095  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:25:55,097  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:25:55,098  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T22:25:55,100  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:25:55,109  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:25:55,109  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:55,109  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:55,109  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T22:25:55,110  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T22:25:55,111  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:55,111  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=4, flushCache_()=0, getTableColumnStatistics_(String, String, List, String)=34, getTable_(GetTableRequest)=7, getAllTableConstraints_(AllTableConstraintsRequest)=4, getValidTxns_(long)=1, openTxn_(String, TxnType)=4}
2024-04-23T22:25:55,111  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5); Time taken: 0.156 seconds
2024-04-23T22:25:55,112  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5
2024-04-23T22:25:55,112  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5
2024-04-23T22:25:55,127  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:25:55,127  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:25:55,128  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5): select a,b from acidTbl order by a,b
2024-04-23T22:25:55,128  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5
2024-04-23T22:25:55,128  INFO [main] ql.Driver: Query ID = alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5
Total jobs = 1
2024-04-23T22:25:55,128  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:25:55,128  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:25:55,252  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:25:55,252  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:25:55,252  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:25:55,252  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:25:55,252  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:25:55,252  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:25:55,252  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:25:55,252  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:25:55,255  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:25:55,255  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T22:25:55,255  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:55,264  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:25:55,265  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:25:55,269  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:25:55,270  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:25:55,271  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:55,276  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:55,283  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:25:55,287  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:25:55,288  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T22:25:55,288  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T22:25:55,288  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:25:55,289  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T22:25:55,289  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T22:25:55,289  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T22:25:55,300  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T22:25:55,300  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 11 ms
2024-04-23T22:25:55,300  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T22:25:55,317  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T22:25:55,336  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local233605501_0036
2024-04-23T22:25:55,336  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:25:55,397  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:25:55,397  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:25:55,398  INFO [Thread-2978] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:55,398  INFO [Thread-2978] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:25:55,400  INFO [Thread-2978] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:25:55,400  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local233605501_0036_m_000000_0
2024-04-23T22:25:55,400  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:55,401  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=699, isOriginal=false, fileLength=699, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:55,401  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:55,402  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:25:55,403  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:55,403  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 699, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:55,404  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:55,404  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:55,408  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:55,408  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:55,408  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:55,408  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:55,408  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:55,409  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:55,409  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:55,410  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:55,411  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:55,411  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:55,411  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:55,411  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:55,411  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, 
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T22:25:55,412  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-23T22:25:55,413  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:55,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:55,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:55,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 38; bufvoid = 104857600
2024-04-23T22:25:55,413  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:25:55,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:55,426  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local233605501_0036_m_000000_0 is done. And is in the process of committing
2024-04-23T22:25:55,427  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=699, isOriginal=false, fileLength=699, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:55,427  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local233605501_0036_m_000000_0' done.
2024-04-23T22:25:55,427  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local233605501_0036_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=737842
		FILE: Number of bytes written=42444525
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=38
		Map output materialized bytes=48
		Input split bytes=495
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1243086848
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7578
2024-04-23T22:25:55,427  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local233605501_0036_m_000000_0
2024-04-23T22:25:55,427  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local233605501_0036_m_000001_0
2024-04-23T22:25:55,428  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:55,428  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=690, isOriginal=false, fileLength=690, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:55,429  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:25:55,429  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:25:55,430  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:25:55,430  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 690, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:25:55,431  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:25:55,432  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:25:55,436  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:25:55,436  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:25:55,436  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:25:55,436  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:25:55,436  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:25:55,437  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:25:55,437  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:25:55,438  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:25:55,439  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:25:55,439  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:25:55,439  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:25:55,439  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:25:55,439  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:25:55,440  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T22:25:55,441  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T22:25:55,441  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:25:55,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:25:55,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:25:55,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 38; bufvoid = 104857600
2024-04-23T22:25:55,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:25:55,449  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:25:55,452  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local233605501_0036_m_000001_0 is done. And is in the process of committing
2024-04-23T22:25:55,453  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=690, isOriginal=false, fileLength=690, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:25:55,453  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local233605501_0036_m_000001_0' done.
2024-04-23T22:25:55,453  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local233605501_0036_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=746397
		FILE: Number of bytes written=42444605
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=38
		Map output materialized bytes=48
		Input split bytes=495
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1243086848
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7542
2024-04-23T22:25:55,453  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local233605501_0036_m_000001_0
2024-04-23T22:25:55,453  INFO [Thread-2978] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:25:55,454  INFO [Thread-2978] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:25:55,454  INFO [pool-179-thread-1] mapred.LocalJobRunner: Starting task: attempt_local233605501_0036_r_000000_0
2024-04-23T22:25:55,455  INFO [pool-179-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:25:55,455  INFO [pool-179-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5dd1ef6e
2024-04-23T22:25:55,455  WARN [pool-179-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:25:55,456  INFO [pool-179-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:25:55,456  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local233605501_0036_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:25:55,457  INFO [localfetcher#51] reduce.LocalFetcher: localfetcher#51 about to shuffle output of map attempt_local233605501_0036_m_000001_0 decomp: 44 len: 48 to MEMORY
2024-04-23T22:25:55,457  INFO [localfetcher#51] reduce.InMemoryMapOutput: Read 44 bytes from map-output for attempt_local233605501_0036_m_000001_0
2024-04-23T22:25:55,457  INFO [localfetcher#51] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 44, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->44
2024-04-23T22:25:55,460  INFO [localfetcher#51] reduce.LocalFetcher: localfetcher#51 about to shuffle output of map attempt_local233605501_0036_m_000000_0 decomp: 44 len: 48 to MEMORY
2024-04-23T22:25:55,460  INFO [localfetcher#51] reduce.InMemoryMapOutput: Read 44 bytes from map-output for attempt_local233605501_0036_m_000000_0
2024-04-23T22:25:55,460  INFO [localfetcher#51] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 44, inMemoryMapOutputs.size() -> 2, commitMemory -> 44, usedMemory ->88
2024-04-23T22:25:55,460  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:25:55,460  INFO [pool-179-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:25:55,461  INFO [pool-179-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:25:55,467  INFO [pool-179-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T22:25:55,467  INFO [pool-179-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 54 bytes
2024-04-23T22:25:55,469  INFO [pool-179-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 88 bytes to disk to satisfy reduce memory limit
2024-04-23T22:25:55,469  INFO [pool-179-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-23T22:25:55,469  INFO [pool-179-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:25:55,470  INFO [pool-179-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:25:55,470  INFO [pool-179-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-23T22:25:55,470  INFO [pool-179-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:25:55,471  INFO [pool-179-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:25:55,471  INFO [pool-179-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:25:55,472  INFO [pool-179-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:25:55,472  INFO [pool-179-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:25:55,472  INFO [pool-179-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T22:25:55,472  INFO [pool-179-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:25:55,473  INFO [pool-179-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@2b3764d4, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@164c8933, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@2365f0b6
2024-04-23T22:25:55,473  INFO [pool-179-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-54_955_5329271025206255118-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-54_955_5329271025206255118-1/_tmp.-ext-10002/000000_0
2024-04-23T22:25:55,473  INFO [pool-179-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-54_955_5329271025206255118-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-54_955_5329271025206255118-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:25:55,473  INFO [pool-179-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-54_955_5329271025206255118-1/-mr-10001/.hive-staging_hive_2024-04-23_22-25-54_955_5329271025206255118-1/_tmp.-ext-10002/000000_0
2024-04-23T22:25:55,481  INFO [pool-179-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:25:55,482  INFO [pool-179-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:25:55,482  INFO [pool-179-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:55,482  INFO [pool-179-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:25:55,482  INFO [pool-179-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T22:25:55,482  INFO [pool-179-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-23T22:25:55,483  INFO [pool-179-thread-1] mapred.Task: Task:attempt_local233605501_0036_r_000000_0 is done. And is in the process of committing
2024-04-23T22:25:55,483  INFO [pool-179-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:25:55,483  INFO [pool-179-thread-1] mapred.Task: Task 'attempt_local233605501_0036_r_000000_0' done.
2024-04-23T22:25:55,483  INFO [pool-179-thread-1] mapred.Task: Final Counters for attempt_local233605501_0036_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=752294
		FILE: Number of bytes written=42444858
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=96
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1243086848
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:25:55,484  INFO [pool-179-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local233605501_0036_r_000000_0
2024-04-23T22:25:55,484  INFO [Thread-2978] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:25:56,398 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:25:56,399  INFO [main] exec.Task: 2024-04-23 22:25:56,398 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local233605501_0036
2024-04-23T22:25:56,399  INFO [main] exec.Task: Ended Job = job_local233605501_0036
2024-04-23T22:25:56,401  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:56,401  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T22:25:56,401  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:25:56,401  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:56,401  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:25:56,401  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5); Time taken: 1.273 seconds
2024-04-23T22:25:56,401  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222554_4d613dce-4b24-4d74-8df3-a68e6c938ee5
2024-04-23T22:25:56,407  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:25:56,414  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:56,415  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:25:56,419  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T22:25:56,419  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T22:25:56,420  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:25:56,420  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T22:25:56,420  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-54_955_5329271025206255118-1
2024-04-23T22:25:56,421  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/2f63e2c5-2707-4403-aaf6-63b03fff9599/hive_2024-04-23_22-25-54_955_5329271025206255118-1 on fs with scheme file
2024-04-23T22:25:56,422  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222556_3d7313d4-c2de-41b0-9d2a-8b817303a9b8): START TRANSACTION
2024-04-23T22:25:56,424  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:25:56,424  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:25:56,425  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:25:56,425  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:25:56,426  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:25:56,426  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:56,426  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:56,426  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:56,426  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T22:25:56,426  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222556_3d7313d4-c2de-41b0-9d2a-8b817303a9b8); Time taken: 0.004 seconds
2024-04-23T22:25:56,427  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222556_3d7313d4-c2de-41b0-9d2a-8b817303a9b8
2024-04-23T22:25:56,427  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T22:25:56,427  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222556_3d7313d4-c2de-41b0-9d2a-8b817303a9b8): START TRANSACTION
2024-04-23T22:25:56,427  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:56,427  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T22:25:56,427  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222556_3d7313d4-c2de-41b0-9d2a-8b817303a9b8); Time taken: 0.0 seconds
2024-04-23T22:25:56,428  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 8
2024-04-23T22:25:56,428  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222556_8808d5cf-e19c-4096-845b-58e141f052dc): delete from acidTbl where b = 8
2024-04-23T22:25:56,429  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:25:56,429  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:56,437  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,437  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 8> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:25:56,437  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:25:56,440  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:25:56,440  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:56,440  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:56,447  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,447  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:56,447  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:56,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:56,454  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,454  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:25:56,454  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:25:56,467  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:25:56,496  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-23T22:25:56,496  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:56,506  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,507  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:25:56,517  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:25:56,528  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-23T22:25:56,528  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-23T22:25:56,589  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:25:56,589  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:25:56,589  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:25:56,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:56,595  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,599 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:25:56,600 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:25:56,600  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:25:56,601 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMultipleDelete(TestTxnCommands.java:906)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:25:56,601  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:56,601  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=5, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=3, getTableColumnStatistics_(String, String, List, String)=32, getTable_(GetTableRequest)=29}
2024-04-23T22:25:56,602  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222556_8808d5cf-e19c-4096-845b-58e141f052dc); Time taken: 0.173 seconds
2024-04-23T22:25:56,602  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222556_3d7313d4-c2de-41b0-9d2a-8b817303a9b8
2024-04-23T22:25:56,605  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:56,612  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:25:56,612  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e): drop table if exists acidTbl
2024-04-23T22:25:56,615  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T22:25:56,616  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:25:56,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:56,623  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,623  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:56,623  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:56,623  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:56,623  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, rollbackTxn_(long)=10, getValidTxns_(long)=1}
2024-04-23T22:25:56,623  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e); Time taken: 0.011 seconds
2024-04-23T22:25:56,624  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e
2024-04-23T22:25:56,624  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e
2024-04-23T22:25:56,638  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:25:56,638  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:56,638  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e): drop table if exists acidTbl
2024-04-23T22:25:56,638  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:56,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:56,644  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:56,650  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,650  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:25:56,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:56,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=118}
2024-04-23T22:25:56,762  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e); Time taken: 0.124 seconds
2024-04-23T22:25:56,762  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222556_8fba787b-4e50-4bbc-ac67-8646ca7fee8e
2024-04-23T22:25:56,766  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:25:56,772  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:56,773  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:25:56,774  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:25:56,774  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2): drop table if exists acidTblPart
2024-04-23T22:25:56,781  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T22:25:56,782  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:25:56,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:56,799  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,799  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:56,799  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:56,799  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:56,799  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, openTxn_(String, TxnType)=8, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=15, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:56,799  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2); Time taken: 0.025 seconds
2024-04-23T22:25:56,800  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2
2024-04-23T22:25:56,800  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2
2024-04-23T22:25:56,818  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:25:56,818  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:56,818  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2): drop table if exists acidTblPart
2024-04-23T22:25:56,818  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:56,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:56,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:56,830  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,831  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:25:56,873  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:56,873  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=49, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T22:25:56,873  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2); Time taken: 0.055 seconds
2024-04-23T22:25:56,873  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222556_67b47285-b5db-4e0c-94a5-c4f895a214f2
2024-04-23T22:25:56,877  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:25:56,884  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:56,884  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:25:56,884  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:25:56,885  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222556_eefabb89-bbb7-4a43-ba87-97c6bd110d3c): drop table if exists acidTbl2
2024-04-23T22:25:56,888  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T22:25:56,888  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:25:56,889  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:56,889  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:56,889  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:56,890  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=0}
2024-04-23T22:25:56,890  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222556_eefabb89-bbb7-4a43-ba87-97c6bd110d3c); Time taken: 0.004 seconds
2024-04-23T22:25:56,890  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222556_eefabb89-bbb7-4a43-ba87-97c6bd110d3c
2024-04-23T22:25:56,890  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:25:56,890  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222556_eefabb89-bbb7-4a43-ba87-97c6bd110d3c): drop table if exists acidTbl2
2024-04-23T22:25:56,891  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:56,891  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:25:56,892  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:56,892  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:56,892  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222556_eefabb89-bbb7-4a43-ba87-97c6bd110d3c); Time taken: 0.002 seconds
2024-04-23T22:25:56,892  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222556_eefabb89-bbb7-4a43-ba87-97c6bd110d3c
2024-04-23T22:25:56,898  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:25:56,904  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:56,904  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:25:56,905  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:25:56,905  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:56,907  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T22:25:56,907  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:25:56,908  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:56,929  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,929  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:56,929  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:56,929  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:56,929  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-23T22:25:56,930  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc); Time taken: 0.024 seconds
2024-04-23T22:25:56,930  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc
2024-04-23T22:25:56,930  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc
2024-04-23T22:25:56,945  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:25:56,945  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:56,945  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc): drop table if exists nonAcidOrcTbl
2024-04-23T22:25:56,945  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:56,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:56,954  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:56,962  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:56,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:25:57,021  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:57,021  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=66}
2024-04-23T22:25:57,021  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc); Time taken: 0.076 seconds
2024-04-23T22:25:57,021  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222556_0ca58ff3-d8bc-48ca-9605-ab945ff54fcc
2024-04-23T22:25:57,025  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:25:57,031  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:57,031  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:25:57,032  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:57,032  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:57,035  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T22:25:57,035  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:25:57,036  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:57,044  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:57,044  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:57,044  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:57,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:57,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=8}
2024-04-23T22:25:57,045  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035); Time taken: 0.012 seconds
2024-04-23T22:25:57,045  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035
2024-04-23T22:25:57,046  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035
2024-04-23T22:25:57,062  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:25:57,062  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:57,062  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035): drop table if exists nonAcidOrcTbl2
2024-04-23T22:25:57,062  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:57,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:57,073  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:57,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:57,081  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:57,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:25:57,120  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:57,120  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=11, dropTable_(String, String, boolean, boolean, boolean)=47}
2024-04-23T22:25:57,121  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035); Time taken: 0.058 seconds
2024-04-23T22:25:57,121  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222557_dee26cf2-9536-42cd-9c2b-9600c42b2035
2024-04-23T22:25:57,125  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:25:57,131  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:57,132  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:25:57,132  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:25:57,133  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b): drop table if exists nonAcidNonBucket
2024-04-23T22:25:57,135  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T22:25:57,135  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:25:57,136  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:57,144  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:57,144  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:25:57,144  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:25:57,144  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:25:57,144  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:57,144  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b); Time taken: 0.012 seconds
2024-04-23T22:25:57,145  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b
2024-04-23T22:25:57,145  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b
2024-04-23T22:25:57,161  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:25:57,161  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:25:57,161  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b): drop table if exists nonAcidNonBucket
2024-04-23T22:25:57,161  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:25:57,161  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:57,170  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:57,170  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:57,178  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:25:57,178  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:25:57,207  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:25:57,207  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=37, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T22:25:57,208  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b); Time taken: 0.046 seconds
2024-04-23T22:25:57,208  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222557_896b4016-b57b-4ecd-a0b6-bad2befda56b
2024-04-23T22:25:57,212  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:25:57,218  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:25:57,218  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:25:57,219  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="truncateTableAdvancingWriteId" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.537"/>
  <testcase name="testAddAndDropConstraintAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.751"/>
  <testcase name="testMultipleInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.345"/>
  <testcase name="testDeleteOfMultipleInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.633">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:26:09,930  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:26:09,931  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:26:09,932  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:26:09,932  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:26:09,934  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 6a9bdb66-d5e2-411c-b8be-bab1675b24fe
2024-04-23T22:26:09,937  INFO [main] SessionState: Hive Session ID = 6a9bdb66-d5e2-411c-b8be-bab1675b24fe
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:26:09,937  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:26:09,943  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6a9bdb66-d5e2-411c-b8be-bab1675b24fe
2024-04-23T22:26:09,945  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe
2024-04-23T22:26:09,948  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/_tmp_space.db
2024-04-23T22:26:09,948  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=6a9bdb66-d5e2-411c-b8be-bab1675b24fe, clientType=HIVECLI]
2024-04-23T22:26:09,948  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:26:09,949  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222609_45351005-deaf-4683-87e6-8289960525cd): drop table if exists acidTbl
2024-04-23T22:26:09,960  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:26:09,960  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:26:09,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:09,966  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:09,966  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:09,966  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:09,966  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, openTxn_(String, TxnType)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15}
2024-04-23T22:26:09,967  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222609_45351005-deaf-4683-87e6-8289960525cd); Time taken: 0.017 seconds
2024-04-23T22:26:09,967  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222609_45351005-deaf-4683-87e6-8289960525cd
2024-04-23T22:26:09,967  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:09,967  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222609_45351005-deaf-4683-87e6-8289960525cd): drop table if exists acidTbl
2024-04-23T22:26:09,967  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:09,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:09,971  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:09,971  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:09,971  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222609_45351005-deaf-4683-87e6-8289960525cd); Time taken: 0.004 seconds
2024-04-23T22:26:09,971  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222609_45351005-deaf-4683-87e6-8289960525cd
2024-04-23T22:26:09,978  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:26:09,986  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:09,986  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:26:09,987  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:26:09,987  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222609_3bf5a0c5-4ebd-48c5-b65a-14d2d218f791): drop table if exists acidTblPart
2024-04-23T22:26:09,989  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:26:09,989  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:26:09,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:09,993  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:09,993  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:09,993  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:09,993  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:26:09,994  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222609_3bf5a0c5-4ebd-48c5-b65a-14d2d218f791); Time taken: 0.006 seconds
2024-04-23T22:26:09,994  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222609_3bf5a0c5-4ebd-48c5-b65a-14d2d218f791
2024-04-23T22:26:09,994  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:09,994  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222609_3bf5a0c5-4ebd-48c5-b65a-14d2d218f791): drop table if exists acidTblPart
2024-04-23T22:26:09,994  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:09,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:09,997  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:09,998  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:09,998  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222609_3bf5a0c5-4ebd-48c5-b65a-14d2d218f791); Time taken: 0.003 seconds
2024-04-23T22:26:09,998  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222609_3bf5a0c5-4ebd-48c5-b65a-14d2d218f791
2024-04-23T22:26:10,004  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:26:10,012  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,012  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:26:10,013  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:26:10,013  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_0e1f2cdd-97af-4dec-b0c6-cdd17d886a5d): drop table if exists acidTbl2
2024-04-23T22:26:10,015  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:26:10,016  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:26:10,017  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:26:10,022  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,022  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:26:10,023  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_0e1f2cdd-97af-4dec-b0c6-cdd17d886a5d); Time taken: 0.009 seconds
2024-04-23T22:26:10,023  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222610_0e1f2cdd-97af-4dec-b0c6-cdd17d886a5d
2024-04-23T22:26:10,023  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:10,023  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_0e1f2cdd-97af-4dec-b0c6-cdd17d886a5d): drop table if exists acidTbl2
2024-04-23T22:26:10,023  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:26:10,028  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,029  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:10,029  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_0e1f2cdd-97af-4dec-b0c6-cdd17d886a5d); Time taken: 0.005 seconds
2024-04-23T22:26:10,029  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_0e1f2cdd-97af-4dec-b0c6-cdd17d886a5d
2024-04-23T22:26:10,038  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:26:10,047  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,047  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:26:10,047  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:26:10,048  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_9f011795-4770-4d1f-9cd7-0afef2dc1b69): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:10,050  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:26:10,050  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:26:10,051  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:10,053  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,053  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,053  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,053  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=18}
2024-04-23T22:26:10,054  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_9f011795-4770-4d1f-9cd7-0afef2dc1b69); Time taken: 0.005 seconds
2024-04-23T22:26:10,054  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222610_9f011795-4770-4d1f-9cd7-0afef2dc1b69
2024-04-23T22:26:10,054  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:10,054  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_9f011795-4770-4d1f-9cd7-0afef2dc1b69): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:10,054  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:10,057  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,057  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:10,057  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_9f011795-4770-4d1f-9cd7-0afef2dc1b69); Time taken: 0.003 seconds
2024-04-23T22:26:10,057  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_9f011795-4770-4d1f-9cd7-0afef2dc1b69
2024-04-23T22:26:10,062  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:26:10,069  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,069  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:26:10,070  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:10,070  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_8660ce53-ef47-4c72-b73a-3bc6a456d83e): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:10,072  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:26:10,072  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:26:10,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:10,076  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,076  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,076  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,076  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:26:10,076  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_8660ce53-ef47-4c72-b73a-3bc6a456d83e); Time taken: 0.006 seconds
2024-04-23T22:26:10,076  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222610_8660ce53-ef47-4c72-b73a-3bc6a456d83e
2024-04-23T22:26:10,076  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:10,076  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_8660ce53-ef47-4c72-b73a-3bc6a456d83e): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:10,076  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:10,079  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:10,080  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_8660ce53-ef47-4c72-b73a-3bc6a456d83e); Time taken: 0.003 seconds
2024-04-23T22:26:10,080  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_8660ce53-ef47-4c72-b73a-3bc6a456d83e
2024-04-23T22:26:10,085  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:26:10,092  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,092  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:26:10,093  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:26:10,093  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_1b91f173-0a55-44bc-a5d2-e0bd80f7f7c8): drop table if exists nonAcidNonBucket
2024-04-23T22:26:10,095  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:26:10,096  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:26:10,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:10,101  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,101  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,101  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T22:26:10,101  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_1b91f173-0a55-44bc-a5d2-e0bd80f7f7c8); Time taken: 0.008 seconds
2024-04-23T22:26:10,102  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222610_1b91f173-0a55-44bc-a5d2-e0bd80f7f7c8
2024-04-23T22:26:10,102  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:10,102  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_1b91f173-0a55-44bc-a5d2-e0bd80f7f7c8): drop table if exists nonAcidNonBucket
2024-04-23T22:26:10,102  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:10,106  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,106  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:10,107  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_1b91f173-0a55-44bc-a5d2-e0bd80f7f7c8); Time taken: 0.004 seconds
2024-04-23T22:26:10,107  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_1b91f173-0a55-44bc-a5d2-e0bd80f7f7c8
2024-04-23T22:26:10,115  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:26:10,121  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,121  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:26:10,122  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,122  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,125  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:26:10,125  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:26:10,125  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,125  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,132  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:26:10,132  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:10,133  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,133  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,133  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,134  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=1}
2024-04-23T22:26:10,134  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e); Time taken: 0.011 seconds
2024-04-23T22:26:10,134  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e
2024-04-23T22:26:10,134  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e
2024-04-23T22:26:10,154  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:26:10,154  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:10,154  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,154  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,155  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936370, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, totalSize=0, rawDataSize=0, numRows=0, numFilesErasureCoded=0, numFiles=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:26:10,161  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:10,200  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=45}
2024-04-23T22:26:10,201  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e); Time taken: 0.046 seconds
2024-04-23T22:26:10,201  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_457833cb-d8a7-49f8-b3c5-31fb013a287e
2024-04-23T22:26:10,205  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:26:10,213  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,213  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:26:10,213  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,214  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,216  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:26:10,216  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:26:10,217  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,217  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,220  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:26:10,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:10,222  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,222  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,222  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=1, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:10,222  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7); Time taken: 0.008 seconds
2024-04-23T22:26:10,222  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7
2024-04-23T22:26:10,223  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7
2024-04-23T22:26:10,240  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:26:10,240  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:10,241  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,241  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,241  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936370, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:26:10,247  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:26:10,269  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,269  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=27, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:10,269  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7); Time taken: 0.027 seconds
2024-04-23T22:26:10,269  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_03310763-f996-480a-a4b9-26c08a1543c7
2024-04-23T22:26:10,273  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:26:10,280  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,280  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:26:10,281  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,281  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,283  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:26:10,284  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:26:10,284  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,284  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,287  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:26:10,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:10,289  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,289  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,289  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,289  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,289  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:26:10,289  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18); Time taken: 0.008 seconds
2024-04-23T22:26:10,289  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18
2024-04-23T22:26:10,289  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18
2024-04-23T22:26:10,305  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:26:10,305  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:10,305  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,305  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936370, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=false, totalSize=0, rawDataSize=0, numFilesErasureCoded=0, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:10,312  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:26:10,326  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,326  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T22:26:10,326  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18); Time taken: 0.021 seconds
2024-04-23T22:26:10,326  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_4967be2b-0175-4eed-9340-f920af8b0d18
2024-04-23T22:26:10,331  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:26:10,338  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,338  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:26:10,339  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,339  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,343  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:26:10,343  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:26:10,344  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,344  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,347  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:26:10,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:10,350  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,350  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,350  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,350  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=2, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1}
2024-04-23T22:26:10,351  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938); Time taken: 0.011 seconds
2024-04-23T22:26:10,351  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938
2024-04-23T22:26:10,351  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938
2024-04-23T22:26:10,377  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:26:10,377  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:10,377  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,377  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936370, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, transactional=false, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, numFiles=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:10,386  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:26:10,401  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,401  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T22:26:10,401  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938); Time taken: 0.024 seconds
2024-04-23T22:26:10,401  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_e1d78068-f8de-4fee-b034-19544f555938
2024-04-23T22:26:10,406  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:26:10,415  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,415  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:26:10,416  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,416  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,419  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:26:10,419  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:26:10,420  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,420  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,423  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:26:10,423  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:10,424  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,424  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,424  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,425  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,425  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getDatabase_(String)=1}
2024-04-23T22:26:10,425  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d); Time taken: 0.009 seconds
2024-04-23T22:26:10,425  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d
2024-04-23T22:26:10,425  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d
2024-04-23T22:26:10,442  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:26:10,442  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:10,443  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:10,443  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,444  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/_tmp_space.db/8ad189a2-b11f-4d67-b464-2cac7c6e9406
2024-04-23T22:26:10,448  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,448  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:10,448  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d); Time taken: 0.005 seconds
2024-04-23T22:26:10,448  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_d0ffa670-3cc3-497d-81f3-c563e2411a1d
2024-04-23T22:26:10,454  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:26:10,464  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,464  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:26:10,465  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,465  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,468  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:26:10,468  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:26:10,469  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,469  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,471  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:26:10,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:10,473  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,473  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,473  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,473  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,474  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=17}
2024-04-23T22:26:10,474  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d); Time taken: 0.008 seconds
2024-04-23T22:26:10,474  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d
2024-04-23T22:26:10,474  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d
2024-04-23T22:26:10,498  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:26:10,498  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:10,498  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:10,498  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:10,499  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936370, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, transactional=false, numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:10,505  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:26:10,519  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,519  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T22:26:10,520  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d); Time taken: 0.021 seconds
2024-04-23T22:26:10,520  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222610_e53909cb-daca-44fe-bfd1-3ab23835695d
2024-04-23T22:26:10,525  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:26:10,533  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:10,533  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:26:10,533  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T22:26:10,534  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_02cfaaa0-67f9-4741-94a4-8b512a781cc7): START TRANSACTION
2024-04-23T22:26:10,536  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:26:10,536  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:26:10,537  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,537  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,537  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,537  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,537  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:10,537  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,537  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T22:26:10,538  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_02cfaaa0-67f9-4741-94a4-8b512a781cc7); Time taken: 0.003 seconds
2024-04-23T22:26:10,538  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222610_02cfaaa0-67f9-4741-94a4-8b512a781cc7
2024-04-23T22:26:10,538  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T22:26:10,538  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_02cfaaa0-67f9-4741-94a4-8b512a781cc7): START TRANSACTION
2024-04-23T22:26:10,538  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:10,538  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T22:26:10,538  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_02cfaaa0-67f9-4741-94a4-8b512a781cc7); Time taken: 0.0 seconds
2024-04-23T22:26:10,539  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:26:10,539  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:26:10,540  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:10,540  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:10,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:10,567  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:10,567  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:10,567  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:10,567  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:10,567  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:10,567  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:10,574  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:10,574  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:10,574  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:10,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:10,675  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:10,675  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:10,675  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:10,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:10,678  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:10,678  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:10,678  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:10,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:10,685  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:10,687  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:10,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:10,698  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T22:26:10,699  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T22:26:10,700  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:26:10,703  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:26:10,703  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:26:10,704  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:26:10,704  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:26:10,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:10,720  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:10,721  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:26:10,721  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:10,721  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:10,721  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:26:10,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:10,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, getTable_(GetTableRequest)=44, allocateTableWriteId_(long, String, String)=9, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=1, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=29}
2024-04-23T22:26:10,722  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7); Time taken: 0.182 seconds
2024-04-23T22:26:10,722  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7
2024-04-23T22:26:10,722  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7
2024-04-23T22:26:10,746  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:26:10,746  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:26:10,748  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:26:10,749  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7
2024-04-23T22:26:10,749  INFO [main] ql.Driver: Query ID = alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7
Total jobs = 1
2024-04-23T22:26:10,749  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:26:10,749  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:26:10,875  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:26:10,875  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:26:10,875  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:26:10,875  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:26:10,875  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:26:10,875  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:26:10,875  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:26:10,875  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:26:10,877  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:26:10,877  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:26:10,877  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-10_539_4222465166856908052-1/dummy_path
2024-04-23T22:26:10,887  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:26:10,887  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:26:10,892  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:26:10,893  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:10,894  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:10,897  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-10_539_4222465166856908052-1/-mr-10000
2024-04-23T22:26:10,899  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:10,906  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:26:10,910  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:26:10,911  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:26:10,911  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:26:10,911  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-10_539_4222465166856908052-1/dummy_path
2024-04-23T22:26:10,911  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:26:10,928  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:26:10,947  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local558483738_0042
2024-04-23T22:26:10,947  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:26:11,007  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:26:11,007  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:26:11,008  INFO [Thread-3523] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:11,008  INFO [Thread-3523] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:11,009  INFO [Thread-3523] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:26:11,010  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local558483738_0042_m_000000_0
2024-04-23T22:26:11,012  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:11,013  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-10_539_4222465166856908052-1/dummy_path/null:0+1
2024-04-23T22:26:11,015  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:11,016  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:26:11,016  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:26:11,032  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:11,032  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:11,032  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:11,032  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:11,032  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:11,033  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:11,033  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:11,033  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:11,034  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:11,034  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:11,034  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:26:11,034  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:26:11,034  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:26:11,034  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:26:11,034  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:11,035  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:11,036  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:26:11,036  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:26:11,036  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:26:11,036  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T22:26:11,036  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:26:11,036  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:26:11,036  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T22:26:11,038  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:11,038  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:11,038  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:11,038  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:26:11,038  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:26:11,047  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:11,052  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local558483738_0042_m_000000_0 is done. And is in the process of committing
2024-04-23T22:26:11,052  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:26:11,052  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local558483738_0042_m_000000_0' done.
2024-04-23T22:26:11,053  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local558483738_0042_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=902672
		FILE: Number of bytes written=49518829
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=11
		Total committed heap usage (bytes)=1234173952
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-23T22:26:11,053  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local558483738_0042_m_000000_0
2024-04-23T22:26:11,053  INFO [Thread-3523] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:26:11,054  INFO [Thread-3523] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:26:11,054  INFO [pool-206-thread-1] mapred.LocalJobRunner: Starting task: attempt_local558483738_0042_r_000000_0
2024-04-23T22:26:11,056  INFO [pool-206-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:11,056  INFO [pool-206-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@179ec547
2024-04-23T22:26:11,056  WARN [pool-206-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:11,057  INFO [pool-206-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:11,058  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local558483738_0042_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:11,060  INFO [localfetcher#59] reduce.LocalFetcher: localfetcher#59 about to shuffle output of map attempt_local558483738_0042_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:11,060  INFO [localfetcher#59] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local558483738_0042_m_000000_0
2024-04-23T22:26:11,060  INFO [localfetcher#59] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:11,061  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:11,061  INFO [pool-206-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:11,061  INFO [pool-206-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:11,067  INFO [pool-206-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:11,068  INFO [pool-206-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:11,070  INFO [pool-206-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:11,070  INFO [pool-206-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:11,070  INFO [pool-206-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:11,070  INFO [pool-206-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:11,070  INFO [pool-206-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:11,070  INFO [pool-206-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:11,071  INFO [pool-206-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:11,071  INFO [pool-206-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:11,072  INFO [pool-206-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:11,072  INFO [pool-206-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:11,072  INFO [pool-206-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:11,072  INFO [pool-206-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:11,072  INFO [pool-206-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local558483738_0042/job_local558483738_0042.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@4ec1a6e7
2024-04-23T22:26:11,073  INFO [pool-206-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:11,073  INFO [pool-206-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:11,073  INFO [pool-206-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:11,073  INFO [pool-206-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:11,073  INFO [pool-206-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:11,080  INFO [pool-206-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:11,084  INFO [pool-206-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:11,084  INFO [pool-206-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:11,084  INFO [pool-206-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:11,084  INFO [pool-206-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:11,085  INFO [pool-206-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:26:11,096  INFO [pool-206-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:11,097  INFO [pool-206-thread-1] mapred.Task: Task:attempt_local558483738_0042_r_000000_0 is done. And is in the process of committing
2024-04-23T22:26:11,097  INFO [pool-206-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:11,097  INFO [pool-206-thread-1] mapred.Task: Task 'attempt_local558483738_0042_r_000000_0' done.
2024-04-23T22:26:11,097  INFO [pool-206-thread-1] mapred.Task: Final Counters for attempt_local558483738_0042_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=908777
		FILE: Number of bytes written=49519868
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1234173952
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:11,097  INFO [pool-206-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local558483738_0042_r_000000_0
2024-04-23T22:26:11,097  INFO [pool-206-thread-1] mapred.LocalJobRunner: Starting task: attempt_local558483738_0042_r_000001_0
2024-04-23T22:26:11,098  INFO [pool-206-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:11,098  INFO [pool-206-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7f394c6f
2024-04-23T22:26:11,098  WARN [pool-206-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:11,099  INFO [pool-206-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:11,099  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local558483738_0042_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:11,102  INFO [localfetcher#60] reduce.LocalFetcher: localfetcher#60 about to shuffle output of map attempt_local558483738_0042_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:11,102  INFO [localfetcher#60] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local558483738_0042_m_000000_0
2024-04-23T22:26:11,102  INFO [localfetcher#60] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:11,103  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:11,103  INFO [pool-206-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:11,103  INFO [pool-206-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:11,109  INFO [pool-206-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:11,109  INFO [pool-206-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:11,112  INFO [pool-206-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:11,112  INFO [pool-206-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:11,112  INFO [pool-206-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:11,112  INFO [pool-206-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:11,112  INFO [pool-206-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:11,112  INFO [pool-206-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:11,112  INFO [pool-206-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:11,113  INFO [pool-206-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:11,114  INFO [pool-206-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:11,114  INFO [pool-206-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:11,114  INFO [pool-206-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:11,114  INFO [pool-206-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:11,114  INFO [pool-206-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local558483738_0042/job_local558483738_0042.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@34bc161
2024-04-23T22:26:11,115  INFO [pool-206-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:11,115  INFO [pool-206-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:11,115  INFO [pool-206-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:11,115  INFO [pool-206-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:11,115  INFO [pool-206-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:11,120  INFO [pool-206-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:11,120  INFO [pool-206-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:11,120  INFO [pool-206-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T22:26:11,120  INFO [pool-206-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:11,120  INFO [pool-206-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:11,122  INFO [pool-206-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:26:11,131  INFO [pool-206-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, 
2024-04-23T22:26:11,131  INFO [pool-206-thread-1] mapred.Task: Task:attempt_local558483738_0042_r_000001_0 is done. And is in the process of committing
2024-04-23T22:26:11,132  INFO [pool-206-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:11,132  INFO [pool-206-thread-1] mapred.Task: Task 'attempt_local558483738_0042_r_000001_0' done.
2024-04-23T22:26:11,132  INFO [pool-206-thread-1] mapred.Task: Final Counters for attempt_local558483738_0042_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=914858
		FILE: Number of bytes written=49520896
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1234173952
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:11,132  INFO [pool-206-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local558483738_0042_r_000001_0
2024-04-23T22:26:11,132  INFO [Thread-3523] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:26:12,008 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:26:12,008  INFO [main] exec.Task: 2024-04-23 22:26:12,008 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local558483738_0042
2024-04-23T22:26:12,009  INFO [main] exec.Task: Ended Job = job_local558483738_0042
2024-04-23T22:26:12,010  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:26:12,010  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:26:12,010  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:26:12,011  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:26:12,011  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:26:12,012  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:26:12,012  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:12,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:12,019  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:12,025  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,026  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:12,062  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:26:12,062  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:12,069  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,069  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:26:12,070  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-10_539_4222465166856908052-1/-mr-10000
2024-04-23T22:26:12,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:12,078  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,089  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:26:12,089  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:26:12,089  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:26:12,090  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:12,109  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:26:12,109  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:26:12,109  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:26:12,112  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:26:12,113  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:12,113  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, getTable_(GetTableRequest)=27, alter_table_(String, String, String, Table, EnvironmentContext, String)=55, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:26:12,113  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:26:12,113  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:12,113  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:12,113  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222610_1874a6fe-5508-4f22-8f95-7aea87a6a1e7); Time taken: 1.365 seconds
2024-04-23T22:26:12,113  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:26:12,114  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-10_539_4222465166856908052-1
2024-04-23T22:26:12,114  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-10_539_4222465166856908052-1 on fs with scheme file
2024-04-23T22:26:12,114  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:26:12,115  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:12,115  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:12,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:12,122  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,122  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:12,122  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:12,122  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:12,122  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:12,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:12,128  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,128  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:12,128  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:12,148  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:12,197  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:12,197  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:12,197  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:12,198  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:12,200  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:12,200  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:12,200  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:12,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:12,207  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,209  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:12,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:12,212  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:26:12,215  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:26:12,215  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:26:12,216  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:26:12,216  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:26:12,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:12,235  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:12,235  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:26:12,235  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:12,235  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:12,235  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:26:12,236  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:12,236  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=29, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=1, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=5, isCompatibleWith_(Configuration)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1}
2024-04-23T22:26:12,236  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47); Time taken: 0.122 seconds
2024-04-23T22:26:12,236  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47
2024-04-23T22:26:12,236  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47
2024-04-23T22:26:12,250  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:26:12,250  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:26:12,251  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:26:12,251  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47
2024-04-23T22:26:12,251  INFO [main] ql.Driver: Query ID = alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47
Total jobs = 1
2024-04-23T22:26:12,251  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:26:12,251  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:26:12,425  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:26:12,425  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:26:12,425  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:26:12,425  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:26:12,425  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:26:12,425  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:26:12,425  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:26:12,425  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:26:12,428  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:26:12,428  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:26:12,428  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-12_114_3660119870326533-1/dummy_path
2024-04-23T22:26:12,437  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:26:12,438  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,98KB
2024-04-23T22:26:12,443  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:26:12,444  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,91KB
2024-04-23T22:26:12,445  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:12,448  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-12_114_3660119870326533-1/-mr-10000
2024-04-23T22:26:12,450  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:12,457  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:26:12,462  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:26:12,463  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:26:12,463  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:26:12,463  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-12_114_3660119870326533-1/dummy_path
2024-04-23T22:26:12,464  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:26:12,483  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:26:12,503  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1527889309_0043
2024-04-23T22:26:12,503  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:26:12,569  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:26:12,569  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:26:12,569  INFO [Thread-3597] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:12,570  INFO [Thread-3597] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:12,572  INFO [Thread-3597] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:26:12,572  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1527889309_0043_m_000000_0
2024-04-23T22:26:12,573  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:12,573  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-12_114_3660119870326533-1/dummy_path/null:0+1
2024-04-23T22:26:12,573  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:12,574  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,98KB
2024-04-23T22:26:12,575  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:26:12,579  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:12,579  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:12,579  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:12,579  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:12,579  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:12,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:12,580  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:12,581  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:12,581  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:12,581  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:12,581  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:26:12,582  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:26:12,583  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T22:26:12,584  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:12,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:12,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:12,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:26:12,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:26:12,594  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:12,597  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1527889309_0043_m_000000_0 is done. And is in the process of committing
2024-04-23T22:26:12,598  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:26:12,598  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1527889309_0043_m_000000_0' done.
2024-04-23T22:26:12,598  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1527889309_0043_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=920931
		FILE: Number of bytes written=50700928
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=358
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1234173952
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5033
2024-04-23T22:26:12,598  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1527889309_0043_m_000000_0
2024-04-23T22:26:12,598  INFO [Thread-3597] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:26:12,599  INFO [Thread-3597] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:26:12,600  INFO [pool-211-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1527889309_0043_r_000000_0
2024-04-23T22:26:12,600  INFO [pool-211-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:12,600  INFO [pool-211-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@460057a
2024-04-23T22:26:12,600  WARN [pool-211-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:12,601  INFO [pool-211-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:12,602  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1527889309_0043_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:12,603  INFO [localfetcher#61] reduce.LocalFetcher: localfetcher#61 about to shuffle output of map attempt_local1527889309_0043_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:12,603  INFO [localfetcher#61] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1527889309_0043_m_000000_0
2024-04-23T22:26:12,603  INFO [localfetcher#61] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:12,604  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:12,604  INFO [pool-211-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:12,604  INFO [pool-211-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:12,610  INFO [pool-211-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:12,610  INFO [pool-211-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:12,612  INFO [pool-211-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:12,613  INFO [pool-211-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:12,613  INFO [pool-211-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:12,613  INFO [pool-211-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:12,613  INFO [pool-211-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:12,613  INFO [pool-211-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:12,613  INFO [pool-211-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:12,614  INFO [pool-211-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-23T22:26:12,615  INFO [pool-211-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:12,615  INFO [pool-211-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:12,615  INFO [pool-211-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:12,615  INFO [pool-211-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:12,615  INFO [pool-211-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1527889309_0043/job_local1527889309_0043.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2cba0815
2024-04-23T22:26:12,616  INFO [pool-211-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:12,616  INFO [pool-211-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:12,616  INFO [pool-211-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:12,617  INFO [pool-211-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:12,617  INFO [pool-211-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:12,624  INFO [pool-211-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:12,629  INFO [pool-211-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:12,629  INFO [pool-211-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T22:26:12,629  INFO [pool-211-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:12,629  INFO [pool-211-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:12,631  INFO [pool-211-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00000_0]
2024-04-23T22:26:12,644  INFO [pool-211-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:26:12,644  INFO [pool-211-thread-1] mapred.Task: Task:attempt_local1527889309_0043_r_000000_0 is done. And is in the process of committing
2024-04-23T22:26:12,644  INFO [pool-211-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:12,644  INFO [pool-211-thread-1] mapred.Task: Task 'attempt_local1527889309_0043_r_000000_0' done.
2024-04-23T22:26:12,645  INFO [pool-211-thread-1] mapred.Task: Final Counters for attempt_local1527889309_0043_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=927027
		FILE: Number of bytes written=50701974
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1234173952
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:12,645  INFO [pool-211-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1527889309_0043_r_000000_0
2024-04-23T22:26:12,645  INFO [pool-211-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1527889309_0043_r_000001_0
2024-04-23T22:26:12,645  INFO [pool-211-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:12,645  INFO [pool-211-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@75e8c3f5
2024-04-23T22:26:12,645  WARN [pool-211-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:12,646  INFO [pool-211-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:12,646  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1527889309_0043_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:12,649  INFO [localfetcher#62] reduce.LocalFetcher: localfetcher#62 about to shuffle output of map attempt_local1527889309_0043_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:12,649  INFO [localfetcher#62] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1527889309_0043_m_000000_0
2024-04-23T22:26:12,649  INFO [localfetcher#62] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:12,650  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:12,650  INFO [pool-211-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:12,650  INFO [pool-211-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:12,656  INFO [pool-211-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:12,656  INFO [pool-211-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:12,658  INFO [pool-211-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:12,659  INFO [pool-211-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:12,659  INFO [pool-211-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:12,659  INFO [pool-211-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:12,659  INFO [pool-211-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:12,659  INFO [pool-211-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:12,659  INFO [pool-211-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:12,660  INFO [pool-211-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,91KB
2024-04-23T22:26:12,661  INFO [pool-211-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:12,661  INFO [pool-211-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:12,661  INFO [pool-211-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:12,661  INFO [pool-211-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:12,661  INFO [pool-211-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1527889309_0043/job_local1527889309_0043.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@e0f4531
2024-04-23T22:26:12,662  INFO [pool-211-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:12,662  INFO [pool-211-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:12,662  INFO [pool-211-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:12,662  INFO [pool-211-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:12,662  INFO [pool-211-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:12,667  INFO [pool-211-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:12,667  INFO [pool-211-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:12,667  INFO [pool-211-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:12,667  INFO [pool-211-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:12,667  INFO [pool-211-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:12,669  INFO [pool-211-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0001/bucket_00001_0]
2024-04-23T22:26:12,679  INFO [pool-211-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:12,679  INFO [pool-211-thread-1] mapred.Task: Task:attempt_local1527889309_0043_r_000001_0 is done. And is in the process of committing
2024-04-23T22:26:12,679  INFO [pool-211-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:12,680  INFO [pool-211-thread-1] mapred.Task: Task 'attempt_local1527889309_0043_r_000001_0' done.
2024-04-23T22:26:12,680  INFO [pool-211-thread-1] mapred.Task: Final Counters for attempt_local1527889309_0043_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=933099
		FILE: Number of bytes written=50703008
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1234173952
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:12,680  INFO [pool-211-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1527889309_0043_r_000001_0
2024-04-23T22:26:12,680  INFO [Thread-3597] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:26:13,572 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:26:13,572  INFO [main] exec.Task: 2024-04-23 22:26:13,572 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1527889309_0043
2024-04-23T22:26:13,575  INFO [main] exec.Task: Ended Job = job_local1527889309_0043
2024-04-23T22:26:13,576  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest with attemptId 0.
2024-04-23T22:26:13,576  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest with attemptId 0.
2024-04-23T22:26:13,576  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000000_0.manifest
2024-04-23T22:26:13,576  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001/000001_0.manifest
2024-04-23T22:26:13,577  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0001
2024-04-23T22:26:13,578  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:26:13,578  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:13,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,585  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,591  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:13,610  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:26:13,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,615  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,616  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:26:13,616  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-12_114_3660119870326533-1/-mr-10000
2024-04-23T22:26:13,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,624  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,645  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:26:13,645  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:26:13,645  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:26:13,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:13,664  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:26:13,664  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:26:13,664  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:26:13,665  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2701, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:26:13,665  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:13,665  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=38, isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=1, getTable_(GetTableRequest)=26}
MapReduce Jobs Launched: 
2024-04-23T22:26:13,665  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:26:13,666  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:13,666  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:13,666  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222612_df53c16e-d321-4074-a4f0-a20b6a918e47); Time taken: 1.414 seconds
2024-04-23T22:26:13,666  INFO [main] ql.TxnCommandsBaseForTests: Running the query: commit
2024-04-23T22:26:13,666  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-12_114_3660119870326533-1
2024-04-23T22:26:13,667  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6a9bdb66-d5e2-411c-b8be-bab1675b24fe/hive_2024-04-23_22-26-12_114_3660119870326533-1 on fs with scheme file
2024-04-23T22:26:13,667  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222613_39e045c0-946b-4b11-ac6a-5ccef009dc28): commit
2024-04-23T22:26:13,667  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:13,667  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:13,667  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:13,668  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:13,668  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:13,668  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:13,668  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=0}
2024-04-23T22:26:13,668  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222613_39e045c0-946b-4b11-ac6a-5ccef009dc28); Time taken: 0.001 seconds
2024-04-23T22:26:13,668  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222613_39e045c0-946b-4b11-ac6a-5ccef009dc28
2024-04-23T22:26:13,668  INFO [main] ql.Driver: Operation COMMIT obtained 0 locks
2024-04-23T22:26:13,668  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222613_39e045c0-946b-4b11-ac6a-5ccef009dc28): commit
2024-04-23T22:26:13,668  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:13,668  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T22:26:13,669  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222613_39e045c0-946b-4b11-ac6a-5ccef009dc28); Time taken: 0.0 seconds
2024-04-23T22:26:13,669  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222613_39e045c0-946b-4b11-ac6a-5ccef009dc28
2024-04-23T22:26:13,679  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:13,680  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:26:13,680  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 2
2024-04-23T22:26:13,681  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222613_51cd05be-2c7b-4b45-b341-eb5c74d6fe14): delete from acidTbl where b = 2
2024-04-23T22:26:13,689  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:26:13,689  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:26:13,690  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:26:13,690  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:13,696  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,696  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 2> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:26:13,697  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:26:13,699  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:13,699  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:26:13,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,706  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,707  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:26:13,707  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:26:13,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:13,715  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,715  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:13,715  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:13,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,756  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-23T22:26:13,757  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,765  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:13,772  INFO [Heartbeater-4] lockmgr.DbTxnManager: Sending heartbeat for txnid:14 and lockid:0 queryId=null txnid:0
2024-04-23T22:26:13,775  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,776  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:26:13,785  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-23T22:26:13,785  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-23T22:26:13,841  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:26:13,841  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:26:13,841  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:26:13,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:13,848  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,850 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:26:13,851 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:26:13,851  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:26:13,852 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteOfMultipleInserts(TestTxnCommands.java:826)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:26:13,852  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:13,852  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, getValidTxns_(long)=0, getTableColumnStatistics_(String, String, List, String)=28, getTable_(GetTableRequest)=27, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=8}
2024-04-23T22:26:13,852  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222613_51cd05be-2c7b-4b45-b341-eb5c74d6fe14); Time taken: 0.171 seconds
2024-04-23T22:26:13,852  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:26:13,856  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:13,863  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:26:13,863  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0): drop table if exists acidTbl
2024-04-23T22:26:13,865  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 14
2024-04-23T22:26:13,866  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:26:13,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:13,872  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,872  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:13,872  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:13,872  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:13,872  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, rollbackTxn_(long)=10, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:13,872  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0); Time taken: 0.009 seconds
2024-04-23T22:26:13,873  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0
2024-04-23T22:26:13,873  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0
2024-04-23T22:26:13,888  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:26:13,888  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:13,888  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0): drop table if exists acidTbl
2024-04-23T22:26:13,888  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:13,888  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:13,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:13,900  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:13,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:14,010  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,011  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=116, getTable_(GetTableRequest)=6}
2024-04-23T22:26:14,011  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0); Time taken: 0.122 seconds
2024-04-23T22:26:14,011  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222613_afa9025e-98f1-4abe-bf77-b038cc6816b0
2024-04-23T22:26:14,017  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:26:14,029  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,031  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:26:14,032  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:26:14,033  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709): drop table if exists acidTblPart
2024-04-23T22:26:14,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 14
2024-04-23T22:26:14,037  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:26:14,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:14,058  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,058  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,058  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,059  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,059  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=21, openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=17, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,059  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709); Time taken: 0.026 seconds
2024-04-23T22:26:14,059  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709
2024-04-23T22:26:14,059  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709
2024-04-23T22:26:14,081  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:26:14,081  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:14,081  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709): drop table if exists acidTblPart
2024-04-23T22:26:14,081  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:14,088  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:14,094  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:14,136  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,136  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=48, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,137  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709); Time taken: 0.055 seconds
2024-04-23T22:26:14,137  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_352e5e1d-f9ea-4bc9-aafd-5f5685b00709
2024-04-23T22:26:14,141  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:26:14,148  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,148  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:26:14,148  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:26:14,148  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_cfe29db9-a3d6-4ee4-baf7-337d69555fea): drop table if exists acidTbl2
2024-04-23T22:26:14,151  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 14
2024-04-23T22:26:14,151  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:26:14,152  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,152  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,152  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,152  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=0}
2024-04-23T22:26:14,152  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_cfe29db9-a3d6-4ee4-baf7-337d69555fea); Time taken: 0.004 seconds
2024-04-23T22:26:14,152  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222614_cfe29db9-a3d6-4ee4-baf7-337d69555fea
2024-04-23T22:26:14,152  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:14,152  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_cfe29db9-a3d6-4ee4-baf7-337d69555fea): drop table if exists acidTbl2
2024-04-23T22:26:14,152  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,153  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:26:14,153  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,153  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T22:26:14,153  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_cfe29db9-a3d6-4ee4-baf7-337d69555fea); Time taken: 0.001 seconds
2024-04-23T22:26:14,153  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_cfe29db9-a3d6-4ee4-baf7-337d69555fea
2024-04-23T22:26:14,159  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:26:14,166  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,166  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:26:14,167  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:26:14,167  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:14,170  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 14
2024-04-23T22:26:14,171  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:26:14,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:14,194  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,194  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,194  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,194  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,194  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=23, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=4, flushCache_()=0}
2024-04-23T22:26:14,195  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af); Time taken: 0.027 seconds
2024-04-23T22:26:14,195  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af
2024-04-23T22:26:14,195  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af
2024-04-23T22:26:14,211  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:26:14,211  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:14,211  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:14,211  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:14,219  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:14,229  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,229  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:14,288  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,288  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=68, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,288  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af); Time taken: 0.077 seconds
2024-04-23T22:26:14,288  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_a5e31f32-57eb-40e9-8e08-82c1d3bd67af
2024-04-23T22:26:14,293  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:26:14,300  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,300  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:26:14,300  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:14,301  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:14,304  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 14
2024-04-23T22:26:14,305  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:26:14,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:14,313  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,313  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,313  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,313  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,314  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8, getValidTxns_(long)=0}
2024-04-23T22:26:14,314  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f); Time taken: 0.012 seconds
2024-04-23T22:26:14,314  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f
2024-04-23T22:26:14,314  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f
2024-04-23T22:26:14,330  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:26:14,330  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:14,330  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:14,330  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:14,338  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:14,346  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:14,377  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,377  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=39}
2024-04-23T22:26:14,377  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f); Time taken: 0.047 seconds
2024-04-23T22:26:14,377  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_3d58cd16-3782-40b7-84b4-2564734c446f
2024-04-23T22:26:14,382  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:26:14,390  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,390  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:26:14,391  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:26:14,391  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2): drop table if exists nonAcidNonBucket
2024-04-23T22:26:14,394  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 14
2024-04-23T22:26:14,394  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:26:14,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:14,404  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,404  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,404  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,404  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,404  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1}
2024-04-23T22:26:14,404  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2); Time taken: 0.013 seconds
2024-04-23T22:26:14,404  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2
2024-04-23T22:26:14,405  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2
2024-04-23T22:26:14,420  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:26:14,421  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:14,421  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2): drop table if exists nonAcidNonBucket
2024-04-23T22:26:14,421  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:14,430  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:14,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:14,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:14,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=41}
2024-04-23T22:26:14,471  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2); Time taken: 0.05 seconds
2024-04-23T22:26:14,471  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_fadf5bba-e1a8-4457-b9ec-6282d6a0d6c2
2024-04-23T22:26:14,476  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:26:14,483  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,483  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:26:14,484  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testUpdateDeleteOfInserts" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="7.657">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = 1 where b != 1 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateDeleteOfInserts(TestTxnCommands.java:883)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:26:14,547  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:26:14,547  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:26:14,547  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:26:14,548  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:26:14,550  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 881b72a6-4a4f-4f09-a71c-327a1099c67d
2024-04-23T22:26:14,553  INFO [main] SessionState: Hive Session ID = 881b72a6-4a4f-4f09-a71c-327a1099c67d
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:26:14,554  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:26:14,559  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/881b72a6-4a4f-4f09-a71c-327a1099c67d
2024-04-23T22:26:14,562  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d
2024-04-23T22:26:14,564  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/881b72a6-4a4f-4f09-a71c-327a1099c67d/_tmp_space.db
2024-04-23T22:26:14,565  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=881b72a6-4a4f-4f09-a71c-327a1099c67d, clientType=HIVECLI]
2024-04-23T22:26:14,565  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:26:14,565  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_185f8780-6507-4998-af49-95e3dd9053c1): drop table if exists acidTbl
2024-04-23T22:26:14,575  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:26:14,576  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:26:14,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:14,584  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,584  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,584  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,584  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=10, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=2}
2024-04-23T22:26:14,584  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_185f8780-6507-4998-af49-95e3dd9053c1); Time taken: 0.019 seconds
2024-04-23T22:26:14,584  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222614_185f8780-6507-4998-af49-95e3dd9053c1
2024-04-23T22:26:14,584  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:14,584  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_185f8780-6507-4998-af49-95e3dd9053c1): drop table if exists acidTbl
2024-04-23T22:26:14,585  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:14,588  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,588  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,588  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_185f8780-6507-4998-af49-95e3dd9053c1); Time taken: 0.004 seconds
2024-04-23T22:26:14,588  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_185f8780-6507-4998-af49-95e3dd9053c1
2024-04-23T22:26:14,595  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:26:14,603  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,603  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:26:14,604  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:26:14,604  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_56ecb411-56f6-43b4-9525-18227f0f680a): drop table if exists acidTblPart
2024-04-23T22:26:14,607  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:26:14,607  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:26:14,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:14,611  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,611  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,611  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,611  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=1}
2024-04-23T22:26:14,611  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_56ecb411-56f6-43b4-9525-18227f0f680a); Time taken: 0.007 seconds
2024-04-23T22:26:14,612  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222614_56ecb411-56f6-43b4-9525-18227f0f680a
2024-04-23T22:26:14,612  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:14,612  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_56ecb411-56f6-43b4-9525-18227f0f680a): drop table if exists acidTblPart
2024-04-23T22:26:14,612  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,612  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:14,615  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,616  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,616  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_56ecb411-56f6-43b4-9525-18227f0f680a); Time taken: 0.003 seconds
2024-04-23T22:26:14,616  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_56ecb411-56f6-43b4-9525-18227f0f680a
2024-04-23T22:26:14,623  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:26:14,635  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,635  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:26:14,636  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:26:14,637  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_a9bf91e9-a8ed-45d5-ad38-2ebd52c3b8a5): drop table if exists acidTbl2
2024-04-23T22:26:14,639  INFO [Metastore Scheduled Worker 0] metastore.HMSHandler: 6: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T22:26:14,640  INFO [Metastore Scheduled Worker 0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@18a82afd, with PersistenceManager: null will be shutdown
2024-04-23T22:26:14,640  INFO [Metastore Scheduled Worker 0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@18a82afd, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3120b072 created in the thread with id: 44
2024-04-23T22:26:14,643  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:26:14,643  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:26:14,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:26:14,649  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,649  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,649  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,649  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=20, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=6}
2024-04-23T22:26:14,649  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_a9bf91e9-a8ed-45d5-ad38-2ebd52c3b8a5); Time taken: 0.013 seconds
2024-04-23T22:26:14,650  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222614_a9bf91e9-a8ed-45d5-ad38-2ebd52c3b8a5
2024-04-23T22:26:14,650  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:14,650  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_a9bf91e9-a8ed-45d5-ad38-2ebd52c3b8a5): drop table if exists acidTbl2
2024-04-23T22:26:14,650  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,650  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:26:14,659  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,659  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,660  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_a9bf91e9-a8ed-45d5-ad38-2ebd52c3b8a5); Time taken: 0.009 seconds
2024-04-23T22:26:14,660  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_a9bf91e9-a8ed-45d5-ad38-2ebd52c3b8a5
2024-04-23T22:26:14,673  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:26:14,693  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,694  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:26:14,694  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:26:14,695  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_bd619d16-100b-4763-85e8-1b79d803a15c): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:14,695  INFO [Metastore Scheduled Worker 0] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@18a82afd from thread id: 44
2024-04-23T22:26:14,698  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:26:14,698  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:26:14,699  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:14,704  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,704  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=34, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_bd619d16-100b-4763-85e8-1b79d803a15c); Time taken: 0.01 seconds
2024-04-23T22:26:14,705  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222614_bd619d16-100b-4763-85e8-1b79d803a15c
2024-04-23T22:26:14,705  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:14,705  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_bd619d16-100b-4763-85e8-1b79d803a15c): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:14,705  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:14,710  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,710  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,710  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_bd619d16-100b-4763-85e8-1b79d803a15c); Time taken: 0.005 seconds
2024-04-23T22:26:14,711  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_bd619d16-100b-4763-85e8-1b79d803a15c
2024-04-23T22:26:14,721  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:26:14,730  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,730  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:26:14,748  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:14,748  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_4a14aa90-e7c0-41a2-8483-a3ba045d0428): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:14,751  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:26:14,751  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:26:14,752  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:14,755  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,755  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,755  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,755  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=37}
2024-04-23T22:26:14,756  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_4a14aa90-e7c0-41a2-8483-a3ba045d0428); Time taken: 0.007 seconds
2024-04-23T22:26:14,756  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222614_4a14aa90-e7c0-41a2-8483-a3ba045d0428
2024-04-23T22:26:14,756  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:14,756  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_4a14aa90-e7c0-41a2-8483-a3ba045d0428): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:14,756  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,756  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:14,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,759  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,760  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_4a14aa90-e7c0-41a2-8483-a3ba045d0428); Time taken: 0.003 seconds
2024-04-23T22:26:14,760  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_4a14aa90-e7c0-41a2-8483-a3ba045d0428
2024-04-23T22:26:14,766  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:26:14,774  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,774  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:26:14,774  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:26:14,775  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_d5999e24-e1ca-4815-88e7-ff6e961e2020): drop table if exists nonAcidNonBucket
2024-04-23T22:26:14,777  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:26:14,777  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:26:14,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:14,781  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,781  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,781  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,781  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,781  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_d5999e24-e1ca-4815-88e7-ff6e961e2020); Time taken: 0.006 seconds
2024-04-23T22:26:14,782  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222614_d5999e24-e1ca-4815-88e7-ff6e961e2020
2024-04-23T22:26:14,782  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:14,782  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_d5999e24-e1ca-4815-88e7-ff6e961e2020): drop table if exists nonAcidNonBucket
2024-04-23T22:26:14,782  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:14,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,785  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,785  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_d5999e24-e1ca-4815-88e7-ff6e961e2020); Time taken: 0.003 seconds
2024-04-23T22:26:14,785  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_d5999e24-e1ca-4815-88e7-ff6e961e2020
2024-04-23T22:26:14,793  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:26:14,801  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,801  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:26:14,802  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:14,802  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:14,804  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:26:14,804  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:26:14,805  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:14,805  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:14,813  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:26:14,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:14,815  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:14,815  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,815  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,815  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,815  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=8, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=15}
2024-04-23T22:26:14,816  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6); Time taken: 0.013 seconds
2024-04-23T22:26:14,816  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6
2024-04-23T22:26:14,816  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6
2024-04-23T22:26:14,837  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:26:14,837  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:14,838  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:14,838  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936374, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, numFilesErasureCoded=0, bucketing_version=2, numFiles=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:26:14,844  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:14,881  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,881  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=43}
2024-04-23T22:26:14,882  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6); Time taken: 0.043 seconds
2024-04-23T22:26:14,882  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_9e113b8c-66c6-45c7-9833-139d7d7872c6
2024-04-23T22:26:14,886  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:26:14,892  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,893  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:26:14,893  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:14,894  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:14,902  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:26:14,903  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:26:14,903  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:14,903  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:14,907  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:26:14,907  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:14,909  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:14,909  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,910  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,910  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,910  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=9}
2024-04-23T22:26:14,910  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e); Time taken: 0.017 seconds
2024-04-23T22:26:14,910  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e
2024-04-23T22:26:14,911  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e
2024-04-23T22:26:14,933  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:26:14,933  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:14,933  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:14,933  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:14,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936374, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:26:14,942  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:26:14,961  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:14,961  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=27}
2024-04-23T22:26:14,961  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e); Time taken: 0.028 seconds
2024-04-23T22:26:14,961  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_659e52a9-1223-422f-94ac-471cb3a9a45e
2024-04-23T22:26:14,966  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:26:14,974  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:14,974  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:26:14,974  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:14,974  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:14,977  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:26:14,977  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:26:14,977  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:14,977  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:14,981  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:26:14,981  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:14,983  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:14,983  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:14,983  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:14,983  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:14,983  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:14,983  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841); Time taken: 0.009 seconds
2024-04-23T22:26:14,983  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841
2024-04-23T22:26:14,984  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841
2024-04-23T22:26:14,999  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:26:14,999  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:15,000  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:15,000  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:15,000  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936375, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numRows=0, numFiles=0, bucketing_version=2, totalSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:15,006  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:26:15,021  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:15,021  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T22:26:15,021  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841); Time taken: 0.021 seconds
2024-04-23T22:26:15,021  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222614_162acccb-632b-4dfd-8850-eb1129e50841
2024-04-23T22:26:15,026  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:26:15,034  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:15,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:26:15,035  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:15,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:15,038  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:26:15,038  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:26:15,039  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:15,039  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:15,042  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:26:15,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:15,044  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:15,044  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:15,044  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:15,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:15,045  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=14, getDatabase_(String)=2, openTxn_(String, TxnType)=2}
2024-04-23T22:26:15,045  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3); Time taken: 0.009 seconds
2024-04-23T22:26:15,045  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3
2024-04-23T22:26:15,045  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3
2024-04-23T22:26:15,063  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:26:15,063  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:15,064  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:15,064  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:15,065  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936375, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, transactional=false, numFilesErasureCoded=0, rawDataSize=0, totalSize=0, numFiles=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:15,071  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:26:15,086  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:15,086  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:15,086  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3); Time taken: 0.023 seconds
2024-04-23T22:26:15,086  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222615_7e620a94-66ff-4b79-8553-84d4da92aad3
2024-04-23T22:26:15,091  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:26:15,098  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:15,098  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:26:15,099  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:15,099  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:15,102  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:26:15,103  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:26:15,103  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:15,103  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:15,107  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:26:15,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:15,110  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:15,110  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:15,110  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:15,110  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:15,110  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0}
2024-04-23T22:26:15,110  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902); Time taken: 0.011 seconds
2024-04-23T22:26:15,110  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902
2024-04-23T22:26:15,111  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902
2024-04-23T22:26:15,128  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:26:15,128  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:15,129  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:15,129  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:15,130  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/881b72a6-4a4f-4f09-a71c-327a1099c67d/_tmp_space.db/000262da-e422-4168-ae15-4986e15fc768
2024-04-23T22:26:15,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:15,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:26:15,134  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902); Time taken: 0.004 seconds
2024-04-23T22:26:15,134  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222615_fcccc3dd-5e46-4c69-b3e1-02cbdc37a902
2024-04-23T22:26:15,141  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:26:15,150  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:15,150  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:26:15,151  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:15,151  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:15,153  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:26:15,154  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:26:15,154  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:15,154  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:15,157  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:26:15,157  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:15,158  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:15,158  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:15,159  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:15,159  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:15,159  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=16, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, getDatabase_(String)=1, getValidTxns_(long)=0}
2024-04-23T22:26:15,159  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632); Time taken: 0.008 seconds
2024-04-23T22:26:15,159  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632
2024-04-23T22:26:15,159  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632
2024-04-23T22:26:15,175  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:26:15,175  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:15,175  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:15,176  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:15,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936375, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, numFiles=0, rawDataSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:15,182  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:26:15,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:15,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T22:26:15,197  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632); Time taken: 0.022 seconds
2024-04-23T22:26:15,197  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222615_508803a7-b1cc-41b0-a1b6-1dec3404b632
2024-04-23T22:26:15,203  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:26:15,211  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:15,211  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:26:15,212  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:26:15,212  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:26:15,214  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:26:15,215  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:26:15,215  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:15,215  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:15,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:15,246  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:15,246  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:15,246  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:15,246  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:15,246  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:15,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:15,254  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:15,254  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:15,254  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:15,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:15,367  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:15,367  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:15,367  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:15,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:15,369  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:15,369  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:15,369  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:15,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:15,376  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:15,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:15,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:15,387  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T22:26:15,388  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T22:26:15,389  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:26:15,392  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:26:15,392  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:26:15,393  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:26:15,394  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:26:15,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:15,408  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:15,409  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:26:15,409  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:15,409  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:15,409  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:26:15,409  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:15,409  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=40, getTable_(GetTableRequest)=46, getValidTxns_(long)=0, flushCache_()=0, allocateTableWriteId_(long, String, String)=9, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T22:26:15,409  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97); Time taken: 0.197 seconds
2024-04-23T22:26:15,410  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97
2024-04-23T22:26:15,410  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97
2024-04-23T22:26:15,433  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:26:15,433  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:26:15,436  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:26:15,436  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97
2024-04-23T22:26:15,436  INFO [main] ql.Driver: Query ID = alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97
Total jobs = 1
2024-04-23T22:26:15,437  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:26:15,437  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:26:15,576  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:26:15,577  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:26:15,577  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:26:15,577  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:26:15,577  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:26:15,577  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:26:15,577  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:26:15,577  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:26:15,579  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:26:15,579  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:26:15,579  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-15_212_5314780878156857991-1/dummy_path
2024-04-23T22:26:15,590  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:26:15,591  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:26:15,595  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:26:15,596  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:15,597  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:15,601  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-15_212_5314780878156857991-1/-mr-10000
2024-04-23T22:26:15,603  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:15,611  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:26:15,616  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:26:15,617  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:26:15,617  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:26:15,617  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-15_212_5314780878156857991-1/dummy_path
2024-04-23T22:26:15,617  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:26:15,636  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:26:15,661  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2074458415_0044
2024-04-23T22:26:15,662  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:26:15,734  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:26:15,734  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:26:15,735  INFO [Thread-3705] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:15,735  INFO [Thread-3705] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:15,736  INFO [Thread-3705] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:26:15,737  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2074458415_0044_m_000000_0
2024-04-23T22:26:15,739  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:15,740  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-15_212_5314780878156857991-1/dummy_path/null:0+1
2024-04-23T22:26:15,742  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:15,743  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:26:15,743  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:26:15,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:15,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:15,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:15,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:15,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:15,748  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:15,748  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:15,748  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:15,749  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:15,749  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:15,749  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:26:15,749  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:26:15,749  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:26:15,749  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:26:15,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:26:15,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:15,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:26:15,750  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:26:15,750  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:26:15,751  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T22:26:15,754  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:15,754  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:15,754  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:15,754  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:26:15,754  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:26:15,765  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:15,770  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2074458415_0044_m_000000_0 is done. And is in the process of committing
2024-04-23T22:26:15,771  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:26:15,771  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2074458415_0044_m_000000_0' done.
2024-04-23T22:26:15,771  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2074458415_0044_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=939161
		FILE: Number of bytes written=51883056
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239416832
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-23T22:26:15,771  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2074458415_0044_m_000000_0
2024-04-23T22:26:15,771  INFO [Thread-3705] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:26:15,772  INFO [Thread-3705] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:26:15,772  INFO [pool-216-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2074458415_0044_r_000000_0
2024-04-23T22:26:15,774  INFO [pool-216-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:15,775  INFO [pool-216-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@30350fdf
2024-04-23T22:26:15,775  WARN [pool-216-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:15,776  INFO [pool-216-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:15,776  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2074458415_0044_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:15,779  INFO [localfetcher#63] reduce.LocalFetcher: localfetcher#63 about to shuffle output of map attempt_local2074458415_0044_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:15,779  INFO [localfetcher#63] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local2074458415_0044_m_000000_0
2024-04-23T22:26:15,779  INFO [localfetcher#63] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:15,780  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:15,780  INFO [pool-216-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:15,780  INFO [pool-216-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:15,786  INFO [pool-216-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:15,786  INFO [pool-216-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:15,789  INFO [pool-216-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:15,789  INFO [pool-216-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:15,789  INFO [pool-216-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:15,789  INFO [pool-216-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:15,789  INFO [pool-216-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:15,789  INFO [pool-216-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:15,790  INFO [pool-216-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:15,790  INFO [pool-216-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:15,791  INFO [pool-216-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:15,791  INFO [pool-216-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:15,791  INFO [pool-216-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:15,791  INFO [pool-216-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:15,791  INFO [pool-216-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2074458415_0044/job_local2074458415_0044.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@36fb9d39
2024-04-23T22:26:15,792  INFO [pool-216-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:15,792  INFO [pool-216-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:15,792  INFO [pool-216-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:15,792  INFO [pool-216-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:15,793  INFO [pool-216-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:15,800  INFO [pool-216-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:15,806  INFO [pool-216-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:15,806  INFO [pool-216-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T22:26:15,806  INFO [pool-216-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:15,806  INFO [pool-216-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:15,808  INFO [pool-216-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:26:15,822  INFO [pool-216-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:26:15,823  INFO [pool-216-thread-1] mapred.Task: Task:attempt_local2074458415_0044_r_000000_0 is done. And is in the process of committing
2024-04-23T22:26:15,823  INFO [pool-216-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:15,823  INFO [pool-216-thread-1] mapred.Task: Task 'attempt_local2074458415_0044_r_000000_0' done.
2024-04-23T22:26:15,824  INFO [pool-216-thread-1] mapred.Task: Final Counters for attempt_local2074458415_0044_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=945266
		FILE: Number of bytes written=51884095
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239416832
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:15,824  INFO [pool-216-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2074458415_0044_r_000000_0
2024-04-23T22:26:15,824  INFO [pool-216-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2074458415_0044_r_000001_0
2024-04-23T22:26:15,824  INFO [pool-216-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:15,824  INFO [pool-216-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@64a8abee
2024-04-23T22:26:15,824  WARN [pool-216-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:15,825  INFO [pool-216-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:15,826  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2074458415_0044_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:15,828  INFO [localfetcher#64] reduce.LocalFetcher: localfetcher#64 about to shuffle output of map attempt_local2074458415_0044_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:15,829  INFO [localfetcher#64] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local2074458415_0044_m_000000_0
2024-04-23T22:26:15,829  INFO [localfetcher#64] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:15,829  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:15,829  INFO [pool-216-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:15,830  INFO [pool-216-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:15,836  INFO [pool-216-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:15,836  INFO [pool-216-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:15,839  INFO [pool-216-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:15,840  INFO [pool-216-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:15,840  INFO [pool-216-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:15,840  INFO [pool-216-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:15,840  INFO [pool-216-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:15,840  INFO [pool-216-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:15,840  INFO [pool-216-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:15,841  INFO [pool-216-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2074458415_0044/job_local2074458415_0044.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@37b10763
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:15,842  INFO [pool-216-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:15,843  INFO [pool-216-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:15,843  INFO [pool-216-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:15,848  INFO [pool-216-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:15,848  INFO [pool-216-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:15,848  INFO [pool-216-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:15,848  INFO [pool-216-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:15,848  INFO [pool-216-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:15,850  INFO [pool-216-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:26:15,859  INFO [pool-216-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:26:15,860  INFO [pool-216-thread-1] mapred.Task: Task:attempt_local2074458415_0044_r_000001_0 is done. And is in the process of committing
2024-04-23T22:26:15,860  INFO [pool-216-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:15,860  INFO [pool-216-thread-1] mapred.Task: Task 'attempt_local2074458415_0044_r_000001_0' done.
2024-04-23T22:26:15,860  INFO [pool-216-thread-1] mapred.Task: Final Counters for attempt_local2074458415_0044_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=951347
		FILE: Number of bytes written=51885123
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239416832
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:15,860  INFO [pool-216-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2074458415_0044_r_000001_0
2024-04-23T22:26:15,861  INFO [Thread-3705] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:26:16,735 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:26:16,736  INFO [main] exec.Task: 2024-04-23 22:26:16,735 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2074458415_0044
2024-04-23T22:26:16,737  INFO [main] exec.Task: Ended Job = job_local2074458415_0044
2024-04-23T22:26:16,738  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:26:16,738  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:26:16,738  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:26:16,739  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:26:16,739  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:26:16,740  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:26:16,741  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:16,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:16,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,760  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:16,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:16,798  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:26:16,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,804  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:16,804  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:26:16,804  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-15_212_5314780878156857991-1/-mr-10000
2024-04-23T22:26:16,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,811  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:16,822  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:26:16,822  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:26:16,822  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:26:16,823  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:16,842  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:26:16,842  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:26:16,842  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:26:16,845  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:26:16,845  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:16,846  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, getTable_(GetTableRequest)=31, alter_table_(String, String, String, Table, EnvironmentContext, String)=55, isCompatibleWith_(Configuration)=1}
MapReduce Jobs Launched: 
2024-04-23T22:26:16,846  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:26:16,846  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:16,846  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:16,846  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97); Time taken: 1.409 seconds
2024-04-23T22:26:16,846  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222615_d4b03527-35b3-49e7-ba54-f9ac2469db97
2024-04-23T22:26:16,857  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:16,857  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:26:16,858  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T22:26:16,858  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-15_212_5314780878156857991-1
2024-04-23T22:26:16,858  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-15_212_5314780878156857991-1 on fs with scheme file
2024-04-23T22:26:16,859  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131): select a,b from acidTbl order by a,b
2024-04-23T22:26:16,861  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:26:16,861  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:26:16,862  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:16,862  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:16,864  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:16,864  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:16,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,871  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:16,871  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:16,871  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:16,871  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:16,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,892  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:26:16,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,900  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:16,901  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:16,908  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:16,909  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:26:16,920  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T22:26:16,920  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T22:26:16,960  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:16,960  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:16,960  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:16,961  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-16_858_3720847777414853991-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-16_858_3720847777414853991-1
2024-04-23T22:26:16,968  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:26:16,970  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:26:16,971  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T22:26:16,972  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:26:16,980  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:26:16,980  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:16,980  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:16,980  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T22:26:16,981  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T22:26:16,981  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:16,981  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getTableColumnStatistics_(String, String, List, String)=28, getTable_(GetTableRequest)=6, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=6}
2024-04-23T22:26:16,981  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131); Time taken: 0.122 seconds
2024-04-23T22:26:16,982  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131
2024-04-23T22:26:16,982  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131
2024-04-23T22:26:16,997  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:26:16,997  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:26:16,997  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131): select a,b from acidTbl order by a,b
2024-04-23T22:26:16,998  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131
2024-04-23T22:26:16,998  INFO [main] ql.Driver: Query ID = alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131
Total jobs = 1
2024-04-23T22:26:16,998  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:26:16,998  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:26:17,121  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:26:17,121  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:26:17,121  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:26:17,121  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:26:17,121  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:26:17,121  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:26:17,121  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:26:17,121  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:26:17,124  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:26:17,124  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T22:26:17,124  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:17,133  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:26:17,134  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:26:17,139  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:26:17,139  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:26:17,140  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:17,146  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:17,153  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:26:17,157  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:26:17,158  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T22:26:17,158  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T22:26:17,158  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:17,159  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T22:26:17,159  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T22:26:17,159  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T22:26:17,170  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T22:26:17,170  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 11 ms
2024-04-23T22:26:17,170  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T22:26:17,188  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T22:26:17,206  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local709747960_0045
2024-04-23T22:26:17,206  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:26:17,266  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:26:17,267  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:26:17,267  INFO [Thread-3782] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:17,267  INFO [Thread-3782] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:17,269  INFO [Thread-3782] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:26:17,269  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local709747960_0045_m_000000_0
2024-04-23T22:26:17,269  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:17,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:17,270  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:17,271  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:26:17,272  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:26:17,272  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:26:17,273  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:26:17,273  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:26:17,277  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:17,277  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:17,277  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:17,277  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:17,277  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:17,278  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:17,278  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:17,279  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:17,280  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, 
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:26:17,281  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:26:17,291  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:17,294  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local709747960_0045_m_000000_0 is done. And is in the process of committing
2024-04-23T22:26:17,294  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:17,294  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local709747960_0045_m_000000_0' done.
2024-04-23T22:26:17,295  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local709747960_0045_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=960526
		FILE: Number of bytes written=53057078
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239416832
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7474
2024-04-23T22:26:17,295  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local709747960_0045_m_000000_0
2024-04-23T22:26:17,295  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local709747960_0045_m_000001_0
2024-04-23T22:26:17,295  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:17,296  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:17,296  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:17,296  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:26:17,297  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:26:17,297  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:26:17,298  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:26:17,298  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:26:17,314  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:17,314  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:17,314  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:17,314  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:17,314  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:17,315  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:17,315  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:17,316  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:26:17,317  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-23T22:26:17,318  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:17,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:17,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:17,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:26:17,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:26:17,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:17,328  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local709747960_0045_m_000001_0 is done. And is in the process of committing
2024-04-23T22:26:17,329  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:17,329  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local709747960_0045_m_000001_0' done.
2024-04-23T22:26:17,329  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local709747960_0045_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=969005
		FILE: Number of bytes written=53057137
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=11
		Total committed heap usage (bytes)=1239941120
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7466
2024-04-23T22:26:17,329  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local709747960_0045_m_000001_0
2024-04-23T22:26:17,329  INFO [Thread-3782] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:26:17,330  INFO [Thread-3782] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:26:17,330  INFO [pool-221-thread-1] mapred.LocalJobRunner: Starting task: attempt_local709747960_0045_r_000000_0
2024-04-23T22:26:17,330  INFO [pool-221-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:17,330  INFO [pool-221-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@42fea7da
2024-04-23T22:26:17,331  WARN [pool-221-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:17,331  INFO [pool-221-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:17,332  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local709747960_0045_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:17,333  INFO [localfetcher#65] reduce.LocalFetcher: localfetcher#65 about to shuffle output of map attempt_local709747960_0045_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:26:17,333  INFO [localfetcher#65] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local709747960_0045_m_000001_0
2024-04-23T22:26:17,333  INFO [localfetcher#65] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T22:26:17,335  INFO [localfetcher#65] reduce.LocalFetcher: localfetcher#65 about to shuffle output of map attempt_local709747960_0045_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:26:17,335  INFO [localfetcher#65] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local709747960_0045_m_000000_0
2024-04-23T22:26:17,336  INFO [localfetcher#65] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T22:26:17,336  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:17,336  INFO [pool-221-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:26:17,336  INFO [pool-221-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:17,343  INFO [pool-221-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T22:26:17,343  INFO [pool-221-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-23T22:26:17,345  INFO [pool-221-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:17,345  INFO [pool-221-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-23T22:26:17,345  INFO [pool-221-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:17,345  INFO [pool-221-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:17,345  INFO [pool-221-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-23T22:26:17,345  INFO [pool-221-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:26:17,346  INFO [pool-221-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:17,346  INFO [pool-221-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:26:17,347  INFO [pool-221-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:17,347  INFO [pool-221-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:26:17,347  INFO [pool-221-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T22:26:17,347  INFO [pool-221-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:26:17,347  INFO [pool-221-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@48935102, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@6d591abc, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@595a051d
2024-04-23T22:26:17,348  INFO [pool-221-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-16_858_3720847777414853991-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-16_858_3720847777414853991-1/_tmp.-ext-10002/000000_0
2024-04-23T22:26:17,348  INFO [pool-221-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-16_858_3720847777414853991-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-16_858_3720847777414853991-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:26:17,348  INFO [pool-221-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-16_858_3720847777414853991-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-16_858_3720847777414853991-1/_tmp.-ext-10002/000000_0
2024-04-23T22:26:17,354  INFO [pool-221-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:26:17,355  INFO [pool-221-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:26:17,355  INFO [pool-221-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:17,355  INFO [pool-221-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:26:17,355  INFO [pool-221-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T22:26:17,355  INFO [pool-221-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:2, 
2024-04-23T22:26:17,355  INFO [pool-221-thread-1] mapred.Task: Task:attempt_local709747960_0045_r_000000_0 is done. And is in the process of committing
2024-04-23T22:26:17,356  INFO [pool-221-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:17,356  INFO [pool-221-thread-1] mapred.Task: Task 'attempt_local709747960_0045_r_000000_0' done.
2024-04-23T22:26:17,356  INFO [pool-221-thread-1] mapred.Task: Final Counters for attempt_local709747960_0045_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=974818
		FILE: Number of bytes written=53057316
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239941120
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:17,356  INFO [pool-221-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local709747960_0045_r_000000_0
2024-04-23T22:26:17,356  INFO [Thread-3782] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:26:18,268 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:26:18,268  INFO [main] exec.Task: 2024-04-23 22:26:18,268 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local709747960_0045
2024-04-23T22:26:18,269  INFO [main] exec.Task: Ended Job = job_local709747960_0045
2024-04-23T22:26:18,271  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:18,271  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T22:26:18,272  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:26:18,272  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:18,272  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:18,272  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131); Time taken: 1.274 seconds
2024-04-23T22:26:18,272  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222616_9bd6c805-0aa1-46f9-a930-de28e4384131
2024-04-23T22:26:18,278  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:26:18,287  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:18,287  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:26:18,292  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T22:26:18,293  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T22:26:18,293  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-23T22:26:18,293  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T22:26:18,294  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-16_858_3720847777414853991-1
2024-04-23T22:26:18,295  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-16_858_3720847777414853991-1 on fs with scheme file
2024-04-23T22:26:18,295  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222618_b8b9011d-0f18-47a0-b3d2-2ac415c20cfb): START TRANSACTION
2024-04-23T22:26:18,298  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:26:18,299  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:26:18,299  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:18,299  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:18,300  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:18,300  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:18,300  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:18,300  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:18,300  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=1, commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T22:26:18,300  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222618_b8b9011d-0f18-47a0-b3d2-2ac415c20cfb); Time taken: 0.005 seconds
2024-04-23T22:26:18,300  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222618_b8b9011d-0f18-47a0-b3d2-2ac415c20cfb
2024-04-23T22:26:18,300  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T22:26:18,300  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222618_b8b9011d-0f18-47a0-b3d2-2ac415c20cfb): START TRANSACTION
2024-04-23T22:26:18,301  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:18,301  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T22:26:18,301  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222618_b8b9011d-0f18-47a0-b3d2-2ac415c20cfb); Time taken: 0.001 seconds
2024-04-23T22:26:18,301  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:26:18,302  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:26:18,302  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:18,302  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:18,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:18,312  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:18,313  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:18,313  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:18,313  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:18,313  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:18,313  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:18,319  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:18,319  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:18,319  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:18,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:18,395  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:18,395  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:18,395  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:18,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:18,398  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:18,398  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:18,398  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:18,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:18,405  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:18,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:18,408  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:18,415  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 15
2024-04-23T22:26:18,415  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [15])
2024-04-23T22:26:18,416  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:26:18,419  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:26:18,419  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:26:18,420  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:26:18,420  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:26:18,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:18,437  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:18,437  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:26:18,437  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:18,437  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:18,437  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:26:18,438  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:18,438  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=26, getValidWriteIds_(List, String)=3, getCheckConstraints_(CheckConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=6, getNotNullConstraints_(NotNullConstraintsRequest)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, allocateTableWriteId_(long, String, String)=7}
2024-04-23T22:26:18,438  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0); Time taken: 0.135 seconds
2024-04-23T22:26:18,438  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0
2024-04-23T22:26:18,438  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0
2024-04-23T22:26:18,455  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:26:18,455  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:26:18,458  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0): insert into acidTbl(a,b)  values(5,6),(7,8)
2024-04-23T22:26:18,458  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0
2024-04-23T22:26:18,458  INFO [main] ql.Driver: Query ID = alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0
Total jobs = 1
2024-04-23T22:26:18,458  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:26:18,458  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:26:18,597  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:26:18,597  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:26:18,597  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:26:18,597  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:26:18,597  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:26:18,597  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:26:18,597  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:26:18,597  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:26:18,599  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:26:18,599  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:26:18,599  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-18_301_3587540355744530781-1/dummy_path
2024-04-23T22:26:18,608  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:26:18,609  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:26:18,613  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:26:18,614  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:18,615  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:18,618  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-18_301_3587540355744530781-1/-mr-10000
2024-04-23T22:26:18,620  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:18,626  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:26:18,630  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:26:18,632  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:26:18,632  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:26:18,632  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-18_301_3587540355744530781-1/dummy_path
2024-04-23T22:26:18,632  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:26:18,649  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:26:18,671  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local100838204_0046
2024-04-23T22:26:18,671  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:26:18,743  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:26:18,743  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:26:18,743  INFO [Thread-3835] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:18,743  INFO [Thread-3835] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:18,745  INFO [Thread-3835] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:26:18,745  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local100838204_0046_m_000000_0
2024-04-23T22:26:18,745  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:18,746  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-18_301_3587540355744530781-1/dummy_path/null:0+1
2024-04-23T22:26:18,746  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:18,747  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:26:18,747  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:26:18,752  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:18,752  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:18,752  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:18,752  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:18,752  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:18,752  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:18,753  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:18,753  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:26:18,754  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:26:18,755  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:26:18,756  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:26:18,766  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:18,769  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local100838204_0046_m_000000_0 is done. And is in the process of committing
2024-04-23T22:26:18,770  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:26:18,770  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local100838204_0046_m_000000_0' done.
2024-04-23T22:26:18,770  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local100838204_0046_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=980373
		FILE: Number of bytes written=54232538
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239941120
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-23T22:26:18,770  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local100838204_0046_m_000000_0
2024-04-23T22:26:18,770  INFO [Thread-3835] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:26:18,771  INFO [Thread-3835] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:26:18,771  INFO [pool-224-thread-1] mapred.LocalJobRunner: Starting task: attempt_local100838204_0046_r_000000_0
2024-04-23T22:26:18,772  INFO [pool-224-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:18,772  INFO [pool-224-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@402d3f9b
2024-04-23T22:26:18,772  WARN [pool-224-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:18,773  INFO [pool-224-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:18,773  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local100838204_0046_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:18,774  INFO [localfetcher#66] reduce.LocalFetcher: localfetcher#66 about to shuffle output of map attempt_local100838204_0046_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:18,774  INFO [localfetcher#66] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local100838204_0046_m_000000_0
2024-04-23T22:26:18,774  INFO [localfetcher#66] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:18,775  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:18,775  INFO [pool-224-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:18,775  INFO [pool-224-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:18,781  INFO [pool-224-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:18,781  INFO [pool-224-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:18,784  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:18,784  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:18,784  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:18,784  INFO [pool-224-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:18,784  INFO [pool-224-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:18,784  INFO [pool-224-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:18,784  INFO [pool-224-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:18,785  INFO [pool-224-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local100838204_0046/job_local100838204_0046.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@4504df05
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:18,786  INFO [pool-224-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:18,787  INFO [pool-224-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:18,787  INFO [pool-224-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:18,793  INFO [pool-224-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:18,798  INFO [pool-224-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:18,798  INFO [pool-224-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:18,798  INFO [pool-224-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:18,798  INFO [pool-224-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:18,800  INFO [pool-224-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0]
2024-04-23T22:26:18,811  INFO [pool-224-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.acidtbl:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:18,811  INFO [pool-224-thread-1] mapred.Task: Task:attempt_local100838204_0046_r_000000_0 is done. And is in the process of committing
2024-04-23T22:26:18,812  INFO [pool-224-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:18,812  INFO [pool-224-thread-1] mapred.Task: Task 'attempt_local100838204_0046_r_000000_0' done.
2024-04-23T22:26:18,812  INFO [pool-224-thread-1] mapred.Task: Final Counters for attempt_local100838204_0046_r_000000_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=986478
		FILE: Number of bytes written=54233578
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239941120
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:18,812  INFO [pool-224-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local100838204_0046_r_000000_0
2024-04-23T22:26:18,812  INFO [pool-224-thread-1] mapred.LocalJobRunner: Starting task: attempt_local100838204_0046_r_000001_0
2024-04-23T22:26:18,812  INFO [pool-224-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:18,812  INFO [pool-224-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7fc83bb0
2024-04-23T22:26:18,812  WARN [pool-224-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:18,813  INFO [pool-224-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:18,813  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local100838204_0046_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:18,816  INFO [localfetcher#67] reduce.LocalFetcher: localfetcher#67 about to shuffle output of map attempt_local100838204_0046_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:26:18,816  INFO [localfetcher#67] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local100838204_0046_m_000000_0
2024-04-23T22:26:18,817  INFO [localfetcher#67] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:26:18,817  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:18,817  INFO [pool-224-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:18,817  INFO [pool-224-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:18,823  INFO [pool-224-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:18,823  INFO [pool-224-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:18,826  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:18,826  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:26:18,826  INFO [pool-224-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:18,826  INFO [pool-224-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:18,826  INFO [pool-224-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:26:18,826  INFO [pool-224-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:26:18,827  INFO [pool-224-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:18,827  INFO [pool-224-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:26:18,828  INFO [pool-224-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:18,828  INFO [pool-224-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:26:18,828  INFO [pool-224-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:26:18,828  INFO [pool-224-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:26:18,828  INFO [pool-224-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local100838204_0046/job_local100838204_0046.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@ab2a617
2024-04-23T22:26:18,829  INFO [pool-224-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:18,829  INFO [pool-224-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:18,829  INFO [pool-224-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:18,829  INFO [pool-224-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:18,829  INFO [pool-224-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:18,834  INFO [pool-224-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:18,834  INFO [pool-224-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:26:18,834  INFO [pool-224-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:18,834  INFO [pool-224-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:26:18,834  INFO [pool-224-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:26:18,836  INFO [pool-224-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-23T22:26:18,846  INFO [pool-224-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:26:18,846  INFO [pool-224-thread-1] mapred.Task: Task:attempt_local100838204_0046_r_000001_0 is done. And is in the process of committing
2024-04-23T22:26:18,846  INFO [pool-224-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:18,846  INFO [pool-224-thread-1] mapred.Task: Task 'attempt_local100838204_0046_r_000001_0' done.
2024-04-23T22:26:18,847  INFO [pool-224-thread-1] mapred.Task: Final Counters for attempt_local100838204_0046_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=992559
		FILE: Number of bytes written=54234612
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1239941120
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:18,847  INFO [pool-224-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local100838204_0046_r_000001_0
2024-04-23T22:26:18,847  INFO [Thread-3835] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:26:19,744 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:26:19,744  INFO [main] exec.Task: 2024-04-23 22:26:19,744 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local100838204_0046
2024-04-23T22:26:19,745  INFO [main] exec.Task: Ended Job = job_local100838204_0046
2024-04-23T22:26:19,746  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:26:19,746  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:26:19,746  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000001_0.manifest
2024-04-23T22:26:19,746  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-23T22:26:19,746  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-23T22:26:19,747  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:26:19,747  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:19,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,754  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:19,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,760  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:19,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:19,780  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:26:19,780  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,786  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:19,786  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:26:19,787  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-18_301_3587540355744530781-1/-mr-10000
2024-04-23T22:26:19,788  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,794  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:19,817  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:26:19,817  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:26:19,818  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:26:19,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:26:19,837  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:26:19,837  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:26:19,837  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:26:19,837  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=4, numRows=4, totalSize=2695, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:26:19,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:19,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=38, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=0, getTable_(GetTableRequest)=27}
MapReduce Jobs Launched: 
2024-04-23T22:26:19,838  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:26:19,838  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:19,838  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:19,838  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222618_39c9cbbb-13f2-42d3-920f-448f4bceead0); Time taken: 1.381 seconds
2024-04-23T22:26:19,838  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T22:26:19,839  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-18_301_3587540355744530781-1
2024-04-23T22:26:19,839  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-18_301_3587540355744530781-1 on fs with scheme file
2024-04-23T22:26:19,840  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36): select a,b from acidTbl order by a,b
2024-04-23T22:26:19,840  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:19,840  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:19,841  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:19,841  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:19,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,847  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:19,848  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:19,848  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:19,848  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:19,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,867  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:26:19,868  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,876  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:19,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:19,885  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:19,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:26:19,893  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T22:26:19,893  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T22:26:19,934  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:19,934  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:19,934  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:19,935  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-19_839_644372217653529859-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-19_839_644372217653529859-1
2024-04-23T22:26:19,943  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:26:19,945  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:26:19,945  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:26:19,946  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:26:19,954  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:26:19,954  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:19,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:19,954  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T22:26:19,955  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T22:26:19,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:19,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=6, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTableColumnStatistics_(String, String, List, String)=24, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:26:19,956  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36); Time taken: 0.116 seconds
2024-04-23T22:26:19,956  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36
2024-04-23T22:26:19,956  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36
2024-04-23T22:26:19,970  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:26:19,970  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:26:19,970  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36): select a,b from acidTbl order by a,b
2024-04-23T22:26:19,970  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36
2024-04-23T22:26:19,971  INFO [main] ql.Driver: Query ID = alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36
Total jobs = 1
2024-04-23T22:26:19,971  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:26:19,971  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:26:20,101  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:26:20,101  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:26:20,101  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:26:20,101  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:26:20,101  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:26:20,101  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:26:20,101  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:26:20,101  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:26:20,104  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:26:20,104  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T22:26:20,104  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:20,114  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:26:20,115  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:26:20,119  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:26:20,120  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:26:20,121  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:20,126  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:20,133  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:26:20,137  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:26:20,138  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T22:26:20,138  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T22:26:20,138  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:20,139  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T22:26:20,139  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:2:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T22:26:20,139  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T22:26:20,162  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/4
2024-04-23T22:26:20,162  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 4). duration: 23 ms
2024-04-23T22:26:20,162  INFO [main] io.HiveInputFormat: number of splits 4
2024-04-23T22:26:20,179  INFO [main] mapreduce.JobSubmitter: number of splits:4
2024-04-23T22:26:20,198  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local158997783_0047
2024-04-23T22:26:20,198  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:26:20,263  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:26:20,263  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:26:20,264  INFO [Thread-3920] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:20,264  INFO [Thread-3920] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:20,266  INFO [Thread-3920] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:26:20,266  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local158997783_0047_m_000000_0
2024-04-23T22:26:20,267  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:20,267  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,268  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:20,268  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:26:20,269  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:26:20,269  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 679, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:26:20,270  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:26:20,270  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:26:20,287  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:20,287  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:20,288  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:20,288  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:20,288  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:20,288  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:20,288  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:20,289  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:20,290  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:20,290  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:20,290  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:26:20,290  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:26:20,290  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:26:20,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:26:20,292  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:20,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:20,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:20,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:26:20,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:26:20,304  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:20,307  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local158997783_0047_m_000000_0 is done. And is in the process of committing
2024-04-23T22:26:20,308  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0, start=0, length=679, isOriginal=false, fileLength=679, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,308  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local158997783_0047_m_000000_0' done.
2024-04-23T22:26:20,308  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local158997783_0047_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1002880
		FILE: Number of bytes written=55407682
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=12
		Total committed heap usage (bytes)=1238892544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7584
2024-04-23T22:26:20,308  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local158997783_0047_m_000000_0
2024-04-23T22:26:20,308  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local158997783_0047_m_000001_0
2024-04-23T22:26:20,309  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:20,309  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,309  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:20,310  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:26:20,311  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:26:20,311  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:26:20,312  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:26:20,312  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:26:20,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:20,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:20,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:20,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:20,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:20,318  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:20,318  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:20,319  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:20,320  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:20,320  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:20,320  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:26:20,320  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:26:20,320  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:26:20,321  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:26:20,322  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:1, RECORDS_OUT_OPERATOR_RS_2:1, 
2024-04-23T22:26:20,322  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:20,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:20,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:20,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:26:20,322  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:26:20,330  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:20,333  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local158997783_0047_m_000001_0 is done. And is in the process of committing
2024-04-23T22:26:20,333  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,333  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local158997783_0047_m_000001_0' done.
2024-04-23T22:26:20,333  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local158997783_0047_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1012451
		FILE: Number of bytes written=55407741
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1238892544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7560
2024-04-23T22:26:20,333  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local158997783_0047_m_000001_0
2024-04-23T22:26:20,334  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local158997783_0047_m_000002_0
2024-04-23T22:26:20,334  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:20,335  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,335  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:20,336  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:26:20,337  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:26:20,337  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 672, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:26:20,338  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:26:20,338  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:26:20,344  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:20,344  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:20,344  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:20,344  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:20,344  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:20,345  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:20,345  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:20,346  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:20,347  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:20,347  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:20,347  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:26:20,347  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:26:20,347  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:20,347  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, 
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:26:20,348  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:20,349  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:20,349  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:20,349  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:26:20,349  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:26:20,359  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:20,363  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local158997783_0047_m_000002_0 is done. And is in the process of committing
2024-04-23T22:26:20,363  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, start=0, length=672, isOriginal=false, fileLength=672, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,363  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local158997783_0047_m_000002_0' done.
2024-04-23T22:26:20,364  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local158997783_0047_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1021506
		FILE: Number of bytes written=55407800
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1238892544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7556
2024-04-23T22:26:20,364  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local158997783_0047_m_000002_0
2024-04-23T22:26:20,364  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local158997783_0047_m_000003_0
2024-04-23T22:26:20,364  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:20,365  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,366  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:20,366  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,74KB
2024-04-23T22:26:20,367  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:26:20,367  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:26:20,368  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:26:20,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:26:20,374  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:26:20,374  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:26:20,374  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:26:20,374  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:26:20,374  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:26:20,374  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:26:20,375  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:20,376  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:20,376  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:20,376  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:20,376  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:26:20,376  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:26:20,376  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:1, 
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:26:20,377  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:26:20,378  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:20,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:26:20,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:26:20,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:26:20,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:26:20,386  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:26:20,389  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local158997783_0047_m_000003_0 is done. And is in the process of committing
2024-04-23T22:26:20,390  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:26:20,390  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local158997783_0047_m_000003_0' done.
2024-04-23T22:26:20,390  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local158997783_0047_m_000003_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=1030045
		FILE: Number of bytes written=55407859
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1238892544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7552
2024-04-23T22:26:20,390  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local158997783_0047_m_000003_0
2024-04-23T22:26:20,390  INFO [Thread-3920] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:26:20,391  INFO [Thread-3920] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:26:20,391  INFO [pool-229-thread-1] mapred.LocalJobRunner: Starting task: attempt_local158997783_0047_r_000000_0
2024-04-23T22:26:20,392  INFO [pool-229-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:20,392  INFO [pool-229-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4c13bb14
2024-04-23T22:26:20,392  WARN [pool-229-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:20,393  INFO [pool-229-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:26:20,393  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local158997783_0047_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:26:20,396  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local158997783_0047_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:26:20,396  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local158997783_0047_m_000000_0
2024-04-23T22:26:20,396  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T22:26:20,398  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local158997783_0047_m_000002_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:26:20,398  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local158997783_0047_m_000002_0
2024-04-23T22:26:20,398  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T22:26:20,400  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local158997783_0047_m_000003_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:26:20,401  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local158997783_0047_m_000003_0
2024-04-23T22:26:20,401  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 3, commitMemory -> 46, usedMemory ->69
2024-04-23T22:26:20,402  INFO [localfetcher#68] reduce.LocalFetcher: localfetcher#68 about to shuffle output of map attempt_local158997783_0047_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:26:20,403  INFO [localfetcher#68] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local158997783_0047_m_000001_0
2024-04-23T22:26:20,403  INFO [localfetcher#68] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 4, commitMemory -> 69, usedMemory ->92
2024-04-23T22:26:20,403  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:26:20,403  INFO [pool-229-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T22:26:20,403  INFO [pool-229-thread-1] reduce.MergeManagerImpl: finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:26:20,409  INFO [pool-229-thread-1] mapred.Merger: Merging 4 sorted segments
2024-04-23T22:26:20,409  INFO [pool-229-thread-1] mapred.Merger: Down to the last merge-pass, with 4 segments left of total size: 24 bytes
2024-04-23T22:26:20,412  INFO [pool-229-thread-1] reduce.MergeManagerImpl: Merged 4 segments, 92 bytes to disk to satisfy reduce memory limit
2024-04-23T22:26:20,412  INFO [pool-229-thread-1] reduce.MergeManagerImpl: Merging 1 files, 90 bytes from disk
2024-04-23T22:26:20,412  INFO [pool-229-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:26:20,412  INFO [pool-229-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:26:20,413  INFO [pool-229-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 69 bytes
2024-04-23T22:26:20,413  INFO [pool-229-thread-1] mapred.LocalJobRunner: 4 / 4 copied.
2024-04-23T22:26:20,414  INFO [pool-229-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:26:20,414  INFO [pool-229-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:26:20,415  INFO [pool-229-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:26:20,415  INFO [pool-229-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:26:20,415  INFO [pool-229-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T22:26:20,415  INFO [pool-229-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:26:20,416  INFO [pool-229-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@2dce8dbb, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1dc5b872, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@31d49374
2024-04-23T22:26:20,416  INFO [pool-229-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-19_839_644372217653529859-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-19_839_644372217653529859-1/_tmp.-ext-10002/000000_0
2024-04-23T22:26:20,416  INFO [pool-229-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-19_839_644372217653529859-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-19_839_644372217653529859-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:26:20,416  INFO [pool-229-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-19_839_644372217653529859-1/-mr-10001/.hive-staging_hive_2024-04-23_22-26-19_839_644372217653529859-1/_tmp.-ext-10002/000000_0
2024-04-23T22:26:20,424  INFO [pool-229-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:26:20,424  INFO [pool-229-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:26:20,424  INFO [pool-229-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T22:26:20,424  INFO [pool-229-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:26:20,424  INFO [pool-229-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T22:26:20,425  INFO [pool-229-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:4, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-23T22:26:20,425  INFO [pool-229-thread-1] mapred.Task: Task:attempt_local158997783_0047_r_000000_0 is done. And is in the process of committing
2024-04-23T22:26:20,425  INFO [pool-229-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:26:20,425  INFO [pool-229-thread-1] mapred.Task: Task 'attempt_local158997783_0047_r_000000_0' done.
2024-04-23T22:26:20,425  INFO [pool-229-thread-1] mapred.Task: Final Counters for attempt_local158997783_0047_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1036019
		FILE: Number of bytes written=55408112
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=108
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =4
		Failed Shuffles=0
		Merged Map outputs=4
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1238892544
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:20,425  INFO [pool-229-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local158997783_0047_r_000000_0
2024-04-23T22:26:20,426  INFO [Thread-3920] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:26:21,267 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:26:21,267  INFO [main] exec.Task: 2024-04-23 22:26:21,267 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local158997783_0047
2024-04-23T22:26:21,269  INFO [main] exec.Task: Ended Job = job_local158997783_0047
2024-04-23T22:26:21,272  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:21,272  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T22:26:21,272  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:26:21,272  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:21,272  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:21,272  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36); Time taken: 1.302 seconds
2024-04-23T22:26:21,276  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T22:26:21,276  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T22:26:21,276  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:4, 
2024-04-23T22:26:21,276  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = 1 where b != 1
2024-04-23T22:26:21,277  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-19_839_644372217653529859-1
2024-04-23T22:26:21,277  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/881b72a6-4a4f-4f09-a71c-327a1099c67d/hive_2024-04-23_22-26-19_839_644372217653529859-1 on fs with scheme file
2024-04-23T22:26:21,278  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222621_22ebf76e-8694-49fb-85a5-2a8027470dae): update acidTbl set b = 1 where b != 1
2024-04-23T22:26:21,278  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:26:21,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,286  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,286  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = 1 where b != 1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:26:21,287  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:26:21,288  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,294  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,294  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:21,294  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:26:21,295  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:21,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,301  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:26:21,301  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:26:21,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,307  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,308  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:21,308  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:21,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:21,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:21,325  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:26:21,346  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:26:21,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:21,355  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:26:21,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:26:21,372  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a, b
No Stats for default@acidtbl, Columns: a, b
2024-04-23T22:26:21,372  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a, b
2024-04-23T22:26:21,428  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:26:21,429  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:26:21,429  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:26:21,429  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,435  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,438 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateDeleteOfInserts(TestTxnCommands.java:883) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:26:21,439 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:26:21,439  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:26:21,439 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testUpdateDeleteOfInserts(TestTxnCommands.java:883)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:26:21,440  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:21,440  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getNotNullConstraints_(NotNullConstraintsRequest)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=34, getCheckConstraints_(CheckConstraintsRequest)=1, getValidWriteIds_(List, String)=2, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=4, getTableColumnStatistics_(String, String, List, String)=25}
2024-04-23T22:26:21,440  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222621_22ebf76e-8694-49fb-85a5-2a8027470dae); Time taken: 0.162 seconds
2024-04-23T22:26:21,440  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222619_de84fb86-8bdf-47c9-ad75-495795a4ef36
2024-04-23T22:26:21,443  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:21,450  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:26:21,450  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d): drop table if exists acidTbl
2024-04-23T22:26:21,452  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T22:26:21,452  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:26:21,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,459  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,459  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:21,459  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:21,459  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:21,459  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, rollbackTxn_(long)=9, openTxn_(String, TxnType)=2}
2024-04-23T22:26:21,459  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d); Time taken: 0.009 seconds
2024-04-23T22:26:21,459  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d
2024-04-23T22:26:21,460  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d
2024-04-23T22:26:21,474  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:26:21,474  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:21,474  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d): drop table if exists acidTbl
2024-04-23T22:26:21,475  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:21,475  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,480  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,481  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,486  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:21,616  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:21,616  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=135, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T22:26:21,617  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d); Time taken: 0.142 seconds
2024-04-23T22:26:21,617  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222621_9b669829-472c-4bde-8257-3cf7ab8cfc6d
2024-04-23T22:26:21,621  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:26:21,629  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:21,629  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:26:21,630  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:26:21,630  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac): drop table if exists acidTblPart
2024-04-23T22:26:21,639  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T22:26:21,640  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:26:21,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:21,663  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,663  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:21,663  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:21,663  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:21,664  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=10, getValidTxns_(long)=2, getTable_(GetTableRequest)=21, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:26:21,664  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac); Time taken: 0.033 seconds
2024-04-23T22:26:21,664  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac
2024-04-23T22:26:21,664  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac
2024-04-23T22:26:21,685  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:26:21,685  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:21,685  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac): drop table if exists acidTblPart
2024-04-23T22:26:21,685  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:21,685  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:21,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,692  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:21,698  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:21,737  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:21,737  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:21,737  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac); Time taken: 0.052 seconds
2024-04-23T22:26:21,738  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222621_906893a5-fb6e-4237-8b01-f1f233edd7ac
2024-04-23T22:26:21,742  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:26:21,750  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:21,750  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:26:21,751  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:26:21,751  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222621_7caf9d1e-e270-4f12-91ab-a479b88349cc): drop table if exists acidTbl2
2024-04-23T22:26:21,753  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T22:26:21,753  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:26:21,754  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:21,754  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:21,754  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:21,754  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=0, flushCache_()=0}
2024-04-23T22:26:21,755  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222621_7caf9d1e-e270-4f12-91ab-a479b88349cc); Time taken: 0.003 seconds
2024-04-23T22:26:21,755  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222621_7caf9d1e-e270-4f12-91ab-a479b88349cc
2024-04-23T22:26:21,755  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:21,755  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222621_7caf9d1e-e270-4f12-91ab-a479b88349cc): drop table if exists acidTbl2
2024-04-23T22:26:21,755  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:21,756  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:26:21,756  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:21,756  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-23T22:26:21,756  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222621_7caf9d1e-e270-4f12-91ab-a479b88349cc); Time taken: 0.001 seconds
2024-04-23T22:26:21,756  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222621_7caf9d1e-e270-4f12-91ab-a479b88349cc
2024-04-23T22:26:21,763  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:26:21,770  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:21,770  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:26:21,770  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:26:21,771  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:21,773  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T22:26:21,773  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:26:21,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:21,797  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,797  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:21,797  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:21,797  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:21,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=23, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:26:21,797  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553); Time taken: 0.026 seconds
2024-04-23T22:26:21,798  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553
2024-04-23T22:26:21,798  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553
2024-04-23T22:26:21,814  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:26:21,815  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:21,815  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:21,815  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:21,815  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:21,823  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,823  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:21,832  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:21,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:21,926  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=102, getTable_(GetTableRequest)=8}
2024-04-23T22:26:21,926  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553); Time taken: 0.11 seconds
2024-04-23T22:26:21,926  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222621_51737407-7b5c-48db-825b-f47badb9f553
2024-04-23T22:26:21,931  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:26:21,938  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:21,939  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:26:21,939  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:21,940  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:21,942  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T22:26:21,943  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:26:21,943  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:21,956  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,956  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:21,956  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:21,956  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:21,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=13}
2024-04-23T22:26:21,957  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81); Time taken: 0.016 seconds
2024-04-23T22:26:21,957  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81
2024-04-23T22:26:21,958  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81
2024-04-23T22:26:21,983  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T22:26:21,983  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:21,983  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:21,983  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:21,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:21,994  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:21,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:22,002  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:22,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:22,032  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,033  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=37, getTable_(GetTableRequest)=11}
2024-04-23T22:26:22,033  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81); Time taken: 0.049 seconds
2024-04-23T22:26:22,033  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222621_76fb275b-d7fc-473c-a063-0d1d773c3e81
2024-04-23T22:26:22,038  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:26:22,045  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,046  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:26:22,046  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:26:22,046  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba): drop table if exists nonAcidNonBucket
2024-04-23T22:26:22,049  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T22:26:22,049  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:26:22,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:22,059  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:22,059  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,059  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,059  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,059  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T22:26:22,060  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba); Time taken: 0.013 seconds
2024-04-23T22:26:22,060  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba
2024-04-23T22:26:22,060  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba
2024-04-23T22:26:22,076  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T22:26:22,076  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:22,076  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba): drop table if exists nonAcidNonBucket
2024-04-23T22:26:22,077  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:22,085  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:22,085  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:22,093  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:22,093  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:22,124  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,124  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:26:22,124  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba); Time taken: 0.048 seconds
2024-04-23T22:26:22,125  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_7b0b500a-6e58-48b5-9725-c290aec2beba
2024-04-23T22:26:22,129  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:26:22,137  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,137  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:26:22,137  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testVersioningVersionFileEnabled" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.322">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update T set a=3 where b=2 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:26:22,214  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:26:22,215  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:26:22,215  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:26:22,215  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:26:22,217  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61
2024-04-23T22:26:22,220  INFO [main] SessionState: Hive Session ID = bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:26:22,220  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:26:22,226  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61
2024-04-23T22:26:22,228  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61
2024-04-23T22:26:22,231  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/_tmp_space.db
2024-04-23T22:26:22,231  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61, clientType=HIVECLI]
2024-04-23T22:26:22,231  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:26:22,232  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_3f4f45bd-4d09-4c5a-9563-f3f47c76c952): drop table if exists acidTbl
2024-04-23T22:26:22,244  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:26:22,245  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:26:22,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:22,252  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,252  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,252  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,252  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=3, openTxn_(String, TxnType)=13, flushCache_()=0}
2024-04-23T22:26:22,252  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_3f4f45bd-4d09-4c5a-9563-f3f47c76c952); Time taken: 0.02 seconds
2024-04-23T22:26:22,253  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222622_3f4f45bd-4d09-4c5a-9563-f3f47c76c952
2024-04-23T22:26:22,253  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:22,253  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_3f4f45bd-4d09-4c5a-9563-f3f47c76c952): drop table if exists acidTbl
2024-04-23T22:26:22,253  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:22,258  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,258  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,258  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_3f4f45bd-4d09-4c5a-9563-f3f47c76c952); Time taken: 0.005 seconds
2024-04-23T22:26:22,259  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_3f4f45bd-4d09-4c5a-9563-f3f47c76c952
2024-04-23T22:26:22,267  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:26:22,276  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,276  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:26:22,277  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:26:22,277  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_0a745ef2-5fab-42a1-af94-339293d346cd): drop table if exists acidTblPart
2024-04-23T22:26:22,279  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:26:22,280  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:26:22,280  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:22,283  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,283  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,283  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,283  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=18, flushCache_()=0}
2024-04-23T22:26:22,283  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_0a745ef2-5fab-42a1-af94-339293d346cd); Time taken: 0.006 seconds
2024-04-23T22:26:22,284  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222622_0a745ef2-5fab-42a1-af94-339293d346cd
2024-04-23T22:26:22,284  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:22,284  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_0a745ef2-5fab-42a1-af94-339293d346cd): drop table if exists acidTblPart
2024-04-23T22:26:22,284  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:22,287  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,287  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,287  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_0a745ef2-5fab-42a1-af94-339293d346cd); Time taken: 0.003 seconds
2024-04-23T22:26:22,287  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_0a745ef2-5fab-42a1-af94-339293d346cd
2024-04-23T22:26:22,293  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:26:22,300  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,300  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:26:22,301  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:26:22,301  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_7f898706-e8a2-471c-b44f-cf4bd9fd7166): drop table if exists acidTbl2
2024-04-23T22:26:22,303  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:26:22,304  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:26:22,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:26:22,307  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,307  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,307  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,307  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T22:26:22,307  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_7f898706-e8a2-471c-b44f-cf4bd9fd7166); Time taken: 0.006 seconds
2024-04-23T22:26:22,308  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222622_7f898706-e8a2-471c-b44f-cf4bd9fd7166
2024-04-23T22:26:22,308  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:22,308  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_7f898706-e8a2-471c-b44f-cf4bd9fd7166): drop table if exists acidTbl2
2024-04-23T22:26:22,308  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:26:22,312  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,312  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,313  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_7f898706-e8a2-471c-b44f-cf4bd9fd7166); Time taken: 0.004 seconds
2024-04-23T22:26:22,313  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_7f898706-e8a2-471c-b44f-cf4bd9fd7166
2024-04-23T22:26:22,319  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:26:22,327  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,327  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:26:22,327  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:26:22,328  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_4c647198-934d-4f8d-87f9-e9c583945f78): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:22,330  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:26:22,330  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:26:22,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:22,333  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,333  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,333  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,334  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14}
2024-04-23T22:26:22,334  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_4c647198-934d-4f8d-87f9-e9c583945f78); Time taken: 0.005 seconds
2024-04-23T22:26:22,334  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222622_4c647198-934d-4f8d-87f9-e9c583945f78
2024-04-23T22:26:22,334  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:22,334  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_4c647198-934d-4f8d-87f9-e9c583945f78): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:22,334  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:22,337  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,337  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,337  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_4c647198-934d-4f8d-87f9-e9c583945f78); Time taken: 0.003 seconds
2024-04-23T22:26:22,337  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_4c647198-934d-4f8d-87f9-e9c583945f78
2024-04-23T22:26:22,343  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:26:22,350  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,351  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:26:22,351  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:22,351  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_1427fe31-c071-4253-baf5-b9787af7f671): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:22,354  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:26:22,354  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:26:22,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:22,358  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,358  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,358  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,358  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:26:22,358  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_1427fe31-c071-4253-baf5-b9787af7f671); Time taken: 0.007 seconds
2024-04-23T22:26:22,359  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222622_1427fe31-c071-4253-baf5-b9787af7f671
2024-04-23T22:26:22,359  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:22,359  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_1427fe31-c071-4253-baf5-b9787af7f671): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:22,359  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,359  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:22,362  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,362  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,363  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_1427fe31-c071-4253-baf5-b9787af7f671); Time taken: 0.003 seconds
2024-04-23T22:26:22,363  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_1427fe31-c071-4253-baf5-b9787af7f671
2024-04-23T22:26:22,369  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:26:22,381  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,382  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:26:22,382  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:26:22,383  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_1bc37709-64d3-4cb1-a6a9-b6bf665343bc): drop table if exists nonAcidNonBucket
2024-04-23T22:26:22,386  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:26:22,387  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:26:22,387  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:22,392  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,392  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,392  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,392  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=19, openTxn_(String, TxnType)=4, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,393  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_1bc37709-64d3-4cb1-a6a9-b6bf665343bc); Time taken: 0.009 seconds
2024-04-23T22:26:22,393  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222622_1bc37709-64d3-4cb1-a6a9-b6bf665343bc
2024-04-23T22:26:22,393  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:22,393  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_1bc37709-64d3-4cb1-a6a9-b6bf665343bc): drop table if exists nonAcidNonBucket
2024-04-23T22:26:22,393  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:22,398  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,398  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,399  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_1bc37709-64d3-4cb1-a6a9-b6bf665343bc); Time taken: 0.005 seconds
2024-04-23T22:26:22,399  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_1bc37709-64d3-4cb1-a6a9-b6bf665343bc
2024-04-23T22:26:22,408  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:26:22,420  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,420  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:26:22,421  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,421  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,424  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:26:22,425  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:26:22,425  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:22,426  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:22,436  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:26:22,436  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:22,438  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:22,439  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,439  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,439  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,439  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=10, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=21}
2024-04-23T22:26:22,439  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf); Time taken: 0.018 seconds
2024-04-23T22:26:22,439  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf
2024-04-23T22:26:22,440  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf
2024-04-23T22:26:22,468  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:26:22,468  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:22,470  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,470  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,471  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936382, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, transactional=true, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFiles=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:26:22,477  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:26:22,524  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,525  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=53, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,525  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf); Time taken: 0.054 seconds
2024-04-23T22:26:22,525  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_e0fd8d8e-a658-4681-9d87-e3e3113f5adf
2024-04-23T22:26:22,530  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:26:22,537  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,537  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:26:22,538  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,538  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,541  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:26:22,541  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:26:22,542  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:22,542  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:22,545  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:26:22,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:22,546  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:22,546  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,546  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,546  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:26:22,547  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2); Time taken: 0.008 seconds
2024-04-23T22:26:22,547  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2
2024-04-23T22:26:22,548  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2
2024-04-23T22:26:22,572  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:26:22,572  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:22,573  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,573  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,575  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936382, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:26:22,584  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:26:22,606  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,606  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=31, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,606  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2); Time taken: 0.033 seconds
2024-04-23T22:26:22,606  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_f849507e-eb17-4ca7-8f68-9e80460fb1d2
2024-04-23T22:26:22,610  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:26:22,618  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,618  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:26:22,618  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,619  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,621  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:26:22,622  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:26:22,622  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:22,622  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:22,625  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:26:22,625  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:22,627  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:22,627  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,627  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,628  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,628  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3}
2024-04-23T22:26:22,628  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14); Time taken: 0.01 seconds
2024-04-23T22:26:22,628  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14
2024-04-23T22:26:22,628  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14
2024-04-23T22:26:22,645  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:26:22,645  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:22,645  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,645  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936382, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=false, rawDataSize=0, numFilesErasureCoded=0, bucketing_version=2, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:22,651  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:26:22,666  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,666  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=19}
2024-04-23T22:26:22,666  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14); Time taken: 0.021 seconds
2024-04-23T22:26:22,666  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_bf7da1f3-9ad5-4972-a348-b1cd48c3db14
2024-04-23T22:26:22,671  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:26:22,678  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,678  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:26:22,690  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,690  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,694  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:26:22,695  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:26:22,695  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:22,695  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:22,698  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:26:22,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:22,700  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:22,700  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,700  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,700  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,700  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=24, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3}
2024-04-23T22:26:22,700  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823); Time taken: 0.01 seconds
2024-04-23T22:26:22,700  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823
2024-04-23T22:26:22,701  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823
2024-04-23T22:26:22,724  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:26:22,724  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:22,724  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,725  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,726  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936382, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, bucketing_version=2, totalSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:22,731  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:26:22,746  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,746  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,746  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823); Time taken: 0.022 seconds
2024-04-23T22:26:22,746  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_e282a6f7-2c12-484c-b1f8-be7a7581b823
2024-04-23T22:26:22,751  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:26:22,759  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,759  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:26:22,760  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,760  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,763  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:26:22,764  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:26:22,765  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:22,765  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:22,767  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:26:22,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:22,769  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:22,769  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,769  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,769  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,769  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=4, getDatabase_(String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T22:26:22,770  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486); Time taken: 0.009 seconds
2024-04-23T22:26:22,770  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486
2024-04-23T22:26:22,770  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486
2024-04-23T22:26:22,787  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:26:22,788  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:22,788  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:26:22,788  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,789  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/_tmp_space.db/8100b883-fa9b-48a0-8d8d-eb5293ed94a6
2024-04-23T22:26:22,792  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,792  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:22,792  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486); Time taken: 0.004 seconds
2024-04-23T22:26:22,793  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_0a5572c5-2bef-4c9c-8777-a749b5ab3486
2024-04-23T22:26:22,797  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:26:22,805  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,806  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:26:22,806  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,806  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,809  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:26:22,809  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:26:22,810  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:22,810  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:22,812  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:26:22,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:22,814  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:22,814  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,814  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,814  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,814  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T22:26:22,814  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed); Time taken: 0.008 seconds
2024-04-23T22:26:22,814  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed
2024-04-23T22:26:22,815  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed
2024-04-23T22:26:22,832  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:26:22,832  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:22,832  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:26:22,833  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,834  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936382, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFilesErasureCoded=0, numFiles=0, totalSize=0, transactional=false, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:26:22,839  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:26:22,853  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:22,853  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T22:26:22,853  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed); Time taken: 0.021 seconds
2024-04-23T22:26:22,854  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_f306dee6-a4a3-4603-90fa-31ad306c15ed
2024-04-23T22:26:22,858  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:26:22,865  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:22,865  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:26:22,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
2024-04-23T22:26:22,866  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@11f708ba, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@40ac4345 will be shutdown
2024-04-23T22:26:22,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T22:26:22,866  INFO [main] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -10
2024-04-23T22:26:22,866  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T22:26:22,866  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5): drop table if exists T
2024-04-23T22:26:22,867  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T22:26:22,868  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T22:26:22,869  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T22:26:22,869  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@22bfa81, with PersistenceManager: null will be shutdown
2024-04-23T22:26:22,869  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@22bfa81, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4f3d398c created in the thread with id: 1
2024-04-23T22:26:22,890  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@22bfa81 from thread id: 1
2024-04-23T22:26:22,890  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T22:26:22,890  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T22:26:22,892  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:26:22,893  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:26:22,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:22,911  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:22,911  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:22,911  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:22,911  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:22,912  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getTable_(GetTableRequest)=18, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:26:22,912  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5); Time taken: 0.045 seconds
2024-04-23T22:26:22,912  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5
2024-04-23T22:26:22,913  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5
2024-04-23T22:26:22,934  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:26:22,934  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:22,934  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5): drop table if exists T
2024-04-23T22:26:22,934  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:22,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:22,940  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:22,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:22,946  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:22,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T22:26:23,051  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t does not exist; Force to delete it.
2024-04-23T22:26:23,052 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:26:23,052  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:23,052  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=112, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T22:26:23,052  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5); Time taken: 0.118 seconds
2024-04-23T22:26:23,052  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222622_d4b8c818-6e68-4f36-a2dd-1551a52785f5
2024-04-23T22:26:23,056  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:26:23,063  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:23,065  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:26:23,065  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) stored as orc
2024-04-23T22:26:23,065  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b): create table T (a int, b int) stored as orc
2024-04-23T22:26:23,068  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:26:23,068  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:26:23,069  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:23,069  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:23,074  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T22:26:23,074  INFO [main] parse.CalcitePlanner: Automatically chose to make default.T acid.
2024-04-23T22:26:23,074  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:26:23,076  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:23,076  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:23,076  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:23,076  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:23,076  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=2}
2024-04-23T22:26:23,076  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b); Time taken: 0.011 seconds
2024-04-23T22:26:23,077  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b
2024-04-23T22:26:23,077  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b
2024-04-23T22:26:23,092  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:26:23,092  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:26:23,093  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b): create table T (a int, b int) stored as orc
2024-04-23T22:26:23,093  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:23,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713936383, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFilesErasureCoded=0, rawDataSize=0, bucketing_version=2, transactional_properties=default, numFiles=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:26:23,099  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:26:23,128  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:23,129  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=35, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:23,129  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b); Time taken: 0.035 seconds
2024-04-23T22:26:23,129  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222623_049d44cb-3342-4a5f-b3be-25986b3a731b
2024-04-23T22:26:23,133  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:26:23,139  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:23,140  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:26:23,140  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into T values(1,2)
2024-04-23T22:26:23,140  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a): insert into T values(1,2)
2024-04-23T22:26:23,143  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T22:26:23,143  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:26:23,144  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:26:23,144  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:26:23,147  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:23,153  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:23,153  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:23,153  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:23,153  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:23,154  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:23,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:23,160  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:23,160  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:23,160  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:23,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:23,249  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:23,249  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:23,249  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:26:23,250  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:26:23,252  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:26:23,252  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:23,252  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:26:23,252  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:23,258  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:23,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T22:26:23,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T22:26:23,270  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 15
2024-04-23T22:26:23,271  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [15])
2024-04-23T22:26:23,271  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:26:23,274  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:26:23,274  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:26:23,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:23,288  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:23,289  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:26:23,289  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:26:23,289  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:23,289  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:26:23,290  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:23,290  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=27, getNotNullConstraints_(NotNullConstraintsRequest)=2, getValidWriteIds_(List, String)=3, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=25, allocateTableWriteId_(long, String, String)=9, openTxn_(String, TxnType)=2}
2024-04-23T22:26:23,290  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a); Time taken: 0.15 seconds
2024-04-23T22:26:23,290  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a
2024-04-23T22:26:23,290  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a
2024-04-23T22:26:23,312  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:26:23,312  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:26:23,314  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a): insert into T values(1,2)
2024-04-23T22:26:23,315  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a
2024-04-23T22:26:23,315  INFO [main] ql.Driver: Query ID = alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a
Total jobs = 1
2024-04-23T22:26:23,315  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:26:23,315  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:26:23,439  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:26:23,440  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:26:23,442  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:26:23,442  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:26:23,442  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/hive_2024-04-23_22-26-23_140_6344899700609708294-1/dummy_path
2024-04-23T22:26:23,452  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:26:23,452  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T22:26:23,453  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:23,457  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/hive_2024-04-23_22-26-23_140_6344899700609708294-1/-mr-10000
2024-04-23T22:26:23,459  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:26:23,466  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:26:23,470  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:26:23,471  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:26:23,471  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:26:23,471  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/hive_2024-04-23_22-26-23_140_6344899700609708294-1/dummy_path
2024-04-23T22:26:23,471  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:26:23,488  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:26:23,506  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1755944174_0048
2024-04-23T22:26:23,506  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:26:23,566  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:26:23,566  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:26:23,567  INFO [Thread-4012] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:23,567  INFO [Thread-4012] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:26:23,568  INFO [Thread-4012] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:26:23,569  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1755944174_0048_m_000000_0
2024-04-23T22:26:23,571  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:26:23,572  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/hive_2024-04-23_22-26-23_140_6344899700609708294-1/dummy_path/null:0+1
2024-04-23T22:26:23,574  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:26:23,574  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,35KB
2024-04-23T22:26:23,574  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T22:26:23,576  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:26:23,576  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:26:23,577  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:26:23,577  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:26:23,577  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:26:23,577  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:26:23,577  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:26:23,577  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:26:23,578  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:26:23,578  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1755944174_0048/job_local1755944174_0048.xml], properties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.t, transactional=true, columns.types=int:int, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@20c9df4c
2024-04-23T22:26:23,578  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:26:23,578  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:26:23,578  INFO [LocalJobRunner Map Task Executor #0] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:26:23,580  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:26:23,580  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:26:23,587  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:26:23,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:1, 
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:26:23,592  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:26:23,594  INFO [LocalJobRunner Map Task Executor #0] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:26:23,606  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.t:1, 
2024-04-23T22:26:23,606  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:26:23,608  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1755944174_0048_m_000000_0 is done. And is in the process of committing
2024-04-23T22:26:23,609  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:26:23,609  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1755944174_0048_m_000000_0' done.
2024-04-23T22:26:23,609  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1755944174_0048_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=1041990
		FILE: Number of bytes written=56582899
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1227358208
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.t=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	File Input Format Counters 
		Bytes Read=5403
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:26:23,609  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1755944174_0048_m_000000_0
2024-04-23T22:26:23,609  INFO [Thread-4012] mapred.LocalJobRunner: map task executor complete.
2024-04-23 22:26:24,567 Stage-1 map = 100%,  reduce = 0%
2024-04-23T22:26:24,567  INFO [main] exec.Task: 2024-04-23 22:26:24,567 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1755944174_0048
2024-04-23T22:26:24,568  INFO [main] exec.Task: Ended Job = job_local1755944174_0048
2024-04-23T22:26:24,569  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:26:24,569  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:26:24,569  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t/_tmp.delta_0000001_0000001_0000
2024-04-23T22:26:24,570  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.t
2024-04-23T22:26:24,570  INFO [main] exec.Task: Loading data to table default.t from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/t
2024-04-23T22:26:24,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:24,579  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:24,588  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T22:26:24,617  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:26:24,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:24,627  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,627  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:26:24,628  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/hive_2024-04-23_22-26-23_140_6344899700609708294-1/-mr-10000
2024-04-23T22:26:24,629  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:24,640  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,650  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:26:24,650  INFO [main] FileOperations: Read stats for default.t/, numRows, true, 1, false: 
2024-04-23T22:26:24,650  INFO [main] FileOperations: Read stats for default.t/, rawDataSize, true, 0, false: 
2024-04-23T22:26:24,651  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.t newtbl=t	
2024-04-23T22:26:24,672  INFO [main] FileOperations: Read stats for default.t/, insertCount, true, 1, false: 
2024-04-23T22:26:24,672  INFO [main] FileOperations: Read stats for default.t/, updateCount, true, 0, false: 
2024-04-23T22:26:24,673  INFO [main] FileOperations: Read stats for default.t/, deleteCount, true, 0, false: 
2024-04-23T22:26:24,675  INFO [main] stats.BasicStatsTask: Table default.t stats: [numFiles=1, numRows=1, totalSize=666, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:26:24,675  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:24,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=40, alter_table_(String, String, String, Table, EnvironmentContext, String)=50, isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2}
MapReduce Jobs Launched: 
2024-04-23T22:26:24,676  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:26:24,676  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:24,676  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:26:24,676  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a); Time taken: 1.361 seconds
2024-04-23T22:26:24,676  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222623_f02d8335-f9ca-48c4-a072-ddfd90b3999a
2024-04-23T22:26:24,687  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:24,687  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:26:24,688  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update T set a=3 where b=2
2024-04-23T22:26:24,688  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/hive_2024-04-23_22-26-23_140_6344899700609708294-1
2024-04-23T22:26:24,689  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/bb1b0c7a-5e7c-4ea3-8b7a-3c5e39d0bc61/hive_2024-04-23_22-26-23_140_6344899700609708294-1 on fs with scheme file
2024-04-23T22:26:24,689  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222624_2a7cc64b-a46d-4852-8567-f8a79a04e1f7): update T set a=3 where b=2
2024-04-23T22:26:24,692  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 16
2024-04-23T22:26:24,693  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:26:24,693  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:26:24,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:24,700  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,700  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update T set a=3 where b=2> as 
<insert into table `default`.`T` select ROW__ID,`a`,`b` from `default`.`T` sort by ROW__ID >
2024-04-23T22:26:24,700  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:26:24,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:24,710  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,710  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:26:24,710  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:26:24,711  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:24,717  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,718  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:26:24,718  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:26:24,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:24,724  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,724  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:26:24,724  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:26:24,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T22:26:24,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.t	
2024-04-23T22:26:24,743  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.t	
2024-04-23T22:26:24,765  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [1], allowMissingStats: true
2024-04-23T22:26:24,766  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:24,775  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T22:26:24,784  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.t	
2024-04-23T22:26:24,793  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b
No Stats for default@t, Columns: b
2024-04-23T22:26:24,793  INFO [main] SessionState: No Stats for default@t, Columns: b
2024-04-23T22:26:24,855  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:26:24,856  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:26:24,856  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:26:24,856  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T22:26:24,863  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,866 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:26:24,867 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:26:24,867  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:26:24,868 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6914)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.acidVersionTest(TestTxnCommands.java:1482)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testVersioningVersionFileEnabled(TestTxnCommands.java:1462)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:26:24,868  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:24,868  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=4, getTableColumnStatistics_(String, String, List, String)=27, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=32, getAllTableConstraints_(AllTableConstraintsRequest)=5, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T22:26:24,868  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222624_2a7cc64b-a46d-4852-8567-f8a79a04e1f7); Time taken: 0.179 seconds
2024-04-23T22:26:24,868  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:26:24,873  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:24,881  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:26:24,882  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008): drop table if exists acidTbl
2024-04-23T22:26:24,884  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 16
2024-04-23T22:26:24,885  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:26:24,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:24,892  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,892  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:24,892  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:24,892  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:24,893  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, rollbackTxn_(long)=13, getTable_(GetTableRequest)=7, flushCache_()=0}
2024-04-23T22:26:24,893  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008); Time taken: 0.011 seconds
2024-04-23T22:26:24,893  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008
2024-04-23T22:26:24,893  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008
2024-04-23T22:26:24,910  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:26:24,910  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:24,910  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008): drop table if exists acidTbl
2024-04-23T22:26:24,910  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:24,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:24,917  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:24,924  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:24,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:26:25,034  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:25,034  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=117}
2024-04-23T22:26:25,035  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008); Time taken: 0.124 seconds
2024-04-23T22:26:25,035  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222624_d6c739ce-2329-4ac3-bc0e-c696d163d008
2024-04-23T22:26:25,039  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:26:25,046  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:25,047  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:26:25,048  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:26:25,048  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a): drop table if exists acidTblPart
2024-04-23T22:26:25,057  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 16
2024-04-23T22:26:25,058  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:26:25,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:25,081  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,081  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:25,081  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:25,081  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:25,081  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=21, getValidTxns_(long)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=8}
2024-04-23T22:26:25,081  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a); Time taken: 0.033 seconds
2024-04-23T22:26:25,082  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a
2024-04-23T22:26:25,082  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a
2024-04-23T22:26:25,097  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:26:25,097  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:25,097  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a): drop table if exists acidTblPart
2024-04-23T22:26:25,097  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:25,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:25,103  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:25,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:26:25,146  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:25,147  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:25,147  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a); Time taken: 0.049 seconds
2024-04-23T22:26:25,147  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222625_4627b494-6034-4606-842e-1b3f3e8d364a
2024-04-23T22:26:25,151  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:26:25,157  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:25,158  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:26:25,158  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:26:25,158  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222625_b39e824d-9dbf-4d1b-860e-339189075122): drop table if exists acidTbl2
2024-04-23T22:26:25,161  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 16
2024-04-23T22:26:25,161  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:26:25,162  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:25,162  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:25,162  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:25,162  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T22:26:25,163  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222625_b39e824d-9dbf-4d1b-860e-339189075122); Time taken: 0.004 seconds
2024-04-23T22:26:25,163  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222625_b39e824d-9dbf-4d1b-860e-339189075122
2024-04-23T22:26:25,163  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:26:25,163  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222625_b39e824d-9dbf-4d1b-860e-339189075122): drop table if exists acidTbl2
2024-04-23T22:26:25,163  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:25,164  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:26:25,164  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:25,164  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T22:26:25,165  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222625_b39e824d-9dbf-4d1b-860e-339189075122); Time taken: 0.001 seconds
2024-04-23T22:26:25,165  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222625_b39e824d-9dbf-4d1b-860e-339189075122
2024-04-23T22:26:25,170  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:26:25,177  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:25,177  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:26:25,177  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:26:25,178  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:25,180  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 16
2024-04-23T22:26:25,180  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:26:25,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:25,202  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,202  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:25,202  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:25,202  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:25,202  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=21, openTxn_(String, TxnType)=2}
2024-04-23T22:26:25,202  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10); Time taken: 0.024 seconds
2024-04-23T22:26:25,203  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10
2024-04-23T22:26:25,203  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10
2024-04-23T22:26:25,219  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:26:25,220  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:25,220  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10): drop table if exists nonAcidOrcTbl
2024-04-23T22:26:25,220  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:25,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:25,227  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:25,235  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,235  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:26:25,273  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:25,274  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=8}
2024-04-23T22:26:25,274  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10); Time taken: 0.053 seconds
2024-04-23T22:26:25,274  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222625_5879a226-d2cd-4b70-99e2-861e195e1f10
2024-04-23T22:26:25,278  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:26:25,285  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:25,285  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:26:25,285  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:25,286  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:25,288  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 16
2024-04-23T22:26:25,288  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:26:25,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:25,296  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,297  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:25,297  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:25,297  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:25,297  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=8}
2024-04-23T22:26:25,297  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f); Time taken: 0.011 seconds
2024-04-23T22:26:25,297  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f
2024-04-23T22:26:25,298  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f
2024-04-23T22:26:25,313  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:26:25,313  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:25,313  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f): drop table if exists nonAcidOrcTbl2
2024-04-23T22:26:25,313  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:25,313  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:25,321  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:25,329  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:26:25,356  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:25,357  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=35, isCompatibleWith_(Configuration)=0}
2024-04-23T22:26:25,357  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f); Time taken: 0.043 seconds
2024-04-23T22:26:25,357  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222625_50d73541-dfd9-45d3-9490-b87547d1501f
2024-04-23T22:26:25,361  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:26:25,368  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:25,368  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:26:25,368  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:26:25,369  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933): drop table if exists nonAcidNonBucket
2024-04-23T22:26:25,371  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 16
2024-04-23T22:26:25,371  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T22:26:25,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:25,382  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,382  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:26:25,382  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:26:25,382  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:26:25,382  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T22:26:25,383  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933); Time taken: 0.013 seconds
2024-04-23T22:26:25,383  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933
2024-04-23T22:26:25,383  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933
2024-04-23T22:26:25,401  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T22:26:25,401  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:26:25,401  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933): drop table if exists nonAcidNonBucket
2024-04-23T22:26:25,402  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:26:25,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:25,410  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,411  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:25,419  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:26:25,419  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:26:25,449  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:26:25,449  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=39}
2024-04-23T22:26:25,449  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933); Time taken: 0.048 seconds
2024-04-23T22:26:25,450  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222625_ea78c770-bd1b-4fe4-b294-953c31074933
2024-04-23T22:26:25,454  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T22:26:25,461  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T22:26:25,461  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T22:26:25,462  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testReadMyOwnInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.859"/>
  <testcase name="testAddAndDropPartitionAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.777"/>
  <testcase name="testImplicitRollback" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.756"/>
  <testcase name="testTruncateWithBase" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="3.133"/>
  <testcase name="exchangePartition" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.417"/>
  <testcase name="testTruncateWithBaseOnePartition" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.687"/>
  <testcase name="testParallelInsertAnalyzeStats" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="9.427"/>
  <testcase name="testDDLsAdvancingWriteIds" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.409"/>
  <testcase name="testTruncateWithBaseAllPartition" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.996"/>
  <testcase name="testTimeOutReaper" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.308">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where a = 5 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:27:06,989  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:27:06,989  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:27:06,989  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:27:06,989  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:27:06,989  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:27:06,989  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:27:06,990  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:27:06,990  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:27:06,990  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:27:06,990  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:27:06,990  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:27:06,992  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = d88b97b8-7761-42fc-addd-56644d06a99d
2024-04-23T22:27:06,994  INFO [main] SessionState: Hive Session ID = d88b97b8-7761-42fc-addd-56644d06a99d
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:06,995  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:07,000  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d88b97b8-7761-42fc-addd-56644d06a99d
2024-04-23T22:27:07,003  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d88b97b8-7761-42fc-addd-56644d06a99d
2024-04-23T22:27:07,005  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d88b97b8-7761-42fc-addd-56644d06a99d/_tmp_space.db
2024-04-23T22:27:07,005  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=d88b97b8-7761-42fc-addd-56644d06a99d, clientType=HIVECLI]
2024-04-23T22:27:07,006  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:07,006  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_791bf2b6-d207-4716-a126-fe17b8f628ea): drop table if exists acidTbl
2024-04-23T22:27:07,014  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:27:07,014  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:27:07,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,019  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,019  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,019  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,019  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=8, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T22:27:07,020  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_791bf2b6-d207-4716-a126-fe17b8f628ea); Time taken: 0.013 seconds
2024-04-23T22:27:07,020  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222707_791bf2b6-d207-4716-a126-fe17b8f628ea
2024-04-23T22:27:07,020  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:07,020  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_791bf2b6-d207-4716-a126-fe17b8f628ea): drop table if exists acidTbl
2024-04-23T22:27:07,020  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,023  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,023  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,023  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_791bf2b6-d207-4716-a126-fe17b8f628ea); Time taken: 0.003 seconds
2024-04-23T22:27:07,023  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_791bf2b6-d207-4716-a126-fe17b8f628ea
2024-04-23T22:27:07,028  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:27:07,034  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:27:07,035  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:07,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_7dfa2903-459e-4fc7-b13d-076a8135fe4f): drop table if exists acidTblPart
2024-04-23T22:27:07,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:27:07,037  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:27:07,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:07,040  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,040  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,040  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,040  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=1, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T22:27:07,041  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_7dfa2903-459e-4fc7-b13d-076a8135fe4f); Time taken: 0.005 seconds
2024-04-23T22:27:07,041  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222707_7dfa2903-459e-4fc7-b13d-076a8135fe4f
2024-04-23T22:27:07,041  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:07,041  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_7dfa2903-459e-4fc7-b13d-076a8135fe4f): drop table if exists acidTblPart
2024-04-23T22:27:07,041  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:07,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,044  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_7dfa2903-459e-4fc7-b13d-076a8135fe4f); Time taken: 0.003 seconds
2024-04-23T22:27:07,044  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_7dfa2903-459e-4fc7-b13d-076a8135fe4f
2024-04-23T22:27:07,049  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:27:07,054  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,054  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:27:07,055  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:07,055  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_125cd688-b612-44f3-a4b2-9b015b02c15a): drop table if exists acidTbl2
2024-04-23T22:27:07,057  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:27:07,057  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:27:07,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:07,060  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,060  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,060  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,060  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:27:07,060  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_125cd688-b612-44f3-a4b2-9b015b02c15a); Time taken: 0.005 seconds
2024-04-23T22:27:07,061  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222707_125cd688-b612-44f3-a4b2-9b015b02c15a
2024-04-23T22:27:07,061  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:07,061  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_125cd688-b612-44f3-a4b2-9b015b02c15a): drop table if exists acidTbl2
2024-04-23T22:27:07,061  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,061  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:07,063  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,064  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,064  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_125cd688-b612-44f3-a4b2-9b015b02c15a); Time taken: 0.002 seconds
2024-04-23T22:27:07,064  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_125cd688-b612-44f3-a4b2-9b015b02c15a
2024-04-23T22:27:07,068  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:27:07,073  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,073  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:27:07,074  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:07,074  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_5cf7a2ac-a924-4ee4-9244-5d41f58eb432): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:07,076  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:27:07,076  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:27:07,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:07,079  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,079  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,079  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,079  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T22:27:07,080  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_5cf7a2ac-a924-4ee4-9244-5d41f58eb432); Time taken: 0.005 seconds
2024-04-23T22:27:07,080  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222707_5cf7a2ac-a924-4ee4-9244-5d41f58eb432
2024-04-23T22:27:07,080  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:07,080  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_5cf7a2ac-a924-4ee4-9244-5d41f58eb432): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:07,080  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:07,083  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,083  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,083  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_5cf7a2ac-a924-4ee4-9244-5d41f58eb432); Time taken: 0.003 seconds
2024-04-23T22:27:07,083  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_5cf7a2ac-a924-4ee4-9244-5d41f58eb432
2024-04-23T22:27:07,087  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:27:07,092  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,092  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:27:07,093  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:07,093  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_8326dd3c-74c9-4cff-8391-201be3e5d92c): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:07,096  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:27:07,096  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:27:07,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:07,099  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,099  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,099  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,100  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=1}
2024-04-23T22:27:07,100  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_8326dd3c-74c9-4cff-8391-201be3e5d92c); Time taken: 0.006 seconds
2024-04-23T22:27:07,100  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222707_8326dd3c-74c9-4cff-8391-201be3e5d92c
2024-04-23T22:27:07,100  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:07,100  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_8326dd3c-74c9-4cff-8391-201be3e5d92c): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:07,100  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:07,103  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,103  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,103  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_8326dd3c-74c9-4cff-8391-201be3e5d92c); Time taken: 0.003 seconds
2024-04-23T22:27:07,103  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_8326dd3c-74c9-4cff-8391-201be3e5d92c
2024-04-23T22:27:07,108  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:27:07,113  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,113  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:27:07,113  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:07,113  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_a10bb460-2561-489c-aa09-f381d70351ce): drop table if exists nonAcidNonBucket
2024-04-23T22:27:07,115  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:27:07,116  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:27:07,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:07,118  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,119  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,119  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,119  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-23T22:27:07,119  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_a10bb460-2561-489c-aa09-f381d70351ce); Time taken: 0.006 seconds
2024-04-23T22:27:07,119  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222707_a10bb460-2561-489c-aa09-f381d70351ce
2024-04-23T22:27:07,119  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:07,119  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_a10bb460-2561-489c-aa09-f381d70351ce): drop table if exists nonAcidNonBucket
2024-04-23T22:27:07,119  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:07,122  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,122  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,122  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_a10bb460-2561-489c-aa09-f381d70351ce); Time taken: 0.003 seconds
2024-04-23T22:27:07,122  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_a10bb460-2561-489c-aa09-f381d70351ce
2024-04-23T22:27:07,127  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:27:07,132  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,132  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:27:07,132  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,133  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,135  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:27:07,135  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:27:07,136  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:07,136  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:07,140  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:27:07,141  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:07,142  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:07,142  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,142  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,142  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,142  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=4, getDatabase_(String)=1, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:27:07,143  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea); Time taken: 0.01 seconds
2024-04-23T22:27:07,143  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea
2024-04-23T22:27:07,143  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea
2024-04-23T22:27:07,156  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:27:07,156  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:07,157  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,157  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936427, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, numRows=0, transactional=true, bucketing_version=2, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:07,163  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:07,196  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=38, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,196  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea); Time taken: 0.039 seconds
2024-04-23T22:27:07,196  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_611b1dc1-904a-458e-b866-b12a1bf20dea
2024-04-23T22:27:07,201  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:27:07,206  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,206  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:27:07,206  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,207  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,209  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:27:07,209  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:27:07,210  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:07,210  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:07,212  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:27:07,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:07,214  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:07,214  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,214  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,214  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,214  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=2, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T22:27:07,214  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2); Time taken: 0.007 seconds
2024-04-23T22:27:07,214  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2
2024-04-23T22:27:07,215  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2
2024-04-23T22:27:07,230  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:27:07,230  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:07,230  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,231  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936427, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:07,236  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:27:07,249  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,249  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,249  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2); Time taken: 0.019 seconds
2024-04-23T22:27:07,249  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_44c35370-d389-4553-be87-55a57c9db0d2
2024-04-23T22:27:07,253  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:27:07,258  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,258  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:27:07,259  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,259  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,261  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:27:07,261  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:27:07,262  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:07,262  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:07,264  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:27:07,264  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:07,266  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:07,266  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,266  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,266  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,266  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=8}
2024-04-23T22:27:07,266  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8); Time taken: 0.007 seconds
2024-04-23T22:27:07,266  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8
2024-04-23T22:27:07,267  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8
2024-04-23T22:27:07,279  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:27:07,279  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:07,279  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,280  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936427, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, totalSize=0, rawDataSize=0, numRows=0, numFilesErasureCoded=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:07,286  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:27:07,298  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,298  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,298  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8); Time taken: 0.019 seconds
2024-04-23T22:27:07,298  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_f3f7455b-0a89-41be-8382-b1428a97f7e8
2024-04-23T22:27:07,302  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:27:07,307  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,308  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:27:07,308  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,308  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,310  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:27:07,311  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:27:07,311  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:07,311  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:07,313  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:27:07,313  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:07,315  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:07,315  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,315  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,315  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=1}
2024-04-23T22:27:07,315  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9); Time taken: 0.007 seconds
2024-04-23T22:27:07,315  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9
2024-04-23T22:27:07,316  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9
2024-04-23T22:27:07,328  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:27:07,328  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:07,329  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,329  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936427, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFilesErasureCoded=0, transactional=false, rawDataSize=0, totalSize=0, numRows=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:07,337  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:27:07,350  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,350  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9); Time taken: 0.021 seconds
2024-04-23T22:27:07,350  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_bb06bc21-03c2-4336-b654-834a4823c5a9
2024-04-23T22:27:07,354  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:27:07,359  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,359  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:27:07,360  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,360  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,362  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:27:07,362  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:27:07,362  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:07,363  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:07,365  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:27:07,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:07,366  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:07,366  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,366  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,366  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,366  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, flushCache_()=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2}
2024-04-23T22:27:07,367  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645); Time taken: 0.006 seconds
2024-04-23T22:27:07,367  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645
2024-04-23T22:27:07,367  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645
2024-04-23T22:27:07,380  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:27:07,380  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:07,380  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:07,380  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,381  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d88b97b8-7761-42fc-addd-56644d06a99d/_tmp_space.db/2f814ddd-af70-4e8b-a8a7-4ca433b99864
2024-04-23T22:27:07,384  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,384  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:27:07,384  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645); Time taken: 0.004 seconds
2024-04-23T22:27:07,384  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_3c9e1e09-8317-46cd-b1f7-efc8acbf5645
2024-04-23T22:27:07,388  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:27:07,393  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,393  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:27:07,393  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,394  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,396  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:27:07,396  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:27:07,396  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:07,396  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:07,398  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:27:07,398  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:07,400  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:07,400  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,400  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,400  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,400  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=8}
2024-04-23T22:27:07,400  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1); Time taken: 0.006 seconds
2024-04-23T22:27:07,401  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1
2024-04-23T22:27:07,401  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1
2024-04-23T22:27:07,414  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:27:07,414  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:07,414  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:07,414  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936427, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, rawDataSize=0, numFiles=0, numFilesErasureCoded=0, transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:07,420  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:27:07,431  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,432  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=16, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,432  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1); Time taken: 0.017 seconds
2024-04-23T22:27:07,432  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_595a47ab-456f-48c2-970f-2a7c38cac0b1
2024-04-23T22:27:07,435  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:27:07,440  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,441  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:27:07,441  INFO [main] ql.TxnCommandsBaseForTests: Running the query: start transaction
2024-04-23T22:27:07,441  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_fd3c3061-dd11-4e36-9e1c-4b83fccff929): start transaction
2024-04-23T22:27:07,443  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:27:07,444  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:27:07,444  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:07,444  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:07,444  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:07,444  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,444  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,444  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,445  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:07,445  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_fd3c3061-dd11-4e36-9e1c-4b83fccff929); Time taken: 0.003 seconds
2024-04-23T22:27:07,445  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222707_fd3c3061-dd11-4e36-9e1c-4b83fccff929
2024-04-23T22:27:07,445  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T22:27:07,445  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_fd3c3061-dd11-4e36-9e1c-4b83fccff929): start transaction
2024-04-23T22:27:07,445  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,445  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T22:27:07,445  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_fd3c3061-dd11-4e36-9e1c-4b83fccff929); Time taken: 0.0 seconds
2024-04-23T22:27:07,446  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where a = 5
2024-04-23T22:27:07,446  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_007887fa-6304-4d99-9236-9c3aa3b3022e): delete from acidTbl where a = 5
2024-04-23T22:27:07,446  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:27:07,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,463  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,463  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where a = 5> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:27:07,463  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:27:07,468  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:07,468  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:07,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:07,476  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,476  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:07,476  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:07,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,482  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,482  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:07,482  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:07,493  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:07,537  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:27:07,537  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:07,546  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:07,555  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:27:07,564  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:27:07,565  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:27:07,567  INFO [HiveClientCache-cleaner-0] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
2024-04-23T22:27:07,567  INFO [HiveClientCache-cleaner-0] metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: -12
2024-04-23T22:27:07,620  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:07,621  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:07,621  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:07,621  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,627  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,630 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:27:07,631 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:27:07,631  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:27:07,632 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testTimeOutReaper(TestTxnCommands.java:945)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:27:07,632  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,632  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=27, getAllTableConstraints_(AllTableConstraintsRequest)=24, getValidWriteIds_(List, String)=5, getTable_(GetTableRequest)=37, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T22:27:07,632  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_007887fa-6304-4d99-9236-9c3aa3b3022e); Time taken: 0.186 seconds
2024-04-23T22:27:07,632  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_fd3c3061-dd11-4e36-9e1c-4b83fccff929
2024-04-23T22:27:07,636  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,641  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:07,641  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b): drop table if exists acidTbl
2024-04-23T22:27:07,643  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:27:07,644  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:27:07,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,650  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,650  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,650  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,650  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,650  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, rollbackTxn_(long)=8, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=6}
2024-04-23T22:27:07,650  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b); Time taken: 0.009 seconds
2024-04-23T22:27:07,650  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b
2024-04-23T22:27:07,651  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b
2024-04-23T22:27:07,667  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:27:07,667  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:07,667  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b): drop table if exists acidTbl
2024-04-23T22:27:07,667  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,667  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,673  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,673  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,679  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:07,767  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,767  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=94, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:07,768  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b); Time taken: 0.1 seconds
2024-04-23T22:27:07,768  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_754f69c1-5484-4e47-b08a-65649a28311b
2024-04-23T22:27:07,771  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:27:07,776  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,778  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:27:07,778  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:07,778  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb): drop table if exists acidTblPart
2024-04-23T22:27:07,780  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T22:27:07,780  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:27:07,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:07,787  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,787  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,787  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,787  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,787  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=6, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=1}
2024-04-23T22:27:07,788  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb); Time taken: 0.009 seconds
2024-04-23T22:27:07,788  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb
2024-04-23T22:27:07,788  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb
2024-04-23T22:27:07,801  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:27:07,801  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:07,801  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb): drop table if exists acidTblPart
2024-04-23T22:27:07,801  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,801  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:07,807  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:07,813  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:07,850  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,850  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-23T22:27:07,850  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb); Time taken: 0.049 seconds
2024-04-23T22:27:07,850  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_bbf970eb-8421-43fa-97ed-0886422e1bcb
2024-04-23T22:27:07,854  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:27:07,861  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,861  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:27:07,861  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:07,862  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_1b2cb4a7-58d1-453f-a6f1-d52fa440833c): drop table if exists acidTbl2
2024-04-23T22:27:07,865  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T22:27:07,865  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:27:07,866  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,866  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,866  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3}
2024-04-23T22:27:07,867  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_1b2cb4a7-58d1-453f-a6f1-d52fa440833c); Time taken: 0.005 seconds
2024-04-23T22:27:07,867  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222707_1b2cb4a7-58d1-453f-a6f1-d52fa440833c
2024-04-23T22:27:07,867  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:07,867  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_1b2cb4a7-58d1-453f-a6f1-d52fa440833c): drop table if exists acidTbl2
2024-04-23T22:27:07,867  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,867  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:27:07,868  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:07,868  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T22:27:07,868  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_1b2cb4a7-58d1-453f-a6f1-d52fa440833c); Time taken: 0.001 seconds
2024-04-23T22:27:07,868  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_1b2cb4a7-58d1-453f-a6f1-d52fa440833c
2024-04-23T22:27:07,873  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:27:07,879  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:07,879  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:27:07,880  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:07,880  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:07,882  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T22:27:07,882  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:27:07,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:07,912  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,912  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:07,912  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:07,912  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:07,912  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=29, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:27:07,913  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d); Time taken: 0.032 seconds
2024-04-23T22:27:07,913  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d
2024-04-23T22:27:07,913  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d
2024-04-23T22:27:07,931  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:27:07,931  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:07,931  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:07,931  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:07,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:07,940  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,940  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:07,948  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:07,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:08,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=104, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T22:27:08,045  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d); Time taken: 0.113 seconds
2024-04-23T22:27:08,045  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222707_b880eebd-35ef-4d8e-bed5-517441a5938d
2024-04-23T22:27:08,049  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:27:08,055  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,055  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:27:08,056  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:08,056  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:08,059  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 4
2024-04-23T22:27:08,059  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:27:08,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:08,067  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,068  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,068  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,068  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,068  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:27:08,068  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6); Time taken: 0.012 seconds
2024-04-23T22:27:08,068  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6
2024-04-23T22:27:08,069  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6
2024-04-23T22:27:08,082  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:27:08,082  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:08,082  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:08,083  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,083  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:08,093  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:08,102  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:08,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=10}
2024-04-23T22:27:08,133  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6); Time taken: 0.051 seconds
2024-04-23T22:27:08,133  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_02239448-f84f-423d-8915-0daee6fc3eb6
2024-04-23T22:27:08,137  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:27:08,144  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,144  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:27:08,144  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:08,145  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3): drop table if exists nonAcidNonBucket
2024-04-23T22:27:08,147  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 8
2024-04-23T22:27:08,147  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:27:08,148  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:08,156  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,156  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,156  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,156  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,156  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:27:08,156  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3); Time taken: 0.011 seconds
2024-04-23T22:27:08,156  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3
2024-04-23T22:27:08,157  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3
2024-04-23T22:27:08,172  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:27:08,172  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:08,172  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3): drop table if exists nonAcidNonBucket
2024-04-23T22:27:08,172  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:08,180  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:08,189  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,189  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:08,220  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,220  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=39, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T22:27:08,220  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3); Time taken: 0.048 seconds
2024-04-23T22:27:08,220  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_780f25e3-d364-46dd-98af-820a394736e3
2024-04-23T22:27:08,224  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:27:08,231  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,231  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:27:08,232  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeOnTezEdges" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.506">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b)  failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:27:08,299  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:27:08,301  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = fa846d1f-7dbb-441d-ac77-038781846084
2024-04-23T22:27:08,304  INFO [main] SessionState: Hive Session ID = fa846d1f-7dbb-441d-ac77-038781846084
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:08,304  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:08,309  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/fa846d1f-7dbb-441d-ac77-038781846084
2024-04-23T22:27:08,312  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa846d1f-7dbb-441d-ac77-038781846084
2024-04-23T22:27:08,314  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/fa846d1f-7dbb-441d-ac77-038781846084/_tmp_space.db
2024-04-23T22:27:08,315  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=fa846d1f-7dbb-441d-ac77-038781846084, clientType=HIVECLI]
2024-04-23T22:27:08,315  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:08,315  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_86ef7bd2-5be6-43e7-8bae-2e869cfd07de): drop table if exists acidTbl
2024-04-23T22:27:08,324  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:27:08,324  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:27:08,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:08,329  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,329  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=9, getValidTxns_(long)=2}
2024-04-23T22:27:08,329  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_86ef7bd2-5be6-43e7-8bae-2e869cfd07de); Time taken: 0.014 seconds
2024-04-23T22:27:08,330  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222708_86ef7bd2-5be6-43e7-8bae-2e869cfd07de
2024-04-23T22:27:08,330  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:08,330  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_86ef7bd2-5be6-43e7-8bae-2e869cfd07de): drop table if exists acidTbl
2024-04-23T22:27:08,330  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:08,333  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,333  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,333  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_86ef7bd2-5be6-43e7-8bae-2e869cfd07de); Time taken: 0.003 seconds
2024-04-23T22:27:08,333  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_86ef7bd2-5be6-43e7-8bae-2e869cfd07de
2024-04-23T22:27:08,339  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:27:08,345  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,345  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:27:08,345  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:08,346  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_22c27d85-32da-4b51-ae34-3c27ade2b47c): drop table if exists acidTblPart
2024-04-23T22:27:08,348  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:27:08,348  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:27:08,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:08,352  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,352  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,352  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,352  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:27:08,353  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_22c27d85-32da-4b51-ae34-3c27ade2b47c); Time taken: 0.006 seconds
2024-04-23T22:27:08,353  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222708_22c27d85-32da-4b51-ae34-3c27ade2b47c
2024-04-23T22:27:08,353  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:08,353  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_22c27d85-32da-4b51-ae34-3c27ade2b47c): drop table if exists acidTblPart
2024-04-23T22:27:08,353  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,353  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:08,356  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,356  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,356  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_22c27d85-32da-4b51-ae34-3c27ade2b47c); Time taken: 0.003 seconds
2024-04-23T22:27:08,356  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_22c27d85-32da-4b51-ae34-3c27ade2b47c
2024-04-23T22:27:08,361  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:27:08,367  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,367  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:27:08,368  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:08,368  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_99d4424a-4d5f-45f6-9320-fba480759a5d): drop table if exists acidTbl2
2024-04-23T22:27:08,370  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:27:08,370  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:27:08,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:08,374  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,374  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,374  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,374  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=1, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:27:08,374  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_99d4424a-4d5f-45f6-9320-fba480759a5d); Time taken: 0.006 seconds
2024-04-23T22:27:08,374  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222708_99d4424a-4d5f-45f6-9320-fba480759a5d
2024-04-23T22:27:08,374  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:08,374  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_99d4424a-4d5f-45f6-9320-fba480759a5d): drop table if exists acidTbl2
2024-04-23T22:27:08,374  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:08,377  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,378  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:08,378  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_99d4424a-4d5f-45f6-9320-fba480759a5d); Time taken: 0.003 seconds
2024-04-23T22:27:08,378  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_99d4424a-4d5f-45f6-9320-fba480759a5d
2024-04-23T22:27:08,383  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:27:08,388  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,389  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:27:08,389  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:08,389  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_8acfddfb-2333-4e29-abf1-774652bea0fd): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:08,392  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:27:08,392  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:27:08,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:08,396  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,396  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,396  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,396  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:27:08,396  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_8acfddfb-2333-4e29-abf1-774652bea0fd); Time taken: 0.007 seconds
2024-04-23T22:27:08,397  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222708_8acfddfb-2333-4e29-abf1-774652bea0fd
2024-04-23T22:27:08,397  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:08,397  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_8acfddfb-2333-4e29-abf1-774652bea0fd): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:08,397  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:08,401  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,401  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,401  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_8acfddfb-2333-4e29-abf1-774652bea0fd); Time taken: 0.004 seconds
2024-04-23T22:27:08,401  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_8acfddfb-2333-4e29-abf1-774652bea0fd
2024-04-23T22:27:08,407  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:27:08,413  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,413  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:27:08,414  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:08,414  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_3b9b88d2-fa6b-48ba-9bc3-9cf66a3818f9): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:08,416  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:27:08,416  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:27:08,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:08,420  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,420  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,420  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,420  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=1}
2024-04-23T22:27:08,421  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_3b9b88d2-fa6b-48ba-9bc3-9cf66a3818f9); Time taken: 0.006 seconds
2024-04-23T22:27:08,421  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222708_3b9b88d2-fa6b-48ba-9bc3-9cf66a3818f9
2024-04-23T22:27:08,421  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:08,421  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_3b9b88d2-fa6b-48ba-9bc3-9cf66a3818f9): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:08,421  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:08,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,424  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_3b9b88d2-fa6b-48ba-9bc3-9cf66a3818f9); Time taken: 0.003 seconds
2024-04-23T22:27:08,425  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_3b9b88d2-fa6b-48ba-9bc3-9cf66a3818f9
2024-04-23T22:27:08,430  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:27:08,436  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,437  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:27:08,437  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:08,438  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_2d36f29c-c244-413e-8693-4325af0c4d9d): drop table if exists nonAcidNonBucket
2024-04-23T22:27:08,440  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:27:08,440  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:27:08,441  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:08,443  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,443  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,443  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,443  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,444  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_2d36f29c-c244-413e-8693-4325af0c4d9d); Time taken: 0.005 seconds
2024-04-23T22:27:08,444  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222708_2d36f29c-c244-413e-8693-4325af0c4d9d
2024-04-23T22:27:08,444  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:08,444  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_2d36f29c-c244-413e-8693-4325af0c4d9d): drop table if exists nonAcidNonBucket
2024-04-23T22:27:08,444  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:08,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,447  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,447  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_2d36f29c-c244-413e-8693-4325af0c4d9d); Time taken: 0.003 seconds
2024-04-23T22:27:08,447  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_2d36f29c-c244-413e-8693-4325af0c4d9d
2024-04-23T22:27:08,452  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:27:08,458  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,458  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:27:08,459  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,459  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,461  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:27:08,461  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:27:08,462  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:08,462  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:08,467  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:27:08,467  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:08,469  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:08,469  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,469  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,469  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,469  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=2}
2024-04-23T22:27:08,469  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766); Time taken: 0.01 seconds
2024-04-23T22:27:08,469  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766
2024-04-23T22:27:08,469  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766
2024-04-23T22:27:08,488  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:27:08,489  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:08,489  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,489  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936428, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, transactional=true, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:08,495  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:08,537  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,537  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=47}
2024-04-23T22:27:08,537  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766); Time taken: 0.048 seconds
2024-04-23T22:27:08,537  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_a396bd13-6058-4056-b8f6-870fed7f3766
2024-04-23T22:27:08,541  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:27:08,548  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,548  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:27:08,549  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,549  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,552  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:27:08,552  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:27:08,553  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:08,553  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:08,555  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:27:08,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:08,557  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:08,557  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,557  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,558  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,558  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2}
2024-04-23T22:27:08,558  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e); Time taken: 0.009 seconds
2024-04-23T22:27:08,558  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e
2024-04-23T22:27:08,558  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e
2024-04-23T22:27:08,574  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:27:08,574  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:08,575  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,575  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936428, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:08,582  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:27:08,597  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,597  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,597  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e); Time taken: 0.022 seconds
2024-04-23T22:27:08,597  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_ce10fd55-808c-43e8-9a5b-48d2c046586e
2024-04-23T22:27:08,602  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:27:08,608  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,608  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:27:08,609  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,609  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,612  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:27:08,612  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:27:08,613  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:08,613  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:08,615  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:27:08,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:08,618  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:08,618  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,618  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,618  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,618  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T22:27:08,618  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510); Time taken: 0.009 seconds
2024-04-23T22:27:08,618  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510
2024-04-23T22:27:08,619  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510
2024-04-23T22:27:08,635  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:27:08,635  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:08,635  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,635  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,636  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936428, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFilesErasureCoded=0, numFiles=0, totalSize=0, rawDataSize=0, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:08,642  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:27:08,656  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,656  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510); Time taken: 0.021 seconds
2024-04-23T22:27:08,656  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_27bc5c2e-fe08-4319-ab9a-4f771a9c1510
2024-04-23T22:27:08,660  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:27:08,666  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,666  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:27:08,666  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,667  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,669  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:27:08,670  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:27:08,670  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:08,670  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:08,673  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:27:08,673  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:08,674  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:08,674  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,674  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,675  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=3, getDatabase_(String)=1}
2024-04-23T22:27:08,675  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f); Time taken: 0.007 seconds
2024-04-23T22:27:08,675  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f
2024-04-23T22:27:08,675  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f
2024-04-23T22:27:08,690  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:27:08,690  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:08,690  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,690  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936428, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, totalSize=0, transactional=false, bucketing_version=2, numRows=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:08,696  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:27:08,709  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,709  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,710  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f); Time taken: 0.019 seconds
2024-04-23T22:27:08,710  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_fce2b653-294b-4674-becd-6df0099b0d5f
2024-04-23T22:27:08,713  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:27:08,719  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,719  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:27:08,720  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,720  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,722  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:27:08,722  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:27:08,722  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:08,722  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:08,725  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:27:08,725  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:08,726  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:08,726  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,726  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,726  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,726  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1}
2024-04-23T22:27:08,727  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4); Time taken: 0.006 seconds
2024-04-23T22:27:08,727  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4
2024-04-23T22:27:08,727  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4
2024-04-23T22:27:08,740  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:27:08,740  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:08,741  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:08,741  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,742  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/fa846d1f-7dbb-441d-ac77-038781846084/_tmp_space.db/acc4ec1e-fa76-432a-b9b2-27705c684a31
2024-04-23T22:27:08,745  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,745  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=2}
2024-04-23T22:27:08,745  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4); Time taken: 0.003 seconds
2024-04-23T22:27:08,745  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_f5ad77fd-87be-4019-a955-9b9a07d15cf4
2024-04-23T22:27:08,748  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:27:08,753  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,754  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:27:08,754  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,754  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,756  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:27:08,756  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:27:08,757  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:08,757  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:08,759  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:27:08,759  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:08,761  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:08,761  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:08,761  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:08,761  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:08,761  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=1}
2024-04-23T22:27:08,761  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a); Time taken: 0.007 seconds
2024-04-23T22:27:08,761  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a
2024-04-23T22:27:08,761  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a
2024-04-23T22:27:08,774  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:27:08,774  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:08,774  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:08,775  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:08,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936428, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, transactional=false, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:08,780  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:27:08,792  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:08,792  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=17, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:08,793  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a); Time taken: 0.018 seconds
2024-04-23T22:27:08,793  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_36940aef-60c6-4319-9bb0-c4601c04237a
2024-04-23T22:27:08,796  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:27:08,801  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:08,801  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:27:08,803  INFO [main] ql.TxnCommandsBaseForTests: Running the query: explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T22:27:08,804  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) 
2024-04-23T22:27:08,806  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:27:08,806  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:27:08,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:08,823  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T22:27:08,827  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/fa846d1f-7dbb-441d-ac77-038781846084/_tmp_space.db/merge_tmp_table
2024-04-23T22:27:08,829  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <explain merge into acidTbl as t using nonAcidOrcTbl s ON t.a = s.a WHEN MATCHED AND s.a > 8 THEN DELETE WHEN MATCHED THEN UPDATE SET b = 7 WHEN NOT MATCHED THEN INSERT VALUES(s.a, s.b) > as 
<FROM
  `default`.`acidTbl` `t`
  RIGHT OUTER JOIN
  `default`.`nonAcidOrcTbl` `s`
  ON `t`.`a` = `s`.`a`
INSERT INTO `default`.`acidTbl`    -- delete clause
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND `s`.`a` > 8
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- update clause(insert part)
 SELECT `t`.`a`, 7
   WHERE `t`.`a` = `s`.`a` AND NOT(`s`.`a` > 8)
INSERT INTO `default`.`acidTbl`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`a` = `s`.`a` AND NOT(`s`.`a` > 8)
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`acidTbl`    -- insert clause
  SELECT `s`.`a`, `s`.`b`
   WHERE `t`.`a` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`a` = `s`.`a` GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T22:27:08,830  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:27:08,836  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:08,836  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:08,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:08,843  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,844  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:27:08,863  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,864  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:08,864  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:08,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:08,870  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:08,877  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:08,883  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:08,889  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,889  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:08,889  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:08,890  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:08,890  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:08,890  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:08,901  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:08,927  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.nonacidorctbl	
2024-04-23T22:27:08,955  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:27:08,956  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:08,964  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:08,973  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:27:08,982  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:27:08,982  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:27:08,982  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.nonacidorctbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:27:08,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:27:08,993  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:08,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonacidorctbl	
2024-04-23T22:27:09,004  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,004  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.nonacidorctbl	
2024-04-23T22:27:09,015  WARN [main] calcite.RelOptHiveTable: No Stats for default@nonacidorctbl, Columns: a, b
No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T22:27:09,015  INFO [main] SessionState: No Stats for default@nonacidorctbl, Columns: a, b
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:09,176  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:09,177  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:09,177  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:09,177  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:09,177  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:09,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,183  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,190  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,197  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,197  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,204  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,209 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.ExplainSemanticAnalyzer.analyzeInternal(ExplainSemanticAnalyzer.java:175) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:27:09,210 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:27:09,211 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.ExplainSemanticAnalyzer.analyzeInternal(ExplainSemanticAnalyzer.java:175)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeOnTezEdges(TestTxnCommands.java:1198)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:27:09,211  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,211  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=94, openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=29, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=8, getValidTxns_(long)=1, getTableColumnStatistics_(String, String, List, String)=58, createTable_(Table)=2, commitTxn_(CommitTxnRequest)=9}
2024-04-23T22:27:09,211  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.407 seconds
2024-04-23T22:27:09,211  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,216  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,223  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:09,223  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/fa846d1f-7dbb-441d-ac77-038781846084/hive_2024-04-23_22-27-08_829_7281499907770124114-1
2024-04-23T22:27:09,224  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists acidTbl
2024-04-23T22:27:09,226  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:27:09,226  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:27:09,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,233  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,233  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,233  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,233  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,233  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=12, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getTable_(GetTableRequest)=6}
2024-04-23T22:27:09,233  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.009 seconds
2024-04-23T22:27:09,234  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,234  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,253  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:27:09,253  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:09,253  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists acidTbl
2024-04-23T22:27:09,253  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,259  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,265  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=102, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T22:27:09,361  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.108 seconds
2024-04-23T22:27:09,362  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,365  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:27:09,372  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,372  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:27:09,372  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:09,372  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists acidTblPart
2024-04-23T22:27:09,374  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 4
2024-04-23T22:27:09,375  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:27:09,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:09,381  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,381  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,381  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,381  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,382  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=6, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:09,382  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.009 seconds
2024-04-23T22:27:09,382  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,382  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,396  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:27:09,396  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:09,396  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists acidTblPart
2024-04-23T22:27:09,396  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:09,402  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:09,409  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,409  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:09,447  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,447  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=44}
2024-04-23T22:27:09,447  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.051 seconds
2024-04-23T22:27:09,447  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,452  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:27:09,459  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,459  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:27:09,460  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:09,460  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists acidTbl2
2024-04-23T22:27:09,463  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-23T22:27:09,463  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:27:09,464  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,464  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,464  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,465  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=0, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,465  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.004 seconds
2024-04-23T22:27:09,465  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,465  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:09,465  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists acidTbl2
2024-04-23T22:27:09,465  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,466  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:27:09,466  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,466  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T22:27:09,466  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.001 seconds
2024-04-23T22:27:09,466  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,472  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:27:09,479  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,479  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:27:09,480  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:09,480  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:09,482  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-23T22:27:09,482  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:27:09,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:09,506  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,506  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,506  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,506  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,506  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=23, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:27:09,506  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.026 seconds
2024-04-23T22:27:09,506  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,507  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,526  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:27:09,526  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:09,526  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:09,526  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:09,535  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,535  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:09,543  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:09,571  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,571  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=36, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,571  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.045 seconds
2024-04-23T22:27:09,572  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,575  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:27:09,581  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,581  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:27:09,581  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:09,582  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:09,584  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 9
2024-04-23T22:27:09,584  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:27:09,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:09,592  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,593  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,593  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,593  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,593  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1}
2024-04-23T22:27:09,593  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.011 seconds
2024-04-23T22:27:09,593  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,593  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,607  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:27:09,607  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:09,607  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:09,607  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,607  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:09,615  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:09,623  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,623  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:09,651  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,651  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=36, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,651  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.044 seconds
2024-04-23T22:27:09,651  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,655  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:27:09,661  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,661  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:27:09,661  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:09,661  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists nonAcidNonBucket
2024-04-23T22:27:09,664  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 10
2024-04-23T22:27:09,664  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:27:09,664  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:09,672  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,672  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,672  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,672  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,672  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:09,672  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.011 seconds
2024-04-23T22:27:09,672  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,673  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,687  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:27:09,687  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:09,687  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2): drop table if exists nonAcidNonBucket
2024-04-23T22:27:09,687  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,687  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:09,695  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,695  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:09,703  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:09,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:09,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,731  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=35}
2024-04-23T22:27:09,731  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2); Time taken: 0.043 seconds
2024-04-23T22:27:09,731  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222708_dfba48f3-4aa9-420f-927b-1a9affefe7d2
2024-04-23T22:27:09,734  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:27:09,740  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,740  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:27:09,741  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeType2SCD01" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="6.974">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:27:09,804  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:27:09,804  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:27:09,804  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:27:09,804  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:27:09,804  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:27:09,804  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:27:09,804  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:27:09,805  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:27:09,805  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:27:09,805  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:27:09,805  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:27:09,807  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 8a0de207-84d2-4e24-9197-cf22e9ce44f2
2024-04-23T22:27:09,810  INFO [main] SessionState: Hive Session ID = 8a0de207-84d2-4e24-9197-cf22e9ce44f2
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:09,810  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:09,815  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/8a0de207-84d2-4e24-9197-cf22e9ce44f2
2024-04-23T22:27:09,818  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2
2024-04-23T22:27:09,820  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/8a0de207-84d2-4e24-9197-cf22e9ce44f2/_tmp_space.db
2024-04-23T22:27:09,821  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=8a0de207-84d2-4e24-9197-cf22e9ce44f2, clientType=HIVECLI]
2024-04-23T22:27:09,821  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:09,821  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222709_6aa7ec31-0e6c-4998-bf70-f0a7130c5b30): drop table if exists acidTbl
2024-04-23T22:27:09,830  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:27:09,830  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:27:09,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,837  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,837  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,837  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,837  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=8, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,837  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222709_6aa7ec31-0e6c-4998-bf70-f0a7130c5b30); Time taken: 0.016 seconds
2024-04-23T22:27:09,837  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222709_6aa7ec31-0e6c-4998-bf70-f0a7130c5b30
2024-04-23T22:27:09,837  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:09,837  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222709_6aa7ec31-0e6c-4998-bf70-f0a7130c5b30): drop table if exists acidTbl
2024-04-23T22:27:09,838  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:09,841  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,841  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,841  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222709_6aa7ec31-0e6c-4998-bf70-f0a7130c5b30); Time taken: 0.004 seconds
2024-04-23T22:27:09,841  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222709_6aa7ec31-0e6c-4998-bf70-f0a7130c5b30
2024-04-23T22:27:09,847  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:27:09,855  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,855  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:27:09,855  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:09,855  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222709_fa89c68d-6f9d-42ab-8c4e-994472e15dc6): drop table if exists acidTblPart
2024-04-23T22:27:09,857  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:27:09,858  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:27:09,858  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:09,861  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,861  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:09,861  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222709_fa89c68d-6f9d-42ab-8c4e-994472e15dc6); Time taken: 0.006 seconds
2024-04-23T22:27:09,862  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222709_fa89c68d-6f9d-42ab-8c4e-994472e15dc6
2024-04-23T22:27:09,862  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:09,862  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222709_fa89c68d-6f9d-42ab-8c4e-994472e15dc6): drop table if exists acidTblPart
2024-04-23T22:27:09,862  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,862  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:09,865  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,865  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,865  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222709_fa89c68d-6f9d-42ab-8c4e-994472e15dc6); Time taken: 0.003 seconds
2024-04-23T22:27:09,865  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222709_fa89c68d-6f9d-42ab-8c4e-994472e15dc6
2024-04-23T22:27:09,871  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:27:09,877  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,877  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:27:09,878  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:09,878  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222709_f1eb5a66-c7c1-42d7-a109-78ce97ff1790): drop table if exists acidTbl2
2024-04-23T22:27:09,880  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:27:09,880  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:27:09,881  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:09,883  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,883  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,884  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,884  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:09,884  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222709_f1eb5a66-c7c1-42d7-a109-78ce97ff1790); Time taken: 0.006 seconds
2024-04-23T22:27:09,884  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222709_f1eb5a66-c7c1-42d7-a109-78ce97ff1790
2024-04-23T22:27:09,884  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:09,884  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222709_f1eb5a66-c7c1-42d7-a109-78ce97ff1790): drop table if exists acidTbl2
2024-04-23T22:27:09,884  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:09,887  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,887  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,887  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222709_f1eb5a66-c7c1-42d7-a109-78ce97ff1790); Time taken: 0.003 seconds
2024-04-23T22:27:09,887  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222709_f1eb5a66-c7c1-42d7-a109-78ce97ff1790
2024-04-23T22:27:09,893  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:27:09,899  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,899  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:27:09,900  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:09,900  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222709_5ad651ca-8daa-4ba7-bb24-b9650d7db870): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:09,902  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:27:09,902  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:27:09,903  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:09,905  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,905  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,905  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,906  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T22:27:09,906  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222709_5ad651ca-8daa-4ba7-bb24-b9650d7db870); Time taken: 0.005 seconds
2024-04-23T22:27:09,906  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222709_5ad651ca-8daa-4ba7-bb24-b9650d7db870
2024-04-23T22:27:09,906  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:09,906  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222709_5ad651ca-8daa-4ba7-bb24-b9650d7db870): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:09,906  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:09,909  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,909  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,909  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222709_5ad651ca-8daa-4ba7-bb24-b9650d7db870); Time taken: 0.003 seconds
2024-04-23T22:27:09,909  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222709_5ad651ca-8daa-4ba7-bb24-b9650d7db870
2024-04-23T22:27:09,915  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:27:09,921  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,921  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:27:09,921  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:09,922  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222709_a058e1ea-8cc0-4175-baa3-cecdfbfe522d): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:09,924  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:27:09,924  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:27:09,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:09,927  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,927  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,927  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,927  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T22:27:09,927  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222709_a058e1ea-8cc0-4175-baa3-cecdfbfe522d); Time taken: 0.006 seconds
2024-04-23T22:27:09,928  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222709_a058e1ea-8cc0-4175-baa3-cecdfbfe522d
2024-04-23T22:27:09,928  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:09,928  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222709_a058e1ea-8cc0-4175-baa3-cecdfbfe522d): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:09,928  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,928  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:09,931  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,931  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,931  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222709_a058e1ea-8cc0-4175-baa3-cecdfbfe522d); Time taken: 0.003 seconds
2024-04-23T22:27:09,931  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222709_a058e1ea-8cc0-4175-baa3-cecdfbfe522d
2024-04-23T22:27:09,937  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:27:09,943  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,943  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:27:09,944  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:09,944  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222709_c08369de-0fa9-46bd-b1de-3cab3db79f17): drop table if exists nonAcidNonBucket
2024-04-23T22:27:09,946  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:27:09,946  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:27:09,947  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:09,949  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,949  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,950  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,950  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T22:27:09,950  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222709_c08369de-0fa9-46bd-b1de-3cab3db79f17); Time taken: 0.006 seconds
2024-04-23T22:27:09,950  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222709_c08369de-0fa9-46bd-b1de-3cab3db79f17
2024-04-23T22:27:09,950  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:09,950  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222709_c08369de-0fa9-46bd-b1de-3cab3db79f17): drop table if exists nonAcidNonBucket
2024-04-23T22:27:09,950  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,950  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:09,954  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:09,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:09,955  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222709_c08369de-0fa9-46bd-b1de-3cab3db79f17); Time taken: 0.004 seconds
2024-04-23T22:27:09,955  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222709_c08369de-0fa9-46bd-b1de-3cab3db79f17
2024-04-23T22:27:09,961  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:27:09,967  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:09,967  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:27:09,968  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:09,968  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:09,970  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:27:09,971  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:27:09,971  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:09,971  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:09,977  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:27:09,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:09,979  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:09,979  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:09,979  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:09,979  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:09,979  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=6, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T22:27:09,979  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd); Time taken: 0.011 seconds
2024-04-23T22:27:09,980  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd
2024-04-23T22:27:09,980  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd
2024-04-23T22:27:09,997  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:27:09,997  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:09,998  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:09,998  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:09,999  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936429, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, numFilesErasureCoded=0, transactional=true, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:10,005  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:10,047  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,047  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=48, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,047  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd); Time taken: 0.049 seconds
2024-04-23T22:27:10,047  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222709_f65498c8-fadc-4799-bff0-34ec8db95ccd
2024-04-23T22:27:10,051  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:27:10,057  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,057  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:27:10,058  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:10,058  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:10,060  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:27:10,060  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:27:10,061  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:10,061  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:10,063  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:27:10,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:10,065  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:10,065  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,065  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,065  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2}
2024-04-23T22:27:10,065  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74); Time taken: 0.007 seconds
2024-04-23T22:27:10,065  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74
2024-04-23T22:27:10,066  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74
2024-04-23T22:27:10,080  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:27:10,080  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:10,081  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:10,081  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936430, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:10,087  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:27:10,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,101  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,101  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74); Time taken: 0.02 seconds
2024-04-23T22:27:10,101  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_7615820a-2c34-4724-a793-d3ccaa54fd74
2024-04-23T22:27:10,105  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:27:10,112  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,112  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:27:10,112  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,113  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,115  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:27:10,115  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:27:10,115  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:10,115  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:10,118  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:27:10,118  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:10,119  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:10,119  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,119  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,119  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,119  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2}
2024-04-23T22:27:10,119  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a); Time taken: 0.006 seconds
2024-04-23T22:27:10,120  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a
2024-04-23T22:27:10,120  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a
2024-04-23T22:27:10,134  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:27:10,134  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:10,134  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,135  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936430, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, totalSize=0, numFilesErasureCoded=0, numRows=0, numFiles=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:10,141  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:27:10,159  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,159  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-23T22:27:10,160  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a); Time taken: 0.025 seconds
2024-04-23T22:27:10,160  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_4535993d-3eff-4449-9673-76c543b6924a
2024-04-23T22:27:10,165  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:27:10,171  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,171  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:27:10,172  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,172  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,174  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:27:10,174  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:27:10,175  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:10,175  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:10,178  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:27:10,179  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:10,181  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:10,181  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,181  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,181  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,181  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2}
2024-04-23T22:27:10,182  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475); Time taken: 0.009 seconds
2024-04-23T22:27:10,182  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475
2024-04-23T22:27:10,182  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475
2024-04-23T22:27:10,198  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:27:10,198  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:10,198  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,198  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936430, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, totalSize=0, bucketing_version=2, transactional=false, numFiles=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:10,207  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:27:10,225  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,226  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=26, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,226  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475); Time taken: 0.027 seconds
2024-04-23T22:27:10,226  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_e640b7c7-5e68-4503-9bc2-f1c9d14c3475
2024-04-23T22:27:10,230  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:27:10,236  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,236  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:27:10,237  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:10,237  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:10,239  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:27:10,240  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:27:10,240  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:10,240  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:10,243  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:27:10,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:10,245  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:10,245  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,245  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,245  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,245  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,245  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6); Time taken: 0.008 seconds
2024-04-23T22:27:10,245  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6
2024-04-23T22:27:10,246  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6
2024-04-23T22:27:10,260  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:27:10,260  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:10,261  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:10,261  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,262  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/8a0de207-84d2-4e24-9197-cf22e9ce44f2/_tmp_space.db/ee28e4fb-286e-4b6d-b335-c3d5bb615aaf
2024-04-23T22:27:10,266  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,266  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=4, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,266  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6); Time taken: 0.005 seconds
2024-04-23T22:27:10,266  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_dcf2445c-6ded-4db8-9a9b-3676cd77b1d6
2024-04-23T22:27:10,271  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:27:10,277  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,277  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:27:10,278  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,278  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,280  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:27:10,281  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:27:10,281  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:10,281  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:10,284  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:27:10,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:10,286  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:10,286  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,286  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,286  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,286  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=0}
2024-04-23T22:27:10,286  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436); Time taken: 0.008 seconds
2024-04-23T22:27:10,287  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436
2024-04-23T22:27:10,287  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436
2024-04-23T22:27:10,304  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:27:10,304  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:10,304  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:10,304  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,305  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936430, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, bucketing_version=2, numFiles=0, numRows=0, totalSize=0, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:10,310  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:27:10,323  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,324  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,324  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436); Time taken: 0.019 seconds
2024-04-23T22:27:10,324  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_ff729c39-ccff-433a-b576-0ab552e6d436
2024-04-23T22:27:10,328  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:27:10,334  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,334  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:27:10,335  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists target
2024-04-23T22:27:10,335  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_6363f879-e1e7-4c8a-8de8-08cb4d5c7b1e): drop table if exists target
2024-04-23T22:27:10,338  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:27:10,338  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:27:10,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:10,343  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,343  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,343  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,343  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:27:10,343  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_6363f879-e1e7-4c8a-8de8-08cb4d5c7b1e); Time taken: 0.008 seconds
2024-04-23T22:27:10,344  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222710_6363f879-e1e7-4c8a-8de8-08cb4d5c7b1e
2024-04-23T22:27:10,344  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:10,344  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_6363f879-e1e7-4c8a-8de8-08cb4d5c7b1e): drop table if exists target
2024-04-23T22:27:10,344  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:10,347  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,347  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,347  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_6363f879-e1e7-4c8a-8de8-08cb4d5c7b1e); Time taken: 0.003 seconds
2024-04-23T22:27:10,348  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_6363f879-e1e7-4c8a-8de8-08cb4d5c7b1e
2024-04-23T22:27:10,356  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:27:10,366  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,366  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:27:10,367  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists source
2024-04-23T22:27:10,367  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_acd16324-2077-4fe0-b6f6-4d1b790bccdf): drop table if exists source
2024-04-23T22:27:10,370  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:27:10,370  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:27:10,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:10,376  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,376  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,376  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,376  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=18}
2024-04-23T22:27:10,376  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_acd16324-2077-4fe0-b6f6-4d1b790bccdf); Time taken: 0.009 seconds
2024-04-23T22:27:10,377  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222710_acd16324-2077-4fe0-b6f6-4d1b790bccdf
2024-04-23T22:27:10,377  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:10,377  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_acd16324-2077-4fe0-b6f6-4d1b790bccdf): drop table if exists source
2024-04-23T22:27:10,377  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:10,382  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,382  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,382  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_acd16324-2077-4fe0-b6f6-4d1b790bccdf); Time taken: 0.005 seconds
2024-04-23T22:27:10,382  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_acd16324-2077-4fe0-b6f6-4d1b790bccdf
2024-04-23T22:27:10,391  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:27:10,399  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,399  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:27:10,400  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists splitTable
2024-04-23T22:27:10,400  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_331a91b8-3fab-4554-9216-7033d0294e35): drop table if exists splitTable
2024-04-23T22:27:10,403  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T22:27:10,403  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:27:10,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T22:27:10,409  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,409  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,409  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,409  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1}
2024-04-23T22:27:10,409  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_331a91b8-3fab-4554-9216-7033d0294e35); Time taken: 0.009 seconds
2024-04-23T22:27:10,409  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222710_331a91b8-3fab-4554-9216-7033d0294e35
2024-04-23T22:27:10,410  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:10,410  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_331a91b8-3fab-4554-9216-7033d0294e35): drop table if exists splitTable
2024-04-23T22:27:10,410  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,410  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T22:27:10,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,415  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_331a91b8-3fab-4554-9216-7033d0294e35); Time taken: 0.005 seconds
2024-04-23T22:27:10,415  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_331a91b8-3fab-4554-9216-7033d0294e35
2024-04-23T22:27:10,424  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:27:10,434  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,434  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:27:10,435  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table splitTable(op int)
2024-04-23T22:27:10,435  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9): create table splitTable(op int)
2024-04-23T22:27:10,440  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T22:27:10,440  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:27:10,441  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:10,441  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:10,449  INFO [main] parse.CalcitePlanner: Creating table default.splitTable position=13
2024-04-23T22:27:10,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:10,451  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:10,451  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,451  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:10,451  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,451  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=4, getValidWriteIds_(List, String)=7, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=20}
2024-04-23T22:27:10,451  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9); Time taken: 0.016 seconds
2024-04-23T22:27:10,452  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9
2024-04-23T22:27:10,452  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9
2024-04-23T22:27:10,475  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:27:10,475  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:10,475  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9): create table splitTable(op int)
2024-04-23T22:27:10,475  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:10,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:splitTable, dbName:default, owner:alex, createTime:1713936430, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:op, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, totalSize=0, bucketing_version=2, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"op":"true"}}, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:10,482  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable
2024-04-23T22:27:10,526  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:10,526  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=50, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:10,527  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9); Time taken: 0.051 seconds
2024-04-23T22:27:10,527  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_8c0aeb7c-7b87-4871-a4d3-79fdcf0b7fc9
2024-04-23T22:27:10,531  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:27:10,537  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:10,537  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:27:10,537  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into splitTable values (0),(1)
2024-04-23T22:27:10,538  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e): insert into splitTable values (0),(1)
2024-04-23T22:27:10,540  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T22:27:10,540  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:27:10,541  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:10,541  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:10,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T22:27:10,585  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:10,585  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:10,585  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:10,585  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:10,586  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:10,586  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T22:27:10,595  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:10,595  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:10,595  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:10,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:10,689  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:10,689  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:10,689  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:10,690  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:10,692  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:10,692  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:10,692  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:10,692  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splitTable	
2024-04-23T22:27:10,701  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:10,703  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1
2024-04-23T22:27:10,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.splittable	
2024-04-23T22:27:10,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.splittable	
2024-04-23T22:27:10,707  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:10,711  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:10,711  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:10,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:10,728  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:10,728  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T22:27:10,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:10,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:10,755  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:10,755  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:10,755  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:10,755  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null)], properties:null)
2024-04-23T22:27:10,755  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:10,755  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=30, getValidWriteIds_(List, String)=4, getTable_(GetTableRequest)=77, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:27:10,755  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e); Time taken: 0.217 seconds
2024-04-23T22:27:10,755  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e
2024-04-23T22:27:10,756  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e
2024-04-23T22:27:10,771  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:27:10,771  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:10,771  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e): insert into splitTable values (0),(1)
2024-04-23T22:27:10,772  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e
2024-04-23T22:27:10,772  INFO [main] ql.Driver: Query ID = alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e
Total jobs = 3
2024-04-23T22:27:10,772  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-23T22:27:10,772  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-23T22:27:10,902  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:27:10,902  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:27:10,904  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:10,904  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:10,905  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-10_538_4160008703876534196-1/dummy_path
2024-04-23T22:27:10,914  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:10,914  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,57KB
2024-04-23T22:27:10,915  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:10,919  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-10_538_4160008703876534196-1/-mr-10001
2024-04-23T22:27:10,923  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:10,942  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:10,946  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:10,947  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:10,947  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:10,947  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-10_538_4160008703876534196-1/dummy_path
2024-04-23T22:27:10,948  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:10,964  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:10,982  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local293253148_0067
2024-04-23T22:27:10,983  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:11,042  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:11,042  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:11,043  INFO [Thread-5755] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:11,043  INFO [Thread-5755] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:11,044  INFO [Thread-5755] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:11,045  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local293253148_0067_m_000000_0
2024-04-23T22:27:11,047  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:11,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-10_538_4160008703876534196-1/dummy_path/null:0+1
2024-04-23T22:27:11,050  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:11,050  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,57KB
2024-04-23T22:27:11,050  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T22:27:11,052  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:11,052  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:11,053  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:11,053  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:11,053  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:11,053  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:11,053  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:11,053  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int>
2024-04-23T22:27:11,054  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:27:11,054  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@343f994c, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1c5938b3, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [op] : [int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@2478022e
2024-04-23T22:27:11,054  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:11,054  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:27:11,054  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:27:11,063  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T22:27:11,068  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.splittable:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:11,069  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:11,071  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local293253148_0067_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:11,072  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:11,072  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local293253148_0067_m_000000_0' done.
2024-04-23T22:27:11,072  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local293253148_0067_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1387299
		FILE: Number of bytes written=78975230
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1308098560
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.splittable=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=5625
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:11,072  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local293253148_0067_m_000000_0
2024-04-23T22:27:11,072  INFO [Thread-5755] mapred.LocalJobRunner: map task executor complete.
2024-04-23 22:27:12,043 Stage-1 map = 100%,  reduce = 0%
2024-04-23T22:27:12,043  INFO [main] exec.Task: 2024-04-23 22:27:12,043 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local293253148_0067
2024-04-23T22:27:12,044  INFO [main] exec.Task: Ended Job = job_local293253148_0067
2024-04-23T22:27:12,045  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T22:27:12,046  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T22:27:12,046  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T22:27:12,046  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T22:27:12,046  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1/-ext-10000
2024-04-23T22:27:12,046  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1/-ext-10002
2024-04-23T22:27:12,047  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.splittable
2024-04-23T22:27:12,047  INFO [main] exec.Task: Loading data to table default.splittable from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1/-ext-10000
2024-04-23T22:27:12,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:12,055  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:12,063  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,065  WARN [main] metadata.Hive: Cannot get a table snapshot for splittable
2024-04-23T22:27:12,065  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.splittable newtbl=splittable	
2024-04-23T22:27:12,090  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:12,091  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:12,099  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,099  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:12,099  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-10_538_4160008703876534196-1/-mr-10001
2024-04-23T22:27:12,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:12,108  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,109  INFO [main] FileOperations: Read stats for default.splittable/, numRows, true, 2, false: 
2024-04-23T22:27:12,109  INFO [main] FileOperations: Read stats for default.splittable/, rawDataSize, true, 2, false: 
2024-04-23T22:27:12,109  WARN [main] metadata.Hive: Cannot get a table snapshot for splittable
2024-04-23T22:27:12,109  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.splittable newtbl=splittable	
2024-04-23T22:27:12,131  INFO [main] stats.BasicStatsTask: Table default.splittable stats: [numFiles=1, numRows=2, totalSize=4, rawDataSize=2, numFilesErasureCoded=0]
2024-04-23T22:27:12,132  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:12,132  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=47, getTable_(GetTableRequest)=33}
MapReduce Jobs Launched: 
2024-04-23T22:27:12,132  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:12,132  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:12,132  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:12,132  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e); Time taken: 1.361 seconds
2024-04-23T22:27:12,132  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222710_270adcf8-46ab-4dcb-bac0-cf117bd3367e
2024-04-23T22:27:12,136  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:27:12,142  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:12,142  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:27:12,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table source (key int, data int)
2024-04-23T22:27:12,143  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1
2024-04-23T22:27:12,143  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/splittable/.hive-staging_hive_2024-04-23_22-27-10_538_4160008703876534196-1 on fs with scheme file
2024-04-23T22:27:12,143  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-10_538_4160008703876534196-1
2024-04-23T22:27:12,144  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-10_538_4160008703876534196-1 on fs with scheme file
2024-04-23T22:27:12,144  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1): create table source (key int, data int)
2024-04-23T22:27:12,146  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T22:27:12,146  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:27:12,147  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:12,147  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:12,149  INFO [main] parse.CalcitePlanner: Creating table default.source position=13
2024-04-23T22:27:12,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:12,151  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:12,151  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:12,151  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:12,151  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:12,151  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2}
2024-04-23T22:27:12,151  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1); Time taken: 0.007 seconds
2024-04-23T22:27:12,151  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1
2024-04-23T22:27:12,151  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1
2024-04-23T22:27:12,165  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:27:12,165  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:12,166  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1): create table source (key int, data int)
2024-04-23T22:27:12,166  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:12,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:source, dbName:default, owner:alex, createTime:1713936432, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"data":"true","key":"true"}}, totalSize=0, numRows=0, rawDataSize=0, numFilesErasureCoded=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:12,172  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source
2024-04-23T22:27:12,189  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:12,189  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T22:27:12,190  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1); Time taken: 0.023 seconds
2024-04-23T22:27:12,190  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222712_11219ed2-4a23-49a6-9b65-06fa93a6cec1
2024-04-23T22:27:12,194  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:27:12,201  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:12,201  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:27:12,202  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:12,202  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:12,204  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T22:27:12,204  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:27:12,204  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:12,205  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:12,207  INFO [main] parse.CalcitePlanner: Creating table default.target position=13
2024-04-23T22:27:12,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:12,208  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:12,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:12,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:12,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:12,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:27:12,209  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77); Time taken: 0.006 seconds
2024-04-23T22:27:12,209  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77
2024-04-23T22:27:12,209  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77
2024-04-23T22:27:12,223  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:27:12,223  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:12,223  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:12,223  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:12,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:target, dbName:default, owner:alex, createTime:1713936432, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null), FieldSchema(name:cur, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[key], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, totalSize=0, rawDataSize=0, transactional=true, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"cur":"true","data":"true","key":"true"}}, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:12,234  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:12,253  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:12,253  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=28, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:12,253  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77); Time taken: 0.03 seconds
2024-04-23T22:27:12,253  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222712_b5dc21bd-98dc-4a3f-818c-dc6ffc545e77
2024-04-23T22:27:12,257  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:27:12,263  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:12,263  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:27:12,263  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T22:27:12,264  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T22:27:12,266  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T22:27:12,266  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:27:12,267  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:12,267  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:12,270  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:12,276  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,276  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:12,276  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:12,276  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:12,276  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:12,276  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:12,283  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,283  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:12,283  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:12,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:12,354  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:12,354  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:12,354  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:12,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:12,358  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:12,358  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:12,358  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:12,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:12,367  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.target	
2024-04-23T22:27:12,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.target	
2024-04-23T22:27:12,382  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T22:27:12,382  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=target (txnIds: [20])
2024-04-23T22:27:12,383  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:12,387  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col1=Column[_col2], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:27:12,387  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1], VALUE._col1=Column[_col2]}
2024-04-23T22:27:12,387  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:12,389  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:12,399  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:12,406  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:12,407  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:12,407  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:12,407  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:12,407  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null), FieldSchema(name:col3, type:int, comment:null)], properties:null)
2024-04-23T22:27:12,407  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:12,407  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, getAllTableConstraints_(AllTableConstraintsRequest)=4, getTable_(GetTableRequest)=30, allocateTableWriteId_(long, String, String)=10, openTxn_(String, TxnType)=2, getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=3}
2024-04-23T22:27:12,407  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7); Time taken: 0.143 seconds
2024-04-23T22:27:12,408  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7
2024-04-23T22:27:12,408  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7
2024-04-23T22:27:12,430  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:27:12,430  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:12,433  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T22:27:12,433  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7
2024-04-23T22:27:12,433  INFO [main] ql.Driver: Query ID = alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7
Total jobs = 1
2024-04-23T22:27:12,433  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:27:12,433  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:27:12,575  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:27:12,575  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:27:12,575  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:27:12,575  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:27:12,575  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:27:12,575  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:27:12,575  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:27:12,575  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:27:12,578  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:12,578  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:12,578  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-12_263_1795379726891516179-1/dummy_path
2024-04-23T22:27:12,588  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:12,589  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,15KB
2024-04-23T22:27:12,594  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:27:12,595  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T22:27:12,596  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:12,607  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-12_263_1795379726891516179-1/-mr-10000
2024-04-23T22:27:12,611  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:12,626  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:12,643  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:12,644  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:12,644  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:12,644  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-12_263_1795379726891516179-1/dummy_path
2024-04-23T22:27:12,645  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:12,674  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:12,696  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1951496193_0068
2024-04-23T22:27:12,696  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:12,769  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:12,769  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:12,770  INFO [Thread-5801] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:12,770  INFO [Thread-5801] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:12,772  INFO [Thread-5801] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:12,772  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1951496193_0068_m_000000_0
2024-04-23T22:27:12,772  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:12,772  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-12_263_1795379726891516179-1/dummy_path/null:0+1
2024-04-23T22:27:12,773  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:12,773  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,15KB
2024-04-23T22:27:12,773  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:27:12,779  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:27:12,779  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:27:12,779  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:27:12,779  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:27:12,779  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:27:12,780  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:27:12,780  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:12,780  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int,col3:int>
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:27:12,781  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:27:12,782  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:27:12,782  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:27:12,782  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:3, 
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:3, 
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 3. abort - false
2024-04-23T22:27:12,783  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:3, RECORDS_OUT_OPERATOR_RS_4:3, 
2024-04-23T22:27:12,784  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:12,784  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:27:12,784  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:27:12,784  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 51; bufvoid = 104857600
2024-04-23T22:27:12,784  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214388(104857552); length = 9/6553600
2024-04-23T22:27:12,794  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:27:12,797  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1951496193_0068_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:12,798  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:12,798  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1951496193_0068_m_000000_0' done.
2024-04-23T22:27:12,798  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1951496193_0068_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1392995
		FILE: Number of bytes written=80155796
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=3
		Map output bytes=51
		Map output materialized bytes=69
		Input split bytes=361
		Combine input records=0
		Spilled Records=3
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1308098560
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=3
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=3
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=3
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=3
	File Input Format Counters 
		Bytes Read=5201
2024-04-23T22:27:12,798  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1951496193_0068_m_000000_0
2024-04-23T22:27:12,798  INFO [Thread-5801] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:27:12,800  INFO [Thread-5801] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:27:12,800  INFO [pool-337-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1951496193_0068_r_000000_0
2024-04-23T22:27:12,800  INFO [pool-337-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:12,800  INFO [pool-337-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@538ce1f6
2024-04-23T22:27:12,800  WARN [pool-337-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:12,801  INFO [pool-337-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:12,802  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1951496193_0068_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:12,804  INFO [localfetcher#93] reduce.LocalFetcher: localfetcher#93 about to shuffle output of map attempt_local1951496193_0068_m_000000_0 decomp: 21 len: 25 to MEMORY
2024-04-23T22:27:12,805  INFO [localfetcher#93] reduce.InMemoryMapOutput: Read 21 bytes from map-output for attempt_local1951496193_0068_m_000000_0
2024-04-23T22:27:12,805  INFO [localfetcher#93] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 21, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->21
2024-04-23T22:27:12,805  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:12,805  INFO [pool-337-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:12,805  INFO [pool-337-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:12,813  INFO [pool-337-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:12,813  INFO [pool-337-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T22:27:12,816  INFO [pool-337-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 21 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:12,816  INFO [pool-337-thread-1] reduce.MergeManagerImpl: Merging 1 files, 25 bytes from disk
2024-04-23T22:27:12,816  INFO [pool-337-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:12,816  INFO [pool-337-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:12,816  INFO [pool-337-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T22:27:12,816  INFO [pool-337-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:12,817  INFO [pool-337-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:12,817  INFO [pool-337-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T22:27:12,818  INFO [pool-337-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:12,818  INFO [pool-337-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:12,818  INFO [pool-337-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T22:27:12,818  INFO [pool-337-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:12,818  INFO [pool-337-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1951496193_0068/job_local1951496193_0068.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@4bf9546f
2024-04-23T22:27:12,819  INFO [pool-337-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:12,819  INFO [pool-337-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:12,819  INFO [pool-337-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:12,819  INFO [pool-337-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:12,819  INFO [pool-337-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:12,826  INFO [pool-337-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:12,831  INFO [pool-337-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:12,831  INFO [pool-337-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:12,831  INFO [pool-337-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:12,831  INFO [pool-337-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:12,833  INFO [pool-337-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:27:12,844  INFO [pool-337-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.target:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:27:12,844  INFO [pool-337-thread-1] mapred.Task: Task:attempt_local1951496193_0068_r_000000_0 is done. And is in the process of committing
2024-04-23T22:27:12,844  INFO [pool-337-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:12,844  INFO [pool-337-thread-1] mapred.Task: Task 'attempt_local1951496193_0068_r_000000_0' done.
2024-04-23T22:27:12,844  INFO [pool-337-thread-1] mapred.Task: Final Counters for attempt_local1951496193_0068_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1399369
		FILE: Number of bytes written=80156877
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=25
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1308098560
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:12,844  INFO [pool-337-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1951496193_0068_r_000000_0
2024-04-23T22:27:12,844  INFO [pool-337-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1951496193_0068_r_000001_0
2024-04-23T22:27:12,845  INFO [pool-337-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:12,845  INFO [pool-337-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7abeab
2024-04-23T22:27:12,845  WARN [pool-337-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:12,846  INFO [pool-337-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:12,846  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1951496193_0068_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:12,849  INFO [localfetcher#94] reduce.LocalFetcher: localfetcher#94 about to shuffle output of map attempt_local1951496193_0068_m_000000_0 decomp: 40 len: 44 to MEMORY
2024-04-23T22:27:12,849  INFO [localfetcher#94] reduce.InMemoryMapOutput: Read 40 bytes from map-output for attempt_local1951496193_0068_m_000000_0
2024-04-23T22:27:12,849  INFO [localfetcher#94] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 40, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->40
2024-04-23T22:27:12,849  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:12,850  INFO [pool-337-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:12,850  INFO [pool-337-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:12,857  INFO [pool-337-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:12,857  INFO [pool-337-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T22:27:12,859  INFO [pool-337-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 40 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:12,859  INFO [pool-337-thread-1] reduce.MergeManagerImpl: Merging 1 files, 44 bytes from disk
2024-04-23T22:27:12,859  INFO [pool-337-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:12,860  INFO [pool-337-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:12,860  INFO [pool-337-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T22:27:12,860  INFO [pool-337-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:12,860  INFO [pool-337-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:12,860  INFO [pool-337-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T22:27:12,861  INFO [pool-337-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:12,861  INFO [pool-337-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:12,861  INFO [pool-337-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T22:27:12,861  INFO [pool-337-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:12,862  INFO [pool-337-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1951496193_0068/job_local1951496193_0068.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@2bbc65ff
2024-04-23T22:27:12,862  INFO [pool-337-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:12,862  INFO [pool-337-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:12,862  INFO [pool-337-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:12,863  INFO [pool-337-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:12,863  INFO [pool-337-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:12,868  INFO [pool-337-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:12,868  INFO [pool-337-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:12,869  INFO [pool-337-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:27:12,869  INFO [pool-337-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:12,869  INFO [pool-337-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:27:12,871  INFO [pool-337-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:27:12,883  INFO [pool-337-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.target:2, 
2024-04-23T22:27:12,884  INFO [pool-337-thread-1] mapred.Task: Task:attempt_local1951496193_0068_r_000001_0 is done. And is in the process of committing
2024-04-23T22:27:12,884  INFO [pool-337-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:12,884  INFO [pool-337-thread-1] mapred.Task: Task 'attempt_local1951496193_0068_r_000001_0' done.
2024-04-23T22:27:12,885  INFO [pool-337-thread-1] mapred.Task: Final Counters for attempt_local1951496193_0068_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1405737
		FILE: Number of bytes written=80157996
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=44
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1308098560
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:12,885  INFO [pool-337-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1951496193_0068_r_000001_0
2024-04-23T22:27:12,885  INFO [Thread-5801] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:27:13,772 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:27:13,772  INFO [main] exec.Task: 2024-04-23 22:27:13,772 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1951496193_0068
2024-04-23T22:27:13,774  INFO [main] exec.Task: Ended Job = job_local1951496193_0068
2024-04-23T22:27:13,775  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:27:13,775  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:27:13,775  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:27:13,776  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:27:13,776  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000
2024-04-23T22:27:13,777  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.target
2024-04-23T22:27:13,777  INFO [main] exec.Task: Loading data to table default.target from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:13,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:13,784  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:13,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:13,790  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:13,791  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T22:27:13,814  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:13,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:13,819  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:13,820  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:13,820  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-12_263_1795379726891516179-1/-mr-10000
2024-04-23T22:27:13,821  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:13,827  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:13,838  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:27:13,838  INFO [main] FileOperations: Read stats for default.target/, numRows, true, 3, false: 
2024-04-23T22:27:13,838  INFO [main] FileOperations: Read stats for default.target/, rawDataSize, true, 0, false: 
2024-04-23T22:27:13,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T22:27:13,857  INFO [main] FileOperations: Read stats for default.target/, insertCount, true, 3, false: 
2024-04-23T22:27:13,857  INFO [main] FileOperations: Read stats for default.target/, updateCount, true, 0, false: 
2024-04-23T22:27:13,857  INFO [main] FileOperations: Read stats for default.target/, deleteCount, true, 0, false: 
2024-04-23T22:27:13,860  INFO [main] stats.BasicStatsTask: Table default.target stats: [numFiles=2, numRows=3, totalSize=1460, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:27:13,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:13,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=25, alter_table_(String, String, String, Table, EnvironmentContext, String)=41, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:27:13,861  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:13,861  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:13,861  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:13,861  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7); Time taken: 1.427 seconds
2024-04-23T22:27:13,861  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222712_ebd17032-99b3-42d6-b896-9b58614a16f7
2024-04-23T22:27:13,870  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:13,870  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:27:13,871  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into source  values(1,7),(3,8)
2024-04-23T22:27:13,871  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-12_263_1795379726891516179-1
2024-04-23T22:27:13,872  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-12_263_1795379726891516179-1 on fs with scheme file
2024-04-23T22:27:13,872  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e): insert into source  values(1,7),(3,8)
2024-04-23T22:27:13,875  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-23T22:27:13,875  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:27:13,875  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:13,875  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:13,878  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:13,899  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:13,899  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:13,899  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:13,899  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:13,899  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:13,899  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:13,907  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:13,907  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:13,907  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:13,926  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:13,974  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:13,974  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:13,974  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:13,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:13,977  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:13,977  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:13,977  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:13,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:13,986  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:13,988  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1
2024-04-23T22:27:13,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.source	
2024-04-23T22:27:13,991  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.source	
2024-04-23T22:27:13,992  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:13,995  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:13,995  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:14,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:14,015  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:14,016  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T22:27:14,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:14,026  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:14,044  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:14,044  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:14,044  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:14,044  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:27:14,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:14,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=4, flushCache_()=1, getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=58}
2024-04-23T22:27:14,044  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e); Time taken: 0.172 seconds
2024-04-23T22:27:14,044  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e
2024-04-23T22:27:14,045  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e
2024-04-23T22:27:14,061  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:27:14,061  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:14,061  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e): insert into source  values(1,7),(3,8)
2024-04-23T22:27:14,061  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e
2024-04-23T22:27:14,061  INFO [main] ql.Driver: Query ID = alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e
Total jobs = 3
2024-04-23T22:27:14,062  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-23T22:27:14,062  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-23T22:27:14,197  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:27:14,197  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:27:14,200  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:14,200  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:14,200  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-13_872_6643460294959396694-1/dummy_path
2024-04-23T22:27:14,210  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:14,211  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T22:27:14,212  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:14,216  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-13_872_6643460294959396694-1/-mr-10001
2024-04-23T22:27:14,220  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:14,227  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:14,231  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:14,232  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:14,232  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:14,232  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-13_872_6643460294959396694-1/dummy_path
2024-04-23T22:27:14,232  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:14,253  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:14,272  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local819505379_0069
2024-04-23T22:27:14,272  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:14,337  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:14,337  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:14,337  INFO [Thread-5875] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:14,337  INFO [Thread-5875] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:14,339  INFO [Thread-5875] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:14,339  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local819505379_0069_m_000000_0
2024-04-23T22:27:14,340  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:14,341  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-13_872_6643460294959396694-1/dummy_path/null:0+1
2024-04-23T22:27:14,341  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:14,342  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T22:27:14,342  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T22:27:14,342  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:14,342  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:14,343  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:14,343  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:14,343  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:14,343  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:14,343  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:14,343  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:27:14,343  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:27:14,344  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@29f05476, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@7469f1b3, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [key, data] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@788d7610
2024-04-23T22:27:14,344  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:14,344  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:27:14,344  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:14,351  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:27:14,351  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:14,351  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:14,351  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:14,351  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:27:14,351  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:14,351  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:27:14,352  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T22:27:14,357  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.source:2, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-23T22:27:14,358  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:14,358  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local819505379_0069_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:14,358  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:14,359  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local819505379_0069_m_000000_0' done.
2024-04-23T22:27:14,359  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local819505379_0069_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1412511
		FILE: Number of bytes written=81325863
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1308098560
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.source=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=5735
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:14,359  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local819505379_0069_m_000000_0
2024-04-23T22:27:14,359  INFO [Thread-5875] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:27:14,639  INFO [Metastore Scheduled Worker 4] metastore.HMSHandler: 10: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T22:27:14,640  INFO [Metastore Scheduled Worker 4] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2c2fdbf9, with PersistenceManager: null will be shutdown
2024-04-23T22:27:14,640  INFO [Metastore Scheduled Worker 4] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2c2fdbf9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@e97ab35 created in the thread with id: 48
2024-04-23T22:27:14,666  INFO [Metastore Scheduled Worker 4] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2c2fdbf9 from thread id: 48
2024-04-23 22:27:15,337 Stage-1 map = 100%,  reduce = 0%
2024-04-23T22:27:15,337  INFO [main] exec.Task: 2024-04-23 22:27:15,337 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local819505379_0069
2024-04-23T22:27:15,338  INFO [main] exec.Task: Ended Job = job_local819505379_0069
2024-04-23T22:27:15,339  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T22:27:15,340  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T22:27:15,340  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T22:27:15,340  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T22:27:15,340  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1/-ext-10000
2024-04-23T22:27:15,340  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1/-ext-10002
2024-04-23T22:27:15,341  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.source
2024-04-23T22:27:15,341  INFO [main] exec.Task: Loading data to table default.source from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1/-ext-10000
2024-04-23T22:27:15,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:15,352  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,352  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:15,365  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,367  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T22:27:15,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T22:27:15,409  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:15,409  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:15,423  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,423  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:15,423  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-13_872_6643460294959396694-1/-mr-10001
2024-04-23T22:27:15,424  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:15,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,439  INFO [main] FileOperations: Read stats for default.source/, numRows, true, 2, false: 
2024-04-23T22:27:15,439  INFO [main] FileOperations: Read stats for default.source/, rawDataSize, true, 6, false: 
2024-04-23T22:27:15,440  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T22:27:15,440  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T22:27:15,470  INFO [main] stats.BasicStatsTask: Table default.source stats: [numFiles=1, numRows=2, totalSize=8, rawDataSize=6, numFilesErasureCoded=0]
2024-04-23T22:27:15,470  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:15,470  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=52, alter_table_(String, String, String, Table, EnvironmentContext, String)=72, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:27:15,471  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:15,471  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:15,471  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:15,471  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e); Time taken: 1.409 seconds
2024-04-23T22:27:15,471  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222713_cf9c33d3-9e2c-41e8-a896-fe6c319b067e
2024-04-23T22:27:15,475  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:27:15,483  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:15,483  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:27:15,484  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T22:27:15,484  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1
2024-04-23T22:27:15,485  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-13_872_6643460294959396694-1 on fs with scheme file
2024-04-23T22:27:15,485  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-13_872_6643460294959396694-1
2024-04-23T22:27:15,486  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-13_872_6643460294959396694-1 on fs with scheme file
2024-04-23T22:27:15,486  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222715_4f03d7e9-6821-4fc2-b17e-640a959d3e9a): merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T22:27:15,490  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T22:27:15,491  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T22:27:15,491  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:27:15,492  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:15,499  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T22:27:15,505  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/8a0de207-84d2-4e24-9197-cf22e9ce44f2/_tmp_space.db/merge_tmp_table
2024-04-23T22:27:15,508  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into target t using (select curMatch.*, case when splitTable.op is null or splitTable.op = 0 then 0 else 1 end `o/p\n` from (select s.*, case when t.cur is null then 0 else 1 end m from source s left outer join (select * from target where target.cur=1) t on s.key=t.key) curMatch left outer join splitTable on curMatch.m=1) s on t.key=s.key and t.cur=1 and s.`o/p\n`=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)> as 
<FROM
  `default`.`target` `t`
  RIGHT OUTER JOIN
  (select `curMatch`.*, case when `splitTable`.`op` is null or `splitTable`.`op` = 0 then 0 else 1 end `o/p\n` from (select `s`.*, case when `t`.`cur` is null then 0 else 1 end `m` from `source` `s` left outer join (select * from `target` where `target`.`cur`=1) `t` on `s`.`key`=`t`.`key`) `curMatch` left outer join `splitTable` on `curMatch`.`m`=1) `s`
  ON `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
INSERT INTO `default`.`target`    -- update clause(insert part)
 SELECT `t`.`key`, `t`.`data`, 0
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
INSERT INTO `default`.`target`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`target`    -- insert clause
  SELECT `s`.`key`,`s`.`data`,1
   WHERE `t`.`key` IS NULL AND `t`.`cur` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`key`=`s`.`key` and `t`.`cur`=1 and `s`.`o/p\n`=1 GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T22:27:15,510  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:27:15,516  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:15,516  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:15,528  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,528  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,528  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:15,538  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,538  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,538  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:15,548  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,549  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,549  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,549  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,549  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,549  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,549  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,549  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,550  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:15,556  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,557  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:15,563  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:15,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,571  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:15,571  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:15,572  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,572  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,572  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,573  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:15,591  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T22:27:15,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-23T22:27:15,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.splittable	
2024-04-23T22:27:15,618  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T22:27:15,705  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T22:27:15,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:15,714  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:15,722  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,722  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.target	
2024-04-23T22:27:15,732  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: data, cur, key
No Stats for default@target, Columns: data, cur, key
2024-04-23T22:27:15,732  INFO [main] SessionState: No Stats for default@target, Columns: data, cur, key
2024-04-23T22:27:15,733  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:27:15,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:15,746  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,746  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:15,757  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,758  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.source	
2024-04-23T22:27:15,771  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: data, key
No Stats for default@source, Columns: data, key
2024-04-23T22:27:15,771  INFO [main] SessionState: No Stats for default@source, Columns: data, key
2024-04-23T22:27:15,771  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 2], allowMissingStats: true
2024-04-23T22:27:15,772  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: key, cur
No Stats for default@target, Columns: key, cur
2024-04-23T22:27:15,772  INFO [main] SessionState: No Stats for default@target, Columns: key, cur
2024-04-23T22:27:15,774  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.splittable, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:27:15,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:15,785  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.splittable	
2024-04-23T22:27:15,795  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:15,796  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.splittable	
2024-04-23T22:27:15,807  WARN [main] calcite.RelOptHiveTable: No Stats for default@splittable, Columns: op
No Stats for default@splittable, Columns: op
2024-04-23T22:27:15,807  INFO [main] SessionState: No Stats for default@splittable, Columns: op
2024-04-23T22:27:16,070  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:16,070  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:16,070  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:16,070  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:16,070  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:16,071  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:16,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:16,078  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,078  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:16,085  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,085  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:16,091  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,101 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:27:16,102 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:27:16,102  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:27:16,103 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD01(TestTxnCommands.java:1140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:27:16,103  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,103  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTableColumnStatistics_(String, String, List, String)=96, getValidWriteIds_(List, String)=7, openTxn_(String, TxnType)=3, getAllTableConstraints_(AllTableConstraintsRequest)=21, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=78, createTable_(Table)=3}
2024-04-23T22:27:16,103  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222715_4f03d7e9-6821-4fc2-b17e-640a959d3e9a); Time taken: 0.617 seconds
2024-04-23T22:27:16,103  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:27:16,107  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,114  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:16,114  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/8a0de207-84d2-4e24-9197-cf22e9ce44f2/hive_2024-04-23_22-27-15_508_794859111841859405-1
2024-04-23T22:27:16,114  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8): drop table if exists acidTbl
2024-04-23T22:27:16,116  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T22:27:16,117  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T22:27:16,118  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:16,124  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,124  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,124  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,124  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,124  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, rollbackTxn_(long)=10, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T22:27:16,125  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8); Time taken: 0.01 seconds
2024-04-23T22:27:16,125  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8
2024-04-23T22:27:16,126  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8
2024-04-23T22:27:16,149  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:27:16,149  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:16,149  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8): drop table if exists acidTbl
2024-04-23T22:27:16,149  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,150  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:16,158  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:16,165  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:16,273  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,273  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=115, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:27:16,273  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8); Time taken: 0.124 seconds
2024-04-23T22:27:16,273  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_25c27bf6-c378-430a-ba98-89fda9cda1a8
2024-04-23T22:27:16,278  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T22:27:16,284  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,286  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T22:27:16,287  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:16,287  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c): drop table if exists acidTblPart
2024-04-23T22:27:16,289  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T22:27:16,290  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T22:27:16,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:16,307  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,307  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,307  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,307  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,307  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=17, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,307  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c); Time taken: 0.02 seconds
2024-04-23T22:27:16,308  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c
2024-04-23T22:27:16,308  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c
2024-04-23T22:27:16,323  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T22:27:16,323  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:16,323  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c): drop table if exists acidTblPart
2024-04-23T22:27:16,323  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,323  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:16,330  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:16,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:16,380  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,380  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=49}
2024-04-23T22:27:16,380  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c); Time taken: 0.057 seconds
2024-04-23T22:27:16,380  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_80d98b8b-5ab0-47b8-9ce2-afe07395d49c
2024-04-23T22:27:16,385  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T22:27:16,393  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,393  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T22:27:16,393  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:16,394  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_53ad4519-58a5-443a-8c81-8c4fe795831d): drop table if exists acidTbl2
2024-04-23T22:27:16,396  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T22:27:16,396  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T22:27:16,397  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,397  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,397  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,397  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:16,397  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_53ad4519-58a5-443a-8c81-8c4fe795831d); Time taken: 0.003 seconds
2024-04-23T22:27:16,398  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423222716_53ad4519-58a5-443a-8c81-8c4fe795831d
2024-04-23T22:27:16,398  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:16,398  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_53ad4519-58a5-443a-8c81-8c4fe795831d): drop table if exists acidTbl2
2024-04-23T22:27:16,398  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,398  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:27:16,399  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,399  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,399  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_53ad4519-58a5-443a-8c81-8c4fe795831d); Time taken: 0.001 seconds
2024-04-23T22:27:16,399  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_53ad4519-58a5-443a-8c81-8c4fe795831d
2024-04-23T22:27:16,406  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T22:27:16,413  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,413  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T22:27:16,413  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:16,413  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:16,416  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T22:27:16,416  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T22:27:16,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:16,440  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,440  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,440  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,440  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,440  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=23, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:27:16,440  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca); Time taken: 0.027 seconds
2024-04-23T22:27:16,440  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca
2024-04-23T22:27:16,441  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca
2024-04-23T22:27:16,457  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T22:27:16,457  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:16,457  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:16,457  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:16,468  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:16,476  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:16,533  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,533  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=11, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=65}
2024-04-23T22:27:16,534  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca); Time taken: 0.076 seconds
2024-04-23T22:27:16,534  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_06ec4130-f626-4978-85a9-eed834dfa2ca
2024-04-23T22:27:16,538  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T22:27:16,544  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,544  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T22:27:16,545  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:16,545  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:16,547  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 23
2024-04-23T22:27:16,547  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T22:27:16,550  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:16,558  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,558  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,558  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,558  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,558  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=8, openTxn_(String, TxnType)=2}
2024-04-23T22:27:16,558  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1); Time taken: 0.013 seconds
2024-04-23T22:27:16,559  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:27 for queryId=alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1
2024-04-23T22:27:16,559  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1
2024-04-23T22:27:16,574  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T22:27:16,574  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:16,574  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:16,574  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:16,582  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:16,590  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,590  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:16,619  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,619  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=37, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,619  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1); Time taken: 0.045 seconds
2024-04-23T22:27:16,619  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_5bcc5417-d4af-408d-8a9c-23d59efd58f1
2024-04-23T22:27:16,623  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T22:27:16,629  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,629  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T22:27:16,630  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:16,630  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b): drop table if exists nonAcidNonBucket
2024-04-23T22:27:16,632  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 23
2024-04-23T22:27:16,633  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T22:27:16,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:16,641  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,641  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,641  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,641  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=8}
2024-04-23T22:27:16,641  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b); Time taken: 0.011 seconds
2024-04-23T22:27:16,642  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b
2024-04-23T22:27:16,642  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b
2024-04-23T22:27:16,657  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T22:27:16,657  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:16,657  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b): drop table if exists nonAcidNonBucket
2024-04-23T22:27:16,657  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:16,665  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:16,673  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:16,674  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:16,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,705  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=38, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,705  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b); Time taken: 0.047 seconds
2024-04-23T22:27:16,705  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_60118fc2-d841-4419-857a-bbe15873598b
2024-04-23T22:27:16,709  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T22:27:16,715  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,715  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T22:27:16,716  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMergeType2SCD02" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.143">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:27:16,779  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:27:16,779  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:27:16,779  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:27:16,779  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:27:16,779  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:27:16,779  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:27:16,780  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:27:16,780  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:27:16,780  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:27:16,780  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:27:16,780  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:27:16,782  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = b9519500-e50f-49f7-987b-fa77eb57ff42
2024-04-23T22:27:16,784  INFO [main] SessionState: Hive Session ID = b9519500-e50f-49f7-987b-fa77eb57ff42
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:16,784  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:16,789  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b9519500-e50f-49f7-987b-fa77eb57ff42
2024-04-23T22:27:16,792  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42
2024-04-23T22:27:16,794  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b9519500-e50f-49f7-987b-fa77eb57ff42/_tmp_space.db
2024-04-23T22:27:16,795  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=b9519500-e50f-49f7-987b-fa77eb57ff42, clientType=HIVECLI]
2024-04-23T22:27:16,795  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:16,795  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_94b2101f-a50f-43df-8f31-c8152de86dbc): drop table if exists acidTbl
2024-04-23T22:27:16,805  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:27:16,805  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:27:16,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:16,818  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,818  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,818  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,818  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=9}
2024-04-23T22:27:16,818  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_94b2101f-a50f-43df-8f31-c8152de86dbc); Time taken: 0.023 seconds
2024-04-23T22:27:16,819  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222716_94b2101f-a50f-43df-8f31-c8152de86dbc
2024-04-23T22:27:16,819  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:16,819  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_94b2101f-a50f-43df-8f31-c8152de86dbc): drop table if exists acidTbl
2024-04-23T22:27:16,819  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,819  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:16,823  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,823  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,823  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_94b2101f-a50f-43df-8f31-c8152de86dbc); Time taken: 0.004 seconds
2024-04-23T22:27:16,823  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_94b2101f-a50f-43df-8f31-c8152de86dbc
2024-04-23T22:27:16,829  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:27:16,836  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,836  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:27:16,837  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:16,837  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_4be00b70-7050-4114-97dd-362b3bc231c1): drop table if exists acidTblPart
2024-04-23T22:27:16,839  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:27:16,839  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:27:16,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:16,843  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,843  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,843  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,843  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-23T22:27:16,843  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_4be00b70-7050-4114-97dd-362b3bc231c1); Time taken: 0.006 seconds
2024-04-23T22:27:16,843  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222716_4be00b70-7050-4114-97dd-362b3bc231c1
2024-04-23T22:27:16,843  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:16,843  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_4be00b70-7050-4114-97dd-362b3bc231c1): drop table if exists acidTblPart
2024-04-23T22:27:16,843  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:16,846  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,846  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,847  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_4be00b70-7050-4114-97dd-362b3bc231c1); Time taken: 0.003 seconds
2024-04-23T22:27:16,847  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_4be00b70-7050-4114-97dd-362b3bc231c1
2024-04-23T22:27:16,853  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:27:16,858  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,859  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:27:16,859  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:16,860  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_c428b6ba-3f0d-4d6c-8b86-d87cdaba87ec): drop table if exists acidTbl2
2024-04-23T22:27:16,862  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:27:16,862  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:27:16,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:16,865  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,865  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,866  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:27:16,866  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_c428b6ba-3f0d-4d6c-8b86-d87cdaba87ec); Time taken: 0.006 seconds
2024-04-23T22:27:16,866  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222716_c428b6ba-3f0d-4d6c-8b86-d87cdaba87ec
2024-04-23T22:27:16,866  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:16,866  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_c428b6ba-3f0d-4d6c-8b86-d87cdaba87ec): drop table if exists acidTbl2
2024-04-23T22:27:16,866  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:16,869  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,869  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,869  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_c428b6ba-3f0d-4d6c-8b86-d87cdaba87ec); Time taken: 0.003 seconds
2024-04-23T22:27:16,869  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_c428b6ba-3f0d-4d6c-8b86-d87cdaba87ec
2024-04-23T22:27:16,874  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:27:16,880  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,880  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:27:16,880  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:16,881  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_db4fe4af-883e-4e07-a1a3-d05fa439e4bf): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:16,882  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:27:16,883  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:27:16,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:16,886  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,886  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,886  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,886  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:16,886  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_db4fe4af-883e-4e07-a1a3-d05fa439e4bf); Time taken: 0.005 seconds
2024-04-23T22:27:16,886  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222716_db4fe4af-883e-4e07-a1a3-d05fa439e4bf
2024-04-23T22:27:16,886  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:16,886  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_db4fe4af-883e-4e07-a1a3-d05fa439e4bf): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:16,886  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:16,889  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,889  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,890  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_db4fe4af-883e-4e07-a1a3-d05fa439e4bf); Time taken: 0.003 seconds
2024-04-23T22:27:16,890  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_db4fe4af-883e-4e07-a1a3-d05fa439e4bf
2024-04-23T22:27:16,895  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:27:16,900  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,900  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:27:16,901  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:16,901  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_6d22cfad-d909-49e7-96b6-79c935b93bf0): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:16,903  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:27:16,903  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:27:16,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:16,906  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,906  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,906  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,906  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,906  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_6d22cfad-d909-49e7-96b6-79c935b93bf0); Time taken: 0.005 seconds
2024-04-23T22:27:16,907  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222716_6d22cfad-d909-49e7-96b6-79c935b93bf0
2024-04-23T22:27:16,907  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:16,907  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_6d22cfad-d909-49e7-96b6-79c935b93bf0): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:16,907  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,907  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:16,910  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,910  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,910  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_6d22cfad-d909-49e7-96b6-79c935b93bf0); Time taken: 0.003 seconds
2024-04-23T22:27:16,910  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_6d22cfad-d909-49e7-96b6-79c935b93bf0
2024-04-23T22:27:16,915  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:27:16,921  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,921  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:27:16,921  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:16,922  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_8cbb1835-1a6d-4f9c-988b-c152cbceb108): drop table if exists nonAcidNonBucket
2024-04-23T22:27:16,924  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:27:16,924  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:27:16,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:16,928  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,928  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,928  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,928  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:16,928  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_8cbb1835-1a6d-4f9c-988b-c152cbceb108); Time taken: 0.006 seconds
2024-04-23T22:27:16,928  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222716_8cbb1835-1a6d-4f9c-988b-c152cbceb108
2024-04-23T22:27:16,928  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:16,928  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_8cbb1835-1a6d-4f9c-988b-c152cbceb108): drop table if exists nonAcidNonBucket
2024-04-23T22:27:16,928  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,929  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:16,932  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:16,932  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:16,932  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_8cbb1835-1a6d-4f9c-988b-c152cbceb108); Time taken: 0.004 seconds
2024-04-23T22:27:16,932  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_8cbb1835-1a6d-4f9c-988b-c152cbceb108
2024-04-23T22:27:16,937  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:27:16,943  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:16,943  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:27:16,943  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:16,944  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:16,946  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:27:16,946  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:27:16,947  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:16,947  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:16,952  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:27:16,953  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:16,954  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:16,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:16,954  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:16,954  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:16,954  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=5}
2024-04-23T22:27:16,955  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7); Time taken: 0.01 seconds
2024-04-23T22:27:16,955  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7
2024-04-23T22:27:16,955  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7
2024-04-23T22:27:16,973  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:27:16,973  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:16,974  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:16,974  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:16,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936436, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0, transactional=true, numRows=0, bucketing_version=2, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:16,980  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:17,017  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,017  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:17,017  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7); Time taken: 0.043 seconds
2024-04-23T22:27:17,017  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222716_3a5289bc-704d-41d9-8e22-6817501d55d7
2024-04-23T22:27:17,021  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:27:17,028  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,028  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:27:17,028  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,029  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,031  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:27:17,031  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:27:17,032  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,032  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,034  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:27:17,035  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:17,037  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,037  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,037  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,037  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,038  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1}
2024-04-23T22:27:17,038  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5); Time taken: 0.008 seconds
2024-04-23T22:27:17,038  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5
2024-04-23T22:27:17,038  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5
2024-04-23T22:27:17,052  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:27:17,052  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:17,053  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,053  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936437, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:17,059  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:27:17,074  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,074  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:17,074  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5); Time taken: 0.021 seconds
2024-04-23T22:27:17,074  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_c9f54629-47d1-407b-bfca-c97b47624ed5
2024-04-23T22:27:17,079  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:27:17,086  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,086  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:27:17,086  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,086  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,089  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:27:17,089  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:27:17,089  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,090  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,092  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:27:17,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:17,094  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,094  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,094  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,094  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,094  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-23T22:27:17,094  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8); Time taken: 0.008 seconds
2024-04-23T22:27:17,094  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8
2024-04-23T22:27:17,094  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8
2024-04-23T22:27:17,110  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:27:17,110  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:17,110  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,110  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936437, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, rawDataSize=0, totalSize=0, transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:17,116  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:27:17,130  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,130  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:17,131  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8); Time taken: 0.02 seconds
2024-04-23T22:27:17,131  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_49367427-3ce6-4b12-944c-e3f81ae106f8
2024-04-23T22:27:17,135  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:27:17,142  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,142  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:27:17,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,145  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:27:17,145  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:27:17,145  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,145  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,148  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:27:17,148  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:17,150  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,150  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,150  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,150  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,150  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:17,150  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616); Time taken: 0.008 seconds
2024-04-23T22:27:17,150  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616
2024-04-23T22:27:17,150  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616
2024-04-23T22:27:17,166  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:27:17,166  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:17,166  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,166  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,167  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936437, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, numFilesErasureCoded=0, totalSize=0, bucketing_version=2, rawDataSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:17,173  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:27:17,187  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,187  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T22:27:17,187  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616); Time taken: 0.021 seconds
2024-04-23T22:27:17,187  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_e030e8a3-2f87-4411-a8e8-990fb9f53616
2024-04-23T22:27:17,191  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:27:17,199  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,199  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:27:17,199  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,200  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,202  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:27:17,202  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:27:17,203  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,203  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,205  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:27:17,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:17,208  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,208  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getDatabase_(String)=2}
2024-04-23T22:27:17,208  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311); Time taken: 0.008 seconds
2024-04-23T22:27:17,208  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311
2024-04-23T22:27:17,209  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311
2024-04-23T22:27:17,224  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:27:17,224  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:17,225  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,225  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,226  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b9519500-e50f-49f7-987b-fa77eb57ff42/_tmp_space.db/7813e99b-6f6b-4266-93bf-c78f5e4a7e36
2024-04-23T22:27:17,229  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,229  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=2}
2024-04-23T22:27:17,229  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311); Time taken: 0.004 seconds
2024-04-23T22:27:17,229  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_9f27f9e7-1a55-45d6-b670-93d7e5a73311
2024-04-23T22:27:17,235  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:27:17,244  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,244  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:27:17,244  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,245  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,247  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:27:17,247  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:27:17,248  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,248  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,250  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:27:17,250  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:17,252  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,252  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,252  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,252  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,252  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T22:27:17,252  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3); Time taken: 0.007 seconds
2024-04-23T22:27:17,252  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3
2024-04-23T22:27:17,252  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3
2024-04-23T22:27:17,268  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:27:17,268  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:17,268  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:17,268  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,269  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936437, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, transactional=false, totalSize=0, numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:17,274  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:27:17,287  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,287  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=18, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:17,287  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3); Time taken: 0.019 seconds
2024-04-23T22:27:17,287  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_d27fee46-b1fb-4cf2-a85b-666e3ab47ab3
2024-04-23T22:27:17,291  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:27:17,298  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,298  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:27:17,299  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists target
2024-04-23T22:27:17,299  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae): drop table if exists target
2024-04-23T22:27:17,301  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:27:17,302  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:27:17,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:17,322  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,322  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,322  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,322  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,322  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=20, getValidTxns_(long)=0}
2024-04-23T22:27:17,322  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae); Time taken: 0.023 seconds
2024-04-23T22:27:17,322  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae
2024-04-23T22:27:17,323  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae
2024-04-23T22:27:17,343  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:27:17,343  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:17,343  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae): drop table if exists target
2024-04-23T22:27:17,343  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:17,350  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:17,356  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.target	
2024-04-23T22:27:17,471  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target does not exist; Force to delete it.
2024-04-23T22:27:17,471 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:17,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=121, getTable_(GetTableRequest)=7}
2024-04-23T22:27:17,471  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae); Time taken: 0.128 seconds
2024-04-23T22:27:17,471  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_a9bb0e24-fda7-48dd-96c3-d8e9862a04ae
2024-04-23T22:27:17,475  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:27:17,480  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,481  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:27:17,481  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists source
2024-04-23T22:27:17,482  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd): drop table if exists source
2024-04-23T22:27:17,489  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:27:17,489  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:27:17,492  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:17,510  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,510  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,510  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,510  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,511  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=7, getValidTxns_(long)=1, getTable_(GetTableRequest)=19}
2024-04-23T22:27:17,511  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd); Time taken: 0.029 seconds
2024-04-23T22:27:17,511  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd
2024-04-23T22:27:17,511  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd
2024-04-23T22:27:17,525  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:27:17,525  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:17,525  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd): drop table if exists source
2024-04-23T22:27:17,525  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:17,533  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:17,540  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,540  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.source	
2024-04-23T22:27:17,567  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source does not exist; Force to delete it.
2024-04-23T22:27:17,567 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source
2024-04-23T22:27:17,567  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,568  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=34, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:27:17,568  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd); Time taken: 0.042 seconds
2024-04-23T22:27:17,568  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_36db5d1c-5986-433d-be2a-7da14581eafd
2024-04-23T22:27:17,572  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:27:17,577  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,577  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:27:17,578  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table source (key int, data int)
2024-04-23T22:27:17,578  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce): create table source (key int, data int)
2024-04-23T22:27:17,580  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T22:27:17,581  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:27:17,581  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,581  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,586  INFO [main] parse.CalcitePlanner: Creating table default.source position=13
2024-04-23T22:27:17,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:17,588  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,588  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,588  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,588  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,588  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=5, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T22:27:17,589  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce); Time taken: 0.01 seconds
2024-04-23T22:27:17,589  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce
2024-04-23T22:27:17,589  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce
2024-04-23T22:27:17,603  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:27:17,603  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:17,603  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce): create table source (key int, data int)
2024-04-23T22:27:17,603  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,604  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:source, dbName:default, owner:alex, createTime:1713936437, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numRows=0, rawDataSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"data":"true","key":"true"}}, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:17,609  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source
2024-04-23T22:27:17,639  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,639  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=34}
2024-04-23T22:27:17,639  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce); Time taken: 0.036 seconds
2024-04-23T22:27:17,639  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_701cb597-8c42-441a-8534-0916181878ce
2024-04-23T22:27:17,643  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:27:17,648  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,648  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:27:17,649  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,649  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,651  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T22:27:17,652  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:27:17,652  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,652  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,654  INFO [main] parse.CalcitePlanner: Creating table default.target position=13
2024-04-23T22:27:17,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:17,656  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,656  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,656  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:17,656  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=1, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T22:27:17,657  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c); Time taken: 0.007 seconds
2024-04-23T22:27:17,657  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c
2024-04-23T22:27:17,657  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c
2024-04-23T22:27:17,674  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:27:17,674  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:17,675  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c): create table target (key int, data int, cur int) clustered by (key) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:17,675  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:17,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:target, dbName:default, owner:alex, createTime:1713936437, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:key, type:int, comment:null), FieldSchema(name:data, type:int, comment:null), FieldSchema(name:cur, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[key], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"cur":"true","data":"true","key":"true"}}, numFilesErasureCoded=0, numRows=0, transactional=true, rawDataSize=0, bucketing_version=2, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:17,681  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:17,695  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:17,696  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:17,696  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c); Time taken: 0.02 seconds
2024-04-23T22:27:17,696  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_85aff9df-2dc8-43f9-9656-ae5c6f7e190c
2024-04-23T22:27:17,700  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:27:17,705  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:17,705  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:27:17,706  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T22:27:17,706  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T22:27:17,709  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T22:27:17,709  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:27:17,710  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:17,710  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:17,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:17,741  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,741  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:17,742  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:17,742  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:17,742  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:17,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:17,748  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,748  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:17,749  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:17,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:17,839  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:17,839  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:17,839  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:17,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:17,842  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:17,842  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:17,842  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:17,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:17,848  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,850  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.target	
2024-04-23T22:27:17,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.target	
2024-04-23T22:27:17,860  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-23T22:27:17,860  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=target (txnIds: [17])
2024-04-23T22:27:17,861  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:17,864  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col1=Column[_col2], VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:27:17,864  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1], VALUE._col1=Column[_col2]}
2024-04-23T22:27:17,865  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:17,866  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:17,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:17,880  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:17,881  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:17,881  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:17,881  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:17,881  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null), FieldSchema(name:col3, type:int, comment:null)], properties:null)
2024-04-23T22:27:17,881  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:17,881  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=45, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=27, getNotNullConstraints_(NotNullConstraintsRequest)=1, allocateTableWriteId_(long, String, String)=8, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=9}
2024-04-23T22:27:17,881  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a); Time taken: 0.175 seconds
2024-04-23T22:27:17,881  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a
2024-04-23T22:27:17,882  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a
2024-04-23T22:27:17,897  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:27:17,897  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:17,899  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a): insert into target  values(1,5,1),(2,6,1),(1,18,0)
2024-04-23T22:27:17,900  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a
2024-04-23T22:27:17,900  INFO [main] ql.Driver: Query ID = alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a
Total jobs = 1
2024-04-23T22:27:17,900  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:27:17,900  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:27:18,031  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:27:18,031  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:27:18,031  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:27:18,031  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:27:18,031  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:27:18,031  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:27:18,031  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:27:18,031  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:27:18,033  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:18,033  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:18,034  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-17_706_7296422082100097718-1/dummy_path
2024-04-23T22:27:18,043  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:18,044  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,13KB
2024-04-23T22:27:18,048  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:27:18,049  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T22:27:18,050  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:18,054  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-17_706_7296422082100097718-1/-mr-10000
2024-04-23T22:27:18,056  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:18,063  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:18,067  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:18,068  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:18,068  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:18,068  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-17_706_7296422082100097718-1/dummy_path
2024-04-23T22:27:18,069  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:18,086  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:18,108  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1437826493_0070
2024-04-23T22:27:18,109  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:18,172  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:18,172  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:18,172  INFO [Thread-5954] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:18,173  INFO [Thread-5954] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:18,174  INFO [Thread-5954] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:18,174  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1437826493_0070_m_000000_0
2024-04-23T22:27:18,177  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:18,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-17_706_7296422082100097718-1/dummy_path/null:0+1
2024-04-23T22:27:18,181  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:18,181  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,13KB
2024-04-23T22:27:18,182  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:27:18,186  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:27:18,186  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:27:18,186  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:27:18,186  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:27:18,186  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:27:18,187  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:27:18,187  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:18,187  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:18,188  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:18,188  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:18,189  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:18,189  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:18,189  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:18,189  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int,col3:int>
2024-04-23T22:27:18,189  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:27:18,189  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:27:18,189  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:18,190  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:3, 
2024-04-23T22:27:18,191  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:18,191  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:3, 
2024-04-23T22:27:18,191  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:27:18,191  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 3. abort - false
2024-04-23T22:27:18,191  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:3, RECORDS_OUT_INTERMEDIATE:3, 
2024-04-23T22:27:18,193  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:18,193  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:27:18,193  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:27:18,193  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 51; bufvoid = 104857600
2024-04-23T22:27:18,193  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214388(104857552); length = 9/6553600
2024-04-23T22:27:18,204  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:27:18,209  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1437826493_0070_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:18,209  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:18,209  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1437826493_0070_m_000000_0' done.
2024-04-23T22:27:18,210  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1437826493_0070_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1418183
		FILE: Number of bytes written=82506409
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=3
		Map output bytes=51
		Map output materialized bytes=69
		Input split bytes=361
		Combine input records=0
		Spilled Records=3
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1309147136
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=3
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=3
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=3
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=3
	File Input Format Counters 
		Bytes Read=5181
2024-04-23T22:27:18,210  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1437826493_0070_m_000000_0
2024-04-23T22:27:18,210  INFO [Thread-5954] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:27:18,211  INFO [Thread-5954] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:27:18,211  INFO [pool-346-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1437826493_0070_r_000000_0
2024-04-23T22:27:18,214  INFO [pool-346-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:18,214  INFO [pool-346-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@187f6d8c
2024-04-23T22:27:18,214  WARN [pool-346-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:18,214  INFO [pool-346-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:18,215  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1437826493_0070_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:18,217  INFO [localfetcher#95] reduce.LocalFetcher: localfetcher#95 about to shuffle output of map attempt_local1437826493_0070_m_000000_0 decomp: 21 len: 25 to MEMORY
2024-04-23T22:27:18,218  INFO [localfetcher#95] reduce.InMemoryMapOutput: Read 21 bytes from map-output for attempt_local1437826493_0070_m_000000_0
2024-04-23T22:27:18,218  INFO [localfetcher#95] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 21, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->21
2024-04-23T22:27:18,218  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:18,218  INFO [pool-346-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:18,218  INFO [pool-346-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:18,224  INFO [pool-346-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:18,225  INFO [pool-346-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T22:27:18,227  INFO [pool-346-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 21 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:18,227  INFO [pool-346-thread-1] reduce.MergeManagerImpl: Merging 1 files, 25 bytes from disk
2024-04-23T22:27:18,227  INFO [pool-346-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:18,227  INFO [pool-346-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:18,227  INFO [pool-346-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 9 bytes
2024-04-23T22:27:18,228  INFO [pool-346-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:18,228  INFO [pool-346-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:18,228  INFO [pool-346-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T22:27:18,229  INFO [pool-346-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:18,229  INFO [pool-346-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:18,229  INFO [pool-346-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T22:27:18,229  INFO [pool-346-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:18,230  INFO [pool-346-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1437826493_0070/job_local1437826493_0070.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@6390d74d
2024-04-23T22:27:18,230  INFO [pool-346-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:18,230  INFO [pool-346-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:18,230  INFO [pool-346-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:18,231  INFO [pool-346-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:18,231  INFO [pool-346-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:18,238  INFO [pool-346-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:18,245  INFO [pool-346-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:18,245  INFO [pool-346-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T22:27:18,245  INFO [pool-346-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:18,245  INFO [pool-346-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:18,246  INFO [pool-346-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:27:18,259  INFO [pool-346-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_1_default.target:1, RECORDS_OUT_OPERATOR_FS_6:1, 
2024-04-23T22:27:18,259  INFO [pool-346-thread-1] mapred.Task: Task:attempt_local1437826493_0070_r_000000_0 is done. And is in the process of committing
2024-04-23T22:27:18,260  INFO [pool-346-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:18,260  INFO [pool-346-thread-1] mapred.Task: Task 'attempt_local1437826493_0070_r_000000_0' done.
2024-04-23T22:27:18,260  INFO [pool-346-thread-1] mapred.Task: Final Counters for attempt_local1437826493_0070_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1424557
		FILE: Number of bytes written=82507490
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=25
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1309147136
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:18,260  INFO [pool-346-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1437826493_0070_r_000000_0
2024-04-23T22:27:18,260  INFO [pool-346-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1437826493_0070_r_000001_0
2024-04-23T22:27:18,260  INFO [pool-346-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:18,260  INFO [pool-346-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@4581d429
2024-04-23T22:27:18,261  WARN [pool-346-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:18,262  INFO [pool-346-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:18,262  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1437826493_0070_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:18,265  INFO [localfetcher#96] reduce.LocalFetcher: localfetcher#96 about to shuffle output of map attempt_local1437826493_0070_m_000000_0 decomp: 40 len: 44 to MEMORY
2024-04-23T22:27:18,265  INFO [localfetcher#96] reduce.InMemoryMapOutput: Read 40 bytes from map-output for attempt_local1437826493_0070_m_000000_0
2024-04-23T22:27:18,265  INFO [localfetcher#96] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 40, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->40
2024-04-23T22:27:18,266  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:18,266  INFO [pool-346-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:18,266  INFO [pool-346-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:18,272  INFO [pool-346-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:18,272  INFO [pool-346-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T22:27:18,275  INFO [pool-346-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 40 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:18,275  INFO [pool-346-thread-1] reduce.MergeManagerImpl: Merging 1 files, 44 bytes from disk
2024-04-23T22:27:18,275  INFO [pool-346-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:18,275  INFO [pool-346-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:18,275  INFO [pool-346-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 28 bytes
2024-04-23T22:27:18,275  INFO [pool-346-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:18,276  INFO [pool-346-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:18,276  INFO [pool-346-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,16KB
2024-04-23T22:27:18,277  INFO [pool-346-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:18,277  INFO [pool-346-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:18,277  INFO [pool-346-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int,_col1:int>>
2024-04-23T22:27:18,277  INFO [pool-346-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:18,278  INFO [pool-346-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1437826493_0070/job_local1437826493_0070.xml], properties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.target, transactional=true, columns.types=int:int:int, bucket_field_name=key, columns=key,data,cur, numFilesErasureCoded=0, columns.comments=&amp#0;&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[key, data, cur], columnTypes=[int, int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@9c62330
2024-04-23T22:27:18,278  INFO [pool-346-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:18,278  INFO [pool-346-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:18,278  INFO [pool-346-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:18,279  INFO [pool-346-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:18,279  INFO [pool-346-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:18,284  INFO [pool-346-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:18,284  INFO [pool-346-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:18,284  INFO [pool-346-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:18,284  INFO [pool-346-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:18,284  INFO [pool-346-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:27:18,286  INFO [pool-346-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:27:18,298  INFO [pool-346-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.target:2, 
2024-04-23T22:27:18,298  INFO [pool-346-thread-1] mapred.Task: Task:attempt_local1437826493_0070_r_000001_0 is done. And is in the process of committing
2024-04-23T22:27:18,299  INFO [pool-346-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:18,299  INFO [pool-346-thread-1] mapred.Task: Task 'attempt_local1437826493_0070_r_000001_0' done.
2024-04-23T22:27:18,299  INFO [pool-346-thread-1] mapred.Task: Final Counters for attempt_local1437826493_0070_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1430925
		FILE: Number of bytes written=82508609
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=44
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1309147136
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.target=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:18,299  INFO [pool-346-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1437826493_0070_r_000001_0
2024-04-23T22:27:18,299  INFO [Thread-5954] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:27:19,175 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:27:19,175  INFO [main] exec.Task: 2024-04-23 22:27:19,175 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1437826493_0070
2024-04-23T22:27:19,177  INFO [main] exec.Task: Ended Job = job_local1437826493_0070
2024-04-23T22:27:19,178  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:27:19,178  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:27:19,178  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:27:19,178  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:27:19,179  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target/_tmp.delta_0000001_0000001_0000
2024-04-23T22:27:19,180  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.target
2024-04-23T22:27:19,180  INFO [main] exec.Task: Loading data to table default.target from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/target
2024-04-23T22:27:19,180  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:19,186  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,187  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:19,192  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,193  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T22:27:19,220  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:19,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:19,226  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,226  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:19,226  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-17_706_7296422082100097718-1/-mr-10000
2024-04-23T22:27:19,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:19,233  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,244  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:27:19,244  INFO [main] FileOperations: Read stats for default.target/, numRows, true, 3, false: 
2024-04-23T22:27:19,244  INFO [main] FileOperations: Read stats for default.target/, rawDataSize, true, 0, false: 
2024-04-23T22:27:19,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.target newtbl=target	
2024-04-23T22:27:19,262  INFO [main] FileOperations: Read stats for default.target/, insertCount, true, 3, false: 
2024-04-23T22:27:19,262  INFO [main] FileOperations: Read stats for default.target/, updateCount, true, 0, false: 
2024-04-23T22:27:19,262  INFO [main] FileOperations: Read stats for default.target/, deleteCount, true, 0, false: 
2024-04-23T22:27:19,265  INFO [main] stats.BasicStatsTask: Table default.target stats: [numFiles=2, numRows=3, totalSize=1460, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:27:19,265  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:19,265  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=45, isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, getTable_(GetTableRequest)=25}
MapReduce Jobs Launched: 
2024-04-23T22:27:19,265  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:19,265  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:19,265  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:19,265  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a); Time taken: 1.366 seconds
2024-04-23T22:27:19,266  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222717_f09afee9-3d05-4a3f-b30d-1eaa9bad6f0a
2024-04-23T22:27:19,275  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:19,275  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:27:19,276  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into source  values(1,7),(3,8)
2024-04-23T22:27:19,276  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-17_706_7296422082100097718-1
2024-04-23T22:27:19,277  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-17_706_7296422082100097718-1 on fs with scheme file
2024-04-23T22:27:19,277  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628): insert into source  values(1,7),(3,8)
2024-04-23T22:27:19,279  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T22:27:19,280  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:27:19,280  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:19,280  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:19,283  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:19,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,301  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:19,302  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:19,302  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:19,302  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:19,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:19,309  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,309  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:19,309  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:19,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:19,373  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:19,373  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:19,373  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:19,374  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:19,376  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:19,376  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:19,376  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:19,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:19,384  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,385  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1
2024-04-23T22:27:19,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.source	
2024-04-23T22:27:19,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.source	
2024-04-23T22:27:19,390  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:19,392  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:19,393  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:19,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:19,410  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,410  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T22:27:19,410  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:19,419  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:19,433  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:19,434  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:19,434  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:19,434  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:27:19,434  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:19,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=52, getAllTableConstraints_(AllTableConstraintsRequest)=4, commitTxn_(CommitTxnRequest)=10, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0}
2024-04-23T22:27:19,434  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628); Time taken: 0.157 seconds
2024-04-23T22:27:19,434  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628
2024-04-23T22:27:19,434  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628
2024-04-23T22:27:19,448  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:27:19,448  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:19,448  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628): insert into source  values(1,7),(3,8)
2024-04-23T22:27:19,448  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628
2024-04-23T22:27:19,449  INFO [main] ql.Driver: Query ID = alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628
Total jobs = 3
2024-04-23T22:27:19,449  INFO [main] ql.Driver: Total jobs = 3
Launching Job 1 out of 3
2024-04-23T22:27:19,449  INFO [main] ql.Driver: Launching Job 1 out of 3
2024-04-23T22:27:19,572  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:27:19,572  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T22:27:19,574  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:19,574  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:19,575  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-19_277_3741505897214657851-1/dummy_path
2024-04-23T22:27:19,584  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:19,584  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T22:27:19,585  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:19,589  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-19_277_3741505897214657851-1/-mr-10001
2024-04-23T22:27:19,593  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:19,613  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:19,617  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:19,618  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:19,618  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:19,618  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-19_277_3741505897214657851-1/dummy_path
2024-04-23T22:27:19,619  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:19,635  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:19,654  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local741253311_0071
2024-04-23T22:27:19,654  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:19,713  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:19,713  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:19,713  INFO [Thread-6028] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:19,713  INFO [Thread-6028] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:19,715  INFO [Thread-6028] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:19,715  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local741253311_0071_m_000000_0
2024-04-23T22:27:19,715  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:19,716  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-19_277_3741505897214657851-1/dummy_path/null:0+1
2024-04-23T22:27:19,716  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:19,717  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,68KB
2024-04-23T22:27:19,717  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T22:27:19,717  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:19,717  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:19,718  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:19,718  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:19,718  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:19,718  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:19,718  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:19,719  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:27:19,719  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:27:19,719  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@29e963b2, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@3d17de32, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8] : [key, data] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat@789440e3
2024-04-23T22:27:19,719  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:19,719  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:27:19,719  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:19,726  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:27:19,726  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:19,726  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:19,726  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:19,726  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T22:27:19,726  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:27:19,727  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T22:27:19,732  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_1_default.source:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:19,732  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:19,732  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local741253311_0071_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:19,733  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:19,733  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local741253311_0071_m_000000_0' done.
2024-04-23T22:27:19,733  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local741253311_0071_m_000000_0: Counters: 32
	File System Counters
		FILE: Number of bytes read=1437699
		FILE: Number of bytes written=83676476
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1306001408
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.source=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=5735
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:19,733  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local741253311_0071_m_000000_0
2024-04-23T22:27:19,733  INFO [Thread-6028] mapred.LocalJobRunner: map task executor complete.
2024-04-23 22:27:20,715 Stage-1 map = 100%,  reduce = 0%
2024-04-23T22:27:20,715  INFO [main] exec.Task: 2024-04-23 22:27:20,715 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local741253311_0071
2024-04-23T22:27:20,716  INFO [main] exec.Task: Ended Job = job_local741253311_0071
2024-04-23T22:27:20,720  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T22:27:20,721  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T22:27:20,721  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T22:27:20,721  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T22:27:20,721  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1/-ext-10000
2024-04-23T22:27:20,722  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1/-ext-10002
2024-04-23T22:27:20,723  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.source
2024-04-23T22:27:20,723  INFO [main] exec.Task: Loading data to table default.source from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1/-ext-10000
2024-04-23T22:27:20,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:20,749  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:20,763  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,765  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T22:27:20,765  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T22:27:20,785  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:20,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:20,793  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,793  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:20,793  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-19_277_3741505897214657851-1/-mr-10001
2024-04-23T22:27:20,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:20,802  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,802  INFO [main] FileOperations: Read stats for default.source/, numRows, true, 2, false: 
2024-04-23T22:27:20,802  INFO [main] FileOperations: Read stats for default.source/, rawDataSize, true, 6, false: 
2024-04-23T22:27:20,803  WARN [main] metadata.Hive: Cannot get a table snapshot for source
2024-04-23T22:27:20,803  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.source newtbl=source	
2024-04-23T22:27:20,823  INFO [main] stats.BasicStatsTask: Table default.source stats: [numFiles=1, numRows=2, totalSize=8, rawDataSize=6, numFilesErasureCoded=0]
2024-04-23T22:27:20,824  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:20,824  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=40, getTable_(GetTableRequest)=55, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T22:27:20,824  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:20,824  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:20,824  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:20,824  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628); Time taken: 1.376 seconds
2024-04-23T22:27:20,824  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222719_fbe96073-99eb-4fdc-8a08-a0024f8b2628
2024-04-23T22:27:20,828  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:27:20,833  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:20,833  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:27:20,834  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T22:27:20,834  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1
2024-04-23T22:27:20,835  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/source/.hive-staging_hive_2024-04-23_22-27-19_277_3741505897214657851-1 on fs with scheme file
2024-04-23T22:27:20,835  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-19_277_3741505897214657851-1
2024-04-23T22:27:20,836  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-19_277_3741505897214657851-1 on fs with scheme file
2024-04-23T22:27:20,836  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222720_14ce0b46-ef32-4722-a486-01fd9567b820): merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)
2024-04-23T22:27:20,839  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 19
2024-04-23T22:27:20,839  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:27:20,840  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:27:20,840  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:20,846  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T22:27:20,849  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b9519500-e50f-49f7-987b-fa77eb57ff42/_tmp_space.db/merge_tmp_table
2024-04-23T22:27:20,852  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into target t using (select source.*, 0 c from source union all select source.*, 1 c from source inner join target on source.key=target.key where target.cur=1) s on t.key=s.key and t.cur=s.c and t.cur=1 when matched then update set cur=0 when not matched then insert values(s.key,s.data,1)> as 
<FROM
  `default`.`target` `t`
  RIGHT OUTER JOIN
  (select `source`.*, 0 `c` from `source` union all select `source`.*, 1 `c` from `source` inner join `target` on `source`.`key`=`target`.`key` where `target`.`cur`=1) `s`
  ON `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
INSERT INTO `default`.`target`    -- update clause(insert part)
 SELECT `t`.`key`, `t`.`data`, 0
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
INSERT INTO `default`.`target`    -- update clause (delete part)
 SELECT `t`.ROW__ID 
   WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1
 SORT BY `t`.ROW__ID 
INSERT INTO `default`.`target`    -- insert clause
  SELECT `s`.`key`,`s`.`data`,1
   WHERE `t`.`key` IS NULL AND `t`.`cur` IS NULL AND `t`.`cur` IS NULL
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`t`.ROW__ID)
 WHERE `t`.`key`=`s`.`key` and `t`.`cur`=`s`.`c` and `t`.`cur`=1 GROUP BY `t`.ROW__ID HAVING count(*) > 1>
2024-04-23T22:27:20,853  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:27:20,857  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:20,857  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,858  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:20,864  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,864  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,864  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,864  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,864  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:20,873  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,873  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,873  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,873  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,873  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,873  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,873  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,873  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:20,880  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:20,886  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,886  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:20,892  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:20,892  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:20,892  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:20,893  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,893  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,893  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,893  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,893  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,894  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,894  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,894  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:20,894  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:20,894  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,894  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,894  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:20,905  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-23T22:27:20,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.source	
2024-04-23T22:27:20,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T22:27:20,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.target	
2024-04-23T22:27:21,039  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T22:27:21,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:21,048  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:21,056  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,057  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.target	
2024-04-23T22:27:21,068  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: data, key, cur
No Stats for default@target, Columns: data, key, cur
2024-04-23T22:27:21,069  INFO [main] SessionState: No Stats for default@target, Columns: data, key, cur
2024-04-23T22:27:21,070  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:27:21,070  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:21,081  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.source	
2024-04-23T22:27:21,093  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,093  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.source	
2024-04-23T22:27:21,105  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: key, data
No Stats for default@source, Columns: key, data
2024-04-23T22:27:21,106  INFO [main] SessionState: No Stats for default@source, Columns: key, data
2024-04-23T22:27:21,106  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.source, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:27:21,107  WARN [main] calcite.RelOptHiveTable: No Stats for default@source, Columns: data, key
No Stats for default@source, Columns: data, key
2024-04-23T22:27:21,107  INFO [main] SessionState: No Stats for default@source, Columns: data, key
2024-04-23T22:27:21,107  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.target, projIndxSet: [0, 2], allowMissingStats: true
2024-04-23T22:27:21,109  WARN [main] calcite.RelOptHiveTable: No Stats for default@target, Columns: cur, key
No Stats for default@target, Columns: cur, key
2024-04-23T22:27:21,109  INFO [main] SessionState: No Stats for default@target, Columns: cur, key
2024-04-23T22:27:21,328  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,328  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,328  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,328  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,329  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:21,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:21,336  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,336  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:21,342  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,342  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.target	
2024-04-23T22:27:21,348  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,357 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:27:21,358 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:27:21,358  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:27:21,358 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMergeType2SCD02(TestTxnCommands.java:1178)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:27:21,359  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,359  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=27, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=6, openTxn_(String, TxnType)=2, getTableColumnStatistics_(String, String, List, String)=62, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, createTable_(Table)=3, getTable_(GetTableRequest)=58, flushCache_()=0}
2024-04-23T22:27:21,359  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222720_14ce0b46-ef32-4722-a486-01fd9567b820); Time taken: 0.523 seconds
2024-04-23T22:27:21,359  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:27:21,363  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,369  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:21,369  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b9519500-e50f-49f7-987b-fa77eb57ff42/hive_2024-04-23_22-27-20_852_9077457679812996667-1
2024-04-23T22:27:21,369  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef): drop table if exists acidTbl
2024-04-23T22:27:21,372  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 19
2024-04-23T22:27:21,372  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:27:21,373  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:21,378  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,378  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,378  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,378  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,379  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=10, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:27:21,379  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef); Time taken: 0.009 seconds
2024-04-23T22:27:21,379  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef
2024-04-23T22:27:21,379  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef
2024-04-23T22:27:21,394  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:27:21,394  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:21,394  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef): drop table if exists acidTbl
2024-04-23T22:27:21,394  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:21,400  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:21,406  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,406  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:21,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,493  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=92, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:21,493  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef); Time taken: 0.098 seconds
2024-04-23T22:27:21,493  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_e71c1349-eb14-4341-99ed-05c1a1fbd6ef
2024-04-23T22:27:21,497  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:27:21,502  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,502  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:27:21,503  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:21,503  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d): drop table if exists acidTblPart
2024-04-23T22:27:21,505  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 19
2024-04-23T22:27:21,506  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:27:21,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:21,523  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,523  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,523  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=17, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T22:27:21,524  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d); Time taken: 0.02 seconds
2024-04-23T22:27:21,524  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d
2024-04-23T22:27:21,524  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d
2024-04-23T22:27:21,538  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T22:27:21,538  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:21,538  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d): drop table if exists acidTblPart
2024-04-23T22:27:21,538  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:21,544  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:21,551  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:21,590  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,590  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=45}
2024-04-23T22:27:21,591  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d); Time taken: 0.052 seconds
2024-04-23T22:27:21,591  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_06c46c07-d0a5-4032-b14e-6101d4aec90d
2024-04-23T22:27:21,594  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:27:21,600  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,600  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:27:21,600  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:21,601  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_c9c8aded-eea7-4158-b7af-1a2a97191656): drop table if exists acidTbl2
2024-04-23T22:27:21,603  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 19
2024-04-23T22:27:21,603  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T22:27:21,604  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,604  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,604  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,604  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=0}
2024-04-23T22:27:21,604  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_c9c8aded-eea7-4158-b7af-1a2a97191656); Time taken: 0.003 seconds
2024-04-23T22:27:21,604  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423222721_c9c8aded-eea7-4158-b7af-1a2a97191656
2024-04-23T22:27:21,605  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:21,605  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_c9c8aded-eea7-4158-b7af-1a2a97191656): drop table if exists acidTbl2
2024-04-23T22:27:21,605  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,605  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:27:21,605  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,606  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:21,606  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_c9c8aded-eea7-4158-b7af-1a2a97191656); Time taken: 0.0 seconds
2024-04-23T22:27:21,606  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_c9c8aded-eea7-4158-b7af-1a2a97191656
2024-04-23T22:27:21,611  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T22:27:21,616  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,616  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T22:27:21,617  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:21,617  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:21,619  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 19
2024-04-23T22:27:21,619  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T22:27:21,620  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:21,639  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,639  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,639  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,639  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,639  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=19, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:21,639  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374); Time taken: 0.022 seconds
2024-04-23T22:27:21,639  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374
2024-04-23T22:27:21,640  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374
2024-04-23T22:27:21,653  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T22:27:21,653  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:21,653  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:21,653  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,654  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:21,661  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:21,669  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,669  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:21,695  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,695  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=34, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:21,695  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374); Time taken: 0.042 seconds
2024-04-23T22:27:21,696  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_4155824f-c31c-40fc-aefc-b2a84e52c374
2024-04-23T22:27:21,699  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T22:27:21,705  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,705  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T22:27:21,706  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:21,706  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:21,708  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 19
2024-04-23T22:27:21,708  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T22:27:21,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:21,716  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,716  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,716  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,716  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,716  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T22:27:21,717  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd); Time taken: 0.01 seconds
2024-04-23T22:27:21,717  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd
2024-04-23T22:27:21,717  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd
2024-04-23T22:27:21,731  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T22:27:21,731  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:21,731  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:21,731  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:21,739  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:21,747  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:21,773  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,773  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=34, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:27:21,774  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd); Time taken: 0.042 seconds
2024-04-23T22:27:21,774  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_0456f445-9c21-42b9-875a-9265ddcdf3dd
2024-04-23T22:27:21,777  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T22:27:21,783  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,783  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T22:27:21,784  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:21,784  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e): drop table if exists nonAcidNonBucket
2024-04-23T22:27:21,786  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 19
2024-04-23T22:27:21,787  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T22:27:21,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:21,795  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,795  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,796  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,796  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,796  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=8, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9}
2024-04-23T22:27:21,796  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e); Time taken: 0.012 seconds
2024-04-23T22:27:21,796  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e
2024-04-23T22:27:21,797  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e
2024-04-23T22:27:21,810  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T22:27:21,810  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:21,810  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e): drop table if exists nonAcidNonBucket
2024-04-23T22:27:21,810  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:21,817  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:21,825  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:21,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:21,852  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,852  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=34}
2024-04-23T22:27:21,852  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e); Time taken: 0.042 seconds
2024-04-23T22:27:21,852  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_65b047ca-8b1b-4b1e-a0bf-77787077083e
2024-04-23T22:27:21,856  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T22:27:21,861  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,861  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T22:27:21,862  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testQuotedIdentifier2" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="2.021">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: 
merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1097)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:27:21,918  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:27:21,920  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 4ae42430-f394-4f71-aee3-eb7f32625f9b
2024-04-23T22:27:21,923  INFO [main] SessionState: Hive Session ID = 4ae42430-f394-4f71-aee3-eb7f32625f9b
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:21,923  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:21,928  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4ae42430-f394-4f71-aee3-eb7f32625f9b
2024-04-23T22:27:21,931  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4ae42430-f394-4f71-aee3-eb7f32625f9b
2024-04-23T22:27:21,933  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4ae42430-f394-4f71-aee3-eb7f32625f9b/_tmp_space.db
2024-04-23T22:27:21,934  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=4ae42430-f394-4f71-aee3-eb7f32625f9b, clientType=HIVECLI]
2024-04-23T22:27:21,934  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:21,934  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_a0816292-7b4e-476a-bdea-c3083c78b7e9): drop table if exists acidTbl
2024-04-23T22:27:21,943  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:27:21,943  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:27:21,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:21,948  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,948  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,948  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,948  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=2, flushCache_()=0}
2024-04-23T22:27:21,949  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_a0816292-7b4e-476a-bdea-c3083c78b7e9); Time taken: 0.014 seconds
2024-04-23T22:27:21,949  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222721_a0816292-7b4e-476a-bdea-c3083c78b7e9
2024-04-23T22:27:21,949  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:21,949  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_a0816292-7b4e-476a-bdea-c3083c78b7e9): drop table if exists acidTbl
2024-04-23T22:27:21,949  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,949  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:21,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:21,953  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_a0816292-7b4e-476a-bdea-c3083c78b7e9); Time taken: 0.003 seconds
2024-04-23T22:27:21,953  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_a0816292-7b4e-476a-bdea-c3083c78b7e9
2024-04-23T22:27:21,958  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:27:21,966  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,966  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:27:21,966  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:21,966  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_4068165b-7552-435d-b563-825611965618): drop table if exists acidTblPart
2024-04-23T22:27:21,968  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:27:21,969  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:27:21,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:21,972  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,972  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,972  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,972  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:21,973  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_4068165b-7552-435d-b563-825611965618); Time taken: 0.006 seconds
2024-04-23T22:27:21,973  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222721_4068165b-7552-435d-b563-825611965618
2024-04-23T22:27:21,973  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:21,973  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_4068165b-7552-435d-b563-825611965618): drop table if exists acidTblPart
2024-04-23T22:27:21,973  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:21,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:21,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:21,977  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_4068165b-7552-435d-b563-825611965618); Time taken: 0.003 seconds
2024-04-23T22:27:21,977  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_4068165b-7552-435d-b563-825611965618
2024-04-23T22:27:21,983  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:27:21,989  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:21,989  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:27:21,990  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:21,990  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222721_3fdc8485-f161-444b-bfcc-b54e0c2bde0d): drop table if exists acidTbl2
2024-04-23T22:27:21,992  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:27:21,992  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:27:21,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:21,996  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:21,996  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:21,996  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:21,996  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:27:21,996  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222721_3fdc8485-f161-444b-bfcc-b54e0c2bde0d); Time taken: 0.006 seconds
2024-04-23T22:27:21,996  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222721_3fdc8485-f161-444b-bfcc-b54e0c2bde0d
2024-04-23T22:27:21,996  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:21,996  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222721_3fdc8485-f161-444b-bfcc-b54e0c2bde0d): drop table if exists acidTbl2
2024-04-23T22:27:21,996  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:21,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:21,999  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,000  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:22,000  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222721_3fdc8485-f161-444b-bfcc-b54e0c2bde0d); Time taken: 0.003 seconds
2024-04-23T22:27:22,000  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222721_3fdc8485-f161-444b-bfcc-b54e0c2bde0d
2024-04-23T22:27:22,006  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:27:22,013  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,013  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:27:22,014  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:22,014  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_07c74445-b5c0-4ed8-bfd4-721356fc11b2): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:22,018  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:27:22,018  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:27:22,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:22,023  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,023  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,023  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,024  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14}
2024-04-23T22:27:22,024  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_07c74445-b5c0-4ed8-bfd4-721356fc11b2); Time taken: 0.009 seconds
2024-04-23T22:27:22,024  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222722_07c74445-b5c0-4ed8-bfd4-721356fc11b2
2024-04-23T22:27:22,024  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:22,024  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_07c74445-b5c0-4ed8-bfd4-721356fc11b2): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:22,024  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,025  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:22,029  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,029  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,029  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_07c74445-b5c0-4ed8-bfd4-721356fc11b2); Time taken: 0.005 seconds
2024-04-23T22:27:22,030  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_07c74445-b5c0-4ed8-bfd4-721356fc11b2
2024-04-23T22:27:22,035  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:27:22,041  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,041  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:27:22,041  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:22,042  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_71ad2612-a4ad-4231-ac61-375c07fb3923): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:22,043  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:27:22,044  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:27:22,044  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:22,047  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,047  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,047  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,047  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T22:27:22,047  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_71ad2612-a4ad-4231-ac61-375c07fb3923); Time taken: 0.006 seconds
2024-04-23T22:27:22,048  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222722_71ad2612-a4ad-4231-ac61-375c07fb3923
2024-04-23T22:27:22,048  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:22,048  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_71ad2612-a4ad-4231-ac61-375c07fb3923): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:22,048  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:22,051  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,051  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,051  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_71ad2612-a4ad-4231-ac61-375c07fb3923); Time taken: 0.003 seconds
2024-04-23T22:27:22,051  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_71ad2612-a4ad-4231-ac61-375c07fb3923
2024-04-23T22:27:22,056  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:27:22,062  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,062  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:27:22,063  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:22,063  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_e939e411-22f1-42ef-9e4f-927fd5a1082a): drop table if exists nonAcidNonBucket
2024-04-23T22:27:22,065  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:27:22,065  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:27:22,066  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:22,068  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,068  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,068  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,068  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,069  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_e939e411-22f1-42ef-9e4f-927fd5a1082a); Time taken: 0.005 seconds
2024-04-23T22:27:22,069  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222722_e939e411-22f1-42ef-9e4f-927fd5a1082a
2024-04-23T22:27:22,069  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:22,069  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_e939e411-22f1-42ef-9e4f-927fd5a1082a): drop table if exists nonAcidNonBucket
2024-04-23T22:27:22,069  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,069  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:22,072  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,072  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,072  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_e939e411-22f1-42ef-9e4f-927fd5a1082a); Time taken: 0.003 seconds
2024-04-23T22:27:22,072  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_e939e411-22f1-42ef-9e4f-927fd5a1082a
2024-04-23T22:27:22,077  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:27:22,083  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,083  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:27:22,084  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,084  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,087  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:27:22,087  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:27:22,088  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,088  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,096  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:27:22,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,098  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,098  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,098  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,099  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,099  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=7, flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:27:22,099  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca); Time taken: 0.014 seconds
2024-04-23T22:27:22,099  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca
2024-04-23T22:27:22,099  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca
2024-04-23T22:27:22,127  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:27:22,127  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,128  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,128  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936442, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, rawDataSize=0, numFiles=0, transactional=true, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:22,134  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:22,178  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,178  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=50}
2024-04-23T22:27:22,179  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca); Time taken: 0.05 seconds
2024-04-23T22:27:22,179  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_e0926b24-669a-47b5-831a-c1a49c7be8ca
2024-04-23T22:27:22,186  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:27:22,196  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,196  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:27:22,197  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,197  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,200  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:27:22,200  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:27:22,201  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,201  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,204  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:27:22,204  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,207  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,207  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,207  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,207  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,207  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=17, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=0}
2024-04-23T22:27:22,207  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05); Time taken: 0.01 seconds
2024-04-23T22:27:22,207  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05
2024-04-23T22:27:22,208  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05
2024-04-23T22:27:22,225  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:27:22,225  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,226  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,226  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936442, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:22,232  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:27:22,246  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,246  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T22:27:22,247  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05); Time taken: 0.02 seconds
2024-04-23T22:27:22,247  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_7f799229-a155-4d2b-ac86-08356be86d05
2024-04-23T22:27:22,252  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:27:22,259  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,259  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:27:22,259  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,260  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,262  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:27:22,262  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:27:22,262  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,262  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,265  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:27:22,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,266  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,266  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,267  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,267  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,267  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T22:27:22,267  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d); Time taken: 0.008 seconds
2024-04-23T22:27:22,267  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d
2024-04-23T22:27:22,267  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d
2024-04-23T22:27:22,282  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:27:22,282  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,282  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,282  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,283  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936442, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2, numFiles=0, numFilesErasureCoded=0, transactional=false, totalSize=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:22,289  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:27:22,305  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,305  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=22}
2024-04-23T22:27:22,305  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d); Time taken: 0.023 seconds
2024-04-23T22:27:22,305  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_0dc8adcc-2a6e-47c7-aff6-225e5f9ac28d
2024-04-23T22:27:22,312  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:27:22,322  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,322  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:27:22,323  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,323  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,327  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:27:22,327  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:27:22,328  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,328  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,331  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:27:22,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,334  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,334  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,334  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,334  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,335  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=17, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, getDatabase_(String)=2, getValidWriteIds_(List, String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,335  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808); Time taken: 0.011 seconds
2024-04-23T22:27:22,335  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808
2024-04-23T22:27:22,335  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808
2024-04-23T22:27:22,359  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:27:22,359  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,359  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,359  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,360  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936442, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, bucketing_version=2, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:22,368  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:27:22,387  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,387  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-23T22:27:22,387  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808); Time taken: 0.028 seconds
2024-04-23T22:27:22,387  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_d8a1650c-f201-400e-a4c4-682bfe13e808
2024-04-23T22:27:22,392  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:27:22,400  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,400  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:27:22,401  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,401  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,404  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:27:22,404  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:27:22,405  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,405  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,407  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:27:22,408  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,409  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,409  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,410  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,410  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,410  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,410  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38); Time taken: 0.009 seconds
2024-04-23T22:27:22,410  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38
2024-04-23T22:27:22,410  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38
2024-04-23T22:27:22,426  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:27:22,426  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,427  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,427  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,428  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4ae42430-f394-4f71-aee3-eb7f32625f9b/_tmp_space.db/807041dc-6326-4806-aae9-ad7e4c6c6dd5
2024-04-23T22:27:22,432  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,432  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,432  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38); Time taken: 0.005 seconds
2024-04-23T22:27:22,432  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_0a88c370-5a60-4543-b921-e2d5b6cf6d38
2024-04-23T22:27:22,439  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:27:22,450  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,450  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:27:22,450  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,451  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,453  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:27:22,453  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:27:22,454  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,454  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,457  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:27:22,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,459  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,459  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,459  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,459  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,459  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,459  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66); Time taken: 0.008 seconds
2024-04-23T22:27:22,460  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66
2024-04-23T22:27:22,460  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66
2024-04-23T22:27:22,475  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:27:22,475  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,475  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:22,475  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936442, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, numFilesErasureCoded=0, rawDataSize=0, totalSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:22,481  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:27:22,494  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,494  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=17}
2024-04-23T22:27:22,494  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66); Time taken: 0.019 seconds
2024-04-23T22:27:22,494  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_6be87982-7b01-43f6-8780-9def010d0c66
2024-04-23T22:27:22,498  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:27:22,504  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,505  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:27:22,505  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `aci/d_u/ami`
2024-04-23T22:27:22,505  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281): drop table if exists `aci/d_u/ami`
2024-04-23T22:27:22,508  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:27:22,508  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:27:22,509  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,529  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,530  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,530  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,530  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,530  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=20, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:22,530  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281); Time taken: 0.025 seconds
2024-04-23T22:27:22,530  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281
2024-04-23T22:27:22,531  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281
2024-04-23T22:27:22,552  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:27:22,552  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:22,552  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281): drop table if exists `aci/d_u/ami`
2024-04-23T22:27:22,552  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,558  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,685  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/aci-47-d_u-47-ami does not exist; Force to delete it.
2024-04-23T22:27:22,686 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/aci-47-d_u-47-ami
2024-04-23T22:27:22,686  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,686  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=127}
2024-04-23T22:27:22,686  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281); Time taken: 0.134 seconds
2024-04-23T22:27:22,686  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_f84e6081-faa7-40f3-a4ff-3d72c8166281
2024-04-23T22:27:22,692  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T22:27:22,699  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,699  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:27:22,700  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists `src/name`
2024-04-23T22:27:22,700  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa): drop table if exists `src/name`
2024-04-23T22:27:22,702  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:27:22,702  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:27:22,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:27:22,725  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,725  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,725  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,725  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,725  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=22, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:27:22,725  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa); Time taken: 0.025 seconds
2024-04-23T22:27:22,725  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa
2024-04-23T22:27:22,726  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa
2024-04-23T22:27:22,741  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:27:22,741  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:22,741  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa): drop table if exists `src/name`
2024-04-23T22:27:22,742  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:27:22,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:27:22,759  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.src/name	
2024-04-23T22:27:22,791  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/src-47-name does not exist; Force to delete it.
2024-04-23T22:27:22,791 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/src-47-name
2024-04-23T22:27:22,792  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,792  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=41, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T22:27:22,792  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa); Time taken: 0.051 seconds
2024-04-23T22:27:22,792  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_dab834f3-f711-4faf-a439-cdea6c54a3fa
2024-04-23T22:27:22,796  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:27:22,802  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,802  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:27:22,803  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,803  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,805  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T22:27:22,805  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:27:22,806  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,806  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,811  INFO [main] parse.CalcitePlanner: Creating table default.aci/d_u/ami position=13
2024-04-23T22:27:22,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,813  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,813  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,813  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,813  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,813  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=1, flushCache_()=0}
2024-04-23T22:27:22,814  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647); Time taken: 0.01 seconds
2024-04-23T22:27:22,814  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647
2024-04-23T22:27:22,814  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647
2024-04-23T22:27:22,828  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:27:22,828  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,828  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647): create table `aci/d_u/ami`(i int,`d?*de e` decimal(5,2),vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:22,828  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:aci/d_u/ami, dbName:default, owner:alex, createTime:1713936442, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i, type:int, comment:null), FieldSchema(name:d?*de e, type:decimal(5,2), comment:null), FieldSchema(name:vc, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[i], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"d?*de e":"true","i":"true","vc":"true"}}, numFiles=0, transactional=true, numFilesErasureCoded=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:22,834  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/aci-47-d_u-47-ami
2024-04-23T22:27:22,865  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=36}
2024-04-23T22:27:22,866  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647); Time taken: 0.037 seconds
2024-04-23T22:27:22,866  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_5f3b3c57-eaad-48fc-aee8-53c01bad5647
2024-04-23T22:27:22,870  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:27:22,876  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,876  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:27:22,876  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-23T22:27:22,877  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9): create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-23T22:27:22,879  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T22:27:22,880  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:27:22,880  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:22,880  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:22,883  INFO [main] parse.CalcitePlanner: Creating table default.src/name position=13
2024-04-23T22:27:22,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:22,884  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:22,884  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:22,884  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:22,885  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:22,885  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2}
2024-04-23T22:27:22,885  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9); Time taken: 0.007 seconds
2024-04-23T22:27:22,885  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9
2024-04-23T22:27:22,885  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9
2024-04-23T22:27:22,903  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:27:22,903  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:22,903  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9): create table `src/name`(`g/h` int, j decimal(5,2), k varchar(128))
2024-04-23T22:27:22,903  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:22,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:src/name, dbName:default, owner:alex, createTime:1713936442, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:g/h, type:int, comment:null), FieldSchema(name:j, type:decimal(5,2), comment:null), FieldSchema(name:k, type:varchar(128), comment:null)], location:null, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"g/h":"true","j":"true","k":"true"}}, totalSize=0, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:22,909  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/src-47-name
2024-04-23T22:27:22,922  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:22,922  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=17}
2024-04-23T22:27:22,922  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9); Time taken: 0.019 seconds
2024-04-23T22:27:22,922  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222722_44ab2bcb-1619-4e3e-9b04-50982c99f4f9
2024-04-23T22:27:22,926  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:27:22,932  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:22,932  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:27:22,933  INFO [main] ql.TxnCommandsBaseForTests: Running the query: merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-23T22:27:22,933  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222722_27621685-943d-4e0f-b246-fd0e54b3c651): merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)
2024-04-23T22:27:22,937  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T22:27:22,937  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:27:22,938  INFO [main] parse.MergeSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:27:22,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,956  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,957  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.merge_tmp_table	
2024-04-23T22:27:22,960  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4ae42430-f394-4f71-aee3-eb7f32625f9b/_tmp_space.db/merge_tmp_table
2024-04-23T22:27:22,962  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <merge into `aci/d_u/ami` as `d/8` using `src/name` as `a/b` on i=`g/h`
when matched and `g/h` > 5 then delete 
when matched and `g/h` < 0 then update set vc='', `d?*de e` =  `d?*de e` * j + 1
when not matched and `d?*de e` <> 0 then insert values(`a/b`.`g/h`,`a/b`.j,`a/b`.k)> as 
<FROM
  `default`.`aci/d_u/ami` `d/8`
  RIGHT OUTER JOIN
  `default`.`src/name` `a/b`
  ON `i`=`g/h`
INSERT INTO `default`.`aci/d_u/ami`    -- delete clause
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` > 5
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- update clause(insert part)
 SELECT `d/8`.`i`, `d?*de e` * `j` + 1, ''
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
INSERT INTO `default`.`aci/d_u/ami`    -- update clause (delete part)
 SELECT `d/8`.ROW__ID 
   WHERE `i`=`g/h` AND `g/h` < 0 AND NOT(`g/h` > 5)
 SORT BY `d/8`.ROW__ID 
INSERT INTO `default`.`aci/d_u/ami`    -- insert clause
  SELECT `a/b`.`g/h`,`a/b`.`j`,`a/b`.`k`
   WHERE `d/8`.`i` IS NULL AND `d?*de e` <> 0
INSERT INTO merge_tmp_table
  SELECT cardinality_violation(`d/8`.ROW__ID)
 WHERE `i`=`g/h` GROUP BY `d/8`.ROW__ID HAVING count(*) > 1>
2024-04-23T22:27:22,964  INFO [main] parse.MergeSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:27:22,967  INFO [main] parse.MergeSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:22,968  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:22,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,974  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:27:22,983  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,983  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:22,983  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:22,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,989  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:22,996  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:22,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,002  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,008  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,008  INFO [main] parse.MergeSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:23,008  INFO [main] parse.MergeSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:23,009  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:23,009  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:23,009  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:23,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.src/name	
2024-04-23T22:27:23,076  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.aci/d_u/ami, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:27:23,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,084  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,085  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,093  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,093  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,103  WARN [main] calcite.RelOptHiveTable: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T22:27:23,103  INFO [main] SessionState: No Stats for default@aci/d_u/ami, Columns: d?*de e, i
2024-04-23T22:27:23,103  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.src/name, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T22:27:23,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:27:23,114  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.src/name	
2024-04-23T22:27:23,124  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.src/name	
2024-04-23T22:27:23,136  WARN [main] calcite.RelOptHiveTable: No Stats for default@src/name, Columns: k, g/h, j
No Stats for default@src/name, Columns: k, g/h, j
2024-04-23T22:27:23,136  INFO [main] SessionState: No Stats for default@src/name, Columns: k, g/h, j
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:23,295  INFO [main] parse.MergeSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:23,296  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,302  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,308  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,316  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.aci/d_u/ami	
2024-04-23T22:27:23,322  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,327 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1097) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:27:23,328 ERROR [main] parse.MergeSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:27:23,328  INFO [main] parse.MergeSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:27:23,328 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyzeMerge(MergeSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.MergeSemanticAnalyzer.analyze(MergeSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testQuotedIdentifier2(TestTxnCommands.java:1097)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:27:23,329  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,329  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getTableColumnStatistics_(String, String, List, String)=57, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, getTable_(GetTableRequest)=83, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=31, flushCache_()=0, createTable_(Table)=2}
2024-04-23T22:27:23,329  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222722_27621685-943d-4e0f-b246-fd0e54b3c651); Time taken: 0.395 seconds
2024-04-23T22:27:23,329  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:27:23,332  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,339  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:23,339  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4ae42430-f394-4f71-aee3-eb7f32625f9b/hive_2024-04-23_22-27-22_962_6384699312819302009-1
2024-04-23T22:27:23,339  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41): drop table if exists acidTbl
2024-04-23T22:27:23,341  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 11
2024-04-23T22:27:23,342  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:27:23,342  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:23,349  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,350  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,350  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,350  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, rollbackTxn_(long)=9}
2024-04-23T22:27:23,350  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41); Time taken: 0.011 seconds
2024-04-23T22:27:23,351  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41
2024-04-23T22:27:23,351  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41
2024-04-23T22:27:23,373  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:27:23,373  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:23,373  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41): drop table if exists acidTbl
2024-04-23T22:27:23,373  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,374  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:23,383  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:23,392  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:23,494  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:23,494  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=111, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:23,495  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41); Time taken: 0.121 seconds
2024-04-23T22:27:23,495  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_b778dc67-68ef-4f3c-b4ba-53c7f69f4a41
2024-04-23T22:27:23,498  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:27:23,504  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,505  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:27:23,506  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:23,506  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21): drop table if exists acidTblPart
2024-04-23T22:27:23,515  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 14
2024-04-23T22:27:23,515  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:27:23,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:23,523  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,523  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,523  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,524  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,524  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=8, getTable_(GetTableRequest)=6, getValidTxns_(long)=2}
2024-04-23T22:27:23,524  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21); Time taken: 0.018 seconds
2024-04-23T22:27:23,524  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21
2024-04-23T22:27:23,525  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21
2024-04-23T22:27:23,539  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:27:23,539  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:23,539  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21): drop table if exists acidTblPart
2024-04-23T22:27:23,539  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:23,545  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,545  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:23,551  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:23,586  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:23,586  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=41, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T22:27:23,586  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21); Time taken: 0.047 seconds
2024-04-23T22:27:23,586  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_8b5c3e1f-def6-45fb-a1db-417a13648d21
2024-04-23T22:27:23,590  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:27:23,596  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,596  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:27:23,596  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:23,597  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_487929c8-bd43-4dad-8fc1-ce6952a683b2): drop table if exists acidTbl2
2024-04-23T22:27:23,599  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 14
2024-04-23T22:27:23,599  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:27:23,600  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,600  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,600  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,600  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:23,600  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_487929c8-bd43-4dad-8fc1-ce6952a683b2); Time taken: 0.003 seconds
2024-04-23T22:27:23,600  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222723_487929c8-bd43-4dad-8fc1-ce6952a683b2
2024-04-23T22:27:23,600  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:23,601  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_487929c8-bd43-4dad-8fc1-ce6952a683b2): drop table if exists acidTbl2
2024-04-23T22:27:23,601  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,601  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:27:23,601  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:23,601  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:23,602  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_487929c8-bd43-4dad-8fc1-ce6952a683b2); Time taken: 0.001 seconds
2024-04-23T22:27:23,602  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_487929c8-bd43-4dad-8fc1-ce6952a683b2
2024-04-23T22:27:23,607  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:27:23,612  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,612  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:27:23,613  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:23,613  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:23,615  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 14
2024-04-23T22:27:23,615  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:27:23,616  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:23,635  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,635  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,635  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,636  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,636  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getTable_(GetTableRequest)=19, openTxn_(String, TxnType)=2}
2024-04-23T22:27:23,636  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292); Time taken: 0.022 seconds
2024-04-23T22:27:23,636  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292
2024-04-23T22:27:23,637  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292
2024-04-23T22:27:23,651  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:27:23,651  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:23,651  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:23,651  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:23,659  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:23,667  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,667  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:23,715  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:23,715  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=56}
2024-04-23T22:27:23,715  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292); Time taken: 0.064 seconds
2024-04-23T22:27:23,716  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_e9b09efd-99e2-4d11-b823-d5747632a292
2024-04-23T22:27:23,719  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:27:23,725  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,725  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:27:23,726  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:23,726  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:23,728  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 15
2024-04-23T22:27:23,728  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T22:27:23,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:23,737  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,737  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,737  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,737  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,737  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:27:23,737  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e); Time taken: 0.011 seconds
2024-04-23T22:27:23,738  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e
2024-04-23T22:27:23,738  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e
2024-04-23T22:27:23,752  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T22:27:23,752  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:23,752  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:23,752  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,752  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:23,759  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:23,767  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,767  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:23,794  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:23,794  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=34, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:27:23,794  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e); Time taken: 0.042 seconds
2024-04-23T22:27:23,794  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_6e879b10-e96d-4fdd-9327-e26a4a59d49e
2024-04-23T22:27:23,798  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T22:27:23,803  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,804  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T22:27:23,804  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:23,804  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d): drop table if exists nonAcidNonBucket
2024-04-23T22:27:23,806  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 16
2024-04-23T22:27:23,806  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T22:27:23,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:23,814  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,814  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,815  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,815  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,815  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=1}
2024-04-23T22:27:23,815  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d); Time taken: 0.011 seconds
2024-04-23T22:27:23,815  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d
2024-04-23T22:27:23,816  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d
2024-04-23T22:27:23,831  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T22:27:23,831  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:23,831  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d): drop table if exists nonAcidNonBucket
2024-04-23T22:27:23,831  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,831  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:23,839  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:23,846  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:23,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:23,874  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:23,874  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=35, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:23,875  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d); Time taken: 0.043 seconds
2024-04-23T22:27:23,875  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_ff40776c-174b-4ebf-b3a4-62c0e06f153d
2024-04-23T22:27:23,878  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T22:27:23,884  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,884  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T22:27:23,885  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testDelete" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.495">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where b = 4 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:27:23,941  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:27:23,942  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:27:23,943  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7
2024-04-23T22:27:23,946  INFO [main] SessionState: Hive Session ID = 726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:23,946  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:23,952  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7
2024-04-23T22:27:23,955  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7
2024-04-23T22:27:23,957  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/_tmp_space.db
2024-04-23T22:27:23,957  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7, clientType=HIVECLI]
2024-04-23T22:27:23,958  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:23,958  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_bf7b8570-7f4f-4c50-8cae-329d6c62554c): drop table if exists acidTbl
2024-04-23T22:27:23,965  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:27:23,966  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:27:23,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:23,974  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,974  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,974  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,974  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=8, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=9}
2024-04-23T22:27:23,975  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_bf7b8570-7f4f-4c50-8cae-329d6c62554c); Time taken: 0.016 seconds
2024-04-23T22:27:23,975  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222723_bf7b8570-7f4f-4c50-8cae-329d6c62554c
2024-04-23T22:27:23,975  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:23,975  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_bf7b8570-7f4f-4c50-8cae-329d6c62554c): drop table if exists acidTbl
2024-04-23T22:27:23,975  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,975  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:23,978  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:23,978  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:23,978  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_bf7b8570-7f4f-4c50-8cae-329d6c62554c); Time taken: 0.003 seconds
2024-04-23T22:27:23,978  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_bf7b8570-7f4f-4c50-8cae-329d6c62554c
2024-04-23T22:27:23,984  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:27:23,990  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:23,990  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:27:23,991  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:23,991  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222723_c24ea3b9-53bb-40fa-98fd-52ec3e3d2d4e): drop table if exists acidTblPart
2024-04-23T22:27:23,993  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:27:23,993  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:27:23,994  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:23,996  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:23,996  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:23,996  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:23,996  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:23,997  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222723_c24ea3b9-53bb-40fa-98fd-52ec3e3d2d4e); Time taken: 0.005 seconds
2024-04-23T22:27:23,997  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222723_c24ea3b9-53bb-40fa-98fd-52ec3e3d2d4e
2024-04-23T22:27:23,997  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:23,997  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222723_c24ea3b9-53bb-40fa-98fd-52ec3e3d2d4e): drop table if exists acidTblPart
2024-04-23T22:27:23,997  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:23,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:24,000  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,000  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:24,000  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222723_c24ea3b9-53bb-40fa-98fd-52ec3e3d2d4e); Time taken: 0.003 seconds
2024-04-23T22:27:24,000  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222723_c24ea3b9-53bb-40fa-98fd-52ec3e3d2d4e
2024-04-23T22:27:24,006  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:27:24,012  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,012  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:27:24,012  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:24,013  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_d58d8922-6a07-4b76-84c9-fd5329b808bf): drop table if exists acidTbl2
2024-04-23T22:27:24,015  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:27:24,015  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:27:24,015  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:24,018  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,018  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,018  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,018  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:24,018  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_d58d8922-6a07-4b76-84c9-fd5329b808bf); Time taken: 0.005 seconds
2024-04-23T22:27:24,019  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222724_d58d8922-6a07-4b76-84c9-fd5329b808bf
2024-04-23T22:27:24,019  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:24,019  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_d58d8922-6a07-4b76-84c9-fd5329b808bf): drop table if exists acidTbl2
2024-04-23T22:27:24,019  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:24,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,022  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:24,022  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_d58d8922-6a07-4b76-84c9-fd5329b808bf); Time taken: 0.003 seconds
2024-04-23T22:27:24,022  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_d58d8922-6a07-4b76-84c9-fd5329b808bf
2024-04-23T22:27:24,028  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:27:24,034  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:27:24,035  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:24,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_182c402e-c232-4e2e-8ef2-079dc4bfe06c): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:24,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:27:24,037  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:27:24,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:24,040  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,041  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,041  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,041  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:27:24,041  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_182c402e-c232-4e2e-8ef2-079dc4bfe06c); Time taken: 0.006 seconds
2024-04-23T22:27:24,041  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222724_182c402e-c232-4e2e-8ef2-079dc4bfe06c
2024-04-23T22:27:24,041  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:24,041  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_182c402e-c232-4e2e-8ef2-079dc4bfe06c): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:24,041  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,041  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:24,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,044  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:24,044  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_182c402e-c232-4e2e-8ef2-079dc4bfe06c); Time taken: 0.003 seconds
2024-04-23T22:27:24,044  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_182c402e-c232-4e2e-8ef2-079dc4bfe06c
2024-04-23T22:27:24,050  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:27:24,056  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,056  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:27:24,056  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:24,056  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_98dbddf0-c3ae-485b-8be1-e391cab633d7): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:24,058  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:27:24,059  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:27:24,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:24,062  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,062  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:27:24,062  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_98dbddf0-c3ae-485b-8be1-e391cab633d7); Time taken: 0.006 seconds
2024-04-23T22:27:24,062  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222724_98dbddf0-c3ae-485b-8be1-e391cab633d7
2024-04-23T22:27:24,062  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:24,062  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_98dbddf0-c3ae-485b-8be1-e391cab633d7): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:24,062  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,062  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:24,065  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:24,065  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_98dbddf0-c3ae-485b-8be1-e391cab633d7); Time taken: 0.003 seconds
2024-04-23T22:27:24,065  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_98dbddf0-c3ae-485b-8be1-e391cab633d7
2024-04-23T22:27:24,071  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:27:24,077  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,077  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:27:24,077  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:24,077  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_090a1bbb-5b59-4c08-b90e-4276d11f10bc): drop table if exists nonAcidNonBucket
2024-04-23T22:27:24,079  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:27:24,080  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:27:24,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:24,083  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,083  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,083  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,083  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:27:24,083  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_090a1bbb-5b59-4c08-b90e-4276d11f10bc); Time taken: 0.006 seconds
2024-04-23T22:27:24,084  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222724_090a1bbb-5b59-4c08-b90e-4276d11f10bc
2024-04-23T22:27:24,084  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:24,084  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_090a1bbb-5b59-4c08-b90e-4276d11f10bc): drop table if exists nonAcidNonBucket
2024-04-23T22:27:24,084  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,084  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:24,086  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,087  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:24,087  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_090a1bbb-5b59-4c08-b90e-4276d11f10bc); Time taken: 0.002 seconds
2024-04-23T22:27:24,087  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_090a1bbb-5b59-4c08-b90e-4276d11f10bc
2024-04-23T22:27:24,092  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:27:24,098  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,098  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:27:24,099  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,099  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,101  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:27:24,101  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:27:24,102  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:24,102  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:24,107  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:27:24,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:24,109  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:24,109  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,109  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,109  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,109  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:27:24,109  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3); Time taken: 0.01 seconds
2024-04-23T22:27:24,109  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3
2024-04-23T22:27:24,110  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3
2024-04-23T22:27:24,128  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:27:24,128  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:24,128  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,128  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936444, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, totalSize=0, bucketing_version=2, numRows=0, numFiles=0, transactional=true, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:24,134  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:24,167  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,167  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=38}
2024-04-23T22:27:24,167  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3); Time taken: 0.039 seconds
2024-04-23T22:27:24,168  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_f80a6b81-627a-42cb-9e6b-80cf348f18b3
2024-04-23T22:27:24,171  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:27:24,178  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,178  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:27:24,179  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,179  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,181  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:27:24,182  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:27:24,182  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:24,182  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:24,185  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:27:24,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:24,187  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:24,187  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,187  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,187  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,187  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2}
2024-04-23T22:27:24,187  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9); Time taken: 0.008 seconds
2024-04-23T22:27:24,188  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9
2024-04-23T22:27:24,188  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9
2024-04-23T22:27:24,203  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:27:24,203  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:24,203  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,203  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,204  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936444, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:24,209  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:27:24,227  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,227  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=23}
2024-04-23T22:27:24,227  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9); Time taken: 0.024 seconds
2024-04-23T22:27:24,228  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_d61e4ad7-d2a9-4d05-9281-9c42d24e3ed9
2024-04-23T22:27:24,232  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:27:24,240  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,240  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:27:24,255  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,255  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,258  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:27:24,258  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:27:24,259  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:24,259  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:24,261  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:27:24,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:24,263  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:24,263  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,263  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,263  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,263  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=27, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:24,263  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5); Time taken: 0.008 seconds
2024-04-23T22:27:24,264  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5
2024-04-23T22:27:24,264  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5
2024-04-23T22:27:24,281  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:27:24,281  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:24,281  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,281  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936444, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numRows=0, numFilesErasureCoded=0, bucketing_version=2, rawDataSize=0, transactional=false, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:24,287  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:27:24,300  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,300  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T22:27:24,300  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5); Time taken: 0.019 seconds
2024-04-23T22:27:24,301  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_b8122a8e-79d4-41c1-ba39-f777c3a0d8b5
2024-04-23T22:27:24,305  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:27:24,311  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,311  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:27:24,311  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,312  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,314  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:27:24,314  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:27:24,315  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:24,315  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:24,317  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:27:24,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:24,319  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:24,319  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,319  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,319  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,319  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-23T22:27:24,320  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b); Time taken: 0.007 seconds
2024-04-23T22:27:24,320  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b
2024-04-23T22:27:24,320  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b
2024-04-23T22:27:24,337  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:27:24,337  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:24,337  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,338  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,339  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936444, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, numFilesErasureCoded=0, totalSize=0, numFiles=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:24,344  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:27:24,359  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,359  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T22:27:24,360  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b); Time taken: 0.022 seconds
2024-04-23T22:27:24,360  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_c46daac4-4d8b-4fe5-a779-1f2a2d39e75b
2024-04-23T22:27:24,364  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:27:24,372  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:27:24,373  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,373  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,376  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:27:24,377  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:27:24,377  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:24,377  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:24,380  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:27:24,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:24,382  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:24,382  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,382  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,382  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,382  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T22:27:24,382  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3); Time taken: 0.009 seconds
2024-04-23T22:27:24,382  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3
2024-04-23T22:27:24,382  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3
2024-04-23T22:27:24,398  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:27:24,398  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:24,399  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:24,399  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,400  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/_tmp_space.db/707938c6-e603-4e34-903c-4c176e0c54a6
2024-04-23T22:27:24,402  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,403  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:27:24,403  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3); Time taken: 0.004 seconds
2024-04-23T22:27:24,403  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_aaf2d987-75a3-46d7-9426-f1d31a5a14a3
2024-04-23T22:27:24,408  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:27:24,415  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,415  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:27:24,415  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,416  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,418  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:27:24,418  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:27:24,419  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:24,419  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:24,422  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:27:24,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:24,424  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:24,424  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,424  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:24,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, getDatabase_(String)=2, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:24,424  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977); Time taken: 0.009 seconds
2024-04-23T22:27:24,425  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977
2024-04-23T22:27:24,425  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977
2024-04-23T22:27:24,440  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:27:24,440  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:24,440  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:24,440  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:24,441  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936444, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, numRows=0, totalSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:24,447  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:27:24,461  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:24,461  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:24,461  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977); Time taken: 0.021 seconds
2024-04-23T22:27:24,461  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_f84c97d6-0a9d-44eb-ad96-09e4bcae3977
2024-04-23T22:27:24,466  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:27:24,472  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:24,472  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:27:24,473  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:27:24,473  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:27:24,475  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:27:24,476  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:27:24,476  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:24,476  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:24,479  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:24,500  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:24,500  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:24,500  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:24,500  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:24,500  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:24,500  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:24,507  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:24,508  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:24,508  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:24,528  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:24,641  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:24,641  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:24,641  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:24,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:24,644  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:24,644  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:24,644  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:24,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:24,651  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:24,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:24,654  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:24,665  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T22:27:24,665  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T22:27:24,666  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:24,669  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:27:24,669  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:27:24,670  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:24,671  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:24,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:24,693  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:24,693  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:24,693  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:24,693  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:24,693  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:int, comment:null), FieldSchema(name:_col1, type:int, comment:null)], properties:null)
2024-04-23T22:27:24,694  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:24,694  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=11, openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=2, getValidWriteIds_(List, String)=4, getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=40, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=48}
2024-04-23T22:27:24,694  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b); Time taken: 0.22 seconds
2024-04-23T22:27:24,694  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b
2024-04-23T22:27:24,694  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b
2024-04-23T22:27:24,720  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:27:24,720  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:24,722  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b): insert into acidTbl(a,b)  values(1,2),(3,4)
2024-04-23T22:27:24,723  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b
2024-04-23T22:27:24,723  INFO [main] ql.Driver: Query ID = alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b
Total jobs = 1
2024-04-23T22:27:24,723  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:27:24,723  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:27:24,850  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T22:27:24,850  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T22:27:24,850  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:27:24,850  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:27:24,850  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:27:24,850  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:27:24,850  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:27:24,850  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:27:24,853  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:24,853  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:24,853  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-24_473_5266419574744334733-1/dummy_path
2024-04-23T22:27:24,862  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:24,863  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:27:24,868  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:27:24,868  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:27:24,869  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:24,873  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-24_473_5266419574744334733-1/-mr-10000
2024-04-23T22:27:24,874  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:24,881  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:24,885  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:24,886  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:24,886  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:24,886  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-24_473_5266419574744334733-1/dummy_path
2024-04-23T22:27:24,886  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:24,903  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:24,922  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local435190295_0072
2024-04-23T22:27:24,922  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:24,997  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:24,997  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:24,997  INFO [Thread-6138] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:24,998  INFO [Thread-6138] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:24,999  INFO [Thread-6138] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:24,999  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local435190295_0072_m_000000_0
2024-04-23T22:27:25,002  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:25,002  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-24_473_5266419574744334733-1/dummy_path/null:0+1
2024-04-23T22:27:25,004  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:25,005  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,97KB
2024-04-23T22:27:25,005  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T22:27:25,009  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:27:25,009  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:27:25,009  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:27:25,009  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:27:25,009  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:27:25,010  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:27:25,010  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:25,011  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:25,011  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:25,011  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:25,012  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:25,012  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:25,012  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:25,012  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:27:25,012  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:27:25,012  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:27:25,012  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:25,013  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:27:25,014  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:25,014  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:25,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:27:25,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:27:25,014  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T22:27:25,016  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:25,016  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:27:25,016  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:27:25,016  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:27:25,016  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:27:25,030  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:27:25,040  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local435190295_0072_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:25,041  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:25,041  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local435190295_0072_m_000000_0' done.
2024-04-23T22:27:25,041  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local435190295_0072_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1443209
		FILE: Number of bytes written=84851698
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1301807104
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5019
2024-04-23T22:27:25,041  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local435190295_0072_m_000000_0
2024-04-23T22:27:25,041  INFO [Thread-6138] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:27:25,044  INFO [Thread-6138] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:27:25,044  INFO [pool-355-thread-1] mapred.LocalJobRunner: Starting task: attempt_local435190295_0072_r_000000_0
2024-04-23T22:27:25,049  INFO [pool-355-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:25,049  INFO [pool-355-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3b4b925f
2024-04-23T22:27:25,049  WARN [pool-355-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:25,051  INFO [pool-355-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:25,052  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local435190295_0072_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:25,057  INFO [localfetcher#97] reduce.LocalFetcher: localfetcher#97 about to shuffle output of map attempt_local435190295_0072_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:27:25,057  INFO [localfetcher#97] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local435190295_0072_m_000000_0
2024-04-23T22:27:25,058  INFO [localfetcher#97] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:27:25,058  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:25,059  INFO [pool-355-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:25,059  INFO [pool-355-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:25,069  INFO [pool-355-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:25,069  INFO [pool-355-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:27:25,075  INFO [pool-355-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:25,075  INFO [pool-355-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:27:25,075  INFO [pool-355-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:25,075  INFO [pool-355-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:25,075  INFO [pool-355-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:27:25,075  INFO [pool-355-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:25,076  INFO [pool-355-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:25,077  INFO [pool-355-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:27:25,079  INFO [pool-355-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:25,079  INFO [pool-355-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:25,079  INFO [pool-355-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:27:25,079  INFO [pool-355-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:25,079  INFO [pool-355-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local435190295_0072/job_local435190295_0072.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@51fb4968
2024-04-23T22:27:25,080  INFO [pool-355-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:25,080  INFO [pool-355-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:25,080  INFO [pool-355-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:25,081  INFO [pool-355-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:25,081  INFO [pool-355-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:25,096  INFO [pool-355-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:25,106  INFO [pool-355-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:25,106  INFO [pool-355-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:25,106  INFO [pool-355-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:25,106  INFO [pool-355-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:25,109  INFO [pool-355-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0]
2024-04-23T22:27:25,133  INFO [pool-355-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:25,134  INFO [pool-355-thread-1] mapred.Task: Task:attempt_local435190295_0072_r_000000_0 is done. And is in the process of committing
2024-04-23T22:27:25,135  INFO [pool-355-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:25,135  INFO [pool-355-thread-1] mapred.Task: Task 'attempt_local435190295_0072_r_000000_0' done.
2024-04-23T22:27:25,135  INFO [pool-355-thread-1] mapred.Task: Final Counters for attempt_local435190295_0072_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1449314
		FILE: Number of bytes written=84852737
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1301807104
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:25,135  INFO [pool-355-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local435190295_0072_r_000000_0
2024-04-23T22:27:25,135  INFO [pool-355-thread-1] mapred.LocalJobRunner: Starting task: attempt_local435190295_0072_r_000001_0
2024-04-23T22:27:25,136  INFO [pool-355-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:25,136  INFO [pool-355-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3be68621
2024-04-23T22:27:25,136  WARN [pool-355-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:25,138  INFO [pool-355-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:25,139  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local435190295_0072_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:25,143  INFO [localfetcher#98] reduce.LocalFetcher: localfetcher#98 about to shuffle output of map attempt_local435190295_0072_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:27:25,143  INFO [localfetcher#98] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local435190295_0072_m_000000_0
2024-04-23T22:27:25,143  INFO [localfetcher#98] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:27:25,144  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:25,144  INFO [pool-355-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:25,145  INFO [pool-355-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:25,154  INFO [pool-355-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:25,154  INFO [pool-355-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:27:25,160  INFO [pool-355-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:25,160  INFO [pool-355-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:27:25,160  INFO [pool-355-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:25,160  INFO [pool-355-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:25,160  INFO [pool-355-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:27:25,161  INFO [pool-355-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:25,162  INFO [pool-355-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:25,162  INFO [pool-355-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:27:25,164  INFO [pool-355-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:25,164  INFO [pool-355-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:25,164  INFO [pool-355-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:27:25,164  INFO [pool-355-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:25,165  INFO [pool-355-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local435190295_0072/job_local435190295_0072.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@130cf1ce
2024-04-23T22:27:25,166  INFO [pool-355-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:25,166  INFO [pool-355-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:25,166  INFO [pool-355-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:25,167  INFO [pool-355-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:25,167  INFO [pool-355-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:25,178  INFO [pool-355-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:25,178  INFO [pool-355-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:25,178  INFO [pool-355-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:1, 
2024-04-23T22:27:25,178  INFO [pool-355-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:25,179  INFO [pool-355-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:25,182  INFO [pool-355-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:27:25,203  INFO [pool-355-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.acidtbl:1, TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:25,204  INFO [pool-355-thread-1] mapred.Task: Task:attempt_local435190295_0072_r_000001_0 is done. And is in the process of committing
2024-04-23T22:27:25,204  INFO [pool-355-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:25,204  INFO [pool-355-thread-1] mapred.Task: Task 'attempt_local435190295_0072_r_000001_0' done.
2024-04-23T22:27:25,205  INFO [pool-355-thread-1] mapred.Task: Final Counters for attempt_local435190295_0072_r_000001_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1455395
		FILE: Number of bytes written=84853765
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1301807104
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:25,205  INFO [pool-355-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local435190295_0072_r_000001_0
2024-04-23T22:27:25,205  INFO [Thread-6138] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23T22:27:25,860  INFO [Heartbeater-0] lockmgr.DbTxnManager: Sending heartbeat for txnid:13 and lockid:0 queryId=null txnid:0
2024-04-23T22:27:25,862  INFO [Heartbeater-0] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T22:27:25,865  INFO [Heartbeater-0] metastore.HMSHandler: 11: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T22:27:25,865  INFO [Heartbeater-0] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T22:27:25,865  INFO [Heartbeater-0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1012fe82, with PersistenceManager: null will be shutdown
2024-04-23T22:27:25,866  INFO [Heartbeater-0] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1012fe82, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@648fd09d created in the thread with id: 49
2024-04-23T22:27:25,886  INFO [Heartbeater-0] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1012fe82 from thread id: 49
2024-04-23T22:27:25,886  INFO [Heartbeater-0] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T22:27:25,886  INFO [Heartbeater-0] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23 22:27:25,998 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:27:25,998  INFO [main] exec.Task: 2024-04-23 22:27:25,998 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local435190295_0072
2024-04-23T22:27:25,999  INFO [main] exec.Task: Ended Job = job_local435190295_0072
2024-04-23T22:27:26,000  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T22:27:26,000  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:27:26,000  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:27:26,000  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T22:27:26,000  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:27:26,001  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:27:26,002  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:26,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,008  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:26,008  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,014  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:26,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:27:26,047  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:26,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,053  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:26,053  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:26,054  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-24_473_5266419574744334733-1/-mr-10000
2024-04-23T22:27:26,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,061  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:26,072  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:27:26,072  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:27:26,072  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:27:26,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:27:26,094  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:27:26,094  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:27:26,094  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:27:26,096  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=2, numRows=2, totalSize=1344, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:27:26,097  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:26,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, alter_table_(String, String, String, Table, EnvironmentContext, String)=54, getTable_(GetTableRequest)=24, isCompatibleWith_(Configuration)=1}
MapReduce Jobs Launched: 
2024-04-23T22:27:26,097  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:26,097  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:26,097  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:26,097  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b); Time taken: 1.375 seconds
2024-04-23T22:27:26,097  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222724_6ff16c5d-cec6-42b8-9b0d-5d3eb5df349b
2024-04-23T22:27:26,108  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:26,109  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:27:26,109  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select a,b from acidTbl order by a,b
2024-04-23T22:27:26,109  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-24_473_5266419574744334733-1
2024-04-23T22:27:26,110  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-24_473_5266419574744334733-1 on fs with scheme file
2024-04-23T22:27:26,110  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197): select a,b from acidTbl order by a,b
2024-04-23T22:27:26,112  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:27:26,113  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:27:26,113  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:26,113  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:26,116  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:26,116  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:26,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,122  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:26,123  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:26,123  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:26,123  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:26,134  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,158  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0, 1], allowMissingStats: true
2024-04-23T22:27:26,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,167  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:26,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:26,176  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:26,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:27:26,190  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b, a
No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:27:26,190  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b, a
2024-04-23T22:27:26,233  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:26,233  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:26,233  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:26,235  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-26_110_5501816743029389109-1/-mr-10001/.hive-staging_hive_2024-04-23_22-27-26_110_5501816743029389109-1
2024-04-23T22:27:26,244  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:26,246  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:27:26,247  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T22:27:26,248  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:26,258  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:26,258  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:26,258  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:26,258  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T22:27:26,259  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T22:27:26,259  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:26,259  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=5, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTableColumnStatistics_(String, String, List, String)=30, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:26,259  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197); Time taken: 0.149 seconds
2024-04-23T22:27:26,260  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197
2024-04-23T22:27:26,260  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197
2024-04-23T22:27:26,280  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:27:26,280  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:26,280  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197): select a,b from acidTbl order by a,b
2024-04-23T22:27:26,281  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197
2024-04-23T22:27:26,281  INFO [main] ql.Driver: Query ID = alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197
Total jobs = 1
2024-04-23T22:27:26,281  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:27:26,281  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:27:26,415  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:27:26,415  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:27:26,416  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:27:26,416  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:27:26,416  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:27:26,416  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:27:26,416  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:27:26,416  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:27:26,418  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:26,418  INFO [main] exec.Utilities: Processing alias acidtbl
2024-04-23T22:27:26,418  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:26,428  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:26,429  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:27:26,434  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:27:26,435  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:27:26,436  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:26,441  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:26,449  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:26,453  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:26,455  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T22:27:26,455  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T22:27:26,455  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:26,455  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T22:27:26,455  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.acidtbl:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T22:27:26,455  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T22:27:26,467  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T22:27:26,467  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 12 ms
2024-04-23T22:27:26,467  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T22:27:26,486  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T22:27:26,505  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1973913301_0073
2024-04-23T22:27:26,505  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:26,568  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:26,568  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:26,569  INFO [Thread-6215] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:26,569  INFO [Thread-6215] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:26,570  INFO [Thread-6215] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:26,570  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1973913301_0073_m_000000_0
2024-04-23T22:27:26,571  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:26,571  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:27:26,572  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:26,572  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:27:26,574  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:27:26,574  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with {include: [true, true, true], offset: 0, length: 673, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:27:26,575  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:27:26,575  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:27:26,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:27:26,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:27:26,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:27:26,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:27:26,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:27:26,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:27:26,580  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:26,582  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:27:26,583  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:1, 
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:27:26,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:27:26,585  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:27:26,585  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:27:26,596  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:27:26,599  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1973913301_0073_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:26,599  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0, start=0, length=673, isOriginal=false, fileLength=673, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:27:26,599  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1973913301_0073_m_000000_0' done.
2024-04-23T22:27:26,599  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1973913301_0073_m_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1464574
		FILE: Number of bytes written=86030926
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1301807104
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7474
2024-04-23T22:27:26,599  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1973913301_0073_m_000000_0
2024-04-23T22:27:26,600  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1973913301_0073_m_000001_0
2024-04-23T22:27:26,600  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:26,600  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:27:26,601  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:26,601  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,65KB
2024-04-23T22:27:26,603  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T22:27:26,603  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0 with {include: [true, true, true], offset: 0, length: 671, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T22:27:26,604  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T22:27:26,604  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:27:26,622  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:27:26,622  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:27:26,622  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:27:26,622  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:27:26,622  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:27:26,623  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:27:26,623  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:26,624  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:26,625  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:26,625  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:26,625  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int>
2024-04-23T22:27:26,625  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T22:27:26,625  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 1. abort - false
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:1, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 1. abort - false
2024-04-23T22:27:26,626  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:27:26,627  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:26,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:27:26,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:27:26,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 19; bufvoid = 104857600
2024-04-23T22:27:26,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:27:26,635  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:27:26,637  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1973913301_0073_m_000001_0 is done. And is in the process of committing
2024-04-23T22:27:26,638  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00000_0, start=0, length=671, isOriginal=false, fileLength=671, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T22:27:26,638  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1973913301_0073_m_000001_0' done.
2024-04-23T22:27:26,638  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1973913301_0073_m_000001_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=1473053
		FILE: Number of bytes written=86030985
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=1
		Map output bytes=19
		Map output materialized bytes=27
		Input split bytes=495
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=12
		Total committed heap usage (bytes)=1303379968
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=1
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_TS_0=1
	File Input Format Counters 
		Bytes Read=7466
2024-04-23T22:27:26,638  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1973913301_0073_m_000001_0
2024-04-23T22:27:26,638  INFO [Thread-6215] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:27:26,639  INFO [Thread-6215] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:27:26,639  INFO [pool-361-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1973913301_0073_r_000000_0
2024-04-23T22:27:26,640  INFO [pool-361-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:26,640  INFO [pool-361-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3cc474a5
2024-04-23T22:27:26,640  WARN [pool-361-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:26,640  INFO [pool-361-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:26,641  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1973913301_0073_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:26,642  INFO [localfetcher#99] reduce.LocalFetcher: localfetcher#99 about to shuffle output of map attempt_local1973913301_0073_m_000001_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:27:26,642  INFO [localfetcher#99] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1973913301_0073_m_000001_0
2024-04-23T22:27:26,642  INFO [localfetcher#99] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->23
2024-04-23T22:27:26,645  INFO [localfetcher#99] reduce.LocalFetcher: localfetcher#99 about to shuffle output of map attempt_local1973913301_0073_m_000000_0 decomp: 23 len: 27 to MEMORY
2024-04-23T22:27:26,645  INFO [localfetcher#99] reduce.InMemoryMapOutput: Read 23 bytes from map-output for attempt_local1973913301_0073_m_000000_0
2024-04-23T22:27:26,645  INFO [localfetcher#99] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 23, inMemoryMapOutputs.size() -> 2, commitMemory -> 23, usedMemory ->46
2024-04-23T22:27:26,645  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:26,646  INFO [pool-361-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:27:26,646  INFO [pool-361-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:26,652  INFO [pool-361-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T22:27:26,652  INFO [pool-361-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 12 bytes
2024-04-23T22:27:26,655  INFO [pool-361-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 46 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:26,655  INFO [pool-361-thread-1] reduce.MergeManagerImpl: Merging 1 files, 48 bytes from disk
2024-04-23T22:27:26,655  INFO [pool-361-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:26,655  INFO [pool-361-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:26,655  INFO [pool-361-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 27 bytes
2024-04-23T22:27:26,655  INFO [pool-361-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T22:27:26,655  INFO [pool-361-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:26,656  INFO [pool-361-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,59KB
2024-04-23T22:27:26,657  INFO [pool-361-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:26,657  INFO [pool-361-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:26,657  INFO [pool-361-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int>,value:struct<>>
2024-04-23T22:27:26,657  INFO [pool-361-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T22:27:26,657  INFO [pool-361-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@7a9ff957, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@523e019c>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1cdbab9, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1] : [int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@f1766e2
2024-04-23T22:27:26,657  INFO [pool-361-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-26_110_5501816743029389109-1/-mr-10001/.hive-staging_hive_2024-04-23_22-27-26_110_5501816743029389109-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:26,658  INFO [pool-361-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-26_110_5501816743029389109-1/-mr-10001/.hive-staging_hive_2024-04-23_22-27-26_110_5501816743029389109-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T22:27:26,658  INFO [pool-361-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-26_110_5501816743029389109-1/-mr-10001/.hive-staging_hive_2024-04-23_22-27-26_110_5501816743029389109-1/_tmp.-ext-10002/000000_0
2024-04-23T22:27:26,665  INFO [pool-361-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T22:27:26,665  INFO [pool-361-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:26,665  INFO [pool-361-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:26,665  INFO [pool-361-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T22:27:26,665  INFO [pool-361-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T22:27:26,665  INFO [pool-361-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:26,666  INFO [pool-361-thread-1] mapred.Task: Task:attempt_local1973913301_0073_r_000000_0 is done. And is in the process of committing
2024-04-23T22:27:26,666  INFO [pool-361-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:26,666  INFO [pool-361-thread-1] mapred.Task: Task 'attempt_local1973913301_0073_r_000000_0' done.
2024-04-23T22:27:26,666  INFO [pool-361-thread-1] mapred.Task: Final Counters for attempt_local1973913301_0073_r_000000_0: Counters: 34
	File System Counters
		FILE: Number of bytes read=1478866
		FILE: Number of bytes written=86031164
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=54
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1303379968
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:26,666  INFO [pool-361-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1973913301_0073_r_000000_0
2024-04-23T22:27:26,666  INFO [Thread-6215] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:27:27,571 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:27:27,571  INFO [main] exec.Task: 2024-04-23 22:27:27,571 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1973913301_0073
2024-04-23T22:27:27,573  INFO [main] exec.Task: Ended Job = job_local1973913301_0073
2024-04-23T22:27:27,576  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:27,576  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T22:27:27,576  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:27,576  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:27,576  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:27,576  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197); Time taken: 1.295 seconds
2024-04-23T22:27:27,576  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222726_9d956839-9f29-4cad-a4ae-e909d68a6197
2024-04-23T22:27:27,581  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:27:27,588  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:27,588  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:27:27,593  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T22:27:27,593  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T22:27:27,593  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-23T22:27:27,593  INFO [main] ql.TxnCommandsBaseForTests: Running the query: START TRANSACTION
2024-04-23T22:27:27,594  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-26_110_5501816743029389109-1
2024-04-23T22:27:27,595  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/726ff43c-1e48-4cf7-a18b-7fd77a3f2cd7/hive_2024-04-23_22-27-26_110_5501816743029389109-1 on fs with scheme file
2024-04-23T22:27:27,595  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222727_ca35be37-48f2-4a00-a1c0-d7b199702990): START TRANSACTION
2024-04-23T22:27:27,597  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:27:27,597  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:27:27,598  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:27,598  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:27,598  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:27,598  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:27,598  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:27,598  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:27,598  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=0}
2024-04-23T22:27:27,598  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222727_ca35be37-48f2-4a00-a1c0-d7b199702990); Time taken: 0.003 seconds
2024-04-23T22:27:27,599  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222727_ca35be37-48f2-4a00-a1c0-d7b199702990
2024-04-23T22:27:27,599  INFO [main] ql.Driver: Operation START_TRANSACTION obtained 0 locks
2024-04-23T22:27:27,599  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222727_ca35be37-48f2-4a00-a1c0-d7b199702990): START TRANSACTION
2024-04-23T22:27:27,599  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:27,599  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T22:27:27,599  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222727_ca35be37-48f2-4a00-a1c0-d7b199702990); Time taken: 0.0 seconds
2024-04-23T22:27:27,599  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where b = 4
2024-04-23T22:27:27,599  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222727_887ec045-55d1-4fc4-a366-f55ab5f6c35e): delete from acidTbl where b = 4
2024-04-23T22:27:27,600  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:27:27,600  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:27,607  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,607  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where b = 4> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:27:27,607  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:27:27,610  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:27,610  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:27,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:27,618  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,619  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:27,619  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:27,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:27,625  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,626  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:27,626  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:27,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:27,663  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [1], allowMissingStats: true
2024-04-23T22:27:27,664  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:27,673  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,674  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:27,684  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:27:27,693  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: b
No Stats for default@acidtbl, Columns: b
2024-04-23T22:27:27,693  INFO [main] SessionState: No Stats for default@acidtbl, Columns: b
2024-04-23T22:27:27,750  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:27,750  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:27,750  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:27,750  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:27,757  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,759 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:27:27,761 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:27:27,761  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:27:27,761 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDelete(TestTxnCommands.java:840)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:27:27,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:27,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, flushCache_()=0, getTableColumnStatistics_(String, String, List, String)=29, getTable_(GetTableRequest)=28}
2024-04-23T22:27:27,762  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222727_887ec045-55d1-4fc4-a366-f55ab5f6c35e); Time taken: 0.163 seconds
2024-04-23T22:27:27,762  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222727_ca35be37-48f2-4a00-a1c0-d7b199702990
2024-04-23T22:27:27,766  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:27,773  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:27,774  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2): drop table if exists acidTbl
2024-04-23T22:27:27,777  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T22:27:27,777  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:27:27,778  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:27,784  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,784  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:27,784  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:27,784  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:27,784  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, rollbackTxn_(long)=11, flushCache_()=0}
2024-04-23T22:27:27,785  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2); Time taken: 0.01 seconds
2024-04-23T22:27:27,785  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2
2024-04-23T22:27:27,785  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2
2024-04-23T22:27:27,801  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:27:27,801  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:27,801  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2): drop table if exists acidTbl
2024-04-23T22:27:27,802  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:27,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:27,808  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:27,815  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,815  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:27,909  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:27,909  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=101}
2024-04-23T22:27:27,909  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2); Time taken: 0.108 seconds
2024-04-23T22:27:27,910  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222727_bd8b1425-4706-4657-83ec-1338155811c2
2024-04-23T22:27:27,913  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:27:27,919  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:27,919  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:27:27,920  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:27,920  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5): drop table if exists acidTblPart
2024-04-23T22:27:27,922  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T22:27:27,922  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:27:27,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:27,933  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,933  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:27,933  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:27,933  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:27,933  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=10, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:27,934  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5); Time taken: 0.013 seconds
2024-04-23T22:27:27,934  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5
2024-04-23T22:27:27,934  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5
2024-04-23T22:27:27,955  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:27:27,955  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:27,955  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5): drop table if exists acidTblPart
2024-04-23T22:27:27,955  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:27,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:27,961  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,961  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:27,967  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:27,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:28,005  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:28,005  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=44, getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:28,005  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5); Time taken: 0.05 seconds
2024-04-23T22:27:28,005  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222727_884c8316-2c65-4fda-b954-727883a18ad5
2024-04-23T22:27:28,009  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:27:28,015  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:28,016  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:27:28,016  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:28,016  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222728_e11ad9c9-a6fa-4c90-ba59-54e4f8e66936): drop table if exists acidTbl2
2024-04-23T22:27:28,018  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T22:27:28,019  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:27:28,019  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:28,019  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:28,019  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:28,020  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:27:28,020  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222728_e11ad9c9-a6fa-4c90-ba59-54e4f8e66936); Time taken: 0.003 seconds
2024-04-23T22:27:28,020  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222728_e11ad9c9-a6fa-4c90-ba59-54e4f8e66936
2024-04-23T22:27:28,020  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:28,020  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222728_e11ad9c9-a6fa-4c90-ba59-54e4f8e66936): drop table if exists acidTbl2
2024-04-23T22:27:28,020  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:28,021  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:27:28,021  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:28,021  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=1}
2024-04-23T22:27:28,021  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222728_e11ad9c9-a6fa-4c90-ba59-54e4f8e66936); Time taken: 0.001 seconds
2024-04-23T22:27:28,021  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222728_e11ad9c9-a6fa-4c90-ba59-54e4f8e66936
2024-04-23T22:27:28,027  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:27:28,033  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:28,033  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:27:28,034  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:28,034  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:28,036  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T22:27:28,036  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:27:28,037  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:28,058  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,058  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:28,059  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:28,059  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:28,059  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=21, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2}
2024-04-23T22:27:28,059  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16); Time taken: 0.025 seconds
2024-04-23T22:27:28,059  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16
2024-04-23T22:27:28,060  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16
2024-04-23T22:27:28,074  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:27:28,074  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:28,074  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:28,075  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:28,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:28,091  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,091  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:28,099  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:28,185  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:28,185  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=16, dropTable_(String, String, boolean, boolean, boolean)=94}
2024-04-23T22:27:28,185  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16); Time taken: 0.111 seconds
2024-04-23T22:27:28,185  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222728_f9e5249f-03d8-44e7-a363-1caf243e9a16
2024-04-23T22:27:28,190  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:27:28,196  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:28,197  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:27:28,197  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:28,197  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:28,200  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T22:27:28,200  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:27:28,200  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:28,209  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,209  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:28,209  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:28,209  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:28,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=1, getTable_(GetTableRequest)=9}
2024-04-23T22:27:28,209  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a); Time taken: 0.012 seconds
2024-04-23T22:27:28,210  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a
2024-04-23T22:27:28,210  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a
2024-04-23T22:27:28,226  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:27:28,226  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:28,226  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:28,227  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:28,227  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:28,235  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,235  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:28,243  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:28,274  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:28,275  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=39, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:28,275  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a); Time taken: 0.048 seconds
2024-04-23T22:27:28,275  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222728_84b4b4b8-7ea9-4713-af57-4c3b2f433a5a
2024-04-23T22:27:28,279  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:27:28,285  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:28,285  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:27:28,286  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:28,286  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b): drop table if exists nonAcidNonBucket
2024-04-23T22:27:28,288  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T22:27:28,289  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:27:28,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:28,298  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,298  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:28,298  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:28,298  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:28,298  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=9, getValidTxns_(long)=0}
2024-04-23T22:27:28,299  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b); Time taken: 0.012 seconds
2024-04-23T22:27:28,299  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b
2024-04-23T22:27:28,299  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b
2024-04-23T22:27:28,316  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:27:28,316  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:28,316  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b): drop table if exists nonAcidNonBucket
2024-04-23T22:27:28,316  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:28,316  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:28,324  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:28,332  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:28,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:28,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:28,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=37}
2024-04-23T22:27:28,362  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b); Time taken: 0.045 seconds
2024-04-23T22:27:28,362  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222728_93056bff-6bdb-4f2f-b618-8facffb0ab8b
2024-04-23T22:27:28,366  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:27:28,373  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:28,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:27:28,374  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testErrors" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="5.653"/>
  <testcase name="testMoreBucketsThanReducers" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.57">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: update acidTbl set b = -1 failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMoreBucketsThanReducers(TestTxnCommands.java:1429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:27:34,092  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:27:34,092  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:27:34,092  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:27:34,092  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:27:34,092  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:27:34,092  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:27:34,093  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:27:34,093  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:27:34,093  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:27:34,093  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:27:34,093  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:27:34,095  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 47f0ca3c-cea9-4e1d-8ade-661fff861281
2024-04-23T22:27:34,097  INFO [main] SessionState: Hive Session ID = 47f0ca3c-cea9-4e1d-8ade-661fff861281
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:34,098  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:27:34,103  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/47f0ca3c-cea9-4e1d-8ade-661fff861281
2024-04-23T22:27:34,105  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281
2024-04-23T22:27:34,108  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/47f0ca3c-cea9-4e1d-8ade-661fff861281/_tmp_space.db
2024-04-23T22:27:34,108  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=47f0ca3c-cea9-4e1d-8ade-661fff861281, clientType=HIVECLI]
2024-04-23T22:27:34,108  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:34,109  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_d4077147-ef5f-42de-ac43-45e7a5b812f5): drop table if exists acidTbl
2024-04-23T22:27:34,117  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:27:34,117  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:27:34,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:34,122  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,122  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,122  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,122  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=8, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:27:34,122  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_d4077147-ef5f-42de-ac43-45e7a5b812f5); Time taken: 0.013 seconds
2024-04-23T22:27:34,123  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222734_d4077147-ef5f-42de-ac43-45e7a5b812f5
2024-04-23T22:27:34,123  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:34,123  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_d4077147-ef5f-42de-ac43-45e7a5b812f5): drop table if exists acidTbl
2024-04-23T22:27:34,123  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:34,126  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,126  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,126  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_d4077147-ef5f-42de-ac43-45e7a5b812f5); Time taken: 0.003 seconds
2024-04-23T22:27:34,126  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_d4077147-ef5f-42de-ac43-45e7a5b812f5
2024-04-23T22:27:34,132  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:27:34,138  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,139  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:27:34,139  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:34,139  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_f15a0054-17da-436a-b910-e974506f57cc): drop table if exists acidTblPart
2024-04-23T22:27:34,141  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:27:34,142  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:27:34,142  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:34,145  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,145  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,145  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,145  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T22:27:34,145  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_f15a0054-17da-436a-b910-e974506f57cc); Time taken: 0.006 seconds
2024-04-23T22:27:34,146  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222734_f15a0054-17da-436a-b910-e974506f57cc
2024-04-23T22:27:34,146  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:34,146  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_f15a0054-17da-436a-b910-e974506f57cc): drop table if exists acidTblPart
2024-04-23T22:27:34,146  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,146  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:34,149  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,149  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,149  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_f15a0054-17da-436a-b910-e974506f57cc); Time taken: 0.003 seconds
2024-04-23T22:27:34,149  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_f15a0054-17da-436a-b910-e974506f57cc
2024-04-23T22:27:34,155  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:27:34,162  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,162  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:27:34,162  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:34,163  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_243183a1-9076-4c08-8155-5cf2b0d9907c): drop table if exists acidTbl2
2024-04-23T22:27:34,165  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:27:34,165  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:27:34,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:34,169  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,169  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,169  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-23T22:27:34,169  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_243183a1-9076-4c08-8155-5cf2b0d9907c); Time taken: 0.007 seconds
2024-04-23T22:27:34,169  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222734_243183a1-9076-4c08-8155-5cf2b0d9907c
2024-04-23T22:27:34,169  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:34,169  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_243183a1-9076-4c08-8155-5cf2b0d9907c): drop table if exists acidTbl2
2024-04-23T22:27:34,170  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,170  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:27:34,173  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,173  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,173  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_243183a1-9076-4c08-8155-5cf2b0d9907c); Time taken: 0.004 seconds
2024-04-23T22:27:34,173  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_243183a1-9076-4c08-8155-5cf2b0d9907c
2024-04-23T22:27:34,180  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:27:34,188  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,188  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:27:34,189  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:34,189  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_17a34a69-2326-4709-8d4d-e1010596c18f): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:34,192  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:27:34,193  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:27:34,193  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:34,196  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,196  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,196  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,196  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_17a34a69-2326-4709-8d4d-e1010596c18f); Time taken: 0.007 seconds
2024-04-23T22:27:34,197  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222734_17a34a69-2326-4709-8d4d-e1010596c18f
2024-04-23T22:27:34,197  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:34,197  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_17a34a69-2326-4709-8d4d-e1010596c18f): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:34,197  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,197  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:34,200  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,200  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_17a34a69-2326-4709-8d4d-e1010596c18f); Time taken: 0.002 seconds
2024-04-23T22:27:34,200  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_17a34a69-2326-4709-8d4d-e1010596c18f
2024-04-23T22:27:34,205  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:27:34,212  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,212  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:27:34,213  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:34,213  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_5d50911e-f4b7-4a32-a90c-2aa5b4d7d9e0): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:34,215  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:27:34,215  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:27:34,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:34,218  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,218  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,218  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,219  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T22:27:34,219  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_5d50911e-f4b7-4a32-a90c-2aa5b4d7d9e0); Time taken: 0.005 seconds
2024-04-23T22:27:34,219  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222734_5d50911e-f4b7-4a32-a90c-2aa5b4d7d9e0
2024-04-23T22:27:34,219  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:34,219  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_5d50911e-f4b7-4a32-a90c-2aa5b4d7d9e0): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:34,219  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:34,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,222  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_5d50911e-f4b7-4a32-a90c-2aa5b4d7d9e0); Time taken: 0.003 seconds
2024-04-23T22:27:34,222  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_5d50911e-f4b7-4a32-a90c-2aa5b4d7d9e0
2024-04-23T22:27:34,228  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:27:34,235  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,235  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:27:34,235  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:34,235  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_868782cf-01ca-47f6-b20a-c2bcefbf5e77): drop table if exists nonAcidNonBucket
2024-04-23T22:27:34,237  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:27:34,238  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:27:34,238  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:34,242  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,242  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,242  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,242  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13}
2024-04-23T22:27:34,242  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_868782cf-01ca-47f6-b20a-c2bcefbf5e77); Time taken: 0.007 seconds
2024-04-23T22:27:34,243  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222734_868782cf-01ca-47f6-b20a-c2bcefbf5e77
2024-04-23T22:27:34,243  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:34,243  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_868782cf-01ca-47f6-b20a-c2bcefbf5e77): drop table if exists nonAcidNonBucket
2024-04-23T22:27:34,243  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:34,246  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,246  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,246  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_868782cf-01ca-47f6-b20a-c2bcefbf5e77); Time taken: 0.003 seconds
2024-04-23T22:27:34,246  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_868782cf-01ca-47f6-b20a-c2bcefbf5e77
2024-04-23T22:27:34,252  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:27:34,259  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,259  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:27:34,260  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,260  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,262  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:27:34,263  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:27:34,263  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:34,263  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:34,269  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:27:34,270  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:34,271  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:34,271  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,271  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,271  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,272  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=6, getValidTxns_(long)=0, flushCache_()=1}
2024-04-23T22:27:34,272  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b); Time taken: 0.011 seconds
2024-04-23T22:27:34,272  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b
2024-04-23T22:27:34,272  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b
2024-04-23T22:27:34,294  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:27:34,294  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:34,294  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,294  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,295  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936454, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFilesErasureCoded=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, numFiles=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:34,301  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:34,337  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,338  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=42, isCompatibleWith_(Configuration)=1}
2024-04-23T22:27:34,338  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b); Time taken: 0.043 seconds
2024-04-23T22:27:34,338  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_86d37d7a-8d0c-4bc4-8821-de28c832ea0b
2024-04-23T22:27:34,356  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:27:34,363  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,363  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:27:34,364  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,364  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,367  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:27:34,367  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:27:34,368  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:34,368  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:34,370  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:27:34,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:34,373  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:34,373  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,373  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,373  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,373  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=26}
2024-04-23T22:27:34,373  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b); Time taken: 0.009 seconds
2024-04-23T22:27:34,374  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b
2024-04-23T22:27:34,374  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b
2024-04-23T22:27:34,390  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:27:34,390  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:34,390  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,391  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936454, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:27:34,397  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:27:34,416  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,416  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=25, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,416  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b); Time taken: 0.026 seconds
2024-04-23T22:27:34,416  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_3d0a3dea-b25d-4b17-b6ed-a0c9abf8bb7b
2024-04-23T22:27:34,420  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:27:34,427  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,428  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:27:34,428  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,428  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,431  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:27:34,431  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:27:34,432  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:34,432  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:34,434  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:27:34,434  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:34,436  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:34,436  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,436  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,436  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,436  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T22:27:34,436  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595); Time taken: 0.008 seconds
2024-04-23T22:27:34,436  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595
2024-04-23T22:27:34,437  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595
2024-04-23T22:27:34,452  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:27:34,452  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:34,453  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,453  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,454  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936454, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFilesErasureCoded=0, transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFiles=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:34,459  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:27:34,472  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,472  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,473  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595); Time taken: 0.019 seconds
2024-04-23T22:27:34,473  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_f0c714d9-d3ba-4f55-8474-1e393c8f2595
2024-04-23T22:27:34,477  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:27:34,483  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,483  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:27:34,484  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,484  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,486  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:27:34,487  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:27:34,487  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:34,487  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:34,490  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:27:34,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:34,492  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:34,492  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,492  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,492  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, flushCache_()=1, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T22:27:34,492  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585); Time taken: 0.008 seconds
2024-04-23T22:27:34,492  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585
2024-04-23T22:27:34,493  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585
2024-04-23T22:27:34,508  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:27:34,508  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:34,508  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,508  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,509  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936454, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFiles=0, rawDataSize=0, totalSize=0, bucketing_version=2, numRows=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:34,514  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:27:34,527  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:34,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585); Time taken: 0.019 seconds
2024-04-23T22:27:34,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_eeab9ef5-92b5-412a-88ad-9a757d42e585
2024-04-23T22:27:34,532  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:27:34,539  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,539  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:27:34,540  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,540  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,543  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:27:34,544  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:27:34,544  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:34,544  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:34,547  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:27:34,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:34,549  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:34,549  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,549  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,549  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,549  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getDatabase_(String)=2, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=12, flushCache_()=0}
2024-04-23T22:27:34,549  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119); Time taken: 0.009 seconds
2024-04-23T22:27:34,549  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119
2024-04-23T22:27:34,550  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119
2024-04-23T22:27:34,566  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:27:34,566  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:34,566  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:27:34,567  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,567  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/47f0ca3c-cea9-4e1d-8ade-661fff861281/_tmp_space.db/80068c58-cb92-4d1b-b227-0dba1104bebf
2024-04-23T22:27:34,570  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,570  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:27:34,570  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119); Time taken: 0.004 seconds
2024-04-23T22:27:34,571  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_18bdcad5-e3b1-409d-a18e-5ba062f18119
2024-04-23T22:27:34,575  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:27:34,583  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,583  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:27:34,584  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,584  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,586  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:27:34,587  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:27:34,587  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:27:34,587  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:34,590  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:27:34,590  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:27:34,592  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:27:34,592  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,592  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:34,592  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,592  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:27:34,592  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0); Time taken: 0.008 seconds
2024-04-23T22:27:34,592  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0
2024-04-23T22:27:34,593  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0
2024-04-23T22:27:34,611  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:27:34,611  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:27:34,611  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:27:34,612  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:34,613  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936454, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, transactional=false, numFilesErasureCoded=0, totalSize=0, numRows=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:27:34,622  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:27:34,645  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:34,645  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=33}
2024-04-23T22:27:34,646  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0); Time taken: 0.034 seconds
2024-04-23T22:27:34,646  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_8af4ae36-cab4-4061-9c26-f5991d27a0f0
2024-04-23T22:27:34,653  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:27:34,664  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:34,664  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:27:34,667  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl values(1,1)
2024-04-23T22:27:34,668  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): insert into acidTbl values(1,1)
2024-04-23T22:27:34,671  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:27:34,671  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:27:34,672  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:34,672  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:34,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:34,700  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:34,700  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:34,700  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:34,700  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:34,700  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:34,700  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:34,707  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:34,708  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:34,708  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:34,732  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:34,811  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:34,811  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:34,811  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:34,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:34,813  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:34,814  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:34,814  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:34,815  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:34,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:34,824  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 13
2024-04-23T22:27:34,825  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [13])
2024-04-23T22:27:34,826  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:34,829  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:27:34,829  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:27:34,829  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:34,830  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:34,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:34,845  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:34,845  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:34,845  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:34,845  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:34,845  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:27:34,846  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:34,846  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidWriteIds_(List, String)=3, getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=19, allocateTableWriteId_(long, String, String)=8, getAllTableConstraints_(AllTableConstraintsRequest)=35, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=38}
2024-04-23T22:27:34,846  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.177 seconds
2024-04-23T22:27:34,846  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:34,846  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:34,866  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:27:34,866  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:34,868  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): insert into acidTbl values(1,1)
2024-04-23T22:27:34,869  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:34,869  INFO [main] ql.Driver: Query ID = alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
Total jobs = 1
2024-04-23T22:27:34,869  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:27:34,869  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:27:34,993  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:27:34,993  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:27:34,993  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:27:34,993  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:27:34,993  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:27:34,993  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:27:34,993  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:27:34,993  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:27:34,996  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:34,996  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:34,996  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-34_668_8121438897572295217-1/dummy_path
2024-04-23T22:27:35,005  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:35,006  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,94KB
2024-04-23T22:27:35,011  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:27:35,011  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T22:27:35,012  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:35,016  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-34_668_8121438897572295217-1/-mr-10000
2024-04-23T22:27:35,018  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:35,024  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:35,028  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:35,030  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:35,030  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:35,030  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-34_668_8121438897572295217-1/dummy_path
2024-04-23T22:27:35,030  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:35,047  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:35,067  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1028297034_0077
2024-04-23T22:27:35,067  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:35,126  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:35,126  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:35,127  INFO [Thread-6499] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:35,127  INFO [Thread-6499] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:35,129  INFO [Thread-6499] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:35,129  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1028297034_0077_m_000000_0
2024-04-23T22:27:35,131  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:35,132  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-34_668_8121438897572295217-1/dummy_path/null:0+1
2024-04-23T22:27:35,134  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:35,134  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,94KB
2024-04-23T22:27:35,135  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:27:35,138  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:27:35,138  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:27:35,138  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:27:35,138  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:27:35,138  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:27:35,139  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:27:35,139  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:35,140  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:35,140  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:35,140  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:35,140  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:27:35,141  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:1, 
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:1, 
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 1. abort - false
2024-04-23T22:27:35,142  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:1, RECORDS_OUT_INTERMEDIATE:1, 
2024-04-23T22:27:35,144  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:35,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:27:35,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:27:35,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 16; bufvoid = 104857600
2024-04-23T22:27:35,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214396(104857584); length = 1/6553600
2024-04-23T22:27:35,154  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:27:35,159  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1028297034_0077_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:35,160  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:35,160  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1028297034_0077_m_000000_0' done.
2024-04-23T22:27:35,160  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1028297034_0077_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1530819
		FILE: Number of bytes written=90746420
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=1
		Map output bytes=16
		Map output materialized bytes=24
		Input split bytes=361
		Combine input records=0
		Spilled Records=1
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302855680
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=1
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=1
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=1
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=1
	File Input Format Counters 
		Bytes Read=4992
2024-04-23T22:27:35,160  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1028297034_0077_m_000000_0
2024-04-23T22:27:35,160  INFO [Thread-6499] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:27:35,161  INFO [Thread-6499] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:27:35,161  INFO [pool-375-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1028297034_0077_r_000000_0
2024-04-23T22:27:35,164  INFO [pool-375-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:35,164  INFO [pool-375-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1d9fca16
2024-04-23T22:27:35,164  WARN [pool-375-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:35,164  INFO [pool-375-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:35,165  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1028297034_0077_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:35,168  INFO [localfetcher#104] reduce.LocalFetcher: localfetcher#104 about to shuffle output of map attempt_local1028297034_0077_m_000000_0 decomp: 20 len: 24 to MEMORY
2024-04-23T22:27:35,168  INFO [localfetcher#104] reduce.InMemoryMapOutput: Read 20 bytes from map-output for attempt_local1028297034_0077_m_000000_0
2024-04-23T22:27:35,168  INFO [localfetcher#104] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 20, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->20
2024-04-23T22:27:35,168  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:35,169  INFO [pool-375-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:35,169  INFO [pool-375-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:35,174  INFO [pool-375-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:35,174  INFO [pool-375-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:27:35,177  INFO [pool-375-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 20 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:35,177  INFO [pool-375-thread-1] reduce.MergeManagerImpl: Merging 1 files, 24 bytes from disk
2024-04-23T22:27:35,177  INFO [pool-375-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:35,177  INFO [pool-375-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:35,177  INFO [pool-375-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 8 bytes
2024-04-23T22:27:35,177  INFO [pool-375-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:35,178  INFO [pool-375-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:35,178  INFO [pool-375-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T22:27:35,179  INFO [pool-375-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:35,179  INFO [pool-375-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:35,179  INFO [pool-375-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:27:35,179  INFO [pool-375-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:35,179  INFO [pool-375-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local1028297034_0077/job_local1028297034_0077.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@507e496a
2024-04-23T22:27:35,180  INFO [pool-375-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:35,180  INFO [pool-375-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:35,180  INFO [pool-375-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:35,180  INFO [pool-375-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:35,180  INFO [pool-375-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:35,181  INFO [pool-375-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:35,181  INFO [pool-375-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:35,181  INFO [pool-375-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:35,187  INFO [pool-375-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:35,192  INFO [pool-375-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:35,192  INFO [pool-375-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:35,192  INFO [pool-375-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:35,192  INFO [pool-375-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:35,193  INFO [pool-375-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T22:27:35,204  INFO [pool-375-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:1, RECORDS_OUT_OPERATOR_FS_6:1, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.acidtbl:1, 
2024-04-23T22:27:35,204  INFO [pool-375-thread-1] mapred.Task: Task:attempt_local1028297034_0077_r_000000_0 is done. And is in the process of committing
2024-04-23T22:27:35,205  INFO [pool-375-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:35,205  INFO [pool-375-thread-1] mapred.Task: Task 'attempt_local1028297034_0077_r_000000_0' done.
2024-04-23T22:27:35,205  INFO [pool-375-thread-1] mapred.Task: Final Counters for attempt_local1028297034_0077_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1536853
		FILE: Number of bytes written=90747447
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=1
		Reduce shuffle bytes=24
		Reduce input records=1
		Reduce output records=0
		Spilled Records=1
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302855680
	HIVE
		CREATED_FILES=2
		RECORDS_OUT_1_default.acidtbl=1
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=1
		RECORDS_OUT_OPERATOR_SEL_5=1
		TOTAL_TABLE_ROWS_WRITTEN=1
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:35,205  INFO [pool-375-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1028297034_0077_r_000000_0
2024-04-23T22:27:35,205  INFO [Thread-6499] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:27:36,128 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:27:36,128  INFO [main] exec.Task: 2024-04-23 22:27:36,128 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1028297034_0077
2024-04-23T22:27:36,129  INFO [main] exec.Task: Ended Job = job_local1028297034_0077
2024-04-23T22:27:36,130  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:27:36,130  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000/000000_0.manifest
2024-04-23T22:27:36,130  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000001_0000001_0000
2024-04-23T22:27:36,132  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:27:36,132  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:36,132  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:36,142  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:36,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:36,153  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:36,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:27:36,200  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:36,200  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:36,210  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:36,210  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:36,210  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-34_668_8121438897572295217-1/-mr-10000
2024-04-23T22:27:36,211  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:36,221  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:36,229  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:27:36,230  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 1, false: 
2024-04-23T22:27:36,230  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:27:36,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:27:36,250  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 1, false: 
2024-04-23T22:27:36,250  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:27:36,250  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:27:36,253  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=1, numRows=1, totalSize=659, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:27:36,254  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:36,254  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, alter_table_(String, String, String, Table, EnvironmentContext, String)=67, getTable_(GetTableRequest)=41}
MapReduce Jobs Launched: 
2024-04-23T22:27:36,254  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:36,254  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:36,254  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:36,254  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 1.386 seconds
2024-04-23T22:27:36,254  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:36,266  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:36,266  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T22:27:36,267  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into acidTbl values(0,0),(3,3)
2024-04-23T22:27:36,267  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-34_668_8121438897572295217-1
2024-04-23T22:27:36,268  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-34_668_8121438897572295217-1 on fs with scheme file
2024-04-23T22:27:36,268  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): insert into acidTbl values(0,0),(3,3)
2024-04-23T22:27:36,270  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 14
2024-04-23T22:27:36,270  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:27:36,271  INFO [main] parse.CalcitePlanner: Starting caching scope for: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:36,271  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:27:36,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:36,280  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:36,280  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:36,280  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:36,280  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:36,280  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:36,280  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:36,287  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:36,287  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:36,287  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:36,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:36,357  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:36,357  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:36,357  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T22:27:36,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T22:27:36,360  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T22:27:36,360  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:36,360  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T22:27:36,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:36,362  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:36,369  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 14
2024-04-23T22:27:36,369  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=acidtbl (txnIds: [14])
2024-04-23T22:27:36,370  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T22:27:36,373  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T22:27:36,373  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T22:27:36,373  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T22:27:36,374  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T22:27:36,382  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:36,389  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:36,389  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T22:27:36,389  INFO [main] parse.CalcitePlanner: Ending caching scope for: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:36,389  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:36,389  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T22:27:36,390  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:36,390  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=20, getValidTxns_(long)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, allocateTableWriteId_(long, String, String)=6, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T22:27:36,390  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.122 seconds
2024-04-23T22:27:36,390  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:36,390  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:36,408  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:27:36,408  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T22:27:36,411  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): insert into acidTbl values(0,0),(3,3)
2024-04-23T22:27:36,411  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:36,411  INFO [main] ql.Driver: Query ID = alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
Total jobs = 1
2024-04-23T22:27:36,411  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T22:27:36,411  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T22:27:36,549  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T22:27:36,549  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T22:27:36,549  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T22:27:36,549  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T22:27:36,549  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T22:27:36,549  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T22:27:36,549  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T22:27:36,549  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T22:27:36,552  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T22:27:36,552  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T22:27:36,552  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-36_268_2436187897770411372-1/dummy_path
2024-04-23T22:27:36,562  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T22:27:36,562  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 4,98KB
2024-04-23T22:27:36,567  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T22:27:36,568  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:27:36,569  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:36,573  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-36_268_2436187897770411372-1/-mr-10000
2024-04-23T22:27:36,575  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:36,582  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T22:27:36,586  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T22:27:36,588  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T22:27:36,588  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T22:27:36,588  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-36_268_2436187897770411372-1/dummy_path
2024-04-23T22:27:36,588  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T22:27:36,609  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T22:27:36,630  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2109891110_0078
2024-04-23T22:27:36,630  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T22:27:36,698  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T22:27:36,698  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T22:27:36,699  INFO [Thread-6559] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:36,699  INFO [Thread-6559] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T22:27:36,700  INFO [Thread-6559] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T22:27:36,700  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2109891110_0078_m_000000_0
2024-04-23T22:27:36,701  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:36,701  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-36_268_2436187897770411372-1/dummy_path/null:0+1
2024-04-23T22:27:36,701  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T22:27:36,702  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 4,98KB
2024-04-23T22:27:36,702  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T22:27:36,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T22:27:36,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T22:27:36,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T22:27:36,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T22:27:36,706  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T22:27:36,707  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T22:27:36,707  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T22:27:36,707  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T22:27:36,708  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T22:27:36,708  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T22:27:36,708  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T22:27:36,708  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T22:27:36,708  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T22:27:36,708  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T22:27:36,709  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T22:27:36,709  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T22:27:36,709  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T22:27:36,709  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T22:27:36,709  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T22:27:36,709  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T22:27:36,709  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T22:27:36,710  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T22:27:36,711  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T22:27:36,711  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T22:27:36,711  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T22:27:36,721  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T22:27:36,723  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2109891110_0078_m_000000_0 is done. And is in the process of committing
2024-04-23T22:27:36,724  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T22:27:36,724  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2109891110_0078_m_000000_0' done.
2024-04-23T22:27:36,724  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2109891110_0078_m_000000_0: Counters: 31
	File System Counters
		FILE: Number of bytes read=1542611
		FILE: Number of bytes written=91928867
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=42
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302855680
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5034
2024-04-23T22:27:36,724  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2109891110_0078_m_000000_0
2024-04-23T22:27:36,724  INFO [Thread-6559] mapred.LocalJobRunner: map task executor complete.
2024-04-23T22:27:36,725  INFO [Thread-6559] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T22:27:36,725  INFO [pool-380-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2109891110_0078_r_000000_0
2024-04-23T22:27:36,725  INFO [pool-380-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T22:27:36,725  INFO [pool-380-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5bd4da07
2024-04-23T22:27:36,725  WARN [pool-380-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T22:27:36,726  INFO [pool-380-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T22:27:36,727  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2109891110_0078_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T22:27:36,727  INFO [localfetcher#105] reduce.LocalFetcher: localfetcher#105 about to shuffle output of map attempt_local2109891110_0078_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T22:27:36,728  INFO [localfetcher#105] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local2109891110_0078_m_000000_0
2024-04-23T22:27:36,728  INFO [localfetcher#105] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T22:27:36,728  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T22:27:36,728  INFO [pool-380-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:36,728  INFO [pool-380-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T22:27:36,734  INFO [pool-380-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:36,734  INFO [pool-380-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:27:36,736  INFO [pool-380-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T22:27:36,737  INFO [pool-380-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T22:27:36,737  INFO [pool-380-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T22:27:36,737  INFO [pool-380-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T22:27:36,737  INFO [pool-380-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T22:27:36,737  INFO [pool-380-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T22:27:36,737  INFO [pool-380-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T22:27:36,737  INFO [pool-380-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,92KB
2024-04-23T22:27:36,738  INFO [pool-380-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T22:27:36,738  INFO [pool-380-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T22:27:36,738  INFO [pool-380-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T22:27:36,738  INFO [pool-380-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T22:27:36,739  INFO [pool-380-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@4469ad1a, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnCommands/mapred/local/localRunner/alex/job_local2109891110_0078/job_local2109891110_0078.xml], properties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.acidtbl, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, numFilesErasureCoded=0, columns.comments=&amp#0;, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@ae713ee
2024-04-23T22:27:36,739  INFO [pool-380-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:36,739  INFO [pool-380-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:36,739  INFO [pool-380-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:36,739  INFO [pool-380-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:36,739  INFO [pool-380-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:36,739  INFO [pool-380-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse
2024-04-23T22:27:36,740  INFO [pool-380-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T22:27:36,740  INFO [pool-380-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:36,746  INFO [pool-380-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:36,751  INFO [pool-380-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T22:27:36,755  INFO [pool-380-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T22:27:36,755  INFO [pool-380-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T22:27:36,755  INFO [pool-380-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T22:27:36,755  INFO [pool-380-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T22:27:36,755  INFO [pool-380-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T22:27:36,757  INFO [pool-380-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00000_0, file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/delta_0000002_0000002_0000/bucket_00001_0]
2024-04-23T22:27:36,768  INFO [pool-380-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.acidtbl:2, 
2024-04-23T22:27:36,769  INFO [pool-380-thread-1] mapred.Task: Task:attempt_local2109891110_0078_r_000000_0 is done. And is in the process of committing
2024-04-23T22:27:36,769  INFO [pool-380-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T22:27:36,769  INFO [pool-380-thread-1] mapred.Task: Task 'attempt_local2109891110_0078_r_000000_0' done.
2024-04-23T22:27:36,769  INFO [pool-380-thread-1] mapred.Task: Final Counters for attempt_local2109891110_0078_r_000000_0: Counters: 35
	File System Counters
		FILE: Number of bytes read=1548703
		FILE: Number of bytes written=91930753
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=0
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=0
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1302855680
	HIVE
		CREATED_FILES=2
		RECORDS_OUT_1_default.acidtbl=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T22:27:36,769  INFO [pool-380-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2109891110_0078_r_000000_0
2024-04-23T22:27:36,769  INFO [Thread-6559] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 22:27:37,701 Stage-1 map = 100%,  reduce = 100%
2024-04-23T22:27:37,701  INFO [main] exec.Task: 2024-04-23 22:27:37,701 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2109891110_0078
2024-04-23T22:27:37,703  INFO [main] exec.Task: Ended Job = job_local2109891110_0078
2024-04-23T22:27:37,704  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest with attemptId 0.
2024-04-23T22:27:37,704  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000/000000_0.manifest
2024-04-23T22:27:37,704  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl/_tmp.delta_0000002_0000002_0000
2024-04-23T22:27:37,705  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.acidtbl
2024-04-23T22:27:37,706  INFO [main] exec.Task: Loading data to table default.acidtbl from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:27:37,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,712  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,712  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,719  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:27:37,736  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T22:27:37,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,742  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,742  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T22:27:37,742  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-36_268_2436187897770411372-1/-mr-10000
2024-04-23T22:27:37,743  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,749  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,767  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T22:27:37,767  INFO [main] FileOperations: Read stats for default.acidtbl/, numRows, true, 2, false: 
2024-04-23T22:27:37,767  INFO [main] FileOperations: Read stats for default.acidtbl/, rawDataSize, true, 0, false: 
2024-04-23T22:27:37,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.acidtbl newtbl=acidtbl	
2024-04-23T22:27:37,786  INFO [main] FileOperations: Read stats for default.acidtbl/, insertCount, true, 2, false: 
2024-04-23T22:27:37,786  INFO [main] FileOperations: Read stats for default.acidtbl/, updateCount, true, 0, false: 
2024-04-23T22:27:37,786  INFO [main] FileOperations: Read stats for default.acidtbl/, deleteCount, true, 0, false: 
2024-04-23T22:27:37,786  INFO [main] stats.BasicStatsTask: Table default.acidtbl stats: [numFiles=3, numRows=3, totalSize=1978, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T22:27:37,787  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:37,787  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=35, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=0, getTable_(GetTableRequest)=24, isCompatibleWith_(Configuration)=1}
MapReduce Jobs Launched: 
2024-04-23T22:27:37,787  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T22:27:37,787  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:37,787  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T22:27:37,787  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 1.376 seconds
2024-04-23T22:27:37,787  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:37,797  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:37,798  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:27:37,798  INFO [main] ql.TxnCommandsBaseForTests: Running the query: update acidTbl set b = -1
2024-04-23T22:27:37,798  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-36_268_2436187897770411372-1
2024-04-23T22:27:37,799  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/47f0ca3c-cea9-4e1d-8ade-661fff861281/hive_2024-04-23_22-27-36_268_2436187897770411372-1 on fs with scheme file
2024-04-23T22:27:37,799  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): update acidTbl set b = -1
2024-04-23T22:27:37,801  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 15
2024-04-23T22:27:37,801  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:27:37,802  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:37,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:37,808  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,808  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <update acidTbl set b = -1> as 
<insert into table `default`.`acidTbl` select ROW__ID,`a`,`b` from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:27:37,808  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:27:37,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:37,817  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,818  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:27:37,818  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:37,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,824  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,824  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:37,825  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:37,825  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:27:37,825  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:27:37,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,844  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,861  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:27:37,862  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,870  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,870  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:27:37,878  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,879  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:27:37,888  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:27:37,888  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:27:37,946  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:27:37,947  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:27:37,947  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:27:37,949 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMoreBucketsThanReducers(TestTxnCommands.java:1429) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:27:37,950 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:27:37,950  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:27:37,950 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeUpdate(UpdateDeleteSemanticAnalyzer.java:63)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:53)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testMoreBucketsThanReducers(TestTxnCommands.java:1429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:27:37,950  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:37,951  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, getCheckConstraints_(CheckConstraintsRequest)=1, getTableColumnStatistics_(String, String, List, String)=26, getValidTxns_(long)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTable_(GetTableRequest)=19, commitTxn_(CommitTxnRequest)=11}
2024-04-23T22:27:37,951  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.151 seconds
2024-04-23T22:27:37,951  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:37,955  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:37,963  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:27:37,963  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists acidTbl
2024-04-23T22:27:37,966  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 15
2024-04-23T22:27:37,967  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:27:37,967  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:37,973  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,973  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:37,973  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:37,973  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:37,973  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=12, openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T22:27:37,974  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.01 seconds
2024-04-23T22:27:37,974  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:37,974  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:37,990  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:27:37,990  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:37,990  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists acidTbl
2024-04-23T22:27:37,990  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:37,990  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:37,996  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:37,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:38,003  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:27:38,106  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:38,106  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=110}
2024-04-23T22:27:38,106  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.116 seconds
2024-04-23T22:27:38,106  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,111  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:27:38,117  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:38,119  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:27:38,119  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:27:38,120  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists acidTblPart
2024-04-23T22:27:38,122  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 15
2024-04-23T22:27:38,122  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:27:38,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:38,144  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,144  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:38,144  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:38,144  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:38,144  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:38,144  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.024 seconds
2024-04-23T22:27:38,145  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,145  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,164  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:27:38,164  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:38,164  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists acidTblPart
2024-04-23T22:27:38,165  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:38,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:38,171  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:38,177  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:27:38,228  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:38,229  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=57, getTable_(GetTableRequest)=6}
2024-04-23T22:27:38,229  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.064 seconds
2024-04-23T22:27:38,229  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,234  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:27:38,241  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:38,241  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:27:38,242  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:27:38,242  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists acidTbl2
2024-04-23T22:27:38,244  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 15
2024-04-23T22:27:38,244  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:27:38,245  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:38,245  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:38,245  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:38,246  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13}
2024-04-23T22:27:38,246  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.003 seconds
2024-04-23T22:27:38,246  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,246  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:27:38,246  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists acidTbl2
2024-04-23T22:27:38,246  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:38,247  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:27:38,247  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:38,247  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:27:38,247  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.001 seconds
2024-04-23T22:27:38,247  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,255  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:27:38,262  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:38,262  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:27:38,263  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:27:38,263  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:38,265  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 15
2024-04-23T22:27:38,265  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:27:38,266  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:38,287  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,287  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:38,287  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:38,287  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:38,287  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=15, getTable_(GetTableRequest)=21}
2024-04-23T22:27:38,288  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.024 seconds
2024-04-23T22:27:38,288  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,288  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,306  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:27:38,306  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:38,306  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists nonAcidOrcTbl
2024-04-23T22:27:38,306  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:38,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:38,314  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,314  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:38,322  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:27:38,393  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:38,394  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=79, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T22:27:38,394  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.087 seconds
2024-04-23T22:27:38,394  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,399  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:27:38,406  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:38,406  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:27:38,407  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:38,407  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:38,409  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 15
2024-04-23T22:27:38,410  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T22:27:38,410  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:38,418  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,418  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:38,418  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:38,419  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:38,419  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=13}
2024-04-23T22:27:38,419  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.012 seconds
2024-04-23T22:27:38,419  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,420  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,436  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T22:27:38,436  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:38,436  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists nonAcidOrcTbl2
2024-04-23T22:27:38,436  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:38,437  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:38,445  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:38,453  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:27:38,485  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:38,485  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=40}
2024-04-23T22:27:38,485  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.049 seconds
2024-04-23T22:27:38,485  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,490  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T22:27:38,498  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:38,498  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T22:27:38,498  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:27:38,498  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists nonAcidNonBucket
2024-04-23T22:27:38,502  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 15
2024-04-23T22:27:38,502  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T22:27:38,503  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:38,511  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,511  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:27:38,511  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:27:38,511  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:27:38,511  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13}
2024-04-23T22:27:38,511  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.013 seconds
2024-04-23T22:27:38,512  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,512  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,528  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T22:27:38,528  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:27:38,528  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e): drop table if exists nonAcidNonBucket
2024-04-23T22:27:38,529  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:27:38,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:38,537  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,537  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:38,546  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:27:38,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:27:38,577  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:27:38,577  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=8}
2024-04-23T22:27:38,577  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e); Time taken: 0.049 seconds
2024-04-23T22:27:38,578  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222734_e5a03bd3-b2d9-4956-8b59-8d84e602176e
2024-04-23T22:27:38,582  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T22:27:38,591  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T22:27:38,591  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T22:27:38,592  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testInsertOverwrite" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="10.397"/>
  <testcase name="testMergeNegative" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.252"/>
  <testcase name="testParallelInsertStats" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="10.464"/>
  <testcase name="testDeleteIn" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="1.692">
    <error type="java.lang.RuntimeException"><![CDATA[java.lang.RuntimeException: delete from acidTbl where a IN (SELECT A.a from acidTbl  A) failed: (responseCode = 40000, errorMessage = FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  , hiveErrorCode = 40000, SQLState = 42000, exception = No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  )
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:247)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:929)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
]]></error>
    <system-err><![CDATA[2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T22:28:00,777  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T22:28:00,780  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = b87c5e9f-31de-40f6-b13b-9ef2b60b45a5
2024-04-23T22:28:00,783  INFO [main] SessionState: Hive Session ID = b87c5e9f-31de-40f6-b13b-9ef2b60b45a5
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:28:00,783  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T22:28:00,788  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b87c5e9f-31de-40f6-b13b-9ef2b60b45a5
2024-04-23T22:28:00,791  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b87c5e9f-31de-40f6-b13b-9ef2b60b45a5
2024-04-23T22:28:00,793  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b87c5e9f-31de-40f6-b13b-9ef2b60b45a5/_tmp_space.db
2024-04-23T22:28:00,793  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=b87c5e9f-31de-40f6-b13b-9ef2b60b45a5, clientType=HIVECLI]
2024-04-23T22:28:00,793  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:28:00,794  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222800_73f65590-4ddd-45ee-8010-65a27c553c12): drop table if exists acidTbl
2024-04-23T22:28:00,804  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T22:28:00,805  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T22:28:00,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:00,810  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:00,810  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:00,810  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:00,810  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, openTxn_(String, TxnType)=11, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T22:28:00,810  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222800_73f65590-4ddd-45ee-8010-65a27c553c12); Time taken: 0.016 seconds
2024-04-23T22:28:00,810  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423222800_73f65590-4ddd-45ee-8010-65a27c553c12
2024-04-23T22:28:00,810  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:28:00,810  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222800_73f65590-4ddd-45ee-8010-65a27c553c12): drop table if exists acidTbl
2024-04-23T22:28:00,810  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:00,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:00,813  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:00,813  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:00,813  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222800_73f65590-4ddd-45ee-8010-65a27c553c12); Time taken: 0.003 seconds
2024-04-23T22:28:00,813  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222800_73f65590-4ddd-45ee-8010-65a27c553c12
2024-04-23T22:28:00,821  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T22:28:00,829  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:00,831  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T22:28:00,831  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:28:00,831  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222800_b91aafce-9aad-4573-ae74-ead49220a203): drop table if exists acidTblPart
2024-04-23T22:28:00,834  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T22:28:00,834  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T22:28:00,834  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:28:00,837  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:00,837  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:00,837  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:00,837  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=17, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T22:28:00,837  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222800_b91aafce-9aad-4573-ae74-ead49220a203); Time taken: 0.006 seconds
2024-04-23T22:28:00,838  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423222800_b91aafce-9aad-4573-ae74-ead49220a203
2024-04-23T22:28:00,838  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:28:00,838  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222800_b91aafce-9aad-4573-ae74-ead49220a203): drop table if exists acidTblPart
2024-04-23T22:28:00,838  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:00,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:28:00,841  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:00,841  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:00,841  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222800_b91aafce-9aad-4573-ae74-ead49220a203); Time taken: 0.003 seconds
2024-04-23T22:28:00,841  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222800_b91aafce-9aad-4573-ae74-ead49220a203
2024-04-23T22:28:00,848  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T22:28:00,855  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:00,855  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T22:28:00,856  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:28:00,856  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222800_88b79945-b300-4ce2-93cc-14585a1a3472): drop table if exists acidTbl2
2024-04-23T22:28:00,858  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T22:28:00,859  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T22:28:00,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:28:00,862  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:00,862  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:00,862  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:00,862  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:00,862  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222800_88b79945-b300-4ce2-93cc-14585a1a3472); Time taken: 0.006 seconds
2024-04-23T22:28:00,862  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423222800_88b79945-b300-4ce2-93cc-14585a1a3472
2024-04-23T22:28:00,862  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:28:00,862  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222800_88b79945-b300-4ce2-93cc-14585a1a3472): drop table if exists acidTbl2
2024-04-23T22:28:00,862  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:00,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T22:28:00,865  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:00,865  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T22:28:00,865  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222800_88b79945-b300-4ce2-93cc-14585a1a3472); Time taken: 0.003 seconds
2024-04-23T22:28:00,865  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222800_88b79945-b300-4ce2-93cc-14585a1a3472
2024-04-23T22:28:00,872  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T22:28:00,880  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:00,880  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T22:28:00,881  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:28:00,881  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222800_2785f442-d286-4f3c-9be3-1acfb9d12c3d): drop table if exists nonAcidOrcTbl
2024-04-23T22:28:00,883  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T22:28:00,884  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T22:28:00,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:28:00,886  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:00,887  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:00,887  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:00,887  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T22:28:00,887  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222800_2785f442-d286-4f3c-9be3-1acfb9d12c3d); Time taken: 0.006 seconds
2024-04-23T22:28:00,887  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423222800_2785f442-d286-4f3c-9be3-1acfb9d12c3d
2024-04-23T22:28:00,887  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:28:00,887  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222800_2785f442-d286-4f3c-9be3-1acfb9d12c3d): drop table if exists nonAcidOrcTbl
2024-04-23T22:28:00,887  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:00,888  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:28:00,890  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:00,890  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T22:28:00,890  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222800_2785f442-d286-4f3c-9be3-1acfb9d12c3d); Time taken: 0.003 seconds
2024-04-23T22:28:00,890  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222800_2785f442-d286-4f3c-9be3-1acfb9d12c3d
2024-04-23T22:28:00,897  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T22:28:00,906  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:00,906  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T22:28:00,906  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:28:00,906  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222800_dd790b9c-9b28-4587-b88f-81847fb2faba): drop table if exists nonAcidOrcTbl2
2024-04-23T22:28:00,909  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T22:28:00,909  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T22:28:00,910  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:28:00,912  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:00,912  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:00,913  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:00,913  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0}
2024-04-23T22:28:00,913  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222800_dd790b9c-9b28-4587-b88f-81847fb2faba); Time taken: 0.006 seconds
2024-04-23T22:28:00,913  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423222800_dd790b9c-9b28-4587-b88f-81847fb2faba
2024-04-23T22:28:00,913  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:28:00,913  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222800_dd790b9c-9b28-4587-b88f-81847fb2faba): drop table if exists nonAcidOrcTbl2
2024-04-23T22:28:00,913  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:00,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:28:00,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:00,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:00,916  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222800_dd790b9c-9b28-4587-b88f-81847fb2faba); Time taken: 0.003 seconds
2024-04-23T22:28:00,916  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222800_dd790b9c-9b28-4587-b88f-81847fb2faba
2024-04-23T22:28:00,923  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T22:28:00,931  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:00,931  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T22:28:00,931  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:28:00,932  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222800_3ae37736-b800-4be8-9804-0e3ba4f49b0a): drop table if exists nonAcidNonBucket
2024-04-23T22:28:00,934  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T22:28:00,934  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T22:28:00,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:28:00,937  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:00,937  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:00,937  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:00,937  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:00,937  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222800_3ae37736-b800-4be8-9804-0e3ba4f49b0a); Time taken: 0.005 seconds
2024-04-23T22:28:00,937  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423222800_3ae37736-b800-4be8-9804-0e3ba4f49b0a
2024-04-23T22:28:00,937  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:28:00,938  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222800_3ae37736-b800-4be8-9804-0e3ba4f49b0a): drop table if exists nonAcidNonBucket
2024-04-23T22:28:00,938  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:00,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:28:00,940  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:00,940  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:00,941  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222800_3ae37736-b800-4be8-9804-0e3ba4f49b0a); Time taken: 0.003 seconds
2024-04-23T22:28:00,941  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222800_3ae37736-b800-4be8-9804-0e3ba4f49b0a
2024-04-23T22:28:00,947  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T22:28:00,955  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:00,955  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T22:28:00,956  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:00,956  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:00,958  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T22:28:00,958  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T22:28:00,959  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:28:00,959  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:28:00,966  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T22:28:00,966  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:28:00,967  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:28:00,967  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:00,967  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:00,967  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:00,967  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=1, getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=7}
2024-04-23T22:28:00,968  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275); Time taken: 0.011 seconds
2024-04-23T22:28:00,968  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275
2024-04-23T22:28:00,968  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275
2024-04-23T22:28:00,990  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T22:28:00,990  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:28:00,991  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:00,991  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:00,991  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713936480, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, numRows=0, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:28:00,996  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtbl
2024-04-23T22:28:01,034  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,035  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=43}
2024-04-23T22:28:01,035  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275); Time taken: 0.043 seconds
2024-04-23T22:28:01,035  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222800_4239aeb5-90d9-4ee3-a43b-c21ca3355275
2024-04-23T22:28:01,040  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T22:28:01,047  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,047  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T22:28:01,048  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:01,048  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:01,050  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T22:28:01,051  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T22:28:01,051  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:28:01,051  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:28:01,054  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T22:28:01,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:28:01,055  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:28:01,055  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,055  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,055  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,056  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=1, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=3}
2024-04-23T22:28:01,056  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8); Time taken: 0.007 seconds
2024-04-23T22:28:01,056  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8
2024-04-23T22:28:01,056  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8
2024-04-23T22:28:01,074  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T22:28:01,074  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:28:01,074  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:01,074  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713936481, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T22:28:01,080  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/acidtblpart
2024-04-23T22:28:01,099  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,099  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:01,099  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8); Time taken: 0.025 seconds
2024-04-23T22:28:01,100  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_52664ab9-708d-48de-9ce8-fb8b0f4302d8
2024-04-23T22:28:01,104  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T22:28:01,112  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,112  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T22:28:01,113  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,113  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,115  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T22:28:01,116  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T22:28:01,116  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:28:01,116  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:28:01,119  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T22:28:01,119  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:28:01,120  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:28:01,120  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,120  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,121  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,121  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=1, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=13}
2024-04-23T22:28:01,121  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9); Time taken: 0.007 seconds
2024-04-23T22:28:01,121  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9
2024-04-23T22:28:01,121  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9
2024-04-23T22:28:01,138  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T22:28:01,138  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:28:01,138  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,138  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,138  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713936481, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:28:01,143  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl
2024-04-23T22:28:01,158  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,158  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=19, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:01,158  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9); Time taken: 0.02 seconds
2024-04-23T22:28:01,158  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_4fcdb8d6-c78e-4c0b-9452-3acbc97de6a9
2024-04-23T22:28:01,163  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T22:28:01,171  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,171  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T22:28:01,172  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,172  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,174  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T22:28:01,175  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T22:28:01,175  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:28:01,175  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:28:01,178  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T22:28:01,178  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:28:01,179  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:28:01,179  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,179  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,179  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,180  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=1, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=14}
2024-04-23T22:28:01,180  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108); Time taken: 0.007 seconds
2024-04-23T22:28:01,180  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108
2024-04-23T22:28:01,180  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108
2024-04-23T22:28:01,197  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T22:28:01,197  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:28:01,197  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,197  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,198  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713936481, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, totalSize=0, bucketing_version=2, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFilesErasureCoded=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:28:01,203  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidorctbl2
2024-04-23T22:28:01,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,215  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=17}
2024-04-23T22:28:01,215  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108); Time taken: 0.018 seconds
2024-04-23T22:28:01,216  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_b389fc3f-f164-4481-a086-c471e95c5108
2024-04-23T22:28:01,220  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T22:28:01,228  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,228  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T22:28:01,229  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:01,229  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:01,232  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T22:28:01,232  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T22:28:01,233  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:28:01,233  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:28:01,236  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T22:28:01,236  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:28:01,237  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:28:01,238  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,238  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,238  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,238  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=3}
2024-04-23T22:28:01,238  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650); Time taken: 0.009 seconds
2024-04-23T22:28:01,238  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650
2024-04-23T22:28:01,238  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650
2024-04-23T22:28:01,258  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T22:28:01,258  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:28:01,258  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T22:28:01,258  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,259  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b87c5e9f-31de-40f6-b13b-9ef2b60b45a5/_tmp_space.db/741bd290-1ac1-4f87-964d-21f4f90dd71f
2024-04-23T22:28:01,262  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,262  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T22:28:01,262  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650); Time taken: 0.004 seconds
2024-04-23T22:28:01,262  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_4609f8cf-2438-4d3f-8534-3554d424a650
2024-04-23T22:28:01,267  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T22:28:01,275  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,275  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T22:28:01,276  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,276  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,278  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T22:28:01,278  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T22:28:01,279  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T22:28:01,279  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T22:28:01,281  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T22:28:01,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T22:28:01,283  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T22:28:01,283  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,283  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,283  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,283  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getDatabase_(String)=1, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=13}
2024-04-23T22:28:01,283  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a); Time taken: 0.007 seconds
2024-04-23T22:28:01,284  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a
2024-04-23T22:28:01,284  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a
2024-04-23T22:28:01,301  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T22:28:01,301  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T22:28:01,301  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T22:28:01,301  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713936481, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFilesErasureCoded=0, rawDataSize=0, bucketing_version=2, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T22:28:01,306  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnCommands-1713936248912/warehouse/nonacidnonbucket
2024-04-23T22:28:01,319  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,319  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=18}
2024-04-23T22:28:01,319  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a); Time taken: 0.018 seconds
2024-04-23T22:28:01,320  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_c4a13e6e-a563-4a80-bcda-cb570b5deb1a
2024-04-23T22:28:01,325  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T22:28:01,332  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,332  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T22:28:01,333  INFO [main] ql.TxnCommandsBaseForTests: Running the query: delete from acidTbl where a IN (SELECT A.a from acidTbl  A)
2024-04-23T22:28:01,333  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_d9aa887e-4c5e-42bd-9f31-2933b1c0833f): delete from acidTbl where a IN (SELECT A.a from acidTbl  A)
2024-04-23T22:28:01,336  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T22:28:01,336  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T22:28:01,337  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting caching scope for: 
2024-04-23T22:28:01,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:01,358  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,358  INFO [main] parse.RewriteSemanticAnalyzer: Going to reparse <delete from acidTbl where a IN (SELECT A.a from acidTbl  A)> as 
<insert into table `default`.`acidTbl` select ROW__ID from `default`.`acidTbl` sort by ROW__ID >
2024-04-23T22:28:01,359  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Starting Semantic Analysis
2024-04-23T22:28:01,363  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed phase 1 of Semantic Analysis
2024-04-23T22:28:01,363  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:28:01,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:28:01,370  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,370  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:28:01,370  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:28:01,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:01,376  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,376  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Completed getting MetaData in Semantic Analysis
2024-04-23T22:28:01,376  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Disabling LLAP IO encode as ETL query is detected
2024-04-23T22:28:01,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:28:01,421  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:28:01,422  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:28:01,422  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:28:01,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.acidtbl	
2024-04-23T22:28:01,530  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:28:01,531  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:28:01,539  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,540  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidtbl	
2024-04-23T22:28:01,548  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table_statistics_req: table=hive.default.acidtbl	
2024-04-23T22:28:01,558  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:28:01,558  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:28:01,559  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.acidtbl, projIndxSet: [0], allowMissingStats: true
2024-04-23T22:28:01,559  WARN [main] calcite.RelOptHiveTable: No Stats for default@acidtbl, Columns: a
No Stats for default@acidtbl, Columns: a
2024-04-23T22:28:01,559  INFO [main] SessionState: No Stats for default@acidtbl, Columns: a
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for source tables
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for subqueries
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:28:01,670  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Get metadata for destination tables
2024-04-23T22:28:01,670  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:01,677  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,680 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed, skipping CBO. 
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168) ~[classes/:?]
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149) ~[classes/:?]
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72) ~[classes/:?]
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:929) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T22:28:01,681 ERROR [main] parse.UpdateDeleteSemanticAnalyzer: CBO failed due to missing column stats (see previous errors), skipping CBO
2024-04-23T22:28:01,681  INFO [main] parse.UpdateDeleteSemanticAnalyzer: Ending caching scope for: 
FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
2024-04-23T22:28:01,682 ERROR [main] ql.Driver: FAILED: NoMatchingMethodException No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
org.apache.hadoop.hive.ql.exec.NoMatchingMethodException: No matching method for class org.apache.hadoop.hive.ql.udf.UDFToInteger with (struct<writeid:bigint,bucketid:int,rowid:bigint>). Possible choices: _FUNC_(bigint)  _FUNC_(boolean)  _FUNC_(decimal(38,18))  _FUNC_(double)  _FUNC_(float)  _FUNC_(smallint)  _FUNC_(string)  _FUNC_(struct<writeid:bigint,bucketid:bigint,rowid:int>)  _FUNC_(timestamp)  _FUNC_(tinyint)  _FUNC_(void)  
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:130)
	at org.apache.hadoop.hive.ql.exec.MethodUtils.getMethodInternal(MethodUtils.java:60)
	at org.apache.hadoop.hive.ql.exec.DefaultUDFMethodResolver.getEvalMethod(DefaultUDFMethodResolver.java:59)
	at org.apache.hadoop.hive.ql.udf.TimestampCastRestrictorResolver.getEvalMethod(TimestampCastRestrictorResolver.java:68)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge.initialize(GenericUDFBridge.java:168)
	at org.apache.hadoop.hive.ql.udf.generic.GenericUDF.initializeAndFoldConstants(GenericUDF.java:149)
	at org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc.newInstance(ExprNodeGenericFuncDesc.java:235)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:584)
	at org.apache.hadoop.hive.ql.parse.type.ExprNodeDescExprFactory.createFuncCallExpr(ExprNodeDescExprFactory.java:97)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.getFuncExprNodeDescWithUdfData(TypeCheckProcFactory.java:762)
	at org.apache.hadoop.hive.ql.parse.type.TypeCheckProcFactory$DefaultExprProcessor.createConversionCast(TypeCheckProcFactory.java:783)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.getPartitionColsFromBucketColsForUpdateDelete(SemanticAnalyzer.java:8725)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBucketingSortingDest(SemanticAnalyzer.java:6906)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genFileSinkPlan(SemanticAnalyzer.java:7335)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPostGroupByBodyPlan(SemanticAnalyzer.java:11063)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genBodyPlan(SemanticAnalyzer.java:10938)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11853)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:11723)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.genOPTree(CalcitePlanner.java:626)
	at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:12558)
	at org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:456)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:67)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.reparseAndSuperAnalyze(UpdateDeleteSemanticAnalyzer.java:208)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyzeDelete(UpdateDeleteSemanticAnalyzer.java:68)
	at org.apache.hadoop.hive.ql.parse.UpdateDeleteSemanticAnalyzer.analyze(UpdateDeleteSemanticAnalyzer.java:50)
	at org.apache.hadoop.hive.ql.parse.RewriteSemanticAnalyzer.analyzeInternal(RewriteSemanticAnalyzer.java:72)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnCommands.testDeleteIn(TestTxnCommands.java:929)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T22:28:01,682  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,682  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, getTableColumnStatistics_(String, String, List, String)=28, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=4, getTable_(GetTableRequest)=40, getAllTableConstraints_(AllTableConstraintsRequest)=35}
2024-04-23T22:28:01,682  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_d9aa887e-4c5e-42bd-9f31-2933b1c0833f); Time taken: 0.349 seconds
2024-04-23T22:28:01,683  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T22:28:01,687  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,695  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T22:28:01,695  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139): drop table if exists acidTbl
2024-04-23T22:28:01,698  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T22:28:01,698  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T22:28:01,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:01,704  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,704  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,704  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, rollbackTxn_(long)=12}
2024-04-23T22:28:01,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139); Time taken: 0.009 seconds
2024-04-23T22:28:01,705  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139
2024-04-23T22:28:01,705  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139
2024-04-23T22:28:01,727  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T22:28:01,727  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:28:01,727  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139): drop table if exists acidTbl
2024-04-23T22:28:01,727  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:01,733  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:01,739  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T22:28:01,870  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,870  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=137, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-23T22:28:01,870  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139); Time taken: 0.143 seconds
2024-04-23T22:28:01,871  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_37b983ed-e772-45d7-a211-a03904c03139
2024-04-23T22:28:01,876  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T22:28:01,884  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,884  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T22:28:01,884  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T22:28:01,884  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b): drop table if exists acidTblPart
2024-04-23T22:28:01,887  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 5
2024-04-23T22:28:01,887  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T22:28:01,887  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:28:01,893  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,894  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,894  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,894  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,894  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=7, openTxn_(String, TxnType)=2}
2024-04-23T22:28:01,894  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b); Time taken: 0.01 seconds
2024-04-23T22:28:01,894  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b
2024-04-23T22:28:01,894  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b
2024-04-23T22:28:01,911  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T22:28:01,911  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:28:01,911  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b): drop table if exists acidTblPart
2024-04-23T22:28:01,911  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,911  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:28:01,917  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T22:28:01,923  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:01,923  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T22:28:01,968  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,968  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=51, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:01,968  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b); Time taken: 0.057 seconds
2024-04-23T22:28:01,968  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_79e7af9a-09f9-421f-b69e-d0fda581774b
2024-04-23T22:28:01,974  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T22:28:01,983  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:01,983  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T22:28:01,984  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T22:28:01,984  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222801_2f1724f1-b4d5-4303-b688-62de34153c53): drop table if exists acidTbl2
2024-04-23T22:28:01,988  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-23T22:28:01,988  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T22:28:01,989  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:01,989  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:01,989  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:01,989  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=4, getValidTxns_(long)=1, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=16, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:01,989  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222801_2f1724f1-b4d5-4303-b688-62de34153c53); Time taken: 0.005 seconds
2024-04-23T22:28:01,990  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423222801_2f1724f1-b4d5-4303-b688-62de34153c53
2024-04-23T22:28:01,990  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T22:28:01,990  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222801_2f1724f1-b4d5-4303-b688-62de34153c53): drop table if exists acidTbl2
2024-04-23T22:28:01,990  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:01,990  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T22:28:01,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:01,990  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0}
2024-04-23T22:28:01,991  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222801_2f1724f1-b4d5-4303-b688-62de34153c53); Time taken: 0.0 seconds
2024-04-23T22:28:01,991  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222801_2f1724f1-b4d5-4303-b688-62de34153c53
2024-04-23T22:28:01,999  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T22:28:02,008  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:02,008  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T22:28:02,008  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T22:28:02,009  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2): drop table if exists nonAcidOrcTbl
2024-04-23T22:28:02,011  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-23T22:28:02,011  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T22:28:02,012  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:28:02,039  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,039  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:02,039  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:02,039  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:02,039  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=17, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=27, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T22:28:02,040  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2); Time taken: 0.03 seconds
2024-04-23T22:28:02,040  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2
2024-04-23T22:28:02,040  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2
2024-04-23T22:28:02,062  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T22:28:02,062  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:28:02,062  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2): drop table if exists nonAcidOrcTbl
2024-04-23T22:28:02,062  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:02,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:28:02,070  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,070  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:28:02,078  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,078  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T22:28:02,183  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:02,184  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=113}
2024-04-23T22:28:02,184  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2); Time taken: 0.121 seconds
2024-04-23T22:28:02,184  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222802_fa3f22f4-6ac3-475e-9010-ab3f650b61d2
2024-04-23T22:28:02,190  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T22:28:02,199  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:02,199  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T22:28:02,200  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T22:28:02,200  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707): drop table if exists nonAcidOrcTbl2
2024-04-23T22:28:02,202  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 11
2024-04-23T22:28:02,203  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T22:28:02,203  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:28:02,211  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,211  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:02,211  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:02,211  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:02,211  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T22:28:02,212  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707); Time taken: 0.011 seconds
2024-04-23T22:28:02,212  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707
2024-04-23T22:28:02,212  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707
2024-04-23T22:28:02,231  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T22:28:02,231  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:28:02,231  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707): drop table if exists nonAcidOrcTbl2
2024-04-23T22:28:02,232  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:02,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:28:02,240  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:28:02,247  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T22:28:02,277  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:02,277  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=37, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:02,277  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707); Time taken: 0.046 seconds
2024-04-23T22:28:02,277  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222802_92b962a1-8daa-4072-aeb3-665c21426707
2024-04-23T22:28:02,283  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T22:28:02,293  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:02,293  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T22:28:02,293  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T22:28:02,293  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49): drop table if exists nonAcidNonBucket
2024-04-23T22:28:02,296  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 13
2024-04-23T22:28:02,296  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T22:28:02,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:28:02,305  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,305  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T22:28:02,305  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T22:28:02,305  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T22:28:02,305  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=8}
2024-04-23T22:28:02,306  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49); Time taken: 0.012 seconds
2024-04-23T22:28:02,306  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49
2024-04-23T22:28:02,306  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49
2024-04-23T22:28:02,326  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T22:28:02,326  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T22:28:02,326  INFO [main] ql.Driver: Executing command(queryId=alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49): drop table if exists nonAcidNonBucket
2024-04-23T22:28:02,326  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T22:28:02,326  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:28:02,334  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:28:02,343  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T22:28:02,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T22:28:02,375  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T22:28:02,375  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=41, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-23T22:28:02,375  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49); Time taken: 0.049 seconds
2024-04-23T22:28:02,375  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423222802_42bf554f-6d2b-486b-82fa-a3d5694eac49
2024-04-23T22:28:02,381  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T22:28:02,391  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T22:28:02,391  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T22:28:02,392  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
]]></system-err>
  </testcase>
  <testcase name="testMmExim" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="10.496"/>
  <testcase name="testExplicitRollback" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="4.383"/>
  <testcase name="testNonAcidInsert" classname="org.apache.hadoop.hive.ql.TestTxnCommands" time="0">
    <skipped message="not needed but useful for testing"/>
  </testcase>
</testsuite>