SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,072872 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@35841320]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@35841320) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@1807e3f6
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,019257 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={console, DRFA}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(noConsoleNoAnsi="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", header="null", charset="null", PatternSelector=null, Configuration(HiveLog4j2Test), disableAnsi="null", Replace=null, alwaysWriteExceptions="null", footer="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(direct="null", follow="null", target="SYSTEM_ERR", bufferSize="null", bufferedIo="null", immediateFlush="null", Configuration(HiveLog4j2Test), name="console", ignoreExceptions="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(charset="null", alwaysWriteExceptions="null", footer="null", disableAnsi="null", Configuration(HiveLog4j2Test), header="null", Replace=null, PatternSelector=null, pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", noConsoleNoAnsi="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(modulate="true", interval="1", maxRandomDelay="null")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(max="30", compressionLevel="null", fileIndex="null", stopCustomActionsOnError="null", tempCompressedFilePattern="null", Configuration(HiveLog4j2Test), min="null", ={})
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(fileGroup="null", fileOwner="null", advertiseURI="null", append="null", fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", advertise="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), filePermissions="null", bufferSize="null", bufferedIo="null", immediateFlush="null", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), name="DRFA", ignoreExceptions="null", Configuration(HiveLog4j2Test), ={}, Filter=null)
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 1589547113
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-24T05:16:41.982-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/24-05:16:45.635, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/25-00:00:00.000, nextFileTime=2024/04/24-00:00:00.000, prevFileTime=2024/04/24-00:00:00.000, current=2024/04/24-05:16:45.636, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@2118cddf...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@2118cddf OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@25e2ab5a
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@35841320
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@35841320) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@35841320] started OK.
2024-04-24T05:16:45,770  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-24T05:16:46,111  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-24T05:16:46,169  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T05:16:46,169  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T05:16:46,169  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T05:16:46,170  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T05:16:46,170  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T05:16:46,171  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T05:16:46,171  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T05:16:46,171  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T05:16:46,171  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T05:16:46,172  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T05:16:46,172  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T05:16:46,249  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T05:16:46,255  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-24T05:16:46,817  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T05:16:46,822  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
2024-04-24T05:16:46,825  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T05:16:46,829  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-24T05:16:46,833  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T05:16:46,834  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-24T05:16:47,027  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
2024-04-24T05:16:47,036  INFO [main] utils.TestTxnDbUtil: Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/ql/target/tmp/junit_metastore_db;create=true
Hive Session ID = 6c4b897a-0105-4e42-96a4-98068a114754
2024-04-24T05:16:47,976  INFO [main] SessionState: Hive Session ID = 6c4b897a-0105-4e42-96a4-98068a114754
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:16:47,987  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
log4j: Trying to find [log4j.xml] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@706fe5c6.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@706fe5c6.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (org.apache.htrace.core.Tracer).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-24T05:16:48,366  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6c4b897a-0105-4e42-96a4-98068a114754
2024-04-24T05:16:48,370  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754
2024-04-24T05:16:48,373  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6c4b897a-0105-4e42-96a4-98068a114754/_tmp_space.db
2024-04-24T05:16:48,395  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=6c4b897a-0105-4e42-96a4-98068a114754, clientType=HIVECLI]
2024-04-24T05:16:48,446  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-24T05:16:48,580  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-24T05:16:48,614  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-24T05:16:48,618  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-24T05:16:48,618  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-24T05:16:48,620  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-24T05:16:48,624  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-24T05:16:48,626  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-24T05:16:48,627  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-24T05:16:49,044  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-24T05:16:49,044  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c479fdf, with PersistenceManager: null will be shutdown
2024-04-24T05:16:49,073  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c479fdf, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2fe74516 created in the thread with id: 1
2024-04-24T05:16:51,288  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c479fdf from thread id: 1
2024-04-24T05:16:51,303  INFO [main] metastore.HMSHandler: Setting location of default catalog, as it hasn't been done after upgrade
2024-04-24T05:16:51,331  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-24T05:16:51,377  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-24T05:16:51,399  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-24T05:16:51,403  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-24T05:16:51,477  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-24T05:16:51,484  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-24T05:16:51,485  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-24T05:16:51,487  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-24T05:16:51,488  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-24T05:16:51,492  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-24T05:16:51,493  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-24T05:16:51,496  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-24T05:16:51,620  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-24T05:16:51,665  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:16:51,695  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051651_be16fd08-2160-4263-9d6f-320373d7d62b): drop table if exists acidTbl
2024-04-24T05:16:52,572  INFO [main] reflections.Reflections: Reflections took 201 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T05:16:52,738  INFO [main] reflections.Reflections: Reflections took 133 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T05:16:52,883  INFO [main] reflections.Reflections: Reflections took 139 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T05:16:52,913  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T05:16:52,926  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T05:16:52,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:16:53,090  INFO [main] reflections.Reflections: Reflections took 134 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-24T05:16:53,126  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,128  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,131  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,131  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=8, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=33}
2024-04-24T05:16:53,132  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051651_be16fd08-2160-4263-9d6f-320373d7d62b); Time taken: 1.438 seconds
2024-04-24T05:16:53,134  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424051651_be16fd08-2160-4263-9d6f-320373d7d62b
2024-04-24T05:16:53,134  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:53,137  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051651_be16fd08-2160-4263-9d6f-320373d7d62b): drop table if exists acidTbl
2024-04-24T05:16:53,140  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,141  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:16:53,158  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,158  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:53,159  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051651_be16fd08-2160-4263-9d6f-320373d7d62b); Time taken: 0.022 seconds
2024-04-24T05:16:53,159  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051651_be16fd08-2160-4263-9d6f-320373d7d62b
2024-04-24T05:16:53,171  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T05:16:53,186  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,189  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T05:16:53,190  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:16:53,191  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_6b0f7199-dabc-444b-b5e0-60da30a2f18b): drop table if exists acidTblPart
2024-04-24T05:16:53,196  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T05:16:53,196  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T05:16:53,198  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:16:53,203  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,203  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,203  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,203  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=30, openTxn_(String, TxnType)=4}
2024-04-24T05:16:53,204  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_6b0f7199-dabc-444b-b5e0-60da30a2f18b); Time taken: 0.012 seconds
2024-04-24T05:16:53,204  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424051653_6b0f7199-dabc-444b-b5e0-60da30a2f18b
2024-04-24T05:16:53,204  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:53,204  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_6b0f7199-dabc-444b-b5e0-60da30a2f18b): drop table if exists acidTblPart
2024-04-24T05:16:53,205  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:16:53,210  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,210  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:53,210  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_6b0f7199-dabc-444b-b5e0-60da30a2f18b); Time taken: 0.006 seconds
2024-04-24T05:16:53,210  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_6b0f7199-dabc-444b-b5e0-60da30a2f18b
2024-04-24T05:16:53,218  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T05:16:53,227  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,227  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T05:16:53,228  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:16:53,229  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_b4c02863-c798-4381-a940-5cf05846a32f): drop table if exists acidTbl2
2024-04-24T05:16:53,233  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T05:16:53,234  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T05:16:53,236  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:16:53,240  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,240  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=18, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T05:16:53,241  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_b4c02863-c798-4381-a940-5cf05846a32f); Time taken: 0.012 seconds
2024-04-24T05:16:53,241  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424051653_b4c02863-c798-4381-a940-5cf05846a32f
2024-04-24T05:16:53,241  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:53,242  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_b4c02863-c798-4381-a940-5cf05846a32f): drop table if exists acidTbl2
2024-04-24T05:16:53,242  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,242  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:16:53,247  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,247  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:53,248  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_b4c02863-c798-4381-a940-5cf05846a32f); Time taken: 0.005 seconds
2024-04-24T05:16:53,248  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_b4c02863-c798-4381-a940-5cf05846a32f
2024-04-24T05:16:53,255  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T05:16:53,264  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,265  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T05:16:53,266  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:16:53,267  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_9f1e1e3d-babd-4878-bc99-02176779a81f): drop table if exists nonAcidOrcTbl
2024-04-24T05:16:53,271  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T05:16:53,272  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T05:16:53,273  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:16:53,278  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,278  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,278  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,279  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=4, flushCache_()=0}
2024-04-24T05:16:53,279  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_9f1e1e3d-babd-4878-bc99-02176779a81f); Time taken: 0.011 seconds
2024-04-24T05:16:53,279  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424051653_9f1e1e3d-babd-4878-bc99-02176779a81f
2024-04-24T05:16:53,279  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:53,280  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_9f1e1e3d-babd-4878-bc99-02176779a81f): drop table if exists nonAcidOrcTbl
2024-04-24T05:16:53,280  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,280  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:16:53,285  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,285  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:53,286  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_9f1e1e3d-babd-4878-bc99-02176779a81f); Time taken: 0.006 seconds
2024-04-24T05:16:53,286  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_9f1e1e3d-babd-4878-bc99-02176779a81f
2024-04-24T05:16:53,297  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T05:16:53,309  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,309  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T05:16:53,311  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:16:53,312  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_05115505-2381-4181-9d11-5061a21e1d69): drop table if exists nonAcidOrcTbl2
2024-04-24T05:16:53,317  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T05:16:53,318  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T05:16:53,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:16:53,327  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,327  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,328  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,328  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=5, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=24}
2024-04-24T05:16:53,328  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_05115505-2381-4181-9d11-5061a21e1d69); Time taken: 0.017 seconds
2024-04-24T05:16:53,329  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424051653_05115505-2381-4181-9d11-5061a21e1d69
2024-04-24T05:16:53,329  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:53,329  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_05115505-2381-4181-9d11-5061a21e1d69): drop table if exists nonAcidOrcTbl2
2024-04-24T05:16:53,329  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:16:53,335  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,336  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:53,336  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_05115505-2381-4181-9d11-5061a21e1d69); Time taken: 0.006 seconds
2024-04-24T05:16:53,336  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_05115505-2381-4181-9d11-5061a21e1d69
2024-04-24T05:16:53,344  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T05:16:53,353  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,353  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T05:16:53,354  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:16:53,355  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_72e9878f-b107-4cce-92dd-f9beae0668fb): drop table if exists nonAcidNonBucket
2024-04-24T05:16:53,359  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T05:16:53,360  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T05:16:53,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:16:53,366  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,366  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,366  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,366  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, getValidTxns_(long)=1, openTxn_(String, TxnType)=4, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T05:16:53,366  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_72e9878f-b107-4cce-92dd-f9beae0668fb); Time taken: 0.011 seconds
2024-04-24T05:16:53,367  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424051653_72e9878f-b107-4cce-92dd-f9beae0668fb
2024-04-24T05:16:53,367  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:53,367  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_72e9878f-b107-4cce-92dd-f9beae0668fb): drop table if exists nonAcidNonBucket
2024-04-24T05:16:53,367  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,368  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:16:53,373  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,373  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:53,373  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_72e9878f-b107-4cce-92dd-f9beae0668fb); Time taken: 0.006 seconds
2024-04-24T05:16:53,373  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_72e9878f-b107-4cce-92dd-f9beae0668fb
2024-04-24T05:16:53,382  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T05:16:53,391  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,391  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T05:16:53,392  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:53,392  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:53,472  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T05:16:53,472  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T05:16:53,474  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:53,477  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:53,495  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T05:16:53,542  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:53,555  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:53,555  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,555  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,555  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,555  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=19, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=4, getDatabase_(String)=5, flushCache_()=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=11}
2024-04-24T05:16:53,555  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739); Time taken: 0.163 seconds
2024-04-24T05:16:53,556  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739
2024-04-24T05:16:53,563  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739
2024-04-24T05:16:53,613  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T05:16:53,614  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:53,617  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:53,617  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,721  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713961013, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, numFilesErasureCoded=0, totalSize=0, transactional=true, bucketing_version=2, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:16:53,735  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtbl
2024-04-24T05:16:53,845  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,846  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=124, isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:53,846  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739); Time taken: 0.228 seconds
2024-04-24T05:16:53,846  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_317dea1c-69a3-4264-9794-c6563f85a739
2024-04-24T05:16:53,851  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T05:16:53,860  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,861  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T05:16:53,861  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:53,862  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:53,867  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T05:16:53,867  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T05:16:53,869  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:53,869  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:53,872  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T05:16:53,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:53,876  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:53,876  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,876  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,876  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,876  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, getDatabase_(String)=2}
2024-04-24T05:16:53,876  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba); Time taken: 0.014 seconds
2024-04-24T05:16:53,877  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba
2024-04-24T05:16:53,877  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba
2024-04-24T05:16:53,912  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T05:16:53,912  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:53,914  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:53,914  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:53,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713961013, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:16:53,925  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtblpart
2024-04-24T05:16:53,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:53,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=40}
2024-04-24T05:16:53,956  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba); Time taken: 0.041 seconds
2024-04-24T05:16:53,956  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_22907f86-7bb4-4a73-b830-0d439c4551ba
2024-04-24T05:16:53,962  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T05:16:53,971  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:53,973  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T05:16:53,974  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:53,975  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:53,979  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 2
2024-04-24T05:16:53,979  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T05:16:53,981  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:53,981  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:53,984  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T05:16:53,985  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:53,988  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:53,988  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:53,988  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:53,988  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:53,988  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, flushCache_()=1, getDatabase_(String)=3, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=18, isCompatibleWith_(Configuration)=1}
2024-04-24T05:16:53,988  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445); Time taken: 0.013 seconds
2024-04-24T05:16:53,988  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445
2024-04-24T05:16:53,989  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445
2024-04-24T05:16:54,018  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T05:16:54,019  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:54,019  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:54,019  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713961014, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numFilesErasureCoded=0, totalSize=0, numRows=0, numFiles=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:16:54,030  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl
2024-04-24T05:16:54,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=41}
2024-04-24T05:16:54,062  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445); Time taken: 0.043 seconds
2024-04-24T05:16:54,062  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051653_41c1c3ac-22e0-435c-91d7-f16891e12445
2024-04-24T05:16:54,068  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T05:16:54,077  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,077  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T05:16:54,078  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:54,078  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:54,083  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 2
2024-04-24T05:16:54,083  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T05:16:54,085  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:54,085  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:54,089  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T05:16:54,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:54,092  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:54,092  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:54,092  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:54,092  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:54,092  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=16, flushCache_()=0, getDatabase_(String)=3}
2024-04-24T05:16:54,092  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903); Time taken: 0.014 seconds
2024-04-24T05:16:54,093  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903
2024-04-24T05:16:54,093  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903
2024-04-24T05:16:54,121  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T05:16:54,121  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:54,121  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:54,121  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713961014, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numRows=0, rawDataSize=0, transactional=false, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:16:54,131  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl2
2024-04-24T05:16:54,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,170  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=47, isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:54,170  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903); Time taken: 0.048 seconds
2024-04-24T05:16:54,170  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_f53692ba-02d9-4202-9dc8-1d4f6332f903
2024-04-24T05:16:54,178  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T05:16:54,189  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,189  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T05:16:54,191  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:54,191  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:54,197  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 3
2024-04-24T05:16:54,198  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T05:16:54,200  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:54,200  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:54,204  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T05:16:54,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:54,208  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:54,208  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:54,208  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:54,208  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:54,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=20, getDatabase_(String)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=5, getValidWriteIds_(List, String)=4, getValidTxns_(long)=2}
2024-04-24T05:16:54,209  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec); Time taken: 0.017 seconds
2024-04-24T05:16:54,209  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec
2024-04-24T05:16:54,210  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec
2024-04-24T05:16:54,247  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T05:16:54,247  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:54,249  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:16:54,249  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,252  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6c4b897a-0105-4e42-96a4-98068a114754/_tmp_space.db/21eec303-5486-49e8-8758-332775ba1975
2024-04-24T05:16:54,257  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,257  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=5, isCompatibleWith_(Configuration)=1}
2024-04-24T05:16:54,257  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec); Time taken: 0.007 seconds
2024-04-24T05:16:54,257  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_d0a076d0-d511-41c8-8f13-97179388b0ec
2024-04-24T05:16:54,263  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T05:16:54,272  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,272  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T05:16:54,273  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:54,274  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:54,278  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 5
2024-04-24T05:16:54,278  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T05:16:54,279  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:54,279  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:54,283  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T05:16:54,283  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:54,286  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:54,286  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:54,286  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:54,286  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:54,286  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=1, flushCache_()=0, getDatabase_(String)=3, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3}
2024-04-24T05:16:54,286  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15); Time taken: 0.012 seconds
2024-04-24T05:16:54,287  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15
2024-04-24T05:16:54,287  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15
2024-04-24T05:16:54,313  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T05:16:54,313  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:54,313  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:16:54,314  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,315  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713961014, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, bucketing_version=2, numRows=0, rawDataSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:16:54,324  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidnonbucket
2024-04-24T05:16:54,349  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,349  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=33, isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:54,349  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15); Time taken: 0.035 seconds
2024-04-24T05:16:54,349  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_baa88751-d27a-44d2-8443-d06ff6baff15
2024-04-24T05:16:54,354  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T05:16:54,363  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,363  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T05:16:54,364  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Initializing local cache in HiveMetaStoreClient...
2024-04-24T05:16:54,387  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Local cache initialized in HiveMetaStoreClient: com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedLocalManualCache@11adab6d
2024-04-24T05:16:54,387  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T05:16:54,388  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_c22c597c-4be9-4e70-80fb-3fd565523692): drop table if exists T
2024-04-24T05:16:54,391  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 7
2024-04-24T05:16:54,392  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T05:16:54,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:16:54,397  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:54,397  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:54,398  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:54,398  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=1}
2024-04-24T05:16:54,398  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_c22c597c-4be9-4e70-80fb-3fd565523692); Time taken: 0.009 seconds
2024-04-24T05:16:54,398  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424051654_c22c597c-4be9-4e70-80fb-3fd565523692
2024-04-24T05:16:54,398  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:54,398  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_c22c597c-4be9-4e70-80fb-3fd565523692): drop table if exists T
2024-04-24T05:16:54,398  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,399  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:16:54,403  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,403  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:54,403  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_c22c597c-4be9-4e70-80fb-3fd565523692); Time taken: 0.005 seconds
2024-04-24T05:16:54,403  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_c22c597c-4be9-4e70-80fb-3fd565523692
2024-04-24T05:16:54,411  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T05:16:54,419  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,419  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T05:16:54,420  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T05:16:54,420  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_8f3d699e-028a-427f-ab09-1eb84158bda2): drop table if exists Tstage
2024-04-24T05:16:54,423  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 7
2024-04-24T05:16:54,424  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T05:16:54,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:54,430  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:54,430  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:54,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:54,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=15, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=3}
2024-04-24T05:16:54,430  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_8f3d699e-028a-427f-ab09-1eb84158bda2); Time taken: 0.01 seconds
2024-04-24T05:16:54,431  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424051654_8f3d699e-028a-427f-ab09-1eb84158bda2
2024-04-24T05:16:54,431  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:16:54,431  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_8f3d699e-028a-427f-ab09-1eb84158bda2): drop table if exists Tstage
2024-04-24T05:16:54,431  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,432  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:54,437  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,438  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:54,438  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_8f3d699e-028a-427f-ab09-1eb84158bda2); Time taken: 0.006 seconds
2024-04-24T05:16:54,438  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_8f3d699e-028a-427f-ab09-1eb84158bda2
2024-04-24T05:16:54,446  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T05:16:54,455  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,455  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T05:16:54,456  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T05:16:54,457  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T05:16:54,462  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 7
2024-04-24T05:16:54,462  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T05:16:54,464  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:54,464  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:54,468  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T05:16:54,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:54,470  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:54,470  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:54,470  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:54,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:54,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getDatabase_(String)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=18, flushCache_()=1}
2024-04-24T05:16:54,471  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc); Time taken: 0.013 seconds
2024-04-24T05:16:54,471  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc
2024-04-24T05:16:54,472  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc
2024-04-24T05:16:54,501  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T05:16:54,501  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:54,502  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T05:16:54,502  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,504  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713961014, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, transactional_properties=insert_only, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:16:54,512  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:16:54,542  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,543  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=39, isCompatibleWith_(Configuration)=1}
2024-04-24T05:16:54,543  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc); Time taken: 0.04 seconds
2024-04-24T05:16:54,543  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_fae5e986-2e3e-423a-b08f-fff1f0e0cecc
2024-04-24T05:16:54,549  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T05:16:54,557  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,557  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T05:16:54,558  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:16:54,558  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:16:54,564  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-24T05:16:54,564  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T05:16:54,566  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:54,566  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:54,569  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T05:16:54,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:16:54,573  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:54,573  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:54,573  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:54,573  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:54,573  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=4, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=14}
2024-04-24T05:16:54,573  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0); Time taken: 0.015 seconds
2024-04-24T05:16:54,574  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0
2024-04-24T05:16:54,574  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0
2024-04-24T05:16:54,600  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T05:16:54,600  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:16:54,600  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:16:54,600  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:54,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713961014, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, bucketing_version=2, transactional=false, rawDataSize=0, totalSize=0, numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:16:54,611  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:16:54,636  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:54,636  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=34, isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:54,636  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0); Time taken: 0.036 seconds
2024-04-24T05:16:54,636  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_69b1670f-ee47-4b67-8538-6b086c23ecd0
2024-04-24T05:16:54,642  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T05:16:54,651  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:54,651  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T05:16:54,652  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T05:16:54,652  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9): insert into Tstage values(0,2),(0,4)
2024-04-24T05:16:54,658  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-24T05:16:54,659  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T05:16:54,660  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:16:54,660  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:16:55,208  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T05:16:55,211  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T05:16:55,211  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T05:16:55,212  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T05:16:55,212  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T05:16:55,220  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T05:16:55,221  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-24T05:16:55,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:55,339  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:55,340  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:16:55,340  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:16:55,340  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:16:55,340  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:16:55,342  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:55,360  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:55,360  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:16:55,361  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T05:16:56,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:16:57,212  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:16:57,213  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:16:57,213  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:16:57,215  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:16:57,218  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:16:57,218  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:16:57,220  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:16:57,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:57,235  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:57,288  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1
2024-04-24T05:16:57,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T05:16:57,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T05:16:57,317  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:16:57,384  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:16:57,397  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:16:57,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:16:57,449  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:57,454  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T05:16:57,456  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:16:57,473  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:57,502  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:16:57,507  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T05:16:57,507  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:16:57,507  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:16:57,507  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:16:57,507  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T05:16:57,507  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T05:16:57,509  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:16:57,509  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:16:57,509  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:57,510  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T05:16:57,510  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:57,510  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, getAllTableConstraints_(AllTableConstraintsRequest)=56, openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=138, commitTxn_(CommitTxnRequest)=14, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=1, getCheckConstraints_(CheckConstraintsRequest)=5, getNotNullConstraints_(NotNullConstraintsRequest)=4}
2024-04-24T05:16:57,510  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9); Time taken: 2.858 seconds
2024-04-24T05:16:57,510  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9
2024-04-24T05:16:57,511  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9
2024-04-24T05:16:57,537  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T05:16:57,537  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:16:57,537  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9): insert into Tstage values(0,2),(0,4)
2024-04-24T05:16:57,538  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9
2024-04-24T05:16:57,538  INFO [main] ql.Driver: Query ID = alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9
Total jobs = 1
2024-04-24T05:16:57,538  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:16:57,538  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:16:57,710  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:16:57,710  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:16:57,718  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:16:57,720  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T05:16:57,720  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-16-54_652_4263553171726694292-1/dummy_path
2024-04-24T05:16:57,784  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:16:57,807  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,09KB
2024-04-24T05:16:57,912  INFO [main] beanutils.FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2024-04-24T05:16:57,926  WARN [main] impl.MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-jobtracker.properties,hadoop-metrics2.properties
2024-04-24T05:16:57,942  INFO [main] impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-04-24T05:16:57,942  INFO [main] impl.MetricsSystemImpl: JobTracker metrics system started
2024-04-24T05:16:57,954  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-16-54_652_4263553171726694292-1/-mr-10001
2024-04-24T05:16:57,970  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:16:58,013  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:16:58,022  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:16:58,028  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T05:16:58,028  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T05:16:58,028  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-16-54_652_4263553171726694292-1/dummy_path
2024-04-24T05:16:58,028  INFO [main] io.NullRowsInputFormat$NullRowsRecordReader: Using null rows input format
2024-04-24T05:16:58,035  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:16:58,065  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:16:58,123  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local142673330_0001
2024-04-24T05:16:58,123  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:16:58,265  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:16:58,267  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:16:58,267  INFO [Thread-78] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:16:58,268  INFO [Thread-78] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:16:58,282  INFO [Thread-78] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:16:58,286  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local142673330_0001_m_000000_0
2024-04-24T05:16:58,321  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:16:58,329  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-16-54_652_4263553171726694292-1/dummy_path/null:0+1
2024-04-24T05:16:58,335  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:16:58,360  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,09KB
2024-04-24T05:16:58,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T05:16:58,376  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:16:58,377  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:16:58,380  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:16:58,380  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:16:58,382  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T05:16:58,383  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T05:16:58,383  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:16:58,383  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T05:16:58,384  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:16:58,385  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local142673330_0001/job_local142673330_0001.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@7a60f6c3
2024-04-24T05:16:58,390  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/_tmp.-ext-10002/000000_0
2024-04-24T05:16:58,390  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:16:58,390  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/_tmp.-ext-10002/000000_0
2024-04-24T05:16:58,405  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:16:58,420  INFO [LocalJobRunner Map Task Executor #0] impl.HadoopShimsPre2_7: Can't get KeyProvider for ORC encryption from hadoop.security.key.provider.path.
2024-04-24T05:16:58,424  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T05:16:58,475  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T05:16:58,480  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:16:58,481  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:16:58,481  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T05:16:58,481  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, 
2024-04-24T05:16:58,481  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:16:58,481  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:16:58,481  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:16:58,481  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:16:58,482  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T05:16:58,482  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T05:16:58,482  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:16:58,482  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:16:58,482  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:16:58,482  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T05:16:58,523  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:16:58,526  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:16:58,532  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local142673330_0001_m_000000_0 is done. And is in the process of committing
2024-04-24T05:16:58,533  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:16:58,533  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local142673330_0001_m_000000_0' done.
2024-04-24T05:16:58,535  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local142673330_0001_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=6553
		FILE: Number of bytes written=1178228
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=898629632
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6148
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:16:58,535  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local142673330_0001_m_000000_0
2024-04-24T05:16:58,536  INFO [Thread-78] mapred.LocalJobRunner: map task executor complete.
2024-04-24 05:16:59,291 Stage-1 map = 100%,  reduce = 0%
2024-04-24T05:16:59,292  INFO [main] exec.Task: 2024-04-24 05:16:59,291 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local142673330_0001
2024-04-24T05:16:59,300  INFO [main] exec.Task: Ended Job = job_local142673330_0001
2024-04-24T05:16:59,349  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T05:16:59,350  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T05:16:59,350  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T05:16:59,350  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T05:16:59,350  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/-ext-10000
2024-04-24T05:16:59,352  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/-ext-10002
2024-04-24T05:16:59,357  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T05:16:59,357  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1/-ext-10000
2024-04-24T05:16:59,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:16:59,371  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:16:59,384  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,390  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:16:59,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:16:59,448  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T05:16:59,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:16:59,461  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,461  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T05:16:59,462  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-16-54_652_4263553171726694292-1/-mr-10001
2024-04-24T05:16:59,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:16:59,480  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,482  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T05:16:59,482  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T05:16:59,483  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:16:59,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:16:59,521  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T05:16:59,521  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:59,521  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=54, alter_table_(String, String, String, Table, EnvironmentContext, String)=92}
MapReduce Jobs Launched: 
2024-04-24T05:16:59,522  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:16:59,528  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:16:59,528  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:16:59,528  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9); Time taken: 1.984 seconds
2024-04-24T05:16:59,528  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051654_31fdb71a-eecb-460c-9d11-b17fa9948db9
2024-04-24T05:16:59,533  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T05:16:59,542  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:59,542  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T05:16:59,543  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:16:59,543  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1
2024-04-24T05:16:59,544  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-16-54_652_4263553171726694292-1 on fs with scheme file
2024-04-24T05:16:59,544  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-16-54_652_4263553171726694292-1
2024-04-24T05:16:59,544  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-16-54_652_4263553171726694292-1 on fs with scheme file
2024-04-24T05:16:59,545  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:16:59,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:59,563  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,567  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T05:16:59,568  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T05:16:59,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:59,591  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,595  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,595  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,595  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,595  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,599  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:59,599  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:59,599  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:59,599  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getCurrentNotificationEventId_()=5, getValidTxns_(long)=1, openTxn_(String, TxnType)=4, flushCache_()=1, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=33}
2024-04-24T05:16:59,600  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b); Time taken: 0.054 seconds
2024-04-24T05:16:59,600  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b
2024-04-24T05:16:59,601  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b
2024-04-24T05:16:59,633  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T05:16:59,633  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:16:59,633  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:16:59,634  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:16:59,634  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,634  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,634  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,634  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:16:59,673  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:16:59,680  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:59,680  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:59,680  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b); Time taken: 0.047 seconds
2024-04-24T05:16:59,680  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051659_a626568f-9ffb-4631-a746-33a447b4685b
2024-04-24T05:16:59,687  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T05:16:59,697  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:59,697  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T05:16:59,698  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:16:59,698  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:16:59,699  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:59,724  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,727  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T05:16:59,728  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T05:16:59,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:16:59,752  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,752  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,752  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,753  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,753  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,753  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:59,753  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:59,754  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:59,754  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCurrentNotificationEventId_()=2, getValidTxns_(long)=1, getTable_(GetTableRequest)=46, commitTxn_(CommitTxnRequest)=17, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=4}
2024-04-24T05:16:59,754  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21); Time taken: 0.055 seconds
2024-04-24T05:16:59,755  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21
2024-04-24T05:16:59,756  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21
2024-04-24T05:16:59,784  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T05:16:59,784  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:16:59,784  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:16:59,785  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:16:59,785  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,785  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,785  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,785  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:16:59,798  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:16:59,804  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:16:59,805  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:16:59,805  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21); Time taken: 0.02 seconds
2024-04-24T05:16:59,805  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051659_c67d8cc7-6930-4ca2-8303-0233f3806d21
2024-04-24T05:16:59,812  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T05:16:59,822  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T05:16:59,823  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T05:16:59,824  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:16:59,824  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:16:59,831  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T05:16:59,831  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T05:16:59,833  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:16:59,851  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,880  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T05:16:59,880  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T05:16:59,884  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:16:59,884  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:16:59,884  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:16:59,884  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=18, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=18, allocateTableWriteId_(long, String, String)=11, flushCache_()=1, getValidTxns_(long)=1}
2024-04-24T05:16:59,884  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6); Time taken: 0.06 seconds
2024-04-24T05:16:59,885  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6
2024-04-24T05:16:59,885  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6
2024-04-24T05:16:59,915  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T05:16:59,915  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:16:59,923  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:16:59,923  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:16:59,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:16:59,944  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:16:59,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:16:59,999  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:00,000  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1
2024-04-24T05:17:00,001  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2
2024-04-24T05:17:00,055  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T05:17:00,056  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data
2024-04-24T05:17:00,056  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:00,070  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:00,072  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:00,097  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T05:17:00,098  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:00,098  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:00,112  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:00,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:00,127  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T05:17:00,133  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:00,133  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T05:17:00,205  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:00,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:00,258  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T05:17:00,258  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data
2024-04-24T05:17:00,258  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:00,272  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:00,273  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:00,288  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T05:17:00,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:00,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:00,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:00,302  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:00,316  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T05:17:00,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:00,321  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T05:17:00,368  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:00,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:00,404  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:00,404  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=178, getValidWriteIds_(List, String)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=98, validatePartitionNameCharacters_(List)=1, getTable_(GetTableRequest)=76, isCompatibleWith_(Configuration)=0, add_partitions_(List, boolean, boolean)=109}
2024-04-24T05:17:00,404  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6); Time taken: 0.481 seconds
2024-04-24T05:17:00,404  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051659_8b056666-612e-4d3d-9c1a-2881d568e8c6
2024-04-24T05:17:00,409  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T05:17:00,417  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:00,417  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T05:17:00,418  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-24T05:17:00,419  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e): select p, a, b from T order by p, a, b
2024-04-24T05:17:00,424  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T05:17:00,424  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T05:17:00,425  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:00,425  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:00,434  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:00,434  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:00,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:00,448  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:00,449  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:00,449  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:00,449  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:00,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:00,630  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:00,631  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:00,693  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:00,709  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:00,709  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:00,741  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:00,741  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:00,800  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:00,800  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:00,800  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:00,807  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-00_418_7058514647200924696-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-00_418_7058514647200924696-1
2024-04-24T05:17:00,836  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:00,843  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T05:17:00,843  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T05:17:00,844  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:00,852  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:00,863  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:00,864  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:00,864  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:00,880  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:00,880  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:00,880  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:00,880  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:00,880  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:00,881  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:00,881  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:00,881  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:00,881  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:00,881  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:00,881  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:00,881  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:00,881  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:00,881  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T05:17:00,884  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T05:17:00,885  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:00,885  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {listPartitions_(String, String, short)=40, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, getAllTableConstraints_(AllTableConstraintsRequest)=41, getValidWriteIds_(List, String)=6, getAggrColStatsFor_(String, String, List, List, String, String)=46, flushCache_()=0, getTable_(GetTableRequest)=14}
2024-04-24T05:17:00,885  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e); Time taken: 0.466 seconds
2024-04-24T05:17:00,885  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e
2024-04-24T05:17:00,887  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e
2024-04-24T05:17:00,911  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T05:17:00,911  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:00,912  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e): select p, a, b from T order by p, a, b
2024-04-24T05:17:00,912  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e
2024-04-24T05:17:00,912  INFO [main] ql.Driver: Query ID = alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e
Total jobs = 1
2024-04-24T05:17:00,912  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:00,912  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:01,060  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:01,061  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:01,061  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:01,061  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:01,061  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:01,061  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:01,061  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:01,061  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:01,063  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:01,064  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:01,064  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:01,072  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-00_418_7058514647200924696-1/-mr-10004/ed11e507-1191-466c-a422-98bb3055db2c (false)
2024-04-24T05:17:01,081  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:01,091  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,99KB
2024-04-24T05:17:01,096  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:01,100  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T05:17:01,101  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:01,108  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:01,116  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:01,120  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:01,122  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:01,122  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:01,122  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:01,137  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:01,142  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-24T05:17:01,142  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:01,162  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T05:17:01,163  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 25 ms
2024-04-24T05:17:01,163  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T05:17:01,181  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T05:17:01,200  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1319234805_0002
2024-04-24T05:17:01,200  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:01,269  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:01,269  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:01,269  INFO [Thread-156] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:01,269  INFO [Thread-156] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:01,273  INFO [Thread-156] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:01,273  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1319234805_0002_m_000000_0
2024-04-24T05:17:01,274  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:01,275  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:01,276  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:01,284  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-24T05:17:01,287  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:01,303  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:01,313  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:01,313  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:01,313  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:01,313  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:01,313  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:01,315  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:01,317  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:01,320  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:01,321  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:01,321  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:01,324  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:01,324  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:01,336  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:01,337  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:01,337  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:01,337  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T05:17:01,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:01,337  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:01,338  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:01,338  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T05:17:01,338  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:01,338  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:01,338  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T05:17:01,339  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:01,339  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:01,339  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:01,339  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T05:17:01,339  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:01,356  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:01,360  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1319234805_0002_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:01,361  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:01,361  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1319234805_0002_m_000000_0' done.
2024-04-24T05:17:01,362  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1319234805_0002_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=18662
		FILE: Number of bytes written=2372936
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=900726784
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8134
2024-04-24T05:17:01,362  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1319234805_0002_m_000000_0
2024-04-24T05:17:01,362  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1319234805_0002_m_000001_0
2024-04-24T05:17:01,363  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:01,363  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:01,364  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:01,366  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-24T05:17:01,367  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:01,369  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:01,441  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:01,442  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:01,442  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:01,442  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:01,442  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:01,444  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:01,444  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:01,444  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:01,445  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:01,445  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:01,445  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:01,445  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:01,446  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:01,446  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:01,446  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:01,446  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:01,446  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:01,446  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T05:17:01,447  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:01,456  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:01,459  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1319234805_0002_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:01,461  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:01,461  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1319234805_0002_m_000001_0' done.
2024-04-24T05:17:01,461  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1319234805_0002_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=27351
		FILE: Number of bytes written=2373026
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=67
		Total committed heap usage (bytes)=966787072
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8134
2024-04-24T05:17:01,461  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1319234805_0002_m_000001_0
2024-04-24T05:17:01,461  INFO [Thread-156] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:01,464  INFO [Thread-156] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:01,464  INFO [pool-16-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1319234805_0002_r_000000_0
2024-04-24T05:17:01,468  INFO [pool-16-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:01,471  INFO [pool-16-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@458b2e37
2024-04-24T05:17:01,472  WARN [pool-16-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:01,485  INFO [pool-16-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:01,487  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1319234805_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:01,507  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local1319234805_0002_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-24T05:17:01,509  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1319234805_0002_m_000001_0
2024-04-24T05:17:01,511  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-24T05:17:01,514  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local1319234805_0002_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-24T05:17:01,515  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1319234805_0002_m_000000_0
2024-04-24T05:17:01,515  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-24T05:17:01,515  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:01,515  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:01,516  INFO [pool-16-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:01,528  INFO [pool-16-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T05:17:01,528  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 64 bytes
2024-04-24T05:17:01,531  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 108 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:01,531  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 1 files, 110 bytes from disk
2024-04-24T05:17:01,532  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:01,532  INFO [pool-16-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:01,532  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 84 bytes
2024-04-24T05:17:01,532  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:01,534  INFO [pool-16-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:01,536  INFO [pool-16-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T05:17:01,538  INFO [pool-16-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:01,538  INFO [pool-16-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:01,538  INFO [pool-16-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-24T05:17:01,538  INFO [pool-16-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:01,539  INFO [pool-16-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@45d27b75, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@477d704f, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@2a6f0060
2024-04-24T05:17:01,543  INFO [pool-16-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-00_418_7058514647200924696-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-00_418_7058514647200924696-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:01,543  INFO [pool-16-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-00_418_7058514647200924696-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-00_418_7058514647200924696-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:01,543  INFO [pool-16-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-00_418_7058514647200924696-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-00_418_7058514647200924696-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:01,564  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:01,564  INFO [pool-16-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:01,564  INFO [pool-16-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:01,564  INFO [pool-16-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:01,564  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T05:17:01,565  INFO [pool-16-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:4, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-24T05:17:01,565  INFO [pool-16-thread-1] mapred.Task: Task:attempt_local1319234805_0002_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:01,566  INFO [pool-16-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:01,566  INFO [pool-16-thread-1] mapred.Task: Task 'attempt_local1319234805_0002_r_000000_0' done.
2024-04-24T05:17:01,567  INFO [pool-16-thread-1] mapred.Task: Final Counters for attempt_local1319234805_0002_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=34858
		FILE: Number of bytes written=2373307
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=116
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=966787072
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:01,567  INFO [pool-16-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1319234805_0002_r_000000_0
2024-04-24T05:17:01,567  INFO [Thread-156] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:02,278 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:02,278  INFO [main] exec.Task: 2024-04-24 05:17:02,278 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1319234805_0002
2024-04-24T05:17:02,280  INFO [main] exec.Task: Ended Job = job_local1319234805_0002
2024-04-24T05:17:02,283  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:02,283  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:02,283  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:02,283  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:02,283  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:02,283  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e); Time taken: 1.371 seconds
2024-04-24T05:17:02,283  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051700_c41477ac-5583-4822-b9e9-f549abdfa58e
2024-04-24T05:17:02,290  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T05:17:02,301  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:02,301  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T05:17:02,311  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:02,325  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T05:17:02,325  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:02,325  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-24T05:17:02,325  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4

2024-04-24T05:17:02,325  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T05:17:02,325  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-00_418_7058514647200924696-1
2024-04-24T05:17:02,326  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-00_418_7058514647200924696-1 on fs with scheme file
2024-04-24T05:17:02,327  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051702_c0deb25f-36bc-4c11-aeb2-52790c0d77b9): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T05:17:02,332  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T05:17:02,333  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T05:17:02,334  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:02,337  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:02,337  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:02,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:02,353  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,354  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:02,354  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:02,354  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:02,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:02,385  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:02,385  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:02,412  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:02,430  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,430  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:02,447  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:02,447  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:02,509  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:02,510  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:02,510  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:02,513  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:02,518  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T05:17:02,518  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T05:17:02,519  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:02,550  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:02,560  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:02,561  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:02,561  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:02,562  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:02,563  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:02,564  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:02,564  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:02,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:02,565  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=9, commitTxn_(CommitTxnRequest)=18, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=15, flushCache_()=0, getValidWriteIds_(List, String)=3, listPartitions_(String, String, short)=13, getValidTxns_(long)=1, getAggrColStatsFor_(String, String, List, List, String, String)=34, openTxn_(String, TxnType)=4}
2024-04-24T05:17:02,565  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051702_c0deb25f-36bc-4c11-aeb2-52790c0d77b9); Time taken: 0.238 seconds
2024-04-24T05:17:02,565  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051702_c0deb25f-36bc-4c11-aeb2-52790c0d77b9): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T05:17:02,566  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:02,598  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:02,598  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:02,598  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051702_c0deb25f-36bc-4c11-aeb2-52790c0d77b9); Time taken: 0.032 seconds
2024-04-24T05:17:02,598  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:02,604  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T05:17:02,614  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:02,614  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T05:17:02,617  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:02,618  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-02_327_3971055226107592335-1
2024-04-24T05:17:02,619  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-02_327_3971055226107592335-1 on fs with scheme file
2024-04-24T05:17:02,619  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:02,620  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:02,639  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,643  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T05:17:02,644  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T05:17:02,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:02,660  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,660  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,660  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,660  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,660  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,661  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:02,661  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:02,661  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:02,661  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=31, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=17, flushCache_()=0, getCurrentNotificationEventId_()=3, openTxn_(String, TxnType)=4}
2024-04-24T05:17:02,661  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea); Time taken: 0.042 seconds
2024-04-24T05:17:02,661  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea
2024-04-24T05:17:02,662  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea
2024-04-24T05:17:02,681  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T05:17:02,681  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:02,682  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:02,682  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:02,682  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,682  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,682  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,682  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:02,695  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:02,701  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:02,701  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:02,701  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea); Time taken: 0.019 seconds
2024-04-24T05:17:02,701  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051702_2158b260-bea4-4448-b6ae-860ed296e9ea
2024-04-24T05:17:02,706  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T05:17:02,714  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:02,715  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T05:17:02,716  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:02,720  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T05:17:02,720  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T05:17:02,722  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:02,736  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,748  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T05:17:02,749  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T05:17:02,750  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:02,750  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:02,750  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:02,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=15, allocateTableWriteId_(long, String, String)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T05:17:02,750  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd); Time taken: 0.034 seconds
2024-04-24T05:17:02,751  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd
2024-04-24T05:17:02,751  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd
2024-04-24T05:17:02,771  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T05:17:02,771  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:02,776  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:02,776  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:02,776  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:02,790  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,791  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:02,821 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T05:17:02,821 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T05:17:02,823 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T05:17:02,824 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:02,827 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:02,828  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:02,828  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14}
2024-04-24T05:17:02,828  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd); Time taken: 0.052 seconds
2024-04-24T05:17:02,828  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051702_edfc84e1-f996-422e-8712-129bfe514bbd
2024-04-24T05:17:02,831  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:02,841  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:02,842  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:02,845  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T05:17:02,846  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T05:17:02,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:02,860  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:02,878  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T05:17:02,893  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:02,906  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T05:17:02,906  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T05:17:02,907  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:02,907  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:02,907  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:02,907  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, allocateTableWriteId_(long, String, String)=6, getPartitionWithAuthInfo_(String, String, List, String, List)=27, rollbackTxn_(long)=12, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T05:17:02,908  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2); Time taken: 0.065 seconds
2024-04-24T05:17:02,908  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2
2024-04-24T05:17:02,908  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2
2024-04-24T05:17:02,928  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T05:17:02,928  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:02,938  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:02,938  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:02,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:02,952  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:02,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:02,968  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:02,971  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:02,974  INFO [HMSHandler #3] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3
2024-04-24T05:17:03,018  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T05:17:03,018  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data
2024-04-24T05:17:03,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:03,033  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:03,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:03,049  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T05:17:03,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:03,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:03,062  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:03,062  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:03,075  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T05:17:03,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:03,080  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T05:17:03,130  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:03,167  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:03,182  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:03,182  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=42, getPartitionWithAuthInfo_(String, String, List, String, List)=42, validatePartitionNameCharacters_(List)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=87, add_partitions_(List, boolean, boolean)=65, getValidWriteIds_(List, String)=0}
2024-04-24T05:17:03,183  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2); Time taken: 0.244 seconds
2024-04-24T05:17:03,183  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051702_fcd01f51-d0b6-406e-b3b2-b9442590e1d2
2024-04-24T05:17:03,188  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T05:17:03,196  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:03,198  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T05:17:03,199  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-24T05:17:03,200  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882): select p, a, b from T order by p, a, b
2024-04-24T05:17:03,212  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-24T05:17:03,212  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T05:17:03,215  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:03,215  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:03,222  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:03,222  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:03,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:03,237  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:03,237  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:03,237  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:03,237  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:03,251  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:03,294  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:03,295  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:03,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:03,365  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:03,365  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:03,388  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:03,388  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:03,444  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:03,445  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:03,445  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:03,446  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-03_199_8824097547715888787-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-03_199_8824097547715888787-1
2024-04-24T05:17:03,454  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:03,457  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T05:17:03,457  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T05:17:03,458  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:03,459  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:03,469  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:03,470  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:03,470  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:03,471  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:03,471  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:03,471  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:03,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:03,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T05:17:03,473  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T05:17:03,473  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:03,474  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, listPartitions_(String, String, short)=36, commitTxn_(CommitTxnRequest)=16, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=37, isCompatibleWith_(Configuration)=1, getAggrColStatsFor_(String, String, List, List, String, String)=37, getValidWriteIds_(List, String)=7, openTxn_(String, TxnType)=11, getTable_(GetTableRequest)=14}
2024-04-24T05:17:03,474  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882); Time taken: 0.273 seconds
2024-04-24T05:17:03,474  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882
2024-04-24T05:17:03,476  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882
2024-04-24T05:17:03,501  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882 LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T05:17:03,501  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:03,502  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882): select p, a, b from T order by p, a, b
2024-04-24T05:17:03,502  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882
2024-04-24T05:17:03,502  INFO [main] ql.Driver: Query ID = alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882
Total jobs = 1
2024-04-24T05:17:03,502  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:03,502  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:03,660  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:03,660  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:03,660  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:03,660  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:03,660  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:03,660  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:03,660  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:03,661  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:03,663  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:03,663  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:03,663  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:03,672  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-03_199_8824097547715888787-1/-mr-10004/4c372c6f-b818-4707-a5ec-8df3a61e3e27 (false)
2024-04-24T05:17:03,682  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:03,684  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,35KB
2024-04-24T05:17:03,689  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:03,691  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T05:17:03,692  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:03,698  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:03,706  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:03,711  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:03,712  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:03,712  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:03,712  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:03,724  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:03,724  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-24T05:17:03,724  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:03,732  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T05:17:03,732  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 8 ms
2024-04-24T05:17:03,732  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T05:17:03,752  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T05:17:03,772  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1368667581_0003
2024-04-24T05:17:03,772  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:03,835  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:03,835  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:03,835  INFO [Thread-250] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:03,835  INFO [Thread-250] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:03,837  INFO [Thread-250] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:03,837  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1368667581_0003_m_000000_0
2024-04-24T05:17:03,838  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:03,838  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:03,839  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:03,841  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-24T05:17:03,843  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:03,844  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:03,862  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:03,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:03,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:03,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:03,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:03,863  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:03,864  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:03,864  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:03,865  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:03,865  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:03,865  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:03,865  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:03,866  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:03,866  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:03,866  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:03,866  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T05:17:03,866  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:03,866  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:03,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:03,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:03,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:03,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:03,867  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T05:17:03,868  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:03,868  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:03,868  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:03,868  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T05:17:03,868  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:03,880  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:03,883  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1368667581_0003_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:03,884  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:03,884  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1368667581_0003_m_000000_0' done.
2024-04-24T05:17:03,885  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1368667581_0003_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=51497
		FILE: Number of bytes written=3570947
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=966787072
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-24T05:17:03,885  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1368667581_0003_m_000000_0
2024-04-24T05:17:03,885  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1368667581_0003_m_000001_0
2024-04-24T05:17:03,886  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:03,886  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:03,887  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:03,888  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-24T05:17:03,891  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:03,893  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:03,913  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:03,913  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:03,913  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:03,913  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:03,913  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:03,915  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:03,915  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:03,915  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:03,916  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:03,916  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:03,916  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:03,916  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:03,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:03,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:03,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:03,917  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:03,917  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:03,917  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T05:17:03,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:03,928  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:03,931  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1368667581_0003_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:03,932  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:03,932  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1368667581_0003_m_000001_0' done.
2024-04-24T05:17:03,933  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1368667581_0003_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=61071
		FILE: Number of bytes written=3571037
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=15
		Total committed heap usage (bytes)=966787072
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-24T05:17:03,933  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1368667581_0003_m_000001_0
2024-04-24T05:17:03,933  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1368667581_0003_m_000002_0
2024-04-24T05:17:03,933  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:03,934  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:03,934  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:03,935  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-24T05:17:03,937  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:03,938  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:03,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:03,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:03,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:03,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:03,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:03,944  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:03,945  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:03,945  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:03,946  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:03,946  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:03,946  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:03,946  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:03,946  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:03,947  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T05:17:03,948  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:03,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:03,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:03,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-24T05:17:03,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:03,956  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:03,959  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1368667581_0003_m_000002_0 is done. And is in the process of committing
2024-04-24T05:17:03,960  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:03,961  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1368667581_0003_m_000002_0' done.
2024-04-24T05:17:03,961  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1368667581_0003_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=70133
		FILE: Number of bytes written=3571127
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=966787072
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-24T05:17:03,961  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1368667581_0003_m_000002_0
2024-04-24T05:17:03,961  INFO [Thread-250] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:03,962  INFO [Thread-250] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:03,962  INFO [pool-21-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1368667581_0003_r_000000_0
2024-04-24T05:17:03,963  INFO [pool-21-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:03,963  INFO [pool-21-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7aa58d11
2024-04-24T05:17:03,963  WARN [pool-21-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:03,964  INFO [pool-21-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:03,965  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1368667581_0003_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:03,968  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local1368667581_0003_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-24T05:17:03,968  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1368667581_0003_m_000001_0
2024-04-24T05:17:03,968  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-24T05:17:03,970  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local1368667581_0003_m_000002_0 decomp: 54 len: 58 to MEMORY
2024-04-24T05:17:03,971  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1368667581_0003_m_000002_0
2024-04-24T05:17:03,971  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-24T05:17:03,973  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local1368667581_0003_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-24T05:17:03,973  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local1368667581_0003_m_000000_0
2024-04-24T05:17:03,973  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 3, commitMemory -> 108, usedMemory ->162
2024-04-24T05:17:03,974  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:03,974  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:03,974  INFO [pool-21-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:03,980  INFO [pool-21-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T05:17:03,980  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 96 bytes
2024-04-24T05:17:03,983  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 162 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:03,983  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 1 files, 162 bytes from disk
2024-04-24T05:17:03,983  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:03,983  INFO [pool-21-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:03,983  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 136 bytes
2024-04-24T05:17:03,983  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:03,984  INFO [pool-21-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:03,985  INFO [pool-21-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,15KB
2024-04-24T05:17:03,987  INFO [pool-21-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:03,987  INFO [pool-21-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:03,987  INFO [pool-21-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-24T05:17:03,987  INFO [pool-21-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:03,988  INFO [pool-21-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@13b7a27e, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@14892a13, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@d50b5a
2024-04-24T05:17:03,988  INFO [pool-21-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-03_199_8824097547715888787-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-03_199_8824097547715888787-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:03,988  INFO [pool-21-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-03_199_8824097547715888787-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-03_199_8824097547715888787-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:03,988  INFO [pool-21-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-03_199_8824097547715888787-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-03_199_8824097547715888787-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:03,996  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:03,996  INFO [pool-21-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:03,996  INFO [pool-21-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:6, 
2024-04-24T05:17:03,997  INFO [pool-21-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:03,997  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T05:17:03,997  INFO [pool-21-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, 
2024-04-24T05:17:03,998  INFO [pool-21-thread-1] mapred.Task: Task:attempt_local1368667581_0003_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:03,998  INFO [pool-21-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:03,998  INFO [pool-21-thread-1] mapred.Task: Task 'attempt_local1368667581_0003_r_000000_0' done.
2024-04-24T05:17:03,998  INFO [pool-21-thread-1] mapred.Task: Final Counters for attempt_local1368667581_0003_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=77783
		FILE: Number of bytes written=3571496
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=174
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=966787072
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:03,999  INFO [pool-21-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1368667581_0003_r_000000_0
2024-04-24T05:17:03,999  INFO [Thread-250] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:04,853 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:04,853  INFO [main] exec.Task: 2024-04-24 05:17:04,853 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1368667581_0003
2024-04-24T05:17:04,858  INFO [main] exec.Task: Ended Job = job_local1368667581_0003
2024-04-24T05:17:04,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:04,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:04,860  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:04,860  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:04,860  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:04,860  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882); Time taken: 1.358 seconds
2024-04-24T05:17:04,861  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051703_8a769004-419e-4c4f-b14c-149d2889b882
2024-04-24T05:17:04,866  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T05:17:04,874  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:04,874  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T05:17:04,879  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:04,879  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T05:17:04,880  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:6, 
2024-04-24T05:17:04,880  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-24T05:17:04,880  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4
3	0	2
3	0	4

2024-04-24T05:17:04,880  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T05:17:04,880  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-03_199_8824097547715888787-1
2024-04-24T05:17:04,881  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-03_199_8824097547715888787-1 on fs with scheme file
2024-04-24T05:17:04,881  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051704_04f24ce8-32a5-490b-b9f1-b49ba59e06a4): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T05:17:04,885  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T05:17:04,886  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T05:17:04,887  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:04,890  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:04,890  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:04,891  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:04,904  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:04,905  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:04,905  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:04,905  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:04,920  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:04,934  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:04,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:04,965  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:04,983  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:04,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:05,000  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:05,000  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:05,053  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:05,053  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:05,053  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:05,055  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:05,058  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T05:17:05,058  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T05:17:05,059  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:05,081  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:05,091  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:05,092  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:05,092  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:05,094  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:05,094  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:05,094  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:05,094  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:05,094  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:05,095  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAggrColStatsFor_(String, String, List, List, String, String)=35, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=11, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=4, getAllTableConstraints_(AllTableConstraintsRequest)=7, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, getTable_(GetTableRequest)=14, getValidTxns_(long)=1}
2024-04-24T05:17:05,095  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051704_04f24ce8-32a5-490b-b9f1-b49ba59e06a4); Time taken: 0.213 seconds
2024-04-24T05:17:05,095  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051704_04f24ce8-32a5-490b-b9f1-b49ba59e06a4): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-24T05:17:05,095  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:05,107  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:05,107  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:05,108  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051704_04f24ce8-32a5-490b-b9f1-b49ba59e06a4); Time taken: 0.012 seconds
2024-04-24T05:17:05,108  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:05,113  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T05:17:05,119  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:05,120  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T05:17:05,121  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:05,121  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-04_881_1353405173055012032-1
2024-04-24T05:17:05,122  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6c4b897a-0105-4e42-96a4-98068a114754/hive_2024-04-24_05-17-04_881_1353405173055012032-1 on fs with scheme file
2024-04-24T05:17:05,122  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54): drop table if exists acidTbl
2024-04-24T05:17:05,125  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T05:17:05,125  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T05:17:05,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:05,135  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,135  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:05,135  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:05,135  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:05,135  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=1, flushCache_()=0}
2024-04-24T05:17:05,135  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54); Time taken: 0.013 seconds
2024-04-24T05:17:05,136  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54
2024-04-24T05:17:05,136  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54
2024-04-24T05:17:05,155  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T05:17:05,155  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:05,155  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54): drop table if exists acidTbl
2024-04-24T05:17:05,155  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:05,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:05,165  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:05,175  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:05,363  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:05,363  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=197, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:05,363  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54); Time taken: 0.208 seconds
2024-04-24T05:17:05,364  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051705_388ce824-146c-4fd8-9a8d-7d32cb7eba54
2024-04-24T05:17:05,368  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T05:17:05,376  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:05,378  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T05:17:05,378  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:05,379  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533): drop table if exists acidTblPart
2024-04-24T05:17:05,388  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T05:17:05,389  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T05:17:05,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:05,418  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,418  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:05,418  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:05,418  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:05,418  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=10, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=28}
2024-04-24T05:17:05,418  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533); Time taken: 0.039 seconds
2024-04-24T05:17:05,419  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533
2024-04-24T05:17:05,419  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533
2024-04-24T05:17:05,442  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T05:17:05,442  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:05,442  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533): drop table if exists acidTblPart
2024-04-24T05:17:05,442  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:05,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:05,452  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,452  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:05,461  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:05,521  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:05,521  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=69, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10}
2024-04-24T05:17:05,521  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533); Time taken: 0.079 seconds
2024-04-24T05:17:05,522  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051705_0aea516b-ae71-444d-86dc-f29a2e632533
2024-04-24T05:17:05,526  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T05:17:05,534  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:05,534  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T05:17:05,535  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:05,535  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051705_82c0cf3d-33b5-47cb-a7be-0674c8185d56): drop table if exists acidTbl2
2024-04-24T05:17:05,538  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T05:17:05,538  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T05:17:05,539  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:05,539  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:05,540  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:05,540  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=2}
2024-04-24T05:17:05,540  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051705_82c0cf3d-33b5-47cb-a7be-0674c8185d56); Time taken: 0.005 seconds
2024-04-24T05:17:05,540  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424051705_82c0cf3d-33b5-47cb-a7be-0674c8185d56
2024-04-24T05:17:05,540  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:05,540  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051705_82c0cf3d-33b5-47cb-a7be-0674c8185d56): drop table if exists acidTbl2
2024-04-24T05:17:05,541  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:05,541  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T05:17:05,542  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:05,542  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-24T05:17:05,542  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051705_82c0cf3d-33b5-47cb-a7be-0674c8185d56); Time taken: 0.002 seconds
2024-04-24T05:17:05,542  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051705_82c0cf3d-33b5-47cb-a7be-0674c8185d56
2024-04-24T05:17:05,548  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T05:17:05,556  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:05,556  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T05:17:05,557  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:05,557  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:05,560  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T05:17:05,561  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T05:17:05,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:05,589  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,589  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:05,589  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:05,589  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:05,589  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=27, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15}
2024-04-24T05:17:05,590  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298); Time taken: 0.032 seconds
2024-04-24T05:17:05,590  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298
2024-04-24T05:17:05,591  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298
2024-04-24T05:17:05,613  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T05:17:05,613  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:05,613  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:05,613  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:05,614  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:05,627  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,627  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:05,640  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,641  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:05,720  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:05,720  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=14, dropTable_(String, String, boolean, boolean, boolean)=93}
2024-04-24T05:17:05,720  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298); Time taken: 0.107 seconds
2024-04-24T05:17:05,720  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051705_f1935e38-f5fd-4173-a047-046c185ea298
2024-04-24T05:17:05,725  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T05:17:05,733  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:05,733  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T05:17:05,734  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:05,735  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:05,738  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-24T05:17:05,738  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T05:17:05,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:05,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,752  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:05,752  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:05,752  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:05,752  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=1, getTable_(GetTableRequest)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13}
2024-04-24T05:17:05,752  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a); Time taken: 0.017 seconds
2024-04-24T05:17:05,752  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a
2024-04-24T05:17:05,753  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a
2024-04-24T05:17:05,772  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T05:17:05,772  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:05,772  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:05,772  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:05,772  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:05,785  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:05,797  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:05,843  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:05,843  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=14, dropTable_(String, String, boolean, boolean, boolean)=57, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:05,843  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a); Time taken: 0.071 seconds
2024-04-24T05:17:05,843  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051705_c0cc5f67-2ca0-4e26-aacc-7546c8b8793a
2024-04-24T05:17:05,848  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T05:17:05,855  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:05,855  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T05:17:05,856  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:05,856  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8): drop table if exists nonAcidNonBucket
2024-04-24T05:17:05,859  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-24T05:17:05,859  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T05:17:05,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:05,872  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,872  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:05,872  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:05,872  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:05,872  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:05,872  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8); Time taken: 0.016 seconds
2024-04-24T05:17:05,873  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8
2024-04-24T05:17:05,873  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8
2024-04-24T05:17:05,891  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8 LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T05:17:05,891  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:05,891  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8): drop table if exists nonAcidNonBucket
2024-04-24T05:17:05,891  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:05,892  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:05,904  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:05,917  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:05,917  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:05,962  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:05,962  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=58}
2024-04-24T05:17:05,962  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8); Time taken: 0.071 seconds
2024-04-24T05:17:05,962  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051705_cb7958fa-9d9d-4a78-a8f4-6b48be5334d8
2024-04-24T05:17:05,967  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T05:17:05,974  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:05,974  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T05:17:05,975  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T05:17:06,060  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T05:17:06,061  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T05:17:06,061  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T05:17:06,063  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 4f149eb3-3afb-47de-9331-e18aabe4b2c4
2024-04-24T05:17:06,066  INFO [main] SessionState: Hive Session ID = 4f149eb3-3afb-47de-9331-e18aabe4b2c4
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:06,067  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:06,072  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4f149eb3-3afb-47de-9331-e18aabe4b2c4
2024-04-24T05:17:06,075  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4
2024-04-24T05:17:06,077  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4f149eb3-3afb-47de-9331-e18aabe4b2c4/_tmp_space.db
2024-04-24T05:17:06,078  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=4f149eb3-3afb-47de-9331-e18aabe4b2c4, clientType=HIVECLI]
2024-04-24T05:17:06,078  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:06,079  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_be9e9b80-5032-45b3-8073-65a1404ee1a3): drop table if exists acidTbl
2024-04-24T05:17:06,088  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T05:17:06,088  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T05:17:06,091  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:06,095  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,095  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,096  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,096  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=9, flushCache_()=0, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:06,096  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_be9e9b80-5032-45b3-8073-65a1404ee1a3); Time taken: 0.017 seconds
2024-04-24T05:17:06,096  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424051706_be9e9b80-5032-45b3-8073-65a1404ee1a3
2024-04-24T05:17:06,096  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:06,096  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_be9e9b80-5032-45b3-8073-65a1404ee1a3): drop table if exists acidTbl
2024-04-24T05:17:06,096  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:06,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,101  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,101  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_be9e9b80-5032-45b3-8073-65a1404ee1a3); Time taken: 0.005 seconds
2024-04-24T05:17:06,101  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_be9e9b80-5032-45b3-8073-65a1404ee1a3
2024-04-24T05:17:06,107  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T05:17:06,115  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,115  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T05:17:06,115  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:06,116  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_f00d2b8e-3247-4176-a38a-f3fdc496b2df): drop table if exists acidTblPart
2024-04-24T05:17:06,119  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T05:17:06,119  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T05:17:06,120  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:06,123  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,123  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,123  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,123  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14}
2024-04-24T05:17:06,124  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_f00d2b8e-3247-4176-a38a-f3fdc496b2df); Time taken: 0.007 seconds
2024-04-24T05:17:06,124  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424051706_f00d2b8e-3247-4176-a38a-f3fdc496b2df
2024-04-24T05:17:06,124  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:06,124  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_f00d2b8e-3247-4176-a38a-f3fdc496b2df): drop table if exists acidTblPart
2024-04-24T05:17:06,124  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:06,129  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,129  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,129  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_f00d2b8e-3247-4176-a38a-f3fdc496b2df); Time taken: 0.005 seconds
2024-04-24T05:17:06,129  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_f00d2b8e-3247-4176-a38a-f3fdc496b2df
2024-04-24T05:17:06,135  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T05:17:06,141  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,141  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T05:17:06,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:06,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_e675f2f8-f47b-462c-9b1e-629d6c1b764e): drop table if exists acidTbl2
2024-04-24T05:17:06,145  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T05:17:06,145  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T05:17:06,146  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:06,150  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,150  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,150  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,150  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13}
2024-04-24T05:17:06,150  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_e675f2f8-f47b-462c-9b1e-629d6c1b764e); Time taken: 0.008 seconds
2024-04-24T05:17:06,151  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424051706_e675f2f8-f47b-462c-9b1e-629d6c1b764e
2024-04-24T05:17:06,151  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:06,151  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_e675f2f8-f47b-462c-9b1e-629d6c1b764e): drop table if exists acidTbl2
2024-04-24T05:17:06,151  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,151  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:06,155  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,155  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,155  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_e675f2f8-f47b-462c-9b1e-629d6c1b764e); Time taken: 0.004 seconds
2024-04-24T05:17:06,155  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_e675f2f8-f47b-462c-9b1e-629d6c1b764e
2024-04-24T05:17:06,161  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T05:17:06,167  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,167  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T05:17:06,168  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:06,168  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_57afd392-ae46-4b2c-bf8e-d924b06943a7): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:06,171  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T05:17:06,171  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T05:17:06,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:06,175  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,175  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,175  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,175  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:06,176  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_57afd392-ae46-4b2c-bf8e-d924b06943a7); Time taken: 0.007 seconds
2024-04-24T05:17:06,176  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424051706_57afd392-ae46-4b2c-bf8e-d924b06943a7
2024-04-24T05:17:06,176  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:06,176  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_57afd392-ae46-4b2c-bf8e-d924b06943a7): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:06,176  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:06,180  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,180  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,180  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_57afd392-ae46-4b2c-bf8e-d924b06943a7); Time taken: 0.004 seconds
2024-04-24T05:17:06,180  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_57afd392-ae46-4b2c-bf8e-d924b06943a7
2024-04-24T05:17:06,185  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T05:17:06,191  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,192  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T05:17:06,192  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:06,193  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_cccac519-2d63-430b-9f60-c1fde884d9eb): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:06,195  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T05:17:06,195  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T05:17:06,196  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:06,200  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,200  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,200  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,201  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_cccac519-2d63-430b-9f60-c1fde884d9eb); Time taken: 0.008 seconds
2024-04-24T05:17:06,201  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424051706_cccac519-2d63-430b-9f60-c1fde884d9eb
2024-04-24T05:17:06,201  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:06,201  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_cccac519-2d63-430b-9f60-c1fde884d9eb): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:06,201  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,201  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:06,205  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,206  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,206  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_cccac519-2d63-430b-9f60-c1fde884d9eb); Time taken: 0.004 seconds
2024-04-24T05:17:06,206  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_cccac519-2d63-430b-9f60-c1fde884d9eb
2024-04-24T05:17:06,212  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T05:17:06,219  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,219  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T05:17:06,220  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:06,221  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_edd7bfe6-59bc-4b75-8c6b-b9d900575713): drop table if exists nonAcidNonBucket
2024-04-24T05:17:06,224  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T05:17:06,224  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T05:17:06,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:06,229  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,229  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,229  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,229  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=3}
2024-04-24T05:17:06,229  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_edd7bfe6-59bc-4b75-8c6b-b9d900575713); Time taken: 0.009 seconds
2024-04-24T05:17:06,230  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424051706_edd7bfe6-59bc-4b75-8c6b-b9d900575713
2024-04-24T05:17:06,230  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:06,230  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_edd7bfe6-59bc-4b75-8c6b-b9d900575713): drop table if exists nonAcidNonBucket
2024-04-24T05:17:06,230  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:06,234  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,234  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,234  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_edd7bfe6-59bc-4b75-8c6b-b9d900575713); Time taken: 0.004 seconds
2024-04-24T05:17:06,234  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_edd7bfe6-59bc-4b75-8c6b-b9d900575713
2024-04-24T05:17:06,240  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T05:17:06,246  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,246  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T05:17:06,247  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,247  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,250  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T05:17:06,250  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T05:17:06,251  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:06,251  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:06,258  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T05:17:06,258  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:06,260  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:06,260  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,260  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,260  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,260  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=6, flushCache_()=0}
2024-04-24T05:17:06,260  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b); Time taken: 0.013 seconds
2024-04-24T05:17:06,260  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b
2024-04-24T05:17:06,261  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b
2024-04-24T05:17:06,283  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T05:17:06,283  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:06,283  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,284  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713961026, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, transactional=true, numFiles=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:06,291  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtbl
2024-04-24T05:17:06,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,348  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=64}
2024-04-24T05:17:06,348  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b); Time taken: 0.065 seconds
2024-04-24T05:17:06,349  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_3a59fc87-ec49-4200-b853-c74b5eec768b
2024-04-24T05:17:06,353  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T05:17:06,359  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,359  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T05:17:06,360  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,360  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,364  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T05:17:06,364  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T05:17:06,365  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:06,365  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:06,367  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T05:17:06,368  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:06,370  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:06,370  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,370  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,370  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,370  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=3, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:06,370  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c); Time taken: 0.01 seconds
2024-04-24T05:17:06,371  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c
2024-04-24T05:17:06,371  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c
2024-04-24T05:17:06,390  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T05:17:06,391  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:06,391  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,392  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,392  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713961026, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:06,399  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtblpart
2024-04-24T05:17:06,420  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,420  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-24T05:17:06,420  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c); Time taken: 0.029 seconds
2024-04-24T05:17:06,420  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_4f0d2da3-0de5-4e20-971e-b5558a72462c
2024-04-24T05:17:06,425  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T05:17:06,433  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,433  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T05:17:06,434  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,434  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,437  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T05:17:06,437  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T05:17:06,438  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:06,438  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:06,441  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T05:17:06,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:06,444  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:06,444  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,444  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,444  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,445  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=13}
2024-04-24T05:17:06,445  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5); Time taken: 0.01 seconds
2024-04-24T05:17:06,445  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5
2024-04-24T05:17:06,446  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5
2024-04-24T05:17:06,464  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T05:17:06,464  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:06,464  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,465  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,466  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713961026, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, transactional=false, numRows=0, bucketing_version=2, numFiles=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:06,478  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl
2024-04-24T05:17:06,499  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,500  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=33, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,500  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5); Time taken: 0.035 seconds
2024-04-24T05:17:06,500  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_41e6d605-87f6-439d-9aa8-a26a90a9a2d5
2024-04-24T05:17:06,505  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T05:17:06,512  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,512  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T05:17:06,513  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,514  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,518  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T05:17:06,518  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T05:17:06,519  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:06,519  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:06,523  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T05:17:06,523  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:06,526  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:06,526  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,526  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,527  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,527  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=4, flushCache_()=0, getDatabase_(String)=3, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:06,527  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1); Time taken: 0.013 seconds
2024-04-24T05:17:06,527  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1
2024-04-24T05:17:06,528  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1
2024-04-24T05:17:06,546  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T05:17:06,546  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:06,546  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,547  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,548  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713961026, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFilesErasureCoded=0, transactional=false, bucketing_version=2, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:06,555  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl2
2024-04-24T05:17:06,579  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,579  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=30}
2024-04-24T05:17:06,579  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1); Time taken: 0.033 seconds
2024-04-24T05:17:06,579  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_5cf7acac-6005-437a-ad52-abe8bc5a6ef1
2024-04-24T05:17:06,585  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T05:17:06,593  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,593  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T05:17:06,594  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,595  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,598  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T05:17:06,598  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T05:17:06,599  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:06,599  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:06,601  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T05:17:06,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:06,603  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:06,603  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,603  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,604  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,604  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=2, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2}
2024-04-24T05:17:06,604  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747); Time taken: 0.008 seconds
2024-04-24T05:17:06,604  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747
2024-04-24T05:17:06,604  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747
2024-04-24T05:17:06,622  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T05:17:06,622  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:06,623  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:06,623  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,624  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/4f149eb3-3afb-47de-9331-e18aabe4b2c4/_tmp_space.db/cf1d8f35-fdb2-4f4a-a426-a35c45b39f75
2024-04-24T05:17:06,628  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,628  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:06,628  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747); Time taken: 0.005 seconds
2024-04-24T05:17:06,628  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_1f7c013e-e69f-4cc5-9fea-247965bb3747
2024-04-24T05:17:06,633  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T05:17:06,640  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,640  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T05:17:06,641  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,641  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,644  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T05:17:06,645  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T05:17:06,646  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:06,646  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:06,648  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T05:17:06,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:06,650  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:06,650  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,650  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,650  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,651  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-24T05:17:06,651  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878); Time taken: 0.009 seconds
2024-04-24T05:17:06,651  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878
2024-04-24T05:17:06,651  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878
2024-04-24T05:17:06,671  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T05:17:06,671  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:06,671  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:06,671  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713961026, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFiles=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, totalSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:06,680  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidnonbucket
2024-04-24T05:17:06,699  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:06,699  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=27}
2024-04-24T05:17:06,699  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878); Time taken: 0.028 seconds
2024-04-24T05:17:06,699  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_9e1557c9-242c-4bb3-b428-f72ce339a878
2024-04-24T05:17:06,704  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T05:17:06,711  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:06,711  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T05:17:06,712  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T05:17:06,712  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637): drop table if exists T
2024-04-24T05:17:06,715  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T05:17:06,716  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T05:17:06,716  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:06,764  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:06,765  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:06,765  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:06,765  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:06,765  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=49, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:06,765  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637); Time taken: 0.053 seconds
2024-04-24T05:17:06,765  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637
2024-04-24T05:17:06,766  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637
2024-04-24T05:17:06,791  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T05:17:06,791  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:06,791  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637): drop table if exists T
2024-04-24T05:17:06,791  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:06,791  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:06,804  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:06,804  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:06,816  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:06,817  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T05:17:07,015  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t does not exist; Force to delete it.
2024-04-24T05:17:07,015 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:07,015  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:07,015  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, dropTable_(String, String, boolean, boolean, boolean)=211, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:07,016  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637); Time taken: 0.224 seconds
2024-04-24T05:17:07,016  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051706_2d293d1d-da74-411c-89fc-b473ad54d637
2024-04-24T05:17:07,021  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T05:17:07,029  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:07,031  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T05:17:07,032  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T05:17:07,032  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae): drop table if exists Tstage
2024-04-24T05:17:07,045  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T05:17:07,046  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T05:17:07,049  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:07,062  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,062  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:07,062  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:07,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:07,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=13, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=2, getTable_(GetTableRequest)=14}
2024-04-24T05:17:07,062  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae); Time taken: 0.03 seconds
2024-04-24T05:17:07,063  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae
2024-04-24T05:17:07,064  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae
2024-04-24T05:17:07,084  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T05:17:07,084  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:07,084  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae): drop table if exists Tstage
2024-04-24T05:17:07,084  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:07,084  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:07,096  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:07,109  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,109  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T05:17:07,165  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage does not exist; Force to delete it.
2024-04-24T05:17:07,165 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:07,165  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:07,165  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, dropTable_(String, String, boolean, boolean, boolean)=68, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:07,165  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae); Time taken: 0.081 seconds
2024-04-24T05:17:07,165  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051707_16c2c5b1-a66f-4c40-9dec-0627e504b9ae
2024-04-24T05:17:07,171  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T05:17:07,179  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:07,179  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T05:17:07,180  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:07,180  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:07,184  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 5
2024-04-24T05:17:07,184  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T05:17:07,185  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:07,185  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:07,192  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T05:17:07,192  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:07,195  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:07,195  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:07,195  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:07,195  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:07,195  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-24T05:17:07,195  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5); Time taken: 0.015 seconds
2024-04-24T05:17:07,195  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5
2024-04-24T05:17:07,196  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5
2024-04-24T05:17:07,221  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T05:17:07,221  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:07,222  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:07,223  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:07,224  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713961027, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:07,233  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:07,279  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:07,279  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=56, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:07,280  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5); Time taken: 0.057 seconds
2024-04-24T05:17:07,280  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051707_71b2ba8d-1603-4112-9758-5861f026ddd5
2024-04-24T05:17:07,284  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T05:17:07,292  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:07,292  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T05:17:07,293  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:07,293  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:07,296  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-24T05:17:07,296  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T05:17:07,297  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:07,297  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:07,300  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T05:17:07,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:07,303  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:07,303  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:07,303  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:07,303  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:07,303  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:07,303  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29); Time taken: 0.01 seconds
2024-04-24T05:17:07,304  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29
2024-04-24T05:17:07,304  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29
2024-04-24T05:17:07,322  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T05:17:07,322  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:07,322  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:07,322  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:07,324  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713961027, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, totalSize=0, numFiles=0, numFilesErasureCoded=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:07,330  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:07,350  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:07,350  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=27, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:07,351  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29); Time taken: 0.028 seconds
2024-04-24T05:17:07,351  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051707_e5af9f7e-40bc-42c0-9fb9-cc849369be29
2024-04-24T05:17:07,356  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T05:17:07,361  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:07,362  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T05:17:07,362  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:07,362  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe): insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:07,366  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 9
2024-04-24T05:17:07,367  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T05:17:07,367  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:07,367  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:07,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:07,383  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,383  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:07,383  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:07,383  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:07,383  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:07,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:07,394  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,394  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:07,394  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T05:17:07,416  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:07,505  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:07,505  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:07,505  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:07,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:07,508  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:07,508  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:07,508  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:07,509  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:07,520  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,522  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1
2024-04-24T05:17:07,525  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:07,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:07,527  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:07,531  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:07,531  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:07,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:07,550  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,551  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T05:17:07,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:07,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:07,572  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:07,573  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T05:17:07,573  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:07,573  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:07,573  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:07,573  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T05:17:07,573  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T05:17:07,574  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:07,574  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:07,574  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:07,574  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T05:17:07,574  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:07,574  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=4, getTable_(GetTableRequest)=65, isCompatibleWith_(Configuration)=1, flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, openTxn_(String, TxnType)=3, getAllTableConstraints_(AllTableConstraintsRequest)=32}
2024-04-24T05:17:07,575  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe); Time taken: 0.212 seconds
2024-04-24T05:17:07,575  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe
2024-04-24T05:17:07,575  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe
2024-04-24T05:17:07,598  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T05:17:07,598  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:07,598  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe): insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:07,599  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe
2024-04-24T05:17:07,599  INFO [main] ql.Driver: Query ID = alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe
Total jobs = 1
2024-04-24T05:17:07,599  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:07,599  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:07,753  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:17:07,754  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:17:07,768  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:07,768  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T05:17:07,768  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-07_362_5999690658295305628-1/dummy_path
2024-04-24T05:17:07,780  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:07,782  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T05:17:07,783  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:07,788  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-07_362_5999690658295305628-1/-mr-10001
2024-04-24T05:17:07,794  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:07,802  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:07,806  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:07,807  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T05:17:07,807  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T05:17:07,808  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-07_362_5999690658295305628-1/dummy_path
2024-04-24T05:17:07,808  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:07,827  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:07,851  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1309087599_0004
2024-04-24T05:17:07,851  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:07,915  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:07,915  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:07,915  INFO [Thread-359] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:07,916  INFO [Thread-359] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:07,917  INFO [Thread-359] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:07,917  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1309087599_0004_m_000000_0
2024-04-24T05:17:07,920  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:07,920  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-07_362_5999690658295305628-1/dummy_path/null:0+1
2024-04-24T05:17:07,923  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:07,924  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T05:17:07,924  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T05:17:07,926  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:07,927  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:07,927  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:07,927  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:07,928  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T05:17:07,928  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T05:17:07,928  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:07,928  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T05:17:07,928  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:07,928  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1309087599_0004/job_local1309087599_0004.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@276fbc31
2024-04-24T05:17:07,929  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:07,929  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:07,929  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:07,931  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:07,931  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T05:17:07,938  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:07,939  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T05:17:07,947  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-24T05:17:07,947  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:07,949  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1309087599_0004_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:07,950  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:07,950  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1309087599_0004_m_000000_0' done.
2024-04-24T05:17:07,950  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1309087599_0004_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=88104
		FILE: Number of bytes written=4757755
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1023934464
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6168
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:07,950  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1309087599_0004_m_000000_0
2024-04-24T05:17:07,950  INFO [Thread-359] mapred.LocalJobRunner: map task executor complete.
2024-04-24 05:17:08,919 Stage-1 map = 100%,  reduce = 0%
2024-04-24T05:17:08,919  INFO [main] exec.Task: 2024-04-24 05:17:08,919 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1309087599_0004
2024-04-24T05:17:08,921  INFO [main] exec.Task: Ended Job = job_local1309087599_0004
2024-04-24T05:17:08,924  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T05:17:08,924  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T05:17:08,924  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T05:17:08,924  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T05:17:08,924  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/-ext-10000
2024-04-24T05:17:08,925  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/-ext-10002
2024-04-24T05:17:08,925  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T05:17:08,925  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1/-ext-10000
2024-04-24T05:17:08,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:08,936  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:08,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:08,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:08,954  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:08,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:09,009  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T05:17:09,009  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:09,023  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,023  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T05:17:09,023  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-07_362_5999690658295305628-1/-mr-10001
2024-04-24T05:17:09,025  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:09,035  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,036  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T05:17:09,036  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T05:17:09,036  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:09,036  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:09,071  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T05:17:09,071  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:09,071  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=51, alter_table_(String, String, String, Table, EnvironmentContext, String)=90, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-24T05:17:09,072  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:09,072  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:09,072  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:09,072  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe); Time taken: 1.473 seconds
2024-04-24T05:17:09,072  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051707_465a542f-4763-4c44-bd67-0b58b6f0c5fe
2024-04-24T05:17:09,078  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T05:17:09,085  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:09,086  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T05:17:09,086  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:09,087  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1
2024-04-24T05:17:09,087  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-07_362_5999690658295305628-1 on fs with scheme file
2024-04-24T05:17:09,087  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-07_362_5999690658295305628-1
2024-04-24T05:17:09,088  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-07_362_5999690658295305628-1 on fs with scheme file
2024-04-24T05:17:09,088  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:09,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:09,098  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,100  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T05:17:09,101  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T05:17:09,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:09,114  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,114  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,114  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,114  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,115  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,115  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:09,115  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:09,115  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:09,115  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getCurrentNotificationEventId_()=3, getTable_(GetTableRequest)=19, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T05:17:09,116  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2); Time taken: 0.027 seconds
2024-04-24T05:17:09,116  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2
2024-04-24T05:17:09,117  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2
2024-04-24T05:17:09,134  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T05:17:09,134  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:09,134  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:09,134  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:09,134  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,134  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,134  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,134  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:09,145  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:09,150  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:09,150  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:09,150  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2); Time taken: 0.016 seconds
2024-04-24T05:17:09,150  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051709_c1782b56-0008-4f8a-b80e-90ee05648ac2
2024-04-24T05:17:09,154  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T05:17:09,276  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:09,276  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T05:17:09,277  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:09,278  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:09,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:09,302  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,304  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T05:17:09,305  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T05:17:09,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:09,316  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,316  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,317  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,317  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,317  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,317  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:09,317  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:09,317  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:09,317  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCurrentNotificationEventId_()=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=127, flushCache_()=0, getTable_(GetTableRequest)=34}
2024-04-24T05:17:09,318  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7); Time taken: 0.039 seconds
2024-04-24T05:17:09,318  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7
2024-04-24T05:17:09,318  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7
2024-04-24T05:17:09,339  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T05:17:09,339  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:09,339  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:09,339  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:09,339  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,339  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,339  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,339  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:09,350  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:09,355  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:09,356  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:09,356  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7); Time taken: 0.016 seconds
2024-04-24T05:17:09,356  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051709_abf77e6f-e3d6-461e-9fa2-c3585bed56d7
2024-04-24T05:17:09,360  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T05:17:09,366  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:09,366  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T05:17:09,366  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:09,367  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:09,370  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T05:17:09,370  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T05:17:09,371  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:09,380  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,391  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T05:17:09,391  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T05:17:09,394  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:09,394  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:09,394  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:09,394  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, allocateTableWriteId_(long, String, String)=8, flushCache_()=1, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:09,394  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742); Time taken: 0.027 seconds
2024-04-24T05:17:09,395  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742
2024-04-24T05:17:09,395  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742
2024-04-24T05:17:09,409  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T05:17:09,409  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:09,413  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:09,414  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:09,414  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:09,422  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,423  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:09,438  INFO [HMSHandler #6] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2
2024-04-24T05:17:09,438  INFO [HMSHandler #4] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:09,438  INFO [HMSHandler #5] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1
2024-04-24T05:17:09,477  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T05:17:09,477  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data
2024-04-24T05:17:09,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:09,486  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:09,505  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T05:17:09,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:09,506  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:09,515  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:09,526  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T05:17:09,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:09,530  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T05:17:09,568  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:09,594  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:09,606  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T05:17:09,607  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data
2024-04-24T05:17:09,607  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:09,617  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:09,633  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T05:17:09,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:09,633  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:09,642  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:09,654  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T05:17:09,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:09,659  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T05:17:09,691  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:09,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:09,721  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:09,721  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=1, getPartitionWithAuthInfo_(String, String, List, String, List)=75, validatePartitionNameCharacters_(List)=1, getTable_(GetTableRequest)=45, add_partitions_(List, boolean, boolean)=54, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=115}
2024-04-24T05:17:09,722  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742); Time taken: 0.308 seconds
2024-04-24T05:17:09,722  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051709_53d5442f-1504-4082-976f-c0f8c7e6a742
2024-04-24T05:17:09,725  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T05:17:09,733  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:09,733  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T05:17:09,734  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:09,734  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:09,738  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T05:17:09,738  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T05:17:09,741  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:09,741  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:09,746  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:09,746  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:09,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:09,755  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,756  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:09,756  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:09,756  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:09,769  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:09,809  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:09,809  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:09,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:09,866  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:09,866  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:09,883  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:09,883  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:09,935  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:09,936  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:09,936  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:09,938  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-09_734_4266119352325704185-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-09_734_4266119352325704185-1
2024-04-24T05:17:09,945  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:09,949  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], VALUE._col2=Column[_col4]}
2024-04-24T05:17:09,950  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2]}
2024-04-24T05:17:09,951  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:09,952  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:09,961  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:09,962  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:09,962  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:09,962  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:09,962  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:09,963  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:09,963  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:09,963  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:09,963  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:09,963  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T05:17:09,964  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T05:17:09,964  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:09,964  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAggrColStatsFor_(String, String, List, List, String, String)=30, getAllTableConstraints_(AllTableConstraintsRequest)=30, commitTxn_(CommitTxnRequest)=11, listPartitions_(String, String, short)=29, getValidTxns_(long)=2, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-24T05:17:09,965  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87); Time taken: 0.23 seconds
2024-04-24T05:17:09,965  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87
2024-04-24T05:17:09,966  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87
2024-04-24T05:17:09,986  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T05:17:09,986  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:09,986  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:09,987  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87
2024-04-24T05:17:09,987  INFO [main] ql.Driver: Query ID = alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87
Total jobs = 1
2024-04-24T05:17:09,987  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:09,987  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:10,135  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:10,135  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:10,135  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:10,135  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:10,135  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:10,135  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:10,135  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:10,135  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:10,138  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:10,138  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:10,138  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:10,145  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-09_734_4266119352325704185-1/-mr-10004/91b47eb7-a254-4c86-9316-dee8896570b6 (false)
2024-04-24T05:17:10,156  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:10,158  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T05:17:10,163  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:10,164  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:10,165  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:10,171  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:10,178  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:10,183  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:10,184  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:10,184  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:10,184  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:10,184  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:10,184  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T05:17:10,184  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:10,194  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T05:17:10,194  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 10 ms
2024-04-24T05:17:10,194  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T05:17:10,212  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T05:17:10,239  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1638092602_0005
2024-04-24T05:17:10,240  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:10,299  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:10,299  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:10,299  INFO [Thread-434] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:10,299  INFO [Thread-434] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:10,301  INFO [Thread-434] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:10,301  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1638092602_0005_m_000000_0
2024-04-24T05:17:10,302  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:10,302  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:10,303  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:10,304  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T05:17:10,314  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T05:17:10,315  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:10,319  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T05:17:10,320  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:10,324  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:10,324  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:10,324  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:10,324  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:10,324  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:10,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:10,325  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:10,328  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:10,329  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:10,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:10,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T05:17:10,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:10,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:10,331  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T05:17:10,332  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:10,343  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:10,346  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1638092602_0005_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:10,347  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:10,347  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1638092602_0005_m_000000_0' done.
2024-04-24T05:17:10,347  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1638092602_0005_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=99234
		FILE: Number of bytes written=5950796
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1161297920
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-24T05:17:10,347  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1638092602_0005_m_000000_0
2024-04-24T05:17:10,347  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1638092602_0005_m_000001_0
2024-04-24T05:17:10,348  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:10,348  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:10,349  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:10,350  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-24T05:17:10,351  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T05:17:10,351  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:10,355  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T05:17:10,356  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:10,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:10,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:10,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:10,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:10,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:10,360  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:10,361  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:10,363  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:10,363  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:10,363  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:10,364  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T05:17:10,364  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:10,364  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:10,364  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:10,364  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:10,364  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:10,365  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:10,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:10,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:10,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T05:17:10,366  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:10,374  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:10,377  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1638092602_0005_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:10,378  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:10,378  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1638092602_0005_m_000001_0' done.
2024-04-24T05:17:10,378  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1638092602_0005_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=107456
		FILE: Number of bytes written=5951244
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1161297920
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-24T05:17:10,378  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1638092602_0005_m_000001_0
2024-04-24T05:17:10,378  INFO [Thread-434] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:10,379  INFO [Thread-434] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:10,379  INFO [pool-30-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1638092602_0005_r_000000_0
2024-04-24T05:17:10,380  INFO [pool-30-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:10,380  INFO [pool-30-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5558d0a9
2024-04-24T05:17:10,380  WARN [pool-30-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:10,381  INFO [pool-30-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:10,381  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1638092602_0005_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:10,384  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local1638092602_0005_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-24T05:17:10,384  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1638092602_0005_m_000001_0
2024-04-24T05:17:10,384  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T05:17:10,387  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local1638092602_0005_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T05:17:10,387  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1638092602_0005_m_000000_0
2024-04-24T05:17:10,387  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-24T05:17:10,387  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:10,388  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:10,388  INFO [pool-30-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:10,395  INFO [pool-30-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T05:17:10,395  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 750 bytes
2024-04-24T05:17:10,402  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 824 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:10,402  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 1 files, 826 bytes from disk
2024-04-24T05:17:10,403  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:10,403  INFO [pool-30-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:10,403  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 785 bytes
2024-04-24T05:17:10,403  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:10,404  INFO [pool-30-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:10,406  INFO [pool-30-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:10,409  INFO [pool-30-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:10,409  INFO [pool-30-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:10,409  INFO [pool-30-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T05:17:10,409  INFO [pool-30-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:10,411  INFO [pool-30-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@3d1132f2, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@4b8eeca7>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@4786b448, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@3c9b54a1
2024-04-24T05:17:10,414  INFO [pool-30-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-09_734_4266119352325704185-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-09_734_4266119352325704185-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:10,414  INFO [pool-30-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-09_734_4266119352325704185-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-09_734_4266119352325704185-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:10,415  INFO [pool-30-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-09_734_4266119352325704185-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-09_734_4266119352325704185-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:10,434  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:10,435  INFO [pool-30-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:10,435  INFO [pool-30-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:10,435  INFO [pool-30-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:10,435  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T05:17:10,436  INFO [pool-30-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, 
2024-04-24T05:17:10,437  INFO [pool-30-thread-1] mapred.Task: Task:attempt_local1638092602_0005_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:10,438  INFO [pool-30-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:10,438  INFO [pool-30-thread-1] mapred.Task: Task 'attempt_local1638092602_0005_r_000000_0' done.
2024-04-24T05:17:10,438  INFO [pool-30-thread-1] mapred.Task: Final Counters for attempt_local1638092602_0005_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=115459
		FILE: Number of bytes written=5952945
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=832
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1161297920
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:10,439  INFO [pool-30-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1638092602_0005_r_000000_0
2024-04-24T05:17:10,439  INFO [Thread-434] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:11,309 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:11,310  INFO [main] exec.Task: 2024-04-24 05:17:11,309 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1638092602_0005
2024-04-24T05:17:11,313  INFO [main] exec.Task: Ended Job = job_local1638092602_0005
2024-04-24T05:17:11,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:11,316  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:11,316  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:11,316  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:11,316  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:11,316  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87); Time taken: 1.329 seconds
2024-04-24T05:17:11,316  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051709_d3a9708b-bf24-4a40-a00b-48a6e1d2af87
2024-04-24T05:17:11,321  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T05:17:11,327  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:11,328  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T05:17:11,332  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:11,334  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T05:17:11,334  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:4, 
2024-04-24T05:17:11,334  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 parts w/data and 1 empty): 
2024-04-24T05:17:11,334  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-24T05:17:11,334  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:11,335  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-09_734_4266119352325704185-1
2024-04-24T05:17:11,336  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-09_734_4266119352325704185-1 on fs with scheme file
2024-04-24T05:17:11,336  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051711_b6210071-f984-424e-a2cf-aeb21f9dac07): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:11,339  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T05:17:11,340  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T05:17:11,341  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:11,343  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:11,343  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:11,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:11,351  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,352  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:11,352  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:11,352  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:11,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:11,379  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:11,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:11,401  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:11,410  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,410  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:11,421  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:11,421  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:11,471  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:11,472  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:11,472  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:11,474  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:11,478  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T05:17:11,479  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4]}
2024-04-24T05:17:11,479  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:11,495  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:11,504  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:11,505  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:11,505  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:11,505  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:11,505  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:11,505  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:11,505  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:11,505  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:11,505  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:11,505  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:11,505  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getAggrColStatsFor_(String, String, List, List, String, String)=20, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=7, isCompatibleWith_(Configuration)=2, getTable_(GetTableRequest)=7, listPartitions_(String, String, short)=9, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3}
2024-04-24T05:17:11,505  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051711_b6210071-f984-424e-a2cf-aeb21f9dac07); Time taken: 0.169 seconds
2024-04-24T05:17:11,506  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051711_b6210071-f984-424e-a2cf-aeb21f9dac07): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:11,506  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:11,516  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:11,516  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:11,516  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051711_b6210071-f984-424e-a2cf-aeb21f9dac07); Time taken: 0.01 seconds
2024-04-24T05:17:11,516  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:11,521  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T05:17:11,526  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:11,526  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T05:17:11,527  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:11,527  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-11_336_7041558800864353854-1
2024-04-24T05:17:11,528  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-11_336_7041558800864353854-1 on fs with scheme file
2024-04-24T05:17:11,528  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:11,528  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:11,547  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,549  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T05:17:11,549  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T05:17:11,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:11,567  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,567  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,567  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,567  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,567  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,568  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:11,568  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:11,568  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:11,568  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=34, getValidTxns_(long)=1, getCurrentNotificationEventId_()=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-24T05:17:11,568  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf); Time taken: 0.04 seconds
2024-04-24T05:17:11,569  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf
2024-04-24T05:17:11,569  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf
2024-04-24T05:17:11,592  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T05:17:11,592  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:11,592  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:11,592  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:11,592  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,592  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,592  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,593  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:11,605  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:11,610  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:11,610  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:11,611  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf); Time taken: 0.018 seconds
2024-04-24T05:17:11,611  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051711_82f206e9-10fc-4d22-90db-2d4c88b1bebf
2024-04-24T05:17:11,616  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T05:17:11,624  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:11,625  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T05:17:11,626  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:11,630  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T05:17:11,630  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T05:17:11,631  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:11,643  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,655  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T05:17:11,655  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T05:17:11,656  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:11,656  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:11,656  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:11,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=13, allocateTableWriteId_(long, String, String)=9}
2024-04-24T05:17:11,656  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b); Time taken: 0.03 seconds
2024-04-24T05:17:11,657  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b
2024-04-24T05:17:11,657  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b
2024-04-24T05:17:11,673  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T05:17:11,673  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:11,677  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:11,678  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:11,678  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:11,686  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:11,706 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T05:17:11,706 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T05:17:11,707 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T05:17:11,708 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:11,709 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:11,709  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:11,709  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:11,709  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b); Time taken: 0.032 seconds
2024-04-24T05:17:11,709  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051711_7e16590b-4b9b-449a-b38a-fad21a092a5b
2024-04-24T05:17:11,711  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:11,717  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:11,718  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:11,726  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T05:17:11,726  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T05:17:11,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:11,737  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,739  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:11,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T05:17:11,771  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:11,784  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T05:17:11,784  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T05:17:11,785  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:11,785  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:11,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:11,785  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=7, isCompatibleWith_(Configuration)=1, getPartitionWithAuthInfo_(String, String, List, String, List)=29, flushCache_()=0, getValidTxns_(long)=2, rollbackTxn_(long)=8, getTable_(GetTableRequest)=8, allocateTableWriteId_(long, String, String)=7}
2024-04-24T05:17:11,785  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f); Time taken: 0.067 seconds
2024-04-24T05:17:11,786  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f
2024-04-24T05:17:11,786  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f
2024-04-24T05:17:11,803  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T05:17:11,803  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:11,812  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:11,812  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:11,812  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:11,822  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,822  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:11,834  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:11,837  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:11,839  INFO [HMSHandler #7] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3
2024-04-24T05:17:11,863  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T05:17:11,863  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data
2024-04-24T05:17:11,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:11,871  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:11,884  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T05:17:11,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:11,884  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:11,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:11,894  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:11,906  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T05:17:11,911  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:11,911  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T05:17:11,952  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:11,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:11,989  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:11,989  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=36, validatePartitionNameCharacters_(List)=0, isCompatibleWith_(Configuration)=0, add_partitions_(List, boolean, boolean)=41, getValidWriteIds_(List, String)=1, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=66, getTable_(GetTableRequest)=28}
2024-04-24T05:17:11,990  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f); Time taken: 0.177 seconds
2024-04-24T05:17:11,990  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051711_e9a82de7-5b5d-4fed-a050-546d267d2c8f
2024-04-24T05:17:11,994  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T05:17:12,001  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:12,002  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T05:17:12,003  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:12,003  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:12,006  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-24T05:17:12,006  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T05:17:12,007  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:12,007  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:12,013  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:12,013  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:12,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:12,023  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:12,023  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:12,023  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:12,023  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:12,037  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:12,079  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:12,080  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:12,127  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:12,137  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:12,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:12,153  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:12,153  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:12,205  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:12,205  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:12,205  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:12,207  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-12_003_3838269822996602845-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-12_003_3838269822996602845-1
2024-04-24T05:17:12,215  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:12,218  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2]}
2024-04-24T05:17:12,218  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3]}
2024-04-24T05:17:12,219  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:12,219  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:12,229  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:12,230  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:12,230  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:12,231  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:12,231  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:12,231  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:12,231  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:12,231  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T05:17:12,232  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T05:17:12,233  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:12,233  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAggrColStatsFor_(String, String, List, List, String, String)=25, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=26, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=6, getTable_(GetTableRequest)=9, getAllTableConstraints_(AllTableConstraintsRequest)=34, getValidTxns_(long)=0}
2024-04-24T05:17:12,233  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b); Time taken: 0.23 seconds
2024-04-24T05:17:12,234  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b
2024-04-24T05:17:12,236  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b
2024-04-24T05:17:12,257  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T05:17:12,257  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:12,258  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:12,258  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b
2024-04-24T05:17:12,258  INFO [main] ql.Driver: Query ID = alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b
Total jobs = 1
2024-04-24T05:17:12,258  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:12,258  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:12,407  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:12,407  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:12,407  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:12,407  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:12,407  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:12,407  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:12,407  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:12,407  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:12,410  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:12,410  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:12,410  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:12,417  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-12_003_3838269822996602845-1/-mr-10004/c4192f63-7ed8-4c56-8b7d-f3358f0b8118 (false)
2024-04-24T05:17:12,426  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:12,428  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,42KB
2024-04-24T05:17:12,433  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:12,435  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:12,436  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:12,442  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:12,450  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:12,454  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:12,455  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:12,455  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:12,455  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:12,456  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:12,456  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-24T05:17:12,456  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:12,466  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T05:17:12,466  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 10 ms
2024-04-24T05:17:12,466  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T05:17:12,483  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T05:17:12,510  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local430626890_0006
2024-04-24T05:17:12,510  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:12,598  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:12,598  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:12,599  INFO [Thread-528] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:12,599  INFO [Thread-528] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:12,601  INFO [Thread-528] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:12,601  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local430626890_0006_m_000000_0
2024-04-24T05:17:12,602  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:12,602  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:12,603  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:12,604  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,42KB
2024-04-24T05:17:12,605  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T05:17:12,605  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:12,609  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T05:17:12,609  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:12,614  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:12,614  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:12,614  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:12,614  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:12,614  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:12,614  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:12,615  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:12,617  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:12,618  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:12,618  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:12,618  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T05:17:12,618  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:12,618  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:12,619  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:12,619  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:12,619  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:12,619  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:12,619  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:12,619  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T05:17:12,619  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T05:17:12,620  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:12,632  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:12,635  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local430626890_0006_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:12,635  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:12,635  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local430626890_0006_m_000000_0' done.
2024-04-24T05:17:12,636  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local430626890_0006_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=130946
		FILE: Number of bytes written=7143233
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7563
2024-04-24T05:17:12,636  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local430626890_0006_m_000000_0
2024-04-24T05:17:12,636  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local430626890_0006_m_000001_0
2024-04-24T05:17:12,636  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:12,637  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:12,637  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:12,638  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,42KB
2024-04-24T05:17:12,640  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T05:17:12,640  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:12,644  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T05:17:12,645  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:12,650  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:12,650  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:12,650  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:12,650  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:12,650  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:12,651  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:12,651  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:12,654  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:12,655  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:12,655  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:12,656  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T05:17:12,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:12,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:12,656  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:12,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T05:17:12,658  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:12,667  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:12,671  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local430626890_0006_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:12,672  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:12,672  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local430626890_0006_m_000001_0' done.
2024-04-24T05:17:12,672  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local430626890_0006_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=140015
		FILE: Number of bytes written=7143681
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7563
2024-04-24T05:17:12,672  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local430626890_0006_m_000001_0
2024-04-24T05:17:12,672  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local430626890_0006_m_000002_0
2024-04-24T05:17:12,673  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:12,673  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:12,674  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:12,675  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,42KB
2024-04-24T05:17:12,677  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T05:17:12,677  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:12,681  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T05:17:12,682  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:12,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:12,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:12,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:12,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:12,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:12,688  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:12,689  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:12,692  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:12,693  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:12,693  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:12,693  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T05:17:12,693  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:12,693  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:12,694  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T05:17:12,695  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:12,704  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:12,707  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local430626890_0006_m_000002_0 is done. And is in the process of committing
2024-04-24T05:17:12,708  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:12,708  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local430626890_0006_m_000002_0' done.
2024-04-24T05:17:12,708  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local430626890_0006_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=148572
		FILE: Number of bytes written=7144129
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7563
2024-04-24T05:17:12,708  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local430626890_0006_m_000002_0
2024-04-24T05:17:12,708  INFO [Thread-528] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:12,709  INFO [Thread-528] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:12,710  INFO [pool-34-thread-1] mapred.LocalJobRunner: Starting task: attempt_local430626890_0006_r_000000_0
2024-04-24T05:17:12,710  INFO [pool-34-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:12,710  INFO [pool-34-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7aec7ada
2024-04-24T05:17:12,711  WARN [pool-34-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:12,712  INFO [pool-34-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:12,712  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local430626890_0006_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:12,715  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local430626890_0006_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T05:17:12,715  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local430626890_0006_m_000000_0
2024-04-24T05:17:12,716  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T05:17:12,718  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local430626890_0006_m_000002_0 decomp: 412 len: 416 to MEMORY
2024-04-24T05:17:12,718  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local430626890_0006_m_000002_0
2024-04-24T05:17:12,719  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-24T05:17:12,721  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local430626890_0006_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-24T05:17:12,721  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local430626890_0006_m_000001_0
2024-04-24T05:17:12,721  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 3, commitMemory -> 824, usedMemory ->1236
2024-04-24T05:17:12,722  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:12,722  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:12,722  INFO [pool-34-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:12,728  INFO [pool-34-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T05:17:12,728  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1125 bytes
2024-04-24T05:17:12,731  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1236 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:12,732  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1236 bytes from disk
2024-04-24T05:17:12,732  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:12,732  INFO [pool-34-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:12,732  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1195 bytes
2024-04-24T05:17:12,732  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:12,733  INFO [pool-34-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:12,733  INFO [pool-34-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:12,734  INFO [pool-34-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:12,734  INFO [pool-34-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:12,734  INFO [pool-34-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T05:17:12,734  INFO [pool-34-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:12,735  INFO [pool-34-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@5fb0b0f1, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@4b8eeca7>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@55a3d0ad, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@4e8dd004
2024-04-24T05:17:12,736  INFO [pool-34-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-12_003_3838269822996602845-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-12_003_3838269822996602845-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:12,736  INFO [pool-34-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-12_003_3838269822996602845-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-12_003_3838269822996602845-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:12,736  INFO [pool-34-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-12_003_3838269822996602845-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-12_003_3838269822996602845-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:12,743  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:12,744  INFO [pool-34-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:12,744  INFO [pool-34-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:6, 
2024-04-24T05:17:12,744  INFO [pool-34-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:12,744  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T05:17:12,744  INFO [pool-34-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:6, RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:12,745  INFO [pool-34-thread-1] mapred.Task: Task:attempt_local430626890_0006_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:12,745  INFO [pool-34-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:12,745  INFO [pool-34-thread-1] mapred.Task: Task 'attempt_local430626890_0006_r_000000_0' done.
2024-04-24T05:17:12,745  INFO [pool-34-thread-1] mapred.Task: Final Counters for attempt_local430626890_0006_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=157433
		FILE: Number of bytes written=7146630
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1248
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:12,746  INFO [pool-34-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local430626890_0006_r_000000_0
2024-04-24T05:17:12,746  INFO [Thread-528] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:13,608 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:13,608  INFO [main] exec.Task: 2024-04-24 05:17:13,608 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local430626890_0006
2024-04-24T05:17:13,613  INFO [main] exec.Task: Ended Job = job_local430626890_0006
2024-04-24T05:17:13,615  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:13,615  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:13,616  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:13,616  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:13,616  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:13,616  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b); Time taken: 1.357 seconds
2024-04-24T05:17:13,616  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051712_067b96b5-d9ae-47e8-bb0f-3a6d8d542b0b
2024-04-24T05:17:13,620  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T05:17:13,627  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:13,627  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T05:17:13,631  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:13,633  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T05:17:13,633  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:13,633  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 existing parts and 1 empty): 
2024-04-24T05:17:13,633  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-24T05:17:13,633  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:13,633  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-12_003_3838269822996602845-1
2024-04-24T05:17:13,634  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-12_003_3838269822996602845-1 on fs with scheme file
2024-04-24T05:17:13,635  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051713_f900360b-a04b-4783-9239-85e881aa17c0): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:13,640  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T05:17:13,640  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T05:17:13,641  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:13,644  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:13,644  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:13,644  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:13,653  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:13,653  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:13,653  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:13,654  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:13,670  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:13,682  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:13,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:13,708  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:13,718  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:13,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:13,730  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:13,730  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:13,778  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:13,778  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:13,778  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:13,780  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:13,783  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], VALUE._col2=Column[_col4], VALUE._col0=Column[_col2]}
2024-04-24T05:17:13,783  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T05:17:13,783  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:13,805  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:13,814  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:13,815  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:13,815  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:13,816  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:13,816  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:13,816  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:13,816  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, getValidWriteIds_(List, String)=3, listPartitions_(String, String, short)=9, openTxn_(String, TxnType)=4, getAggrColStatsFor_(String, String, List, List, String, String)=21, getAllTableConstraints_(AllTableConstraintsRequest)=5, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-24T05:17:13,816  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051713_f900360b-a04b-4783-9239-85e881aa17c0); Time taken: 0.181 seconds
2024-04-24T05:17:13,817  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051713_f900360b-a04b-4783-9239-85e881aa17c0): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:13,817  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:13,827  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:13,827  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:13,827  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051713_f900360b-a04b-4783-9239-85e881aa17c0); Time taken: 0.011 seconds
2024-04-24T05:17:13,827  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:13,832  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T05:17:13,837  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:13,837  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T05:17:13,838  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:13,838  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-13_634_7814132042228218966-1
2024-04-24T05:17:13,839  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/4f149eb3-3afb-47de-9331-e18aabe4b2c4/hive_2024-04-24_05-17-13_634_7814132042228218966-1 on fs with scheme file
2024-04-24T05:17:13,839  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915): drop table if exists acidTbl
2024-04-24T05:17:13,841  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T05:17:13,842  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T05:17:13,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:13,850  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:13,850  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:13,850  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:13,850  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:13,850  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T05:17:13,850  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915); Time taken: 0.011 seconds
2024-04-24T05:17:13,850  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915
2024-04-24T05:17:13,851  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915
2024-04-24T05:17:13,866  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T05:17:13,866  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:13,867  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915): drop table if exists acidTbl
2024-04-24T05:17:13,867  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:13,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:13,875  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:13,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:13,884  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:13,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:14,008  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,008  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=132}
2024-04-24T05:17:14,008  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915); Time taken: 0.141 seconds
2024-04-24T05:17:14,008  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051713_ae18f2e6-ef79-42b3-b159-7b5b3ae59915
2024-04-24T05:17:14,012  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T05:17:14,018  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,018  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T05:17:14,019  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:14,020  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631): drop table if exists acidTblPart
2024-04-24T05:17:14,022  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T05:17:14,022  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T05:17:14,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:14,031  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,031  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,031  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,031  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,031  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11}
2024-04-24T05:17:14,032  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631); Time taken: 0.011 seconds
2024-04-24T05:17:14,032  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631
2024-04-24T05:17:14,032  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631
2024-04-24T05:17:14,056  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631 LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T05:17:14,056  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:14,056  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631): drop table if exists acidTblPart
2024-04-24T05:17:14,056  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,056  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:14,067  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:14,077  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:14,134  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,134  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=67, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=11}
2024-04-24T05:17:14,134  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631); Time taken: 0.078 seconds
2024-04-24T05:17:14,134  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_c64fc663-031e-42cf-a1e4-5d8d321b8631
2024-04-24T05:17:14,139  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T05:17:14,145  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,145  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T05:17:14,146  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:14,146  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_8971215d-63fc-4700-8f39-7ee74fddab88): drop table if exists acidTbl2
2024-04-24T05:17:14,149  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T05:17:14,149  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T05:17:14,150  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,150  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,150  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,151  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:14,151  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_8971215d-63fc-4700-8f39-7ee74fddab88); Time taken: 0.004 seconds
2024-04-24T05:17:14,151  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424051714_8971215d-63fc-4700-8f39-7ee74fddab88
2024-04-24T05:17:14,151  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:14,151  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_8971215d-63fc-4700-8f39-7ee74fddab88): drop table if exists acidTbl2
2024-04-24T05:17:14,151  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,152  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T05:17:14,153  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,153  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,153  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_8971215d-63fc-4700-8f39-7ee74fddab88); Time taken: 0.002 seconds
2024-04-24T05:17:14,153  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_8971215d-63fc-4700-8f39-7ee74fddab88
2024-04-24T05:17:14,159  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T05:17:14,165  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,166  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T05:17:14,166  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:14,167  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:14,170  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T05:17:14,171  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T05:17:14,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:14,195  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,195  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,196  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,196  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=23, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=4}
2024-04-24T05:17:14,196  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56); Time taken: 0.029 seconds
2024-04-24T05:17:14,196  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56
2024-04-24T05:17:14,197  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56
2024-04-24T05:17:14,217  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56 LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T05:17:14,217  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:14,218  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:14,218  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:14,233  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,233  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:14,247  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,247  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:14,295  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,295  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, dropTable_(String, String, boolean, boolean, boolean)=62, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,295  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56); Time taken: 0.078 seconds
2024-04-24T05:17:14,295  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_4912407b-0d19-4a7f-a28c-f41b93e6bb56
2024-04-24T05:17:14,300  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T05:17:14,306  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,306  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T05:17:14,307  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:14,307  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:14,310  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-24T05:17:14,311  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T05:17:14,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:14,327  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,327  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,327  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,327  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,327  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,328  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7); Time taken: 0.02 seconds
2024-04-24T05:17:14,328  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7
2024-04-24T05:17:14,328  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7
2024-04-24T05:17:14,347  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7 LockResponse(lockid:23, state:ACQUIRED)
2024-04-24T05:17:14,347  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:14,347  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:14,347  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:14,362  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,362  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:14,377  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:14,421  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,422  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=15, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=59}
2024-04-24T05:17:14,422  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7); Time taken: 0.074 seconds
2024-04-24T05:17:14,422  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_953d728a-1e6e-4e29-80fe-c5be8391c3f7
2024-04-24T05:17:14,426  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T05:17:14,433  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,433  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T05:17:14,434  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:14,434  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73): drop table if exists nonAcidNonBucket
2024-04-24T05:17:14,437  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-24T05:17:14,437  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T05:17:14,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:14,450  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,450  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,450  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,450  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,451  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=12, flushCache_()=0, getValidTxns_(long)=1}
2024-04-24T05:17:14,451  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73); Time taken: 0.016 seconds
2024-04-24T05:17:14,451  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73
2024-04-24T05:17:14,452  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73
2024-04-24T05:17:14,474  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73 LockResponse(lockid:24, state:ACQUIRED)
2024-04-24T05:17:14,474  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:14,474  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73): drop table if exists nonAcidNonBucket
2024-04-24T05:17:14,474  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:14,490  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:14,503  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:14,504  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:14,552  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,552  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=62, getTable_(GetTableRequest)=16, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,552  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73); Time taken: 0.078 seconds
2024-04-24T05:17:14,552  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_26e93c35-a67a-44ff-85f1-1222a4605c73
2024-04-24T05:17:14,557  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T05:17:14,563  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,564  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T05:17:14,564  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T05:17:14,668  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T05:17:14,669  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T05:17:14,670  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T05:17:14,670  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T05:17:14,672  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = c244bcad-07d7-4c03-9f46-d0bb3277cdc6
2024-04-24T05:17:14,682  INFO [main] SessionState: Hive Session ID = c244bcad-07d7-4c03-9f46-d0bb3277cdc6
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:14,682  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:14,688  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c244bcad-07d7-4c03-9f46-d0bb3277cdc6
2024-04-24T05:17:14,691  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6
2024-04-24T05:17:14,693  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/_tmp_space.db
2024-04-24T05:17:14,693  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=c244bcad-07d7-4c03-9f46-d0bb3277cdc6, clientType=HIVECLI]
2024-04-24T05:17:14,694  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:14,694  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_fdf2669e-8ffb-419e-a508-c9d4b2fdb382): drop table if exists acidTbl
2024-04-24T05:17:14,703  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T05:17:14,703  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T05:17:14,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:14,709  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,709  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,709  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,709  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,709  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_fdf2669e-8ffb-419e-a508-c9d4b2fdb382); Time taken: 0.015 seconds
2024-04-24T05:17:14,709  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424051714_fdf2669e-8ffb-419e-a508-c9d4b2fdb382
2024-04-24T05:17:14,709  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:14,710  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_fdf2669e-8ffb-419e-a508-c9d4b2fdb382): drop table if exists acidTbl
2024-04-24T05:17:14,710  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:14,713  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,714  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,714  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_fdf2669e-8ffb-419e-a508-c9d4b2fdb382); Time taken: 0.003 seconds
2024-04-24T05:17:14,714  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_fdf2669e-8ffb-419e-a508-c9d4b2fdb382
2024-04-24T05:17:14,720  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T05:17:14,727  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,727  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T05:17:14,728  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:14,728  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_3963685e-47ee-4e50-b8e3-76fe42129346): drop table if exists acidTblPart
2024-04-24T05:17:14,730  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T05:17:14,731  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T05:17:14,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:14,735  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,735  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,735  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,735  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:14,735  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_3963685e-47ee-4e50-b8e3-76fe42129346); Time taken: 0.007 seconds
2024-04-24T05:17:14,735  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424051714_3963685e-47ee-4e50-b8e3-76fe42129346
2024-04-24T05:17:14,735  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:14,736  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_3963685e-47ee-4e50-b8e3-76fe42129346): drop table if exists acidTblPart
2024-04-24T05:17:14,736  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,736  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:14,739  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,739  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,740  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_3963685e-47ee-4e50-b8e3-76fe42129346); Time taken: 0.003 seconds
2024-04-24T05:17:14,740  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_3963685e-47ee-4e50-b8e3-76fe42129346
2024-04-24T05:17:14,745  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T05:17:14,751  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,751  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T05:17:14,751  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:14,752  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_08984865-2968-47e1-9586-250f903ca521): drop table if exists acidTbl2
2024-04-24T05:17:14,754  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T05:17:14,754  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T05:17:14,755  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:14,759  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,759  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,759  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T05:17:14,759  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_08984865-2968-47e1-9586-250f903ca521); Time taken: 0.007 seconds
2024-04-24T05:17:14,759  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424051714_08984865-2968-47e1-9586-250f903ca521
2024-04-24T05:17:14,760  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:14,760  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_08984865-2968-47e1-9586-250f903ca521): drop table if exists acidTbl2
2024-04-24T05:17:14,760  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:14,763  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,763  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,764  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_08984865-2968-47e1-9586-250f903ca521); Time taken: 0.003 seconds
2024-04-24T05:17:14,764  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_08984865-2968-47e1-9586-250f903ca521
2024-04-24T05:17:14,768  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T05:17:14,773  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,774  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T05:17:14,774  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:14,775  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_3a8d7f79-780e-4544-8ee1-548e2773afc4): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:14,777  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T05:17:14,777  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T05:17:14,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:14,780  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,781  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,781  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,781  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T05:17:14,781  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_3a8d7f79-780e-4544-8ee1-548e2773afc4); Time taken: 0.006 seconds
2024-04-24T05:17:14,781  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424051714_3a8d7f79-780e-4544-8ee1-548e2773afc4
2024-04-24T05:17:14,781  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:14,781  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_3a8d7f79-780e-4544-8ee1-548e2773afc4): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:14,781  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:14,785  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,785  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,785  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_3a8d7f79-780e-4544-8ee1-548e2773afc4); Time taken: 0.004 seconds
2024-04-24T05:17:14,785  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_3a8d7f79-780e-4544-8ee1-548e2773afc4
2024-04-24T05:17:14,791  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T05:17:14,796  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,796  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T05:17:14,796  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:14,797  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_ae036d07-d922-47e8-8956-8785b5da9866): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:14,799  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T05:17:14,799  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T05:17:14,800  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:14,803  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,803  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,803  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,803  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2}
2024-04-24T05:17:14,803  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_ae036d07-d922-47e8-8956-8785b5da9866); Time taken: 0.006 seconds
2024-04-24T05:17:14,804  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424051714_ae036d07-d922-47e8-8956-8785b5da9866
2024-04-24T05:17:14,804  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:14,804  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_ae036d07-d922-47e8-8956-8785b5da9866): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:14,804  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,804  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:14,808  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,808  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,808  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_ae036d07-d922-47e8-8956-8785b5da9866); Time taken: 0.004 seconds
2024-04-24T05:17:14,808  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_ae036d07-d922-47e8-8956-8785b5da9866
2024-04-24T05:17:14,813  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T05:17:14,818  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,818  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T05:17:14,819  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:14,819  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_4af1b860-7d5e-485b-ae79-c404b7c99b2c): drop table if exists nonAcidNonBucket
2024-04-24T05:17:14,822  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T05:17:14,822  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T05:17:14,823  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:14,826  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,826  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,826  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,826  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-24T05:17:14,827  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_4af1b860-7d5e-485b-ae79-c404b7c99b2c); Time taken: 0.007 seconds
2024-04-24T05:17:14,827  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424051714_4af1b860-7d5e-485b-ae79-c404b7c99b2c
2024-04-24T05:17:14,827  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:14,827  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_4af1b860-7d5e-485b-ae79-c404b7c99b2c): drop table if exists nonAcidNonBucket
2024-04-24T05:17:14,827  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,827  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:14,830  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,830  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,831  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_4af1b860-7d5e-485b-ae79-c404b7c99b2c); Time taken: 0.003 seconds
2024-04-24T05:17:14,831  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_4af1b860-7d5e-485b-ae79-c404b7c99b2c
2024-04-24T05:17:14,836  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T05:17:14,840  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,841  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T05:17:14,841  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:14,842  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:14,844  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T05:17:14,844  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T05:17:14,845  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:14,845  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:14,850  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T05:17:14,851  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:14,853  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:14,853  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,853  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,853  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,853  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, flushCache_()=0}
2024-04-24T05:17:14,853  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69); Time taken: 0.012 seconds
2024-04-24T05:17:14,853  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69
2024-04-24T05:17:14,854  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69
2024-04-24T05:17:14,874  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T05:17:14,874  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:14,874  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:14,875  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713961034, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, totalSize=0, rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:14,883  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtbl
2024-04-24T05:17:14,925  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,925  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=49, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:14,925  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69); Time taken: 0.051 seconds
2024-04-24T05:17:14,925  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_d179c090-dd91-4204-a686-0767cb21db69
2024-04-24T05:17:14,931  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T05:17:14,937  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:14,937  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T05:17:14,938  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:14,938  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:14,941  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T05:17:14,942  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T05:17:14,942  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:14,942  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:14,945  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T05:17:14,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:14,947  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:14,947  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:14,947  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:14,947  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:14,948  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, getDatabase_(String)=2}
2024-04-24T05:17:14,948  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba); Time taken: 0.009 seconds
2024-04-24T05:17:14,948  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba
2024-04-24T05:17:14,948  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba
2024-04-24T05:17:14,964  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T05:17:14,964  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:14,965  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:14,965  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:14,966  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713961034, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:14,973  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtblpart
2024-04-24T05:17:14,996  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:14,996  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=29}
2024-04-24T05:17:14,996  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba); Time taken: 0.031 seconds
2024-04-24T05:17:14,996  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051714_b6faae20-25c0-456e-84f7-f90966f5dcba
2024-04-24T05:17:15,000  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T05:17:15,006  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,006  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T05:17:15,007  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,007  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,010  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T05:17:15,010  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T05:17:15,011  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:15,011  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:15,014  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T05:17:15,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:15,016  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:15,016  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,016  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,016  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,016  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3}
2024-04-24T05:17:15,016  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0); Time taken: 0.009 seconds
2024-04-24T05:17:15,017  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0
2024-04-24T05:17:15,017  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0
2024-04-24T05:17:15,032  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T05:17:15,032  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:15,032  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,033  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713961035, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, totalSize=0, numFiles=0, numFilesErasureCoded=0, bucketing_version=2, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:15,040  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl
2024-04-24T05:17:15,057  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,057  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:15,057  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0); Time taken: 0.025 seconds
2024-04-24T05:17:15,057  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_d6128b40-64ae-4f50-a21e-0869daeea9b0
2024-04-24T05:17:15,061  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T05:17:15,065  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,066  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T05:17:15,066  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,067  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,069  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T05:17:15,069  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T05:17:15,070  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:15,070  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:15,073  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T05:17:15,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:15,075  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:15,075  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,075  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,075  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,075  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2}
2024-04-24T05:17:15,075  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9); Time taken: 0.008 seconds
2024-04-24T05:17:15,075  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9
2024-04-24T05:17:15,076  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9
2024-04-24T05:17:15,089  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T05:17:15,089  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:15,089  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,089  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,090  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713961035, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:15,096  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl2
2024-04-24T05:17:15,113  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,113  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:15,113  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9); Time taken: 0.024 seconds
2024-04-24T05:17:15,114  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_d36d0523-c4b2-4b16-b005-e696364383d9
2024-04-24T05:17:15,118  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T05:17:15,124  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,124  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T05:17:15,125  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:15,125  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:15,127  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T05:17:15,127  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T05:17:15,128  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:15,128  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:15,130  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T05:17:15,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:15,132  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:15,132  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,132  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,132  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getDatabase_(String)=1}
2024-04-24T05:17:15,133  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2); Time taken: 0.007 seconds
2024-04-24T05:17:15,133  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2
2024-04-24T05:17:15,133  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2
2024-04-24T05:17:15,147  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T05:17:15,147  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:15,147  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:15,148  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,149  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/_tmp_space.db/b2f9e00b-b0f3-4e36-afea-38dbd0b19df3
2024-04-24T05:17:15,151  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,151  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:15,152  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2); Time taken: 0.004 seconds
2024-04-24T05:17:15,152  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_0e5019f0-866e-4122-8e6d-41d84b8281d2
2024-04-24T05:17:15,155  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T05:17:15,161  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,161  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T05:17:15,161  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,162  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,164  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T05:17:15,164  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T05:17:15,165  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:15,165  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:15,168  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T05:17:15,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:15,169  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:15,169  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,169  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,170  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=1}
2024-04-24T05:17:15,170  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945); Time taken: 0.007 seconds
2024-04-24T05:17:15,170  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945
2024-04-24T05:17:15,170  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945
2024-04-24T05:17:15,186  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T05:17:15,186  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:15,186  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:15,186  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,188  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713961035, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, rawDataSize=0, bucketing_version=2, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:15,193  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidnonbucket
2024-04-24T05:17:15,210  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,210  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T05:17:15,211  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945); Time taken: 0.024 seconds
2024-04-24T05:17:15,211  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_8ea56df7-1d5f-4f7a-8189-5c7e1361e945
2024-04-24T05:17:15,214  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T05:17:15,220  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,221  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T05:17:15,221  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T05:17:15,222  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0): drop table if exists T
2024-04-24T05:17:15,224  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T05:17:15,224  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T05:17:15,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:15,243  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,244  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,244  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,244  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,244  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=19, getValidTxns_(long)=1}
2024-04-24T05:17:15,244  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0); Time taken: 0.022 seconds
2024-04-24T05:17:15,244  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0
2024-04-24T05:17:15,245  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0
2024-04-24T05:17:15,263  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T05:17:15,263  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:15,263  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0): drop table if exists T
2024-04-24T05:17:15,263  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:15,271  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,271  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:15,283  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,284  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T05:17:15,484  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t does not exist; Force to delete it.
2024-04-24T05:17:15,484 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:15,484  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,484  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=213, getTable_(GetTableRequest)=8}
2024-04-24T05:17:15,484  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0); Time taken: 0.221 seconds
2024-04-24T05:17:15,484  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_92f43e25-828c-49e6-9b9d-f94f5f757bf0
2024-04-24T05:17:15,489  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T05:17:15,497  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,499  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T05:17:15,500  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T05:17:15,500  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b): drop table if exists Tstage
2024-04-24T05:17:15,509  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T05:17:15,510  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T05:17:15,513  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:15,536  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,536  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,536  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=23, commitTxn_(CommitTxnRequest)=16, openTxn_(String, TxnType)=9, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=3}
2024-04-24T05:17:15,536  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b); Time taken: 0.036 seconds
2024-04-24T05:17:15,537  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b
2024-04-24T05:17:15,537  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b
2024-04-24T05:17:15,553  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T05:17:15,553  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:15,553  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b): drop table if exists Tstage
2024-04-24T05:17:15,553  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:15,566  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,567  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:15,582  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T05:17:15,629  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage does not exist; Force to delete it.
2024-04-24T05:17:15,629 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:15,629  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,629  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=63, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12}
2024-04-24T05:17:15,629  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b); Time taken: 0.076 seconds
2024-04-24T05:17:15,629  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_8f5701db-5e0b-47fd-af1a-852664d5998b
2024-04-24T05:17:15,633  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T05:17:15,640  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,640  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T05:17:15,641  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:15,641  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:15,644  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T05:17:15,644  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T05:17:15,644  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:15,645  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:15,650  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T05:17:15,650  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:15,652  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:15,652  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,652  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,653  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=5, getDatabase_(String)=2, getValidTxns_(long)=0}
2024-04-24T05:17:15,653  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208); Time taken: 0.011 seconds
2024-04-24T05:17:15,653  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208
2024-04-24T05:17:15,653  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208
2024-04-24T05:17:15,668  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T05:17:15,668  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:15,669  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:15,669  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,670  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713961035, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:15,677  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:15,711  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,711  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=40}
2024-04-24T05:17:15,711  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208); Time taken: 0.041 seconds
2024-04-24T05:17:15,711  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_a2ede65f-1bed-4db6-901e-0c0226c8c208
2024-04-24T05:17:15,715  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T05:17:15,722  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,722  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T05:17:15,723  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:15,723  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:15,725  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 2
2024-04-24T05:17:15,726  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T05:17:15,726  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:15,726  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:15,729  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T05:17:15,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:15,731  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:15,731  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,731  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:15,731  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,731  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, flushCache_()=0}
2024-04-24T05:17:15,731  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532); Time taken: 0.008 seconds
2024-04-24T05:17:15,732  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532
2024-04-24T05:17:15,732  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532
2024-04-24T05:17:15,751  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T05:17:15,751  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:15,751  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:15,751  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:15,752  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713961035, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, rawDataSize=0, transactional=false, totalSize=0, numRows=0, numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:15,760  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:15,782  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:15,782  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=30}
2024-04-24T05:17:15,782  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532); Time taken: 0.031 seconds
2024-04-24T05:17:15,782  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_7b1566e3-d166-4add-8694-bc92b92b9532
2024-04-24T05:17:15,787  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T05:17:15,794  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:15,794  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T05:17:15,795  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-24T05:17:15,795  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b): insert into Tstage values(0,2),(1,4)
2024-04-24T05:17:15,798  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 5
2024-04-24T05:17:15,798  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T05:17:15,799  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:15,799  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:15,802  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:15,813  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,813  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:15,813  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:15,813  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:15,813  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:15,814  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:15,828  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,828  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:15,828  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T05:17:15,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:15,941  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:15,941  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:15,941  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:15,942  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:15,945  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:15,945  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:15,945  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:15,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:15,955  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,957  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1
2024-04-24T05:17:15,959  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:15,961  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:15,963  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:15,967  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T05:17:15,967  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T05:17:15,968  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:15,968  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:15,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:15,988  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:15,988  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:15,989  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:15,989  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:15,989  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:15,989  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:15,989  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T05:17:15,989  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:15,989  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=32, getValidWriteIds_(List, String)=2, flushCache_()=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, getCheckConstraints_(CheckConstraintsRequest)=2, isCompatibleWith_(Configuration)=3, getTable_(GetTableRequest)=47, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-24T05:17:15,989  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b); Time taken: 0.194 seconds
2024-04-24T05:17:15,990  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b
2024-04-24T05:17:15,990  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b
2024-04-24T05:17:16,005  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T05:17:16,005  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:16,005  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b): insert into Tstage values(0,2),(1,4)
2024-04-24T05:17:16,005  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b
2024-04-24T05:17:16,005  INFO [main] ql.Driver: Query ID = alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b
Total jobs = 1
2024-04-24T05:17:16,005  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:16,005  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:16,157  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T05:17:16,158  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:16,158  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:16,158  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:16,158  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:16,158  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:16,158  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:16,158  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:16,160  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:16,160  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T05:17:16,161  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-15_795_8998459494053577667-1/dummy_path
2024-04-24T05:17:16,171  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:16,172  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:16,176  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:16,177  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T05:17:16,178  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:16,182  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-15_795_8998459494053577667-1/-mr-10001
2024-04-24T05:17:16,187  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:16,194  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:16,199  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:16,200  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T05:17:16,200  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T05:17:16,200  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-15_795_8998459494053577667-1/dummy_path
2024-04-24T05:17:16,200  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:16,219  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:16,238  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local528599488_0007
2024-04-24T05:17:16,239  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:16,302  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:16,303  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:16,303  INFO [Thread-642] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:16,303  INFO [Thread-642] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:16,304  INFO [Thread-642] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:16,305  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local528599488_0007_m_000000_0
2024-04-24T05:17:16,307  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:16,308  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-15_795_8998459494053577667-1/dummy_path/null:0+1
2024-04-24T05:17:16,310  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:16,311  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:16,312  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T05:17:16,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:16,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:16,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:16,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:16,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:16,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:16,318  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:16,318  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:16,319  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:16,319  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:16,320  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T05:17:16,320  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T05:17:16,320  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:16,320  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T05:17:16,320  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T05:17:16,320  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:16,321  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T05:17:16,322  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:16,323  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:16,324  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T05:17:16,324  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:16,324  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:16,324  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T05:17:16,324  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T05:17:16,324  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T05:17:16,324  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:16,327  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:16,327  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:16,327  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:16,327  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T05:17:16,327  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:16,342  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:16,350  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local528599488_0007_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:16,351  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:16,351  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local528599488_0007_m_000000_0' done.
2024-04-24T05:17:16,351  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local528599488_0007_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=167142
		FILE: Number of bytes written=8333701
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1173356544
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-24T05:17:16,351  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local528599488_0007_m_000000_0
2024-04-24T05:17:16,351  INFO [Thread-642] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:16,353  INFO [Thread-642] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:16,353  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local528599488_0007_r_000000_0
2024-04-24T05:17:16,357  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:16,357  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@11e95ec0
2024-04-24T05:17:16,357  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:16,358  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:16,359  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local528599488_0007_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:16,363  INFO [localfetcher#5] reduce.LocalFetcher: localfetcher#5 about to shuffle output of map attempt_local528599488_0007_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-24T05:17:16,364  INFO [localfetcher#5] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local528599488_0007_m_000000_0
2024-04-24T05:17:16,364  INFO [localfetcher#5] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-24T05:17:16,364  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:16,364  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:16,365  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:16,373  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:16,373  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T05:17:16,377  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:16,377  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-24T05:17:16,377  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:16,377  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:16,377  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T05:17:16,377  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:16,378  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:16,379  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T05:17:16,381  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:16,381  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:16,381  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T05:17:16,381  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T05:17:16,382  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local528599488_0007/job_local528599488_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@c7d05ef
2024-04-24T05:17:16,382  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:16,382  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:16,382  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T05:17:16,382  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-24T05:17:16,383  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_tmp.-ext-10000/000000_0
2024-04-24T05:17:16,383  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-24T05:17:16,383  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_tmp.-ext-10000/000000_0
2024-04-24T05:17:16,402  INFO [pool-37-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:0, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_1_default.tstage:0, 
2024-04-24T05:17:16,402  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local528599488_0007_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:16,403  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:16,403  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local528599488_0007_r_000000_0' done.
2024-04-24T05:17:16,403  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local528599488_0007_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=173608
		FILE: Number of bytes written=8333767
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1173356544
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:16,403  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local528599488_0007_r_000000_0
2024-04-24T05:17:16,403  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local528599488_0007_r_000001_0
2024-04-24T05:17:16,404  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:16,404  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@5a5c2046
2024-04-24T05:17:16,404  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:16,405  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:16,406  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local528599488_0007_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:16,410  INFO [localfetcher#6] reduce.LocalFetcher: localfetcher#6 about to shuffle output of map attempt_local528599488_0007_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T05:17:16,410  INFO [localfetcher#6] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local528599488_0007_m_000000_0
2024-04-24T05:17:16,410  INFO [localfetcher#6] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T05:17:16,412  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:16,412  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:16,412  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:16,420  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:16,420  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T05:17:16,424  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:16,424  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T05:17:16,424  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:16,424  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:16,425  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T05:17:16,425  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:16,425  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:16,426  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T05:17:16,428  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:16,428  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:16,428  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T05:17:16,428  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T05:17:16,428  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local528599488_0007/job_local528599488_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@45212894
2024-04-24T05:17:16,429  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_tmp.-ext-10000/000001_0
2024-04-24T05:17:16,429  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-24T05:17:16,429  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_tmp.-ext-10000/000001_0
2024-04-24T05:17:16,429  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T05:17:16,429  INFO [pool-37-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T05:17:16,437  INFO [pool-37-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T05:17:16,437  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:16,437  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T05:17:16,437  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T05:17:16,437  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T05:17:16,448  INFO [pool-37-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-24T05:17:16,448  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local528599488_0007_r_000001_0 is done. And is in the process of committing
2024-04-24T05:17:16,449  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:16,449  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local528599488_0007_r_000001_0' done.
2024-04-24T05:17:16,449  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local528599488_0007_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=180104
		FILE: Number of bytes written=8334155
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1173356544
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:16,449  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local528599488_0007_r_000001_0
2024-04-24T05:17:16,449  INFO [Thread-642] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:17,309 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:17,309  INFO [main] exec.Task: 2024-04-24 05:17:17,309 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local528599488_0007
2024-04-24T05:17:17,312  INFO [main] exec.Task: Ended Job = job_local528599488_0007
2024-04-24T05:17:17,314  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T05:17:17,315  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1/-ext-10000
2024-04-24T05:17:17,315  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:17,324  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,325  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:17,335  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,337  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:17,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:17,368  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T05:17:17,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:17,378  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,378  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T05:17:17,378  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-15_795_8998459494053577667-1/-mr-10001
2024-04-24T05:17:17,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:17,389  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,390  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T05:17:17,390  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T05:17:17,390  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:17,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:17,420  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T05:17:17,420  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:17,421  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=61, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=38}
MapReduce Jobs Launched: 
2024-04-24T05:17:17,421  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:17,421  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:17,421  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:17,421  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b); Time taken: 1.415 seconds
2024-04-24T05:17:17,421  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051715_233314b1-703a-4ac7-8739-43c53fcf437b
2024-04-24T05:17:17,424  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T05:17:17,430  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:17,431  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T05:17:17,431  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:17,431  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1
2024-04-24T05:17:17,432  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-15_795_8998459494053577667-1 on fs with scheme file
2024-04-24T05:17:17,432  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-15_795_8998459494053577667-1
2024-04-24T05:17:17,432  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-15_795_8998459494053577667-1 on fs with scheme file
2024-04-24T05:17:17,433  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:17,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:17,442  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,444  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T05:17:17,445  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T05:17:17,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:17,457  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,457  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,457  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,458  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,458  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,458  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:17,458  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:17,458  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:17,458  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getCurrentNotificationEventId_()=3, getValidTxns_(long)=0, getTable_(GetTableRequest)=19, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:17,458  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432); Time taken: 0.026 seconds
2024-04-24T05:17:17,459  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432
2024-04-24T05:17:17,459  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432
2024-04-24T05:17:17,473  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T05:17:17,473  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:17,473  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:17,473  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:17,473  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,473  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,473  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,474  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:17,484  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:17,493  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:17,493  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:17,493  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432); Time taken: 0.02 seconds
2024-04-24T05:17:17,493  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051717_86598b62-b47d-4b22-80a7-a869f2f6d432
2024-04-24T05:17:17,497  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T05:17:17,503  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:17,503  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T05:17:17,503  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data'
2024-04-24T05:17:17,504  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data'
2024-04-24T05:17:17,506  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T05:17:17,506  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T05:17:17,507  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:17,514  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,522  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-24T05:17:17,523  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-24T05:17:17,524  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:17,524  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:17,524  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:17,524  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=7, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=1}
2024-04-24T05:17:17,524  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864); Time taken: 0.02 seconds
2024-04-24T05:17:17,524  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864
2024-04-24T05:17:17,525  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864
2024-04-24T05:17:17,539  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T05:17:17,539  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:17,543  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data'
2024-04-24T05:17:17,544  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:17,544  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:17,551  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,551  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:17,564  INFO [HMSHandler #8] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:17,589  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T05:17:17,589  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data
2024-04-24T05:17:17,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:17,597  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:17,616  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T05:17:17,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:17,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:17,624  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,624  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:17,635  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T05:17:17,639  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:17,639  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T05:17:17,677  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:17,701  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:17,712  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:17,712  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {add_partitions_(List, boolean, boolean)=38, isCompatibleWith_(Configuration)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=40, validatePartitionNameCharacters_(List)=1, getTable_(GetTableRequest)=22, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=62, getValidWriteIds_(List, String)=0}
2024-04-24T05:17:17,712  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864); Time taken: 0.169 seconds
2024-04-24T05:17:17,712  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051717_0c67d163-450d-41d8-ba55-e21a77866864
2024-04-24T05:17:17,716  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T05:17:17,723  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:17,723  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T05:17:17,723  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:17,724  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:17,727  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T05:17:17,727  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T05:17:17,728  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:17,728  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:17,734  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:17,734  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:17,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:17,742  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,743  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:17,743  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:17,743  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:17,756  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:17,789  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:17,789  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:17,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:17,820  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:17,820  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:17,836  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:17,836  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:17,885  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:17,885  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:17,885  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:17,887  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-17_724_8004537852880499191-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-17_724_8004537852880499191-1
2024-04-24T05:17:17,896  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:17,899  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T05:17:17,899  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col0], VALUE._col2=Column[_col4], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T05:17:17,900  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:17,909  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:17,910  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:17,910  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:17,910  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:17,910  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:17,910  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T05:17:17,911  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T05:17:17,912  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:17,912  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=6, getTable_(GetTableRequest)=7, listPartitions_(String, String, short)=12, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=28, getAggrColStatsFor_(String, String, List, List, String, String)=25, openTxn_(String, TxnType)=2}
2024-04-24T05:17:17,912  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537); Time taken: 0.188 seconds
2024-04-24T05:17:17,912  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537
2024-04-24T05:17:17,913  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537
2024-04-24T05:17:17,929  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T05:17:17,929  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:17,930  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:17,930  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537
2024-04-24T05:17:17,930  INFO [main] ql.Driver: Query ID = alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537
Total jobs = 1
2024-04-24T05:17:17,930  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:17,930  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:18,079  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:18,079  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:18,079  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:18,079  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:18,079  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:18,079  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:18,079  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:18,079  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:18,082  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:18,082  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:18,082  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:18,091  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:18,092  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,34KB
2024-04-24T05:17:18,097  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:18,098  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:18,099  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:18,105  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:18,113  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:18,118  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:18,119  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:18,119  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:18,119  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:18,119  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:18,119  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T05:17:18,119  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:18,130  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T05:17:18,130  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 11 ms
2024-04-24T05:17:18,130  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:18,148  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:18,168  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1945179546_0008
2024-04-24T05:17:18,168  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:18,232  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:18,232  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:18,232  INFO [Thread-723] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:18,233  INFO [Thread-723] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:18,234  INFO [Thread-723] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:18,234  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1945179546_0008_m_000000_0
2024-04-24T05:17:18,235  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:18,236  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:18,236  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:18,237  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,34KB
2024-04-24T05:17:18,238  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T05:17:18,238  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:18,244  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T05:17:18,245  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:18,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:18,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:18,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:18,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:18,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:18,256  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:18,257  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:18,258  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:18,258  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:18,258  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:18,258  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T05:17:18,258  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:18,258  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:18,259  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:18,259  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:18,259  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:18,259  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:18,259  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:18,259  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, 
2024-04-24T05:17:18,259  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T05:17:18,260  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:18,271  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:18,274  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1945179546_0008_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:18,274  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:18,274  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1945179546_0008_m_000000_0' done.
2024-04-24T05:17:18,275  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1945179546_0008_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=188382
		FILE: Number of bytes written=9523532
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=6
		Total committed heap usage (bytes)=1172307968
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6464
2024-04-24T05:17:18,275  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1945179546_0008_m_000000_0
2024-04-24T05:17:18,275  INFO [Thread-723] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:18,276  INFO [Thread-723] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:18,276  INFO [pool-43-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1945179546_0008_r_000000_0
2024-04-24T05:17:18,276  INFO [pool-43-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:18,276  INFO [pool-43-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1cefdbdb
2024-04-24T05:17:18,276  WARN [pool-43-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:18,277  INFO [pool-43-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:18,278  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1945179546_0008_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:18,279  INFO [localfetcher#7] reduce.LocalFetcher: localfetcher#7 about to shuffle output of map attempt_local1945179546_0008_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T05:17:18,279  INFO [localfetcher#7] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1945179546_0008_m_000000_0
2024-04-24T05:17:18,279  INFO [localfetcher#7] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T05:17:18,279  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:18,280  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:18,280  INFO [pool-43-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:18,287  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:18,287  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T05:17:18,289  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:18,289  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-24T05:17:18,289  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:18,289  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:18,290  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T05:17:18,290  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:18,290  INFO [pool-43-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:18,291  INFO [pool-43-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@37748cd1, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@4b8eeca7>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@458f696b, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@29b94f91
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-17_724_8004537852880499191-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-17_724_8004537852880499191-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-17_724_8004537852880499191-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-17_724_8004537852880499191-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:18,292  INFO [pool-43-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-17_724_8004537852880499191-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-17_724_8004537852880499191-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:18,300  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:18,300  INFO [pool-43-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:18,300  INFO [pool-43-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:18,300  INFO [pool-43-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:18,300  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T05:17:18,301  INFO [pool-43-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:2, 
2024-04-24T05:17:18,301  INFO [pool-43-thread-1] mapred.Task: Task:attempt_local1945179546_0008_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:18,301  INFO [pool-43-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:18,301  INFO [pool-43-thread-1] mapred.Task: Task 'attempt_local1945179546_0008_r_000000_0' done.
2024-04-24T05:17:18,301  INFO [pool-43-thread-1] mapred.Task: Final Counters for attempt_local1945179546_0008_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=195527
		FILE: Number of bytes written=9524433
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:18,302  INFO [pool-43-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1945179546_0008_r_000000_0
2024-04-24T05:17:18,302  INFO [Thread-723] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:19,236 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:19,236  INFO [main] exec.Task: 2024-04-24 05:17:19,236 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1945179546_0008
2024-04-24T05:17:19,238  INFO [main] exec.Task: Ended Job = job_local1945179546_0008
2024-04-24T05:17:19,240  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:19,240  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:19,240  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:19,240  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:19,240  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:19,240  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537); Time taken: 1.311 seconds
2024-04-24T05:17:19,240  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051717_7b1c4076-7a2b-4054-b38f-512443435537
2024-04-24T05:17:19,244  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T05:17:19,250  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:19,250  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T05:17:19,254  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:19,255  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T05:17:19,255  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:19,255  WARN [main] ql.TestTxnAddPartition: addPartitionBucketed: read data(add partition (p=0)): 
2024-04-24T05:17:19,255  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-24T05:17:19,255  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:19,255  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-17_724_8004537852880499191-1
2024-04-24T05:17:19,256  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c244bcad-07d7-4c03-9f46-d0bb3277cdc6/hive_2024-04-24_05-17-17_724_8004537852880499191-1 on fs with scheme file
2024-04-24T05:17:19,257  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2): drop table if exists acidTbl
2024-04-24T05:17:19,259  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-24T05:17:19,260  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T05:17:19,261  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:19,267  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,268  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:19,268  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:19,268  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:19,268  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T05:17:19,268  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2); Time taken: 0.011 seconds
2024-04-24T05:17:19,268  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2
2024-04-24T05:17:19,269  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2
2024-04-24T05:17:19,284  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T05:17:19,284  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:19,284  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2): drop table if exists acidTbl
2024-04-24T05:17:19,284  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:19,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:19,292  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:19,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,301  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:19,404  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:19,404  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=112}
2024-04-24T05:17:19,404  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2); Time taken: 0.12 seconds
2024-04-24T05:17:19,404  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051719_5e3f6821-7f59-414a-8dcc-38e3b7b5c2c2
2024-04-24T05:17:19,409  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T05:17:19,416  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:19,416  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T05:17:19,417  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:19,417  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c): drop table if exists acidTblPart
2024-04-24T05:17:19,420  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-24T05:17:19,420  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T05:17:19,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:19,429  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,429  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:19,429  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:19,429  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:19,429  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:19,430  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c); Time taken: 0.012 seconds
2024-04-24T05:17:19,430  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c
2024-04-24T05:17:19,430  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c
2024-04-24T05:17:19,447  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T05:17:19,447  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:19,447  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c): drop table if exists acidTblPart
2024-04-24T05:17:19,447  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:19,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:19,455  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,455  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:19,463  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:19,512  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:19,512  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=57, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-24T05:17:19,512  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c); Time taken: 0.065 seconds
2024-04-24T05:17:19,512  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051719_89dbdfdf-9c7f-4369-b5ff-cb34baea5e6c
2024-04-24T05:17:19,517  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T05:17:19,523  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:19,523  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T05:17:19,523  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:19,524  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051719_674064d1-7304-4457-ab89-a7255eaafb2b): drop table if exists acidTbl2
2024-04-24T05:17:19,526  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-24T05:17:19,526  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T05:17:19,527  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:19,527  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:19,527  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:19,527  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:19,528  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051719_674064d1-7304-4457-ab89-a7255eaafb2b); Time taken: 0.003 seconds
2024-04-24T05:17:19,528  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424051719_674064d1-7304-4457-ab89-a7255eaafb2b
2024-04-24T05:17:19,528  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:19,528  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051719_674064d1-7304-4457-ab89-a7255eaafb2b): drop table if exists acidTbl2
2024-04-24T05:17:19,528  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:19,529  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T05:17:19,529  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:19,529  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-24T05:17:19,530  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051719_674064d1-7304-4457-ab89-a7255eaafb2b); Time taken: 0.001 seconds
2024-04-24T05:17:19,530  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051719_674064d1-7304-4457-ab89-a7255eaafb2b
2024-04-24T05:17:19,535  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T05:17:19,541  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:19,542  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T05:17:19,542  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:19,543  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:19,545  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-24T05:17:19,545  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T05:17:19,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:19,568  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,568  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:19,568  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:19,568  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:19,569  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=22, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:19,569  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f); Time taken: 0.026 seconds
2024-04-24T05:17:19,569  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f
2024-04-24T05:17:19,570  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f
2024-04-24T05:17:19,584  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T05:17:19,584  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:19,585  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:19,585  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:19,585  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:19,595  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:19,605  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,606  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:19,698  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:19,698  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=103, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:19,698  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f); Time taken: 0.114 seconds
2024-04-24T05:17:19,698  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051719_1f5ea7fa-0ba6-44a0-9fea-68b83634210f
2024-04-24T05:17:19,702  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T05:17:19,709  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:19,709  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T05:17:19,709  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:19,710  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:19,712  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-24T05:17:19,712  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T05:17:19,713  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:19,723  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,723  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:19,723  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:19,723  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:19,723  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-24T05:17:19,724  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6); Time taken: 0.013 seconds
2024-04-24T05:17:19,724  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6
2024-04-24T05:17:19,724  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6
2024-04-24T05:17:19,740  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T05:17:19,740  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:19,740  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:19,740  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:19,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:19,751  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:19,762  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,762  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:19,796  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:19,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:19,797  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6); Time taken: 0.056 seconds
2024-04-24T05:17:19,797  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051719_2e46b692-2da6-4cf7-a466-cdee6b1291a6
2024-04-24T05:17:19,800  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T05:17:19,805  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:19,805  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T05:17:19,806  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:19,806  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf): drop table if exists nonAcidNonBucket
2024-04-24T05:17:19,809  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-24T05:17:19,809  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T05:17:19,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:19,819  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,819  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:19,819  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:19,819  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:19,819  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:19,819  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf); Time taken: 0.013 seconds
2024-04-24T05:17:19,819  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf
2024-04-24T05:17:19,820  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf
2024-04-24T05:17:19,834  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T05:17:19,834  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:19,834  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf): drop table if exists nonAcidNonBucket
2024-04-24T05:17:19,834  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:19,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:19,845  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,845  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:19,854  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:19,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:19,888  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:19,888  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-24T05:17:19,889  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf); Time taken: 0.054 seconds
2024-04-24T05:17:19,889  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051719_eec16337-ae19-428c-8872-76ff0a26edbf
2024-04-24T05:17:19,894  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T05:17:19,901  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:19,901  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T05:17:19,901  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T05:17:19,966  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T05:17:19,966  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T05:17:19,966  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T05:17:19,967  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T05:17:19,969  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = dc4bbc10-8c1f-442f-ad9b-829181b98f88
2024-04-24T05:17:19,971  INFO [main] SessionState: Hive Session ID = dc4bbc10-8c1f-442f-ad9b-829181b98f88
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:19,972  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:19,977  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dc4bbc10-8c1f-442f-ad9b-829181b98f88
2024-04-24T05:17:19,979  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88
2024-04-24T05:17:19,981  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dc4bbc10-8c1f-442f-ad9b-829181b98f88/_tmp_space.db
2024-04-24T05:17:19,982  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=dc4bbc10-8c1f-442f-ad9b-829181b98f88, clientType=HIVECLI]
2024-04-24T05:17:19,982  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:19,982  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051719_709d92da-4297-4cd6-9021-c79cd8151de6): drop table if exists acidTbl
2024-04-24T05:17:19,990  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T05:17:19,990  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T05:17:19,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:19,996  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:19,996  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:19,996  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:19,996  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=2, openTxn_(String, TxnType)=7}
2024-04-24T05:17:19,996  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051719_709d92da-4297-4cd6-9021-c79cd8151de6); Time taken: 0.014 seconds
2024-04-24T05:17:19,996  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424051719_709d92da-4297-4cd6-9021-c79cd8151de6
2024-04-24T05:17:19,996  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:19,996  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051719_709d92da-4297-4cd6-9021-c79cd8151de6): drop table if exists acidTbl
2024-04-24T05:17:19,997  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:19,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:20,000  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,000  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,000  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051719_709d92da-4297-4cd6-9021-c79cd8151de6); Time taken: 0.004 seconds
2024-04-24T05:17:20,000  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051719_709d92da-4297-4cd6-9021-c79cd8151de6
2024-04-24T05:17:20,006  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T05:17:20,012  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,012  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T05:17:20,012  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:20,013  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_ef54b956-1937-40f0-b97a-8ff3b473a63c): drop table if exists acidTblPart
2024-04-24T05:17:20,015  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T05:17:20,016  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T05:17:20,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:20,019  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,019  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,019  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,019  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:20,020  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_ef54b956-1937-40f0-b97a-8ff3b473a63c); Time taken: 0.006 seconds
2024-04-24T05:17:20,020  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424051720_ef54b956-1937-40f0-b97a-8ff3b473a63c
2024-04-24T05:17:20,020  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:20,020  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_ef54b956-1937-40f0-b97a-8ff3b473a63c): drop table if exists acidTblPart
2024-04-24T05:17:20,020  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,020  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:20,023  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,023  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,024  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_ef54b956-1937-40f0-b97a-8ff3b473a63c); Time taken: 0.003 seconds
2024-04-24T05:17:20,024  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_ef54b956-1937-40f0-b97a-8ff3b473a63c
2024-04-24T05:17:20,029  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T05:17:20,034  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,034  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T05:17:20,034  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:20,035  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_c121d61d-da12-4621-bd97-6ea5a6ca3ce0): drop table if exists acidTbl2
2024-04-24T05:17:20,037  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T05:17:20,037  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T05:17:20,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:20,041  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,041  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,041  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,041  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-24T05:17:20,041  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_c121d61d-da12-4621-bd97-6ea5a6ca3ce0); Time taken: 0.006 seconds
2024-04-24T05:17:20,042  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424051720_c121d61d-da12-4621-bd97-6ea5a6ca3ce0
2024-04-24T05:17:20,042  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:20,042  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_c121d61d-da12-4621-bd97-6ea5a6ca3ce0): drop table if exists acidTbl2
2024-04-24T05:17:20,042  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:20,045  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,045  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,045  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_c121d61d-da12-4621-bd97-6ea5a6ca3ce0); Time taken: 0.003 seconds
2024-04-24T05:17:20,045  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_c121d61d-da12-4621-bd97-6ea5a6ca3ce0
2024-04-24T05:17:20,050  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T05:17:20,055  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,055  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T05:17:20,055  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:20,056  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_d08c4d2c-eb3d-47a1-a479-42ffb2149796): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:20,058  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T05:17:20,058  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T05:17:20,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:20,061  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,061  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-24T05:17:20,062  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_d08c4d2c-eb3d-47a1-a479-42ffb2149796); Time taken: 0.005 seconds
2024-04-24T05:17:20,062  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424051720_d08c4d2c-eb3d-47a1-a479-42ffb2149796
2024-04-24T05:17:20,062  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:20,062  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_d08c4d2c-eb3d-47a1-a479-42ffb2149796): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:20,062  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,063  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:20,066  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,067  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,067  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_d08c4d2c-eb3d-47a1-a479-42ffb2149796); Time taken: 0.004 seconds
2024-04-24T05:17:20,067  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_d08c4d2c-eb3d-47a1-a479-42ffb2149796
2024-04-24T05:17:20,072  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T05:17:20,077  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,077  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T05:17:20,078  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:20,078  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_737ee7dd-fb21-4c0f-901e-8916abeb0a35): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:20,080  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T05:17:20,081  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T05:17:20,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:20,084  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,084  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,084  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,085  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_737ee7dd-fb21-4c0f-901e-8916abeb0a35); Time taken: 0.006 seconds
2024-04-24T05:17:20,085  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424051720_737ee7dd-fb21-4c0f-901e-8916abeb0a35
2024-04-24T05:17:20,085  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:20,085  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_737ee7dd-fb21-4c0f-901e-8916abeb0a35): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:20,085  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:20,089  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,089  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,089  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_737ee7dd-fb21-4c0f-901e-8916abeb0a35); Time taken: 0.004 seconds
2024-04-24T05:17:20,089  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_737ee7dd-fb21-4c0f-901e-8916abeb0a35
2024-04-24T05:17:20,094  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T05:17:20,100  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,100  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T05:17:20,100  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:20,101  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_f9a5c23b-1b02-4259-99cc-95b0939063d1): drop table if exists nonAcidNonBucket
2024-04-24T05:17:20,103  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T05:17:20,103  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T05:17:20,104  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:20,107  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,107  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,107  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,107  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-24T05:17:20,107  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_f9a5c23b-1b02-4259-99cc-95b0939063d1); Time taken: 0.006 seconds
2024-04-24T05:17:20,108  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424051720_f9a5c23b-1b02-4259-99cc-95b0939063d1
2024-04-24T05:17:20,108  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:20,108  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_f9a5c23b-1b02-4259-99cc-95b0939063d1): drop table if exists nonAcidNonBucket
2024-04-24T05:17:20,108  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,108  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:20,111  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,111  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,111  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_f9a5c23b-1b02-4259-99cc-95b0939063d1); Time taken: 0.003 seconds
2024-04-24T05:17:20,111  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_f9a5c23b-1b02-4259-99cc-95b0939063d1
2024-04-24T05:17:20,116  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T05:17:20,121  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,121  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T05:17:20,122  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,122  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,124  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T05:17:20,125  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T05:17:20,125  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,125  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,131  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T05:17:20,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,133  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,133  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,133  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:20,134  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734); Time taken: 0.011 seconds
2024-04-24T05:17:20,134  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734
2024-04-24T05:17:20,134  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734
2024-04-24T05:17:20,153  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T05:17:20,154  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,154  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,154  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,155  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713961040, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, transactional=true, bucketing_version=2, numFilesErasureCoded=0, numFiles=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:20,162  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtbl
2024-04-24T05:17:20,206  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,206  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=50, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:20,206  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734); Time taken: 0.052 seconds
2024-04-24T05:17:20,206  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_6d842080-4cab-4082-a0e1-dc9088b11734
2024-04-24T05:17:20,210  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T05:17:20,216  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,216  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T05:17:20,217  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,217  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,220  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T05:17:20,220  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T05:17:20,221  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,221  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,223  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T05:17:20,223  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,225  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,225  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,225  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,225  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,225  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-24T05:17:20,226  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0); Time taken: 0.008 seconds
2024-04-24T05:17:20,226  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0
2024-04-24T05:17:20,226  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0
2024-04-24T05:17:20,241  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T05:17:20,241  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,242  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,242  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713961040, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:20,249  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtblpart
2024-04-24T05:17:20,267  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,267  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,267  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0); Time taken: 0.025 seconds
2024-04-24T05:17:20,267  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_a5f2d699-c03c-47fe-a454-b959435da3c0
2024-04-24T05:17:20,272  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T05:17:20,279  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,279  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T05:17:20,279  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,280  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,282  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T05:17:20,282  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T05:17:20,283  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,283  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,285  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T05:17:20,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,287  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,287  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,287  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,287  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,287  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2}
2024-04-24T05:17:20,288  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68); Time taken: 0.007 seconds
2024-04-24T05:17:20,288  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68
2024-04-24T05:17:20,288  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68
2024-04-24T05:17:20,303  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T05:17:20,303  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,303  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,303  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,304  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713961040, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, totalSize=0, rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:20,310  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl
2024-04-24T05:17:20,327  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,327  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,328  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68); Time taken: 0.024 seconds
2024-04-24T05:17:20,328  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_7c7610e7-bb71-4c97-9eab-594dc35a1b68
2024-04-24T05:17:20,331  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T05:17:20,337  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,337  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T05:17:20,338  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,338  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,341  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T05:17:20,341  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T05:17:20,342  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,342  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,344  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T05:17:20,344  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,346  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,346  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,346  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,346  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,346  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidTxns_(long)=1}
2024-04-24T05:17:20,346  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d); Time taken: 0.008 seconds
2024-04-24T05:17:20,347  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d
2024-04-24T05:17:20,347  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d
2024-04-24T05:17:20,363  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T05:17:20,363  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,363  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,363  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713961040, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, bucketing_version=2, numFiles=0, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:20,372  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl2
2024-04-24T05:17:20,388  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,388  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-24T05:17:20,388  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d); Time taken: 0.025 seconds
2024-04-24T05:17:20,388  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_c1e06a41-fa9d-44f8-bbf0-9d59e72a383d
2024-04-24T05:17:20,393  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T05:17:20,399  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,400  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T05:17:20,400  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,400  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,403  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T05:17:20,403  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T05:17:20,404  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,404  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,406  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T05:17:20,406  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,408  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,408  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,408  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,408  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,408  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2}
2024-04-24T05:17:20,409  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a); Time taken: 0.008 seconds
2024-04-24T05:17:20,409  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a
2024-04-24T05:17:20,409  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a
2024-04-24T05:17:20,422  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T05:17:20,422  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,423  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:20,423  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,424  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/dc4bbc10-8c1f-442f-ad9b-829181b98f88/_tmp_space.db/fa735e60-6aa1-4c16-8881-48c278d3481a
2024-04-24T05:17:20,427  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,427  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,428  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a); Time taken: 0.004 seconds
2024-04-24T05:17:20,428  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_e69b00de-c2ed-45e3-a637-9728ec59269a
2024-04-24T05:17:20,432  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T05:17:20,437  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,437  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T05:17:20,438  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,438  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,441  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T05:17:20,441  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T05:17:20,441  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,441  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,444  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T05:17:20,444  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,446  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,446  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,446  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,446  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,446  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=9}
2024-04-24T05:17:20,446  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1); Time taken: 0.008 seconds
2024-04-24T05:17:20,446  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1
2024-04-24T05:17:20,446  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1
2024-04-24T05:17:20,460  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1 LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T05:17:20,460  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,460  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:20,460  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713961040, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFilesErasureCoded=0, transactional=false, totalSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:20,468  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidnonbucket
2024-04-24T05:17:20,484  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,484  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T05:17:20,484  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1); Time taken: 0.024 seconds
2024-04-24T05:17:20,484  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_6445daed-c703-4890-a430-7bd40e0ec1f1
2024-04-24T05:17:20,488  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T05:17:20,493  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,493  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T05:17:20,498  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T05:17:20,499  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983): drop table if exists T
2024-04-24T05:17:20,501  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T05:17:20,501  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T05:17:20,502  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:20,520  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,521  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,521  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,521  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,521  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=19, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:20,521  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983); Time taken: 0.022 seconds
2024-04-24T05:17:20,521  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983
2024-04-24T05:17:20,522  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983
2024-04-24T05:17:20,539  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T05:17:20,539  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:20,539  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983): drop table if exists T
2024-04-24T05:17:20,539  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,539  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:20,547  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:20,555  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T05:17:20,691  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t does not exist; Force to delete it.
2024-04-24T05:17:20,691 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:20,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=144, getTable_(GetTableRequest)=8}
2024-04-24T05:17:20,691  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983); Time taken: 0.152 seconds
2024-04-24T05:17:20,691  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_2bec266f-7e88-49d5-a53e-4b729404d983
2024-04-24T05:17:20,695  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T05:17:20,700  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,701  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T05:17:20,702  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T05:17:20,702  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b): drop table if exists Tstage
2024-04-24T05:17:20,704  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T05:17:20,704  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T05:17:20,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:20,726  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,726  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,726  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,726  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,727  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=2, flushCache_()=0, getTable_(GetTableRequest)=21, openTxn_(String, TxnType)=1}
2024-04-24T05:17:20,727  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b); Time taken: 0.024 seconds
2024-04-24T05:17:20,727  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b
2024-04-24T05:17:20,727  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b
2024-04-24T05:17:20,741  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T05:17:20,741  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:20,741  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b): drop table if exists Tstage
2024-04-24T05:17:20,741  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:20,750  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:20,759  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T05:17:20,793  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage does not exist; Force to delete it.
2024-04-24T05:17:20,793 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:20,793  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,793  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9}
2024-04-24T05:17:20,794  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b); Time taken: 0.052 seconds
2024-04-24T05:17:20,794  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_69347107-d9df-4460-a287-740a20c50d2b
2024-04-24T05:17:20,797  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T05:17:20,803  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,804  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T05:17:20,804  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:20,805  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:20,807  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T05:17:20,807  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T05:17:20,808  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,808  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,813  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T05:17:20,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,815  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,815  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,816  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,816  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,816  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=5}
2024-04-24T05:17:20,816  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa); Time taken: 0.012 seconds
2024-04-24T05:17:20,816  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa
2024-04-24T05:17:20,816  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa
2024-04-24T05:17:20,833  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T05:17:20,833  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,834  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:20,834  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713961040, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:20,841  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:20,871  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,871  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=36, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,871  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa); Time taken: 0.037 seconds
2024-04-24T05:17:20,871  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_2299d2d7-70ec-43e1-b5ae-007446a36dfa
2024-04-24T05:17:20,875  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T05:17:20,880  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,881  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T05:17:20,881  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:20,882  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:20,885  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T05:17:20,885  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T05:17:20,886  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,886  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,889  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T05:17:20,889  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:20,890  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:20,890  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:20,890  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:20,890  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:20,891  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=1, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=2}
2024-04-24T05:17:20,891  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25); Time taken: 0.009 seconds
2024-04-24T05:17:20,891  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25
2024-04-24T05:17:20,891  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25
2024-04-24T05:17:20,905  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T05:17:20,905  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:20,905  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:20,905  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:20,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713961040, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:20,912  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:20,931  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:20,931  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:20,931  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25); Time taken: 0.026 seconds
2024-04-24T05:17:20,931  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_4c1a1a99-e3ec-4c8f-bd66-969692eaee25
2024-04-24T05:17:20,935  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T05:17:20,941  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:20,941  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T05:17:20,941  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-24T05:17:20,942  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-24T05:17:20,944  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T05:17:20,945  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T05:17:20,945  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:20,945  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:20,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:20,954  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,955  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:20,955  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:20,955  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:20,955  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:20,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:20,962  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:20,963  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T05:17:20,971  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:20,971  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T05:17:20,995  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:21,073  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:21,073  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:21,073  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:21,073  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:21,076  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:21,076  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:21,076  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:21,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:21,083  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:21,084  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T05:17:21,091  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:21,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:21,100  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-24T05:17:21,101  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=tstage (txnIds: [17])
2024-04-24T05:17:21,102  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:21,105  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T05:17:21,105  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T05:17:21,106  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:21,107  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:21,115  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:21,123  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:21,124  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:21,124  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:21,124  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:21,124  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:21,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_ps_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T05:17:21,141  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T05:17:21,141  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:21,141  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=4, getAllTableConstraints_(AllTableConstraintsRequest)=27, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, getTable_(GetTableRequest)=30, flushCache_()=0, openTxn_(String, TxnType)=3, allocateTableWriteId_(long, String, String)=7, getNotNullConstraints_(NotNullConstraintsRequest)=1, listPartitionsWithAuthInfo_(String, String, List, short, String, List)=16, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-24T05:17:21,141  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c); Time taken: 0.199 seconds
2024-04-24T05:17:21,142  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c
2024-04-24T05:17:21,142  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c
2024-04-24T05:17:21,161  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T05:17:21,161  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:21,164  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-24T05:17:21,164  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c
2024-04-24T05:17:21,164  INFO [main] ql.Driver: Query ID = alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c
Total jobs = 1
2024-04-24T05:17:21,164  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:21,164  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:21,316  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T05:17:21,316  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:21,316  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:21,316  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:21,316  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:21,316  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:21,316  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:21,316  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:21,319  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:21,319  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T05:17:21,319  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88/hive_2024-04-24_05-17-20_942_8238432215395529506-1/dummy_path
2024-04-24T05:17:21,329  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:21,329  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:21,334  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:21,335  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T05:17:21,336  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:21,340  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88/hive_2024-04-24_05-17-20_942_8238432215395529506-1/-mr-10000
2024-04-24T05:17:21,342  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:21,350  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:21,355  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:21,356  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T05:17:21,356  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T05:17:21,356  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88/hive_2024-04-24_05-17-20_942_8238432215395529506-1/dummy_path
2024-04-24T05:17:21,356  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:21,375  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:21,394  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local40984433_0009
2024-04-24T05:17:21,394  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:21,454  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:21,455  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:21,455  INFO [Thread-810] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:21,455  INFO [Thread-810] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:21,457  INFO [Thread-810] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:21,457  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local40984433_0009_m_000000_0
2024-04-24T05:17:21,460  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:21,460  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88/hive_2024-04-24_05-17-20_942_8238432215395529506-1/dummy_path/null:0+1
2024-04-24T05:17:21,462  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:21,463  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:21,464  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T05:17:21,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:21,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:21,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:21,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:21,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:21,469  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:21,469  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:21,469  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:21,470  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:21,470  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:21,470  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T05:17:21,471  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T05:17:21,471  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:21,471  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T05:17:21,471  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T05:17:21,471  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:21,472  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T05:17:21,472  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T05:17:21,472  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:21,472  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:21,472  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T05:17:21,472  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T05:17:21,473  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-24T05:17:21,475  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:21,475  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:21,475  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:21,475  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T05:17:21,475  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:21,486  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:21,491  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local40984433_0009_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:21,492  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:21,492  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local40984433_0009_m_000000_0' done.
2024-04-24T05:17:21,492  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local40984433_0009_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=201754
		FILE: Number of bytes written=10705438
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-24T05:17:21,492  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local40984433_0009_m_000000_0
2024-04-24T05:17:21,492  INFO [Thread-810] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:21,494  INFO [Thread-810] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:21,494  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local40984433_0009_r_000000_0
2024-04-24T05:17:21,496  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:21,496  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1bbb762c
2024-04-24T05:17:21,496  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:21,497  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:21,498  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local40984433_0009_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:21,501  INFO [localfetcher#8] reduce.LocalFetcher: localfetcher#8 about to shuffle output of map attempt_local40984433_0009_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-24T05:17:21,501  INFO [localfetcher#8] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local40984433_0009_m_000000_0
2024-04-24T05:17:21,501  INFO [localfetcher#8] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-24T05:17:21,502  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:21,502  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:21,502  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:21,508  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:21,508  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T05:17:21,512  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:21,512  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-24T05:17:21,512  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:21,512  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:21,512  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T05:17:21,513  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:21,513  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:21,514  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T05:17:21,515  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:21,515  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:21,515  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T05:17:21,515  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T05:17:21,515  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local40984433_0009/job_local40984433_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@24d1b26f
2024-04-24T05:17:21,516  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:21,516  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:21,516  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T05:17:21,516  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-24T05:17:21,516  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1
2024-04-24T05:17:21,516  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1
2024-04-24T05:17:21,516  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:21,523  INFO [pool-46-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_OPERATOR_FS_6:0, RECORDS_OUT_1_default.tstage:0, 
2024-04-24T05:17:21,523  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local40984433_0009_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:21,524  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:21,524  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local40984433_0009_r_000000_0' done.
2024-04-24T05:17:21,524  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local40984433_0009_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=207886
		FILE: Number of bytes written=10705500
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:21,524  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local40984433_0009_r_000000_0
2024-04-24T05:17:21,524  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local40984433_0009_r_000001_0
2024-04-24T05:17:21,525  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:21,525  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7ee39e
2024-04-24T05:17:21,525  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:21,526  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:21,526  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local40984433_0009_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:21,529  INFO [localfetcher#9] reduce.LocalFetcher: localfetcher#9 about to shuffle output of map attempt_local40984433_0009_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T05:17:21,529  INFO [localfetcher#9] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local40984433_0009_m_000000_0
2024-04-24T05:17:21,530  INFO [localfetcher#9] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T05:17:21,530  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:21,530  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:21,530  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:21,537  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:21,537  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T05:17:21,539  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:21,539  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T05:17:21,539  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:21,539  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:21,539  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T05:17:21,540  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:21,540  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:21,540  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-24T05:17:21,541  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:21,541  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:21,541  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T05:17:21,541  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T05:17:21,542  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local40984433_0009/job_local40984433_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@35ca7be1
2024-04-24T05:17:21,542  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1
2024-04-24T05:17:21,542  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1
2024-04-24T05:17:21,542  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:21,543  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T05:17:21,543  INFO [pool-46-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-24T05:17:21,553  INFO [pool-46-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-24T05:17:21,559  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:21,559  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:21,559  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T05:17:21,559  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T05:17:21,564  INFO [pool-46-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-24T05:17:21,576  INFO [pool-46-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-24T05:17:21,576  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local40984433_0009_r_000001_0 is done. And is in the process of committing
2024-04-24T05:17:21,577  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:21,577  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local40984433_0009_r_000001_0' done.
2024-04-24T05:17:21,577  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local40984433_0009_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=214048
		FILE: Number of bytes written=10706588
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:21,577  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local40984433_0009_r_000001_0
2024-04-24T05:17:21,577  INFO [Thread-810] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:22,457 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:22,457  INFO [main] exec.Task: 2024-04-24 05:17:22,457 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local40984433_0009
2024-04-24T05:17:22,458  INFO [main] exec.Task: Ended Job = job_local40984433_0009
2024-04-24T05:17:22,459  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-24T05:17:22,459  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-24T05:17:22,460  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/_tmp.delta_0000001_0000001_0000
2024-04-24T05:17:22,468  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage partition (p=1)
2024-04-24T05:17:22,469  INFO [main] exec.Task: Loading data to table default.tstage partition (p=1) from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1
2024-04-24T05:17:22,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:22,478  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,478  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T05:17:22,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:22,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:22,486  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T05:17:22,500  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T05:17:22,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.default.tstage	
2024-04-24T05:17:22,534  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T05:17:22,555  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T05:17:22,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:22,562  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,562  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T05:17:22,563  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88/hive_2024-04-24_05-17-20_942_8238432215395529506-1/-mr-10000
2024-04-24T05:17:22,566  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:22,574  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-24T05:17:22,594  WARN [stats-updater-thread-0] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-24T05:17:22,595  INFO [main] FileOperations: Read stats for default.tstage/p=1/, numRows, true, 2, false: 
2024-04-24T05:17:22,595  INFO [main] FileOperations: Read stats for default.tstage/p=1/, rawDataSize, true, 0, false: 
2024-04-24T05:17:22,595  INFO [main] stats.BasicStatsTask: Partition {p=1} stats: [numFiles=1, numRows=2, totalSize=692, rawDataSize=0, numFilesErasureCoded=0]
2024-04-24T05:17:22,595  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.tstage	
2024-04-24T05:17:22,595  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T05:17:22,660  INFO [main] FileOperations: Read stats for default.tstage/p=1/, insertCount, true, 2, false: 
2024-04-24T05:17:22,660  INFO [main] FileOperations: Read stats for default.tstage/p=1/, updateCount, true, 0, false: 
2024-04-24T05:17:22,660  INFO [main] FileOperations: Read stats for default.tstage/p=1/, deleteCount, true, 0, false: 
2024-04-24T05:17:22,664  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:22,664  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=2, alter_partitions_(String, String, List, EnvironmentContext, String, long)=65, add_partition_(Partition)=32, validatePartitionNameCharacters_(List)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=31, getValidWriteIds_(List, String)=0, getTable_(GetTableRequest)=32}
MapReduce Jobs Launched: 
2024-04-24T05:17:22,664  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:22,664  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:22,664  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:22,664  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c); Time taken: 1.5 seconds
2024-04-24T05:17:22,664  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051720_f3ab5184-9693-4dd8-b5ae-0197bc33d03c
2024-04-24T05:17:22,674  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:22,674  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T05:17:22,675  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-24T05:17:22,675  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88/hive_2024-04-24_05-17-20_942_8238432215395529506-1
2024-04-24T05:17:22,676  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/dc4bbc10-8c1f-442f-ad9b-829181b98f88/hive_2024-04-24_05-17-20_942_8238432215395529506-1 on fs with scheme file
2024-04-24T05:17:22,676  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051722_ae1cf8d7-7163-4e5a-bb7a-2ffbf7b12454): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-24T05:17:22,679  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T05:17:22,679  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T05:17:22,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:22,688  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
2024-04-24T05:17:22,690 ERROR [main] ql.Driver: FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
org.apache.hadoop.hive.ql.parse.SemanticException: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidFiles(AcidUtils.java:3072)
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidPartitionLocation(AcidUtils.java:3089)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionAnalyzer.postProcess(AlterTableAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AbstractAddPartitionAnalyzer.analyzeCommand(AbstractAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.AbstractAlterTableAnalyzer.analyzeInternal(AbstractAlterTableAnalyzer.java:62)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionTransactional(TestTxnAddPartition.java:296)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T05:17:22,690  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:22,690  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=8, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:22,690  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051722_ae1cf8d7-7163-4e5a-bb7a-2ffbf7b12454); Time taken: 0.014 seconds
2024-04-24T05:17:22,690  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:22,694  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:22,701  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:22,701  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b): drop table if exists acidTbl
2024-04-24T05:17:22,704  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T05:17:22,704  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T05:17:22,704  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:22,711  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,711  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:22,711  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:22,711  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:22,711  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, rollbackTxn_(long)=10, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7, flushCache_()=0}
2024-04-24T05:17:22,712  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b); Time taken: 0.01 seconds
2024-04-24T05:17:22,712  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b
2024-04-24T05:17:22,712  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b
2024-04-24T05:17:22,731  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T05:17:22,731  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:22,731  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b): drop table if exists acidTbl
2024-04-24T05:17:22,731  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:22,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:22,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:22,744  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,744  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:22,838  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:22,838  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=100}
2024-04-24T05:17:22,838  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b); Time taken: 0.107 seconds
2024-04-24T05:17:22,838  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051722_5f32063b-3964-495c-9809-d841e0bd713b
2024-04-24T05:17:22,842  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T05:17:22,848  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:22,850  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T05:17:22,850  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:22,851  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561): drop table if exists acidTblPart
2024-04-24T05:17:22,853  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T05:17:22,853  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T05:17:22,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:22,872  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,872  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:22,872  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:22,873  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:22,873  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=18, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-24T05:17:22,873  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561); Time taken: 0.022 seconds
2024-04-24T05:17:22,873  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561
2024-04-24T05:17:22,874  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561
2024-04-24T05:17:22,889  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T05:17:22,889  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:22,889  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561): drop table if exists acidTblPart
2024-04-24T05:17:22,890  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:22,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:22,897  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:22,903  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:22,943  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:22,943  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=46, getTable_(GetTableRequest)=7}
2024-04-24T05:17:22,944  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561); Time taken: 0.054 seconds
2024-04-24T05:17:22,944  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051722_640c9340-405f-42d4-ab89-8017f5018561
2024-04-24T05:17:22,947  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T05:17:22,952  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:22,953  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T05:17:22,953  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:22,953  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051722_b09ece1d-735f-4e58-8daa-8272c9aa8d6c): drop table if exists acidTbl2
2024-04-24T05:17:22,955  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T05:17:22,956  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T05:17:22,956  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:22,956  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:22,957  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:22,957  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:22,957  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051722_b09ece1d-735f-4e58-8daa-8272c9aa8d6c); Time taken: 0.003 seconds
2024-04-24T05:17:22,957  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424051722_b09ece1d-735f-4e58-8daa-8272c9aa8d6c
2024-04-24T05:17:22,957  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:22,957  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051722_b09ece1d-735f-4e58-8daa-8272c9aa8d6c): drop table if exists acidTbl2
2024-04-24T05:17:22,957  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:22,958  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T05:17:22,958  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:22,958  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=1, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-24T05:17:22,958  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051722_b09ece1d-735f-4e58-8daa-8272c9aa8d6c); Time taken: 0.001 seconds
2024-04-24T05:17:22,958  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051722_b09ece1d-735f-4e58-8daa-8272c9aa8d6c
2024-04-24T05:17:22,964  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T05:17:22,969  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:22,969  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T05:17:22,969  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:22,969  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:22,972  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 18
2024-04-24T05:17:22,972  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T05:17:22,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:22,995  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:22,995  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:22,995  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:22,996  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:22,996  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=22, getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:22,996  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c); Time taken: 0.027 seconds
2024-04-24T05:17:22,996  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c
2024-04-24T05:17:22,997  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c
2024-04-24T05:17:23,010  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T05:17:23,010  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:23,010  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:23,010  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,011  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:23,019  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,019  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:23,029  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,029  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:23,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-24T05:17:23,062  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c); Time taken: 0.052 seconds
2024-04-24T05:17:23,062  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051722_6124c09f-382a-4554-bd5a-185dfca08f9c
2024-04-24T05:17:23,066  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T05:17:23,071  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,072  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T05:17:23,072  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:23,073  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:23,075  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-24T05:17:23,076  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T05:17:23,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:23,086  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,086  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,087  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,087  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,087  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=10, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:23,087  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b); Time taken: 0.014 seconds
2024-04-24T05:17:23,087  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b
2024-04-24T05:17:23,088  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b
2024-04-24T05:17:23,102  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T05:17:23,102  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:23,102  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:23,103  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:23,111  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:23,120  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:23,155  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,155  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:23,155  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b); Time taken: 0.053 seconds
2024-04-24T05:17:23,155  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_b424b9cf-c2ff-4c89-9bd5-668cb2d5849b
2024-04-24T05:17:23,159  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T05:17:23,165  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,165  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T05:17:23,165  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:23,166  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c): drop table if exists nonAcidNonBucket
2024-04-24T05:17:23,168  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 18
2024-04-24T05:17:23,168  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T05:17:23,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:23,178  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,179  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,179  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,179  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,179  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=10}
2024-04-24T05:17:23,179  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c); Time taken: 0.013 seconds
2024-04-24T05:17:23,179  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c
2024-04-24T05:17:23,180  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c
2024-04-24T05:17:23,193  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T05:17:23,193  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:23,193  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c): drop table if exists nonAcidNonBucket
2024-04-24T05:17:23,194  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:23,203  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,203  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:23,212  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:23,246  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,246  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=43, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:23,246  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c); Time taken: 0.053 seconds
2024-04-24T05:17:23,246  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_3869b58c-f208-4aa7-8efa-379c12d6d91c
2024-04-24T05:17:23,250  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T05:17:23,255  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,255  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T05:17:23,256  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T05:17:23,321  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T05:17:23,321  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T05:17:23,321  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T05:17:23,322  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T05:17:23,324  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 6d66f66c-aee8-4da9-b8c8-ff6dc648880c
2024-04-24T05:17:23,326  INFO [main] SessionState: Hive Session ID = 6d66f66c-aee8-4da9-b8c8-ff6dc648880c
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:23,327  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:23,332  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6d66f66c-aee8-4da9-b8c8-ff6dc648880c
2024-04-24T05:17:23,334  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c
2024-04-24T05:17:23,336  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/_tmp_space.db
2024-04-24T05:17:23,336  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=6d66f66c-aee8-4da9-b8c8-ff6dc648880c, clientType=HIVECLI]
2024-04-24T05:17:23,337  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:23,337  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_87cc7a96-38e2-46a0-9e17-6f269a071644): drop table if exists acidTbl
2024-04-24T05:17:23,346  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T05:17:23,346  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T05:17:23,348  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:23,357  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,357  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,357  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,357  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=8}
2024-04-24T05:17:23,357  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_87cc7a96-38e2-46a0-9e17-6f269a071644); Time taken: 0.02 seconds
2024-04-24T05:17:23,357  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424051723_87cc7a96-38e2-46a0-9e17-6f269a071644
2024-04-24T05:17:23,357  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:23,357  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_87cc7a96-38e2-46a0-9e17-6f269a071644): drop table if exists acidTbl
2024-04-24T05:17:23,357  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:23,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:23,361  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_87cc7a96-38e2-46a0-9e17-6f269a071644); Time taken: 0.004 seconds
2024-04-24T05:17:23,361  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_87cc7a96-38e2-46a0-9e17-6f269a071644
2024-04-24T05:17:23,366  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T05:17:23,372  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,372  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T05:17:23,372  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:23,373  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_d262a24b-ce75-4019-8ab7-2dbf51e29e8e): drop table if exists acidTblPart
2024-04-24T05:17:23,375  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T05:17:23,375  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T05:17:23,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:23,378  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,379  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,379  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,379  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:23,379  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_d262a24b-ce75-4019-8ab7-2dbf51e29e8e); Time taken: 0.006 seconds
2024-04-24T05:17:23,379  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424051723_d262a24b-ce75-4019-8ab7-2dbf51e29e8e
2024-04-24T05:17:23,379  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:23,379  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_d262a24b-ce75-4019-8ab7-2dbf51e29e8e): drop table if exists acidTblPart
2024-04-24T05:17:23,380  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:23,383  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,383  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:23,383  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_d262a24b-ce75-4019-8ab7-2dbf51e29e8e); Time taken: 0.004 seconds
2024-04-24T05:17:23,383  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_d262a24b-ce75-4019-8ab7-2dbf51e29e8e
2024-04-24T05:17:23,388  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T05:17:23,395  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,396  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T05:17:23,397  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:23,397  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_99c2336d-a755-4f79-ba25-5cd2b0d2bfda): drop table if exists acidTbl2
2024-04-24T05:17:23,399  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T05:17:23,400  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T05:17:23,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:23,403  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,403  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,403  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,403  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:23,403  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_99c2336d-a755-4f79-ba25-5cd2b0d2bfda); Time taken: 0.006 seconds
2024-04-24T05:17:23,404  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424051723_99c2336d-a755-4f79-ba25-5cd2b0d2bfda
2024-04-24T05:17:23,404  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:23,404  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_99c2336d-a755-4f79-ba25-5cd2b0d2bfda): drop table if exists acidTbl2
2024-04-24T05:17:23,404  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,404  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:23,407  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,407  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:23,407  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_99c2336d-a755-4f79-ba25-5cd2b0d2bfda); Time taken: 0.003 seconds
2024-04-24T05:17:23,407  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_99c2336d-a755-4f79-ba25-5cd2b0d2bfda
2024-04-24T05:17:23,412  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T05:17:23,417  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,417  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T05:17:23,418  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:23,418  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_e021f29d-6607-4a32-85ab-c421319f8be9): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:23,420  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T05:17:23,420  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T05:17:23,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:23,424  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,424  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-24T05:17:23,424  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_e021f29d-6607-4a32-85ab-c421319f8be9); Time taken: 0.006 seconds
2024-04-24T05:17:23,424  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424051723_e021f29d-6607-4a32-85ab-c421319f8be9
2024-04-24T05:17:23,424  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:23,424  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_e021f29d-6607-4a32-85ab-c421319f8be9): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:23,425  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:23,428  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,428  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:23,428  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_e021f29d-6607-4a32-85ab-c421319f8be9); Time taken: 0.004 seconds
2024-04-24T05:17:23,428  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_e021f29d-6607-4a32-85ab-c421319f8be9
2024-04-24T05:17:23,433  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T05:17:23,439  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,439  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T05:17:23,440  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:23,440  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_9aa42004-e875-4689-a822-7d88b64ab861): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:23,442  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T05:17:23,442  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T05:17:23,443  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:23,446  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,446  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,446  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,446  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=1}
2024-04-24T05:17:23,446  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_9aa42004-e875-4689-a822-7d88b64ab861); Time taken: 0.006 seconds
2024-04-24T05:17:23,446  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424051723_9aa42004-e875-4689-a822-7d88b64ab861
2024-04-24T05:17:23,446  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:23,446  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_9aa42004-e875-4689-a822-7d88b64ab861): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:23,447  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:23,450  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,450  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:23,450  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_9aa42004-e875-4689-a822-7d88b64ab861); Time taken: 0.004 seconds
2024-04-24T05:17:23,450  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_9aa42004-e875-4689-a822-7d88b64ab861
2024-04-24T05:17:23,455  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T05:17:23,460  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,460  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T05:17:23,461  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:23,461  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_14459805-7617-4136-b24e-7ce9e1399af1): drop table if exists nonAcidNonBucket
2024-04-24T05:17:23,463  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T05:17:23,463  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T05:17:23,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:23,467  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,467  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,467  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,467  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T05:17:23,467  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_14459805-7617-4136-b24e-7ce9e1399af1); Time taken: 0.006 seconds
2024-04-24T05:17:23,467  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424051723_14459805-7617-4136-b24e-7ce9e1399af1
2024-04-24T05:17:23,467  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:23,467  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_14459805-7617-4136-b24e-7ce9e1399af1): drop table if exists nonAcidNonBucket
2024-04-24T05:17:23,467  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,468  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:23,470  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:23,471  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_14459805-7617-4136-b24e-7ce9e1399af1); Time taken: 0.003 seconds
2024-04-24T05:17:23,471  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_14459805-7617-4136-b24e-7ce9e1399af1
2024-04-24T05:17:23,476  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T05:17:23,481  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,481  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T05:17:23,481  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,482  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,484  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T05:17:23,485  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T05:17:23,485  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:23,485  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:23,490  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T05:17:23,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:23,492  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:23,492  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,492  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,492  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:23,492  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23); Time taken: 0.01 seconds
2024-04-24T05:17:23,493  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23
2024-04-24T05:17:23,493  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23
2024-04-24T05:17:23,513  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T05:17:23,513  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:23,514  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,514  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,515  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713961043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, rawDataSize=0, numRows=0, transactional=true, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:23,521  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtbl
2024-04-24T05:17:23,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=42}
2024-04-24T05:17:23,558  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23); Time taken: 0.043 seconds
2024-04-24T05:17:23,558  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_afa2db16-21c2-4239-a1f3-fe436f051e23
2024-04-24T05:17:23,563  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T05:17:23,571  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,571  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T05:17:23,571  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,572  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,574  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T05:17:23,574  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T05:17:23,575  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:23,575  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:23,577  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T05:17:23,577  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:23,581  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:23,581  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,581  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,581  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,581  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getDatabase_(String)=3, flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:23,581  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722); Time taken: 0.009 seconds
2024-04-24T05:17:23,581  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722
2024-04-24T05:17:23,581  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722
2024-04-24T05:17:23,596  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T05:17:23,596  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:23,597  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,597  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713961043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:23,604  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtblpart
2024-04-24T05:17:23,621  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-24T05:17:23,621  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722); Time taken: 0.024 seconds
2024-04-24T05:17:23,621  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_58ff0c1c-29b8-4a98-b09b-d14537c40722
2024-04-24T05:17:23,627  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T05:17:23,632  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,632  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T05:17:23,633  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,633  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,636  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T05:17:23,636  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T05:17:23,636  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:23,636  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:23,639  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T05:17:23,639  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:23,640  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:23,640  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,641  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,641  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:23,641  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae); Time taken: 0.008 seconds
2024-04-24T05:17:23,641  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae
2024-04-24T05:17:23,641  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae
2024-04-24T05:17:23,655  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T05:17:23,655  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:23,655  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,655  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713961043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFiles=0, transactional=false, numRows=0, rawDataSize=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:23,662  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl
2024-04-24T05:17:23,685  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,685  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=29}
2024-04-24T05:17:23,685  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae); Time taken: 0.03 seconds
2024-04-24T05:17:23,685  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_33531a46-3bf4-4b4f-909b-e831d8e23dae
2024-04-24T05:17:23,689  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T05:17:23,694  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,695  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T05:17:23,695  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,695  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,697  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T05:17:23,698  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T05:17:23,698  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:23,698  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:23,701  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T05:17:23,701  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:23,702  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:23,703  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,703  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,703  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,703  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getDatabase_(String)=1, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T05:17:23,703  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1); Time taken: 0.008 seconds
2024-04-24T05:17:23,703  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1
2024-04-24T05:17:23,703  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1
2024-04-24T05:17:23,716  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T05:17:23,716  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:23,716  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,717  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,717  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713961043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, bucketing_version=2, totalSize=0, numFilesErasureCoded=0, transactional=false, rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:23,723  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl2
2024-04-24T05:17:23,738  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,738  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-24T05:17:23,738  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1); Time taken: 0.022 seconds
2024-04-24T05:17:23,738  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_94a7f864-7d4b-45a3-9979-13589d2902d1
2024-04-24T05:17:23,742  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T05:17:23,747  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,747  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T05:17:23,748  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,748  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,750  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T05:17:23,751  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T05:17:23,751  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:23,751  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:23,753  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T05:17:23,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:23,755  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:23,755  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,755  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,756  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,756  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, getDatabase_(String)=1}
2024-04-24T05:17:23,756  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a); Time taken: 0.007 seconds
2024-04-24T05:17:23,756  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a
2024-04-24T05:17:23,756  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a
2024-04-24T05:17:23,774  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T05:17:23,774  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:23,774  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:23,774  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,775  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/_tmp_space.db/b9ba102d-1fd8-4cc0-9312-826590af7cab
2024-04-24T05:17:23,778  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,778  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-24T05:17:23,778  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a); Time taken: 0.004 seconds
2024-04-24T05:17:23,778  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_80477fd0-0a9d-4064-9069-fe90510ee15a
2024-04-24T05:17:23,782  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T05:17:23,788  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,788  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T05:17:23,788  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,789  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,791  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T05:17:23,792  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T05:17:23,792  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:23,793  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:23,795  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T05:17:23,795  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:23,796  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:23,796  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,797  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,797  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, getDatabase_(String)=1, isCompatibleWith_(Configuration)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2}
2024-04-24T05:17:23,797  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e); Time taken: 0.008 seconds
2024-04-24T05:17:23,797  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e
2024-04-24T05:17:23,797  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e
2024-04-24T05:17:23,812  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T05:17:23,812  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:23,812  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:23,812  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713961043, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFiles=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, totalSize=0, transactional=false, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:23,819  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidnonbucket
2024-04-24T05:17:23,834  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:23,834  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-24T05:17:23,834  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e); Time taken: 0.022 seconds
2024-04-24T05:17:23,834  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_98716966-bced-41b4-876b-8d8504d80d0e
2024-04-24T05:17:23,838  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T05:17:23,844  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:23,844  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T05:17:23,844  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T05:17:23,845  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221): drop table if exists T
2024-04-24T05:17:23,847  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T05:17:23,847  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T05:17:23,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:23,867  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,867  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:23,867  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:23,867  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:23,867  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getTable_(GetTableRequest)=19}
2024-04-24T05:17:23,867  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221); Time taken: 0.022 seconds
2024-04-24T05:17:23,867  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221
2024-04-24T05:17:23,868  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221
2024-04-24T05:17:23,882  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T05:17:23,883  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:23,883  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221): drop table if exists T
2024-04-24T05:17:23,883  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:23,883  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:23,890  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:23,900  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:23,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T05:17:24,005  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t does not exist; Force to delete it.
2024-04-24T05:17:24,005 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:24,005  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:24,005  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=115, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:24,006  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221); Time taken: 0.122 seconds
2024-04-24T05:17:24,006  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051723_46a748eb-04f4-468c-822a-19bafe3f7221
2024-04-24T05:17:24,010  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T05:17:24,016  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:24,016  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T05:17:24,017  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T05:17:24,018  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9): drop table if exists Tstage
2024-04-24T05:17:24,021  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T05:17:24,021  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T05:17:24,022  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:24,029  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,029  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:24,029  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:24,029  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:24,029  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=7, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, flushCache_()=0}
2024-04-24T05:17:24,030  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9); Time taken: 0.011 seconds
2024-04-24T05:17:24,030  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9
2024-04-24T05:17:24,030  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9
2024-04-24T05:17:24,045  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9 LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T05:17:24,045  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:24,045  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9): drop table if exists Tstage
2024-04-24T05:17:24,045  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:24,045  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:24,052  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:24,059  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T05:17:24,134  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage does not exist; Force to delete it.
2024-04-24T05:17:24,134 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:24,135  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:24,135  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=82, getTable_(GetTableRequest)=7}
2024-04-24T05:17:24,135  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9); Time taken: 0.09 seconds
2024-04-24T05:17:24,135  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051724_8aa80661-44a4-4ffa-82df-387add8675b9
2024-04-24T05:17:24,141  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T05:17:24,151  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:24,153  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T05:17:24,154  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:24,155  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:24,158  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T05:17:24,159  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T05:17:24,160  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:24,160  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:24,167  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T05:17:24,167  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:24,169  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:24,169  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:24,169  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:24,169  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:24,169  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=7, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=19}
2024-04-24T05:17:24,169  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55); Time taken: 0.014 seconds
2024-04-24T05:17:24,170  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55
2024-04-24T05:17:24,170  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55
2024-04-24T05:17:24,190  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T05:17:24,190  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:24,191  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:24,191  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:24,192  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713961044, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:24,198  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:24,233  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:24,234  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=41}
2024-04-24T05:17:24,234  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55); Time taken: 0.042 seconds
2024-04-24T05:17:24,234  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051724_202dce43-4567-442a-a890-cf05b6267a55
2024-04-24T05:17:24,238  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T05:17:24,245  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:24,245  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T05:17:24,246  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:24,246  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:24,249  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T05:17:24,250  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T05:17:24,250  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:24,251  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:24,253  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T05:17:24,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:24,255  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:24,255  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:24,255  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:24,256  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:24,256  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, getDatabase_(String)=1, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:24,256  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6); Time taken: 0.01 seconds
2024-04-24T05:17:24,256  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6
2024-04-24T05:17:24,256  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6
2024-04-24T05:17:24,272  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T05:17:24,272  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:24,272  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:24,273  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:24,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713961044, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=false, numFilesErasureCoded=0, numRows=0, rawDataSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:24,280  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:24,297  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:24,297  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T05:17:24,298  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6); Time taken: 0.025 seconds
2024-04-24T05:17:24,298  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051724_aa0a627a-f42f-414c-af57-72c9a8090ae6
2024-04-24T05:17:24,302  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T05:17:24,309  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:24,309  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T05:17:24,310  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:24,310  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96): insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:24,313  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T05:17:24,314  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T05:17:24,314  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:24,314  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:24,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:24,354  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,354  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:24,354  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:24,354  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:24,354  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:24,354  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:24,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,364  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:24,364  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T05:17:24,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:24,478  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:24,478  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:24,478  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:24,479  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:24,482  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:24,482  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:24,482  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:24,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:24,493  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,495  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1
2024-04-24T05:17:24,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:24,499  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:24,501  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:24,504  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:24,505  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:24,514  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:24,525  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,525  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T05:17:24,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:24,537  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:24,538  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:24,539  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T05:17:24,539  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:24,539  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:24,539  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:24,539  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T05:17:24,539  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T05:17:24,539  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:24,539  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:24,539  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:24,540  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T05:17:24,540  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:24,540  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=29, getTable_(GetTableRequest)=78, isCompatibleWith_(Configuration)=2, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, getCheckConstraints_(CheckConstraintsRequest)=2}
2024-04-24T05:17:24,540  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96); Time taken: 0.23 seconds
2024-04-24T05:17:24,540  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96
2024-04-24T05:17:24,540  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96
2024-04-24T05:17:24,558  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T05:17:24,558  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:24,558  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96): insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:24,559  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96
2024-04-24T05:17:24,559  INFO [main] ql.Driver: Query ID = alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96
Total jobs = 1
2024-04-24T05:17:24,559  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:24,559  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:24,721  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:17:24,721  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:17:24,723  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:24,723  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T05:17:24,723  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-24_310_5027514214440256313-1/dummy_path
2024-04-24T05:17:24,734  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:24,735  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T05:17:24,735  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:24,739  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-24_310_5027514214440256313-1/-mr-10001
2024-04-24T05:17:24,744  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:24,752  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:24,756  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:24,758  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T05:17:24,758  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T05:17:24,758  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-24_310_5027514214440256313-1/dummy_path
2024-04-24T05:17:24,758  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:24,777  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:24,797  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1501571830_0010
2024-04-24T05:17:24,797  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:24,858  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:24,858  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:24,858  INFO [Thread-919] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:24,859  INFO [Thread-919] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:24,860  INFO [Thread-919] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:24,860  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1501571830_0010_m_000000_0
2024-04-24T05:17:24,863  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:24,864  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-24_310_5027514214440256313-1/dummy_path/null:0+1
2024-04-24T05:17:24,866  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:24,876  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,11KB
2024-04-24T05:17:24,876  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T05:17:24,880  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:24,880  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:24,881  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:24,881  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:24,881  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1501571830_0010/job_local1501571830_0010.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@223bc2fb
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:24,882  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:24,884  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:24,884  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:24,891  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T05:17:24,898  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-24T05:17:24,899  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:24,901  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1501571830_0010_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:24,901  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:24,901  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1501571830_0010_m_000000_0' done.
2024-04-24T05:17:24,901  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1501571830_0010_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=221734
		FILE: Number of bytes written=11889246
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6168
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:24,901  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1501571830_0010_m_000000_0
2024-04-24T05:17:24,901  INFO [Thread-919] mapred.LocalJobRunner: map task executor complete.
2024-04-24 05:17:25,859 Stage-1 map = 100%,  reduce = 0%
2024-04-24T05:17:25,859  INFO [main] exec.Task: 2024-04-24 05:17:25,859 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1501571830_0010
2024-04-24T05:17:25,860  INFO [main] exec.Task: Ended Job = job_local1501571830_0010
2024-04-24T05:17:25,861  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T05:17:25,862  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T05:17:25,862  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T05:17:25,862  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T05:17:25,862  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/-ext-10000
2024-04-24T05:17:25,862  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/-ext-10002
2024-04-24T05:17:25,863  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T05:17:25,863  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1/-ext-10000
2024-04-24T05:17:25,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:25,878  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:25,879  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:25,888  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:25,890  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:25,890  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:25,924  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T05:17:25,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:25,934  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:25,934  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T05:17:25,934  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-24_310_5027514214440256313-1/-mr-10001
2024-04-24T05:17:25,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:25,944  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:25,945  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T05:17:25,945  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T05:17:25,945  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:25,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:25,973  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T05:17:25,974  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:25,974  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=44, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=62}
MapReduce Jobs Launched: 
2024-04-24T05:17:25,974  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:25,974  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:25,974  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:25,974  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96); Time taken: 1.416 seconds
2024-04-24T05:17:25,974  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051724_6aaf98c9-199c-4baf-967a-251706433f96
2024-04-24T05:17:25,978  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T05:17:25,985  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:25,985  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T05:17:25,986  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:25,986  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-24_310_5027514214440256313-1
2024-04-24T05:17:25,987  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-24_310_5027514214440256313-1 on fs with scheme file
2024-04-24T05:17:25,987  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1
2024-04-24T05:17:25,987  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-24_310_5027514214440256313-1 on fs with scheme file
2024-04-24T05:17:25,988  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:25,988  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:25,998  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,001  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T05:17:26,001  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T05:17:26,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:26,014  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,015  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,015  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,015  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,015  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,015  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:26,015  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:26,015  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:26,015  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, getCurrentNotificationEventId_()=3, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=20, flushCache_()=0}
2024-04-24T05:17:26,016  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e); Time taken: 0.027 seconds
2024-04-24T05:17:26,016  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e
2024-04-24T05:17:26,016  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e
2024-04-24T05:17:26,031  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T05:17:26,031  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:26,031  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:26,031  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:26,031  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,031  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,031  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,031  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:26,042  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:26,047  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:26,048  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:26,048  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e); Time taken: 0.016 seconds
2024-04-24T05:17:26,048  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051725_67a9cdb9-abf6-4157-baae-387da09f556e
2024-04-24T05:17:26,052  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T05:17:26,057  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:26,059  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T05:17:26,059  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:26,060  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:26,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:26,071  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,073  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T05:17:26,073  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T05:17:26,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:26,084  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,084  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,084  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,084  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,084  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,084  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:26,085  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:26,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:26,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=20, getCurrentNotificationEventId_()=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-24T05:17:26,085  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606); Time taken: 0.025 seconds
2024-04-24T05:17:26,085  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606
2024-04-24T05:17:26,086  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606
2024-04-24T05:17:26,099  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T05:17:26,099  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:26,099  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:26,099  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:26,100  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,100  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,100  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,100  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:26,111  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:26,116  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:26,116  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:26,116  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606); Time taken: 0.017 seconds
2024-04-24T05:17:26,116  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051726_547011ae-d336-449c-b9b0-d3a190a33606
2024-04-24T05:17:26,120  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T05:17:26,125  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:26,125  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T05:17:26,126  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:26,126  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:26,129  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T05:17:26,129  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T05:17:26,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:26,137  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,146  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T05:17:26,147  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T05:17:26,148  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:26,148  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:26,148  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:26,149  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getTable_(GetTableRequest)=8, getValidTxns_(long)=0, allocateTableWriteId_(long, String, String)=8, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:26,149  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d); Time taken: 0.022 seconds
2024-04-24T05:17:26,149  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d
2024-04-24T05:17:26,149  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d
2024-04-24T05:17:26,163  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T05:17:26,163  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:26,168  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:26,168  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:26,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:26,175  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:26,188  INFO [HMSHandler #9] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:26,189  INFO [HMSHandler #11] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2
2024-04-24T05:17:26,189  INFO [HMSHandler #10] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1
2024-04-24T05:17:26,220  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T05:17:26,220  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data
2024-04-24T05:17:26,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:26,227  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:26,245  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T05:17:26,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:26,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:26,255  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:26,264  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T05:17:26,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:26,268  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T05:17:26,299  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:26,321  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:26,332  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T05:17:26,332  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data
2024-04-24T05:17:26,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:26,339  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,339  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:26,350  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T05:17:26,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:26,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:26,357  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:26,371  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T05:17:26,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:26,375  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T05:17:26,412  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:26,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:26,435  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:26,435  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=68, validatePartitionNameCharacters_(List)=1, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=103, getTable_(GetTableRequest)=37, isCompatibleWith_(Configuration)=0, add_partitions_(List, boolean, boolean)=45, getValidWriteIds_(List, String)=0}
2024-04-24T05:17:26,436  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d); Time taken: 0.267 seconds
2024-04-24T05:17:26,436  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051726_73c5da7c-da9d-4e44-bffb-5d0e57d0a37d
2024-04-24T05:17:26,440  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T05:17:26,446  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:26,446  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T05:17:26,447  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:26,447  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:26,455  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T05:17:26,455  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T05:17:26,457  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:26,457  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:26,462  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:26,462  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:26,463  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:26,469  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,469  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:26,469  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:26,470  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:26,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:26,515  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:26,516  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:26,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:26,563  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:26,563  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:26,578  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:26,578  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:26,625  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:26,625  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:26,625  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:26,626  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-26_447_6455561515478123413-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-26_447_6455561515478123413-1
2024-04-24T05:17:26,634  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:26,636  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T05:17:26,637  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3]}
2024-04-24T05:17:26,637  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:26,638  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:26,647  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:26,648  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:26,648  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:26,649  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:26,649  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:26,649  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:26,649  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:26,650  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T05:17:26,651  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T05:17:26,651  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:26,651  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=6, getAllTableConstraints_(AllTableConstraintsRequest)=28, listPartitions_(String, String, short)=26, getValidTxns_(long)=2, openTxn_(String, TxnType)=7, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, getAggrColStatsFor_(String, String, List, List, String, String)=23}
2024-04-24T05:17:26,651  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11); Time taken: 0.204 seconds
2024-04-24T05:17:26,652  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11
2024-04-24T05:17:26,653  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11
2024-04-24T05:17:26,674  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T05:17:26,674  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:26,674  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:26,675  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11
2024-04-24T05:17:26,675  INFO [main] ql.Driver: Query ID = alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11
Total jobs = 1
2024-04-24T05:17:26,675  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:26,675  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:26,831  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:26,831  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:26,831  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:26,831  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:26,831  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:26,831  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:26,831  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:26,831  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:26,834  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:26,834  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:26,834  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:26,841  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-26_447_6455561515478123413-1/-mr-10004/3fd104a0-8153-49b1-af25-4d036071a0af (false)
2024-04-24T05:17:26,850  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:26,852  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,06KB
2024-04-24T05:17:26,856  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:26,863  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:26,864  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:26,870  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:26,877  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:26,881  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:26,883  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:26,883  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:26,883  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:26,883  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:26,883  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T05:17:26,883  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:26,896  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T05:17:26,896  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 13 ms
2024-04-24T05:17:26,896  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T05:17:26,914  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T05:17:26,940  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1536996298_0011
2024-04-24T05:17:26,940  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:26,998  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:26,998  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:26,998  INFO [Thread-996] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:26,998  INFO [Thread-996] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:27,001  INFO [Thread-996] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:27,001  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1536996298_0011_m_000000_0
2024-04-24T05:17:27,001  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:27,002  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:27,002  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:27,004  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-24T05:17:27,004  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:27,007  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:27,008  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:27,012  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:27,012  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:27,012  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:27,012  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:27,012  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:27,013  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:27,013  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:27,013  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:27,014  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:27,014  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:27,015  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:27,015  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, 
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:27,016  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:27,017  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:27,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:27,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:27,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T05:17:27,017  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:27,027  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:27,030  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1536996298_0011_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:27,031  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:27,031  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1536996298_0011_m_000000_0' done.
2024-04-24T05:17:27,031  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1536996298_0011_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=233898
		FILE: Number of bytes written=13084066
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8203
2024-04-24T05:17:27,031  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1536996298_0011_m_000000_0
2024-04-24T05:17:27,031  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1536996298_0011_m_000001_0
2024-04-24T05:17:27,031  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:27,032  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:27,032  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:27,034  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-24T05:17:27,035  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:27,036  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:27,036  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:27,040  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:27,040  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:27,040  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:27,040  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:27,040  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:27,041  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:27,041  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:27,041  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:27,042  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:27,042  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:27,042  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:27,042  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:27,043  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T05:17:27,044  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:27,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:27,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:27,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T05:17:27,044  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:27,052  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:27,055  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1536996298_0011_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:27,055  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:27,055  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1536996298_0011_m_000001_0' done.
2024-04-24T05:17:27,055  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1536996298_0011_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=242642
		FILE: Number of bytes written=13084190
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8203
2024-04-24T05:17:27,055  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1536996298_0011_m_000001_0
2024-04-24T05:17:27,055  INFO [Thread-996] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:27,056  INFO [Thread-996] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:27,056  INFO [pool-58-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1536996298_0011_r_000000_0
2024-04-24T05:17:27,057  INFO [pool-58-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:27,057  INFO [pool-58-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@78dcb1af
2024-04-24T05:17:27,057  WARN [pool-58-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:27,058  INFO [pool-58-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:27,059  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1536996298_0011_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:27,064  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local1536996298_0011_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-24T05:17:27,064  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1536996298_0011_m_000000_0
2024-04-24T05:17:27,064  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-24T05:17:27,067  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local1536996298_0011_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-24T05:17:27,067  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local1536996298_0011_m_000001_0
2024-04-24T05:17:27,067  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-24T05:17:27,067  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:27,067  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:27,067  INFO [pool-58-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:27,074  INFO [pool-58-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T05:17:27,074  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 104 bytes
2024-04-24T05:17:27,076  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 176 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:27,077  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 1 files, 178 bytes from disk
2024-04-24T05:17:27,077  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:27,077  INFO [pool-58-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:27,077  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 138 bytes
2024-04-24T05:17:27,077  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:27,077  INFO [pool-58-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:27,078  INFO [pool-58-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:27,079  INFO [pool-58-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:27,079  INFO [pool-58-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:27,079  INFO [pool-58-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-24T05:17:27,079  INFO [pool-58-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:27,079  INFO [pool-58-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@53471e00, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1ee622b2, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@d4e1e05
2024-04-24T05:17:27,080  INFO [pool-58-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-26_447_6455561515478123413-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-26_447_6455561515478123413-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:27,080  INFO [pool-58-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-26_447_6455561515478123413-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-26_447_6455561515478123413-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:27,080  INFO [pool-58-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-26_447_6455561515478123413-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-26_447_6455561515478123413-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:27,087  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:27,087  INFO [pool-58-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:27,087  INFO [pool-58-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-24T05:17:27,087  INFO [pool-58-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:27,087  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T05:17:27,087  INFO [pool-58-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:27,088  INFO [pool-58-thread-1] mapred.Task: Task:attempt_local1536996298_0011_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:27,088  INFO [pool-58-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:27,088  INFO [pool-58-thread-1] mapred.Task: Task 'attempt_local1536996298_0011_r_000000_0' done.
2024-04-24T05:17:27,088  INFO [pool-58-thread-1] mapred.Task: Final Counters for attempt_local1536996298_0011_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=250550
		FILE: Number of bytes written=13084595
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=184
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172307968
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:27,088  INFO [pool-58-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1536996298_0011_r_000000_0
2024-04-24T05:17:27,088  INFO [Thread-996] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:28,001 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:28,001  INFO [main] exec.Task: 2024-04-24 05:17:28,001 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1536996298_0011
2024-04-24T05:17:28,004  INFO [main] exec.Task: Ended Job = job_local1536996298_0011
2024-04-24T05:17:28,006  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:28,006  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:28,007  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:28,007  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:28,007  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:28,007  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11); Time taken: 1.332 seconds
2024-04-24T05:17:28,007  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051726_f2caa0de-1422-41b9-843d-6ccbf8fddf11
2024-04-24T05:17:28,011  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T05:17:28,018  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:28,018  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T05:17:28,022  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:28,023  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T05:17:28,023  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:28,023  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-24T05:17:28,023  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4

2024-04-24T05:17:28,023  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:28,024  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-26_447_6455561515478123413-1
2024-04-24T05:17:28,025  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-26_447_6455561515478123413-1 on fs with scheme file
2024-04-24T05:17:28,025  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051728_d1a3d7c4-d6b4-4b2f-8dec-d7b3ac041428): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:28,029  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T05:17:28,029  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T05:17:28,030  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:28,032  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:28,032  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:28,033  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,040  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,040  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:28,040  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:28,041  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:28,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:28,067  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:28,068  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:28,089  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,098  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,098  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:28,108  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:28,108  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:28,154  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:28,154  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:28,155  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:28,157  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:28,160  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2]}
2024-04-24T05:17:28,160  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T05:17:28,161  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:28,175  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:28,184  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:28,185  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:28,185  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:28,186  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:28,186  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:28,186  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:28,186  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:28,186  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:28,187  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getAllTableConstraints_(AllTableConstraintsRequest)=6, getTable_(GetTableRequest)=7, getAggrColStatsFor_(String, String, List, List, String, String)=20, openTxn_(String, TxnType)=2, listPartitions_(String, String, short)=9, getValidWriteIds_(List, String)=4, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=0}
2024-04-24T05:17:28,187  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051728_d1a3d7c4-d6b4-4b2f-8dec-d7b3ac041428); Time taken: 0.161 seconds
2024-04-24T05:17:28,187  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051728_d1a3d7c4-d6b4-4b2f-8dec-d7b3ac041428): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:28,187  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:28,200  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:28,200  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:28,200  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051728_d1a3d7c4-d6b4-4b2f-8dec-d7b3ac041428); Time taken: 0.013 seconds
2024-04-24T05:17:28,201  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:28,208  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T05:17:28,215  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:28,215  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T05:17:28,216  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:28,216  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_025_2256016408815012855-1
2024-04-24T05:17:28,216  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_025_2256016408815012855-1 on fs with scheme file
2024-04-24T05:17:28,216  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:28,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:28,225  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,227  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T05:17:28,228  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T05:17:28,230  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:28,239  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,239  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,239  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,239  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,239  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,240  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:28,240  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:28,240  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:28,240  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getCurrentNotificationEventId_()=2, getTable_(GetTableRequest)=17, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T05:17:28,241  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0); Time taken: 0.024 seconds
2024-04-24T05:17:28,241  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0
2024-04-24T05:17:28,241  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0
2024-04-24T05:17:28,255  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T05:17:28,255  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:28,255  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:28,256  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:28,256  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,256  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,256  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,256  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:28,266  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:28,270  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:28,270  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:28,271  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0); Time taken: 0.015 seconds
2024-04-24T05:17:28,271  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051728_057b7486-ac16-4d7c-bfac-3abb6f28b7b0
2024-04-24T05:17:28,274  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T05:17:28,280  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:28,280  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T05:17:28,280  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:28,282  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T05:17:28,283  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T05:17:28,283  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:28,290  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,299  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T05:17:28,299  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T05:17:28,300  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:28,300  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:28,300  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:28,300  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=7, allocateTableWriteId_(long, String, String)=7}
2024-04-24T05:17:28,300  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e); Time taken: 0.02 seconds
2024-04-24T05:17:28,301  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e
2024-04-24T05:17:28,301  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e
2024-04-24T05:17:28,314  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T05:17:28,314  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:28,318  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:28,318  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:28,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,325  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,325  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:28,342 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T05:17:28,342 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T05:17:28,343 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T05:17:28,344 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:28,345 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:28,345  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:28,345  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:28,345  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e); Time taken: 0.027 seconds
2024-04-24T05:17:28,345  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051728_a7d339fb-ec2e-442a-90a1-ae661164636e
2024-04-24T05:17:28,347  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:28,354  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:28,354  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:28,357  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T05:17:28,357  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T05:17:28,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:28,365  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:28,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T05:17:28,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:28,401  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T05:17:28,402  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T05:17:28,402  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:28,402  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:28,402  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:28,403  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=21, rollbackTxn_(long)=9, flushCache_()=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, allocateTableWriteId_(long, String, String)=6, getValidTxns_(long)=1}
2024-04-24T05:17:28,403  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795); Time taken: 0.048 seconds
2024-04-24T05:17:28,403  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795
2024-04-24T05:17:28,403  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795
2024-04-24T05:17:28,418  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T05:17:28,418  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:28,426  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:28,426  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:28,426  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,433  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:28,441  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:28,443  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:28,445  INFO [HMSHandler #12] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3
2024-04-24T05:17:28,464  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T05:17:28,464  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data
2024-04-24T05:17:28,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,471  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,471  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:28,482  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T05:17:28,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:28,482  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,489  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:28,499  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T05:17:28,503  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:28,503  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T05:17:28,538  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:28,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:28,569  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:28,569  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {add_partitions_(List, boolean, boolean)=31, getValidWriteIds_(List, String)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=29, validatePartitionNameCharacters_(List)=0, getTable_(GetTableRequest)=21, isCompatibleWith_(Configuration)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=57}
2024-04-24T05:17:28,570  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795); Time taken: 0.143 seconds
2024-04-24T05:17:28,570  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051728_263aab0d-291f-4d07-8776-0cab449fb795
2024-04-24T05:17:28,573  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T05:17:28,578  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:28,580  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T05:17:28,580  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:28,581  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:28,583  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-24T05:17:28,583  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T05:17:28,584  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:28,584  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:28,589  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:28,589  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:28,590  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,597  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,597  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:28,597  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:28,597  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:28,610  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:28,641  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:28,642  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:28,687  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:28,696  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:28,696  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:28,710  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:28,710  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:28,754  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:28,754  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:28,754  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:28,755  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_580_6751375952868266118-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-28_580_6751375952868266118-1
2024-04-24T05:17:28,762  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:28,765  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T05:17:28,765  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0]}
2024-04-24T05:17:28,766  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:28,766  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:28,775  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:28,775  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:28,775  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:28,777  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:28,777  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:28,777  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:28,777  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:28,777  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-24T05:17:28,778  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-24T05:17:28,778  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:28,779  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, listPartitions_(String, String, short)=27, getAggrColStatsFor_(String, String, List, List, String, String)=22, getTable_(GetTableRequest)=7, getAllTableConstraints_(AllTableConstraintsRequest)=26, getValidWriteIds_(List, String)=7, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:28,779  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d); Time taken: 0.197 seconds
2024-04-24T05:17:28,779  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d
2024-04-24T05:17:28,780  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d
2024-04-24T05:17:28,796  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T05:17:28,796  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:28,796  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:28,797  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d
2024-04-24T05:17:28,797  INFO [main] ql.Driver: Query ID = alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d
Total jobs = 1
2024-04-24T05:17:28,797  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:28,797  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:28,944  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:28,944  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:28,944  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:28,944  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:28,944  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:28,944  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:28,945  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:28,945  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:28,947  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:28,947  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:28,947  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:28,954  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_580_6751375952868266118-1/-mr-10004/4b954176-1c6a-4704-a6b7-0d8aadf67e61 (false)
2024-04-24T05:17:28,963  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:28,965  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:28,970  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:28,971  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:28,972  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:28,978  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:28,985  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:28,989  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:28,990  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:28,990  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:28,990  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:28,991  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:28,991  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-24T05:17:28,991  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:29,004  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T05:17:29,004  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 13 ms
2024-04-24T05:17:29,004  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T05:17:29,020  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T05:17:29,039  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local204155416_0012
2024-04-24T05:17:29,039  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:29,115  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:29,115  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:29,115  INFO [Thread-1091] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:29,116  INFO [Thread-1091] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:29,117  INFO [Thread-1091] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:29,118  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local204155416_0012_m_000000_0
2024-04-24T05:17:29,118  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:29,119  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,119  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:29,120  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:29,121  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,122  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:29,122  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:29,134  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:29,135  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:29,135  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:29,135  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:29,135  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:29,135  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:29,136  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:29,136  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:29,137  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:29,137  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:29,137  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:29,137  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:29,138  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:29,139  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:29,139  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:29,139  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:29,139  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:29,139  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T05:17:29,139  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:29,149  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:29,152  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local204155416_0012_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:29,153  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,153  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local204155416_0012_m_000000_0' done.
2024-04-24T05:17:29,153  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local204155416_0012_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=267575
		FILE: Number of bytes written=14277815
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=7
		Total committed heap usage (bytes)=1172832256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-24T05:17:29,153  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local204155416_0012_m_000000_0
2024-04-24T05:17:29,153  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local204155416_0012_m_000001_0
2024-04-24T05:17:29,153  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:29,154  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,154  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:29,155  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:29,156  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,157  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:29,157  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:29,162  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:29,162  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:29,162  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:29,162  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:29,162  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:29,162  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:29,163  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:29,163  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:29,163  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:29,163  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:29,164  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T05:17:29,165  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:29,173  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:29,176  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local204155416_0012_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:29,176  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,176  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local204155416_0012_m_000001_0' done.
2024-04-24T05:17:29,176  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local204155416_0012_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=277189
		FILE: Number of bytes written=14277939
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-24T05:17:29,176  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local204155416_0012_m_000001_0
2024-04-24T05:17:29,176  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local204155416_0012_m_000002_0
2024-04-24T05:17:29,177  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:29,178  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,178  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:29,179  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:29,179  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,180  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:29,181  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:29,185  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:29,185  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:29,185  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:29,185  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:29,185  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:29,186  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:29,186  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:29,186  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:29,187  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:29,187  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:29,187  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-24T05:17:29,187  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, 
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-24T05:17:29,188  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-24T05:17:29,189  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:29,189  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:29,189  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:29,189  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-24T05:17:29,189  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:29,197  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:29,200  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local204155416_0012_m_000002_0 is done. And is in the process of committing
2024-04-24T05:17:29,201  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:29,201  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local204155416_0012_m_000002_0' done.
2024-04-24T05:17:29,201  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local204155416_0012_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=286291
		FILE: Number of bytes written=14278063
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-24T05:17:29,201  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local204155416_0012_m_000002_0
2024-04-24T05:17:29,201  INFO [Thread-1091] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:29,202  INFO [Thread-1091] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:29,202  INFO [pool-62-thread-1] mapred.LocalJobRunner: Starting task: attempt_local204155416_0012_r_000000_0
2024-04-24T05:17:29,202  INFO [pool-62-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:29,202  INFO [pool-62-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@626324b9
2024-04-24T05:17:29,202  WARN [pool-62-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:29,203  INFO [pool-62-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:29,204  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local204155416_0012_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:29,205  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local204155416_0012_m_000002_0 decomp: 88 len: 92 to MEMORY
2024-04-24T05:17:29,205  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local204155416_0012_m_000002_0
2024-04-24T05:17:29,205  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-24T05:17:29,207  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local204155416_0012_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-24T05:17:29,207  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local204155416_0012_m_000001_0
2024-04-24T05:17:29,207  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-24T05:17:29,210  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local204155416_0012_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-24T05:17:29,210  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local204155416_0012_m_000000_0
2024-04-24T05:17:29,210  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 3, commitMemory -> 176, usedMemory ->264
2024-04-24T05:17:29,210  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:29,210  INFO [pool-62-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:29,210  INFO [pool-62-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:29,216  INFO [pool-62-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T05:17:29,216  INFO [pool-62-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 156 bytes
2024-04-24T05:17:29,218  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 264 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:29,219  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merging 1 files, 264 bytes from disk
2024-04-24T05:17:29,219  INFO [pool-62-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:29,219  INFO [pool-62-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:29,219  INFO [pool-62-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 224 bytes
2024-04-24T05:17:29,219  INFO [pool-62-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:29,219  INFO [pool-62-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:29,220  INFO [pool-62-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-24T05:17:29,221  INFO [pool-62-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:29,221  INFO [pool-62-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:29,221  INFO [pool-62-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-24T05:17:29,221  INFO [pool-62-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:29,221  INFO [pool-62-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@35ad1e01, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@49f88afe, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@1ced142a
2024-04-24T05:17:29,222  INFO [pool-62-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_580_6751375952868266118-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-28_580_6751375952868266118-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:29,222  INFO [pool-62-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_580_6751375952868266118-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-28_580_6751375952868266118-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:29,222  INFO [pool-62-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_580_6751375952868266118-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-28_580_6751375952868266118-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:29,228  INFO [pool-62-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:29,229  INFO [pool-62-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:29,229  INFO [pool-62-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:6, 
2024-04-24T05:17:29,229  INFO [pool-62-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:29,229  INFO [pool-62-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T05:17:29,229  INFO [pool-62-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, 
2024-04-24T05:17:29,230  INFO [pool-62-thread-1] mapred.Task: Task:attempt_local204155416_0012_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:29,230  INFO [pool-62-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:29,230  INFO [pool-62-thread-1] mapred.Task: Task 'attempt_local204155416_0012_r_000000_0' done.
2024-04-24T05:17:29,230  INFO [pool-62-thread-1] mapred.Task: Final Counters for attempt_local204155416_0012_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=294410
		FILE: Number of bytes written=14278618
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=276
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1172832256
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:29,230  INFO [pool-62-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local204155416_0012_r_000000_0
2024-04-24T05:17:29,230  INFO [Thread-1091] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:30,119 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:30,119  INFO [main] exec.Task: 2024-04-24 05:17:30,119 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local204155416_0012
2024-04-24T05:17:30,121  INFO [main] exec.Task: Ended Job = job_local204155416_0012
2024-04-24T05:17:30,123  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,123  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:30,123  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:30,123  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:30,123  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:30,123  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d); Time taken: 1.327 seconds
2024-04-24T05:17:30,123  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051728_1d6587ee-a20b-42ff-9312-216ba96a574d
2024-04-24T05:17:30,127  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T05:17:30,133  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,133  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T05:17:30,137  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:30,138  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-24T05:17:30,138  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:6, 
2024-04-24T05:17:30,138  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-24T05:17:30,138  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4

2024-04-24T05:17:30,138  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:30,139  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_580_6751375952868266118-1
2024-04-24T05:17:30,140  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-28_580_6751375952868266118-1 on fs with scheme file
2024-04-24T05:17:30,140  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051730_5854cf10-ebcd-4b83-9dfa-77929f7449d0): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:30,143  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T05:17:30,143  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T05:17:30,145  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:30,148  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:30,148  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:30,148  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:30,155  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,155  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:30,155  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:30,156  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:30,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:30,179  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:30,179  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:30,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:30,216  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:30,226  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:30,226  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:30,277  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:30,277  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:30,277  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:30,279  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:30,281  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T05:17:30,282  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T05:17:30,282  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:30,304  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:30,314  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:30,314  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:30,314  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:30,316  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:30,316  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:30,316  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:30,316  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:30,316  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:30,317  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=2, getAggrColStatsFor_(String, String, List, List, String, String)=18, isCompatibleWith_(Configuration)=2, openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=5, getTable_(GetTableRequest)=7, listPartitions_(String, String, short)=10, getValidWriteIds_(List, String)=3, flushCache_()=0}
2024-04-24T05:17:30,317  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051730_5854cf10-ebcd-4b83-9dfa-77929f7449d0); Time taken: 0.176 seconds
2024-04-24T05:17:30,317  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051730_5854cf10-ebcd-4b83-9dfa-77929f7449d0): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-24T05:17:30,317  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:30,328  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,328  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:30,329  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051730_5854cf10-ebcd-4b83-9dfa-77929f7449d0); Time taken: 0.011 seconds
2024-04-24T05:17:30,329  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:30,334  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T05:17:30,341  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,341  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T05:17:30,342  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:30,343  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-30_140_7747090346738298502-1
2024-04-24T05:17:30,343  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/6d66f66c-aee8-4da9-b8c8-ff6dc648880c/hive_2024-04-24_05-17-30_140_7747090346738298502-1 on fs with scheme file
2024-04-24T05:17:30,343  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4): drop table if exists acidTbl
2024-04-24T05:17:30,346  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T05:17:30,346  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T05:17:30,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:30,354  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,355  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:30,355  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:30,355  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:30,355  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:30,355  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4); Time taken: 0.012 seconds
2024-04-24T05:17:30,355  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4
2024-04-24T05:17:30,356  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4
2024-04-24T05:17:30,372  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T05:17:30,372  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:30,372  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4): drop table if exists acidTbl
2024-04-24T05:17:30,372  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:30,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:30,379  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,380  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:30,387  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,387  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:30,496  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,496  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=117, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:30,497  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4); Time taken: 0.124 seconds
2024-04-24T05:17:30,497  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051730_df44d15c-2b7b-49cc-991c-ce1d0709cbd4
2024-04-24T05:17:30,501  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T05:17:30,507  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,508  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T05:17:30,508  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:30,509  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c): drop table if exists acidTblPart
2024-04-24T05:17:30,516  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T05:17:30,516  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T05:17:30,517  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:30,534  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,534  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:30,535  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:30,535  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:30,535  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=17, openTxn_(String, TxnType)=7}
2024-04-24T05:17:30,535  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c); Time taken: 0.026 seconds
2024-04-24T05:17:30,535  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c
2024-04-24T05:17:30,536  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c
2024-04-24T05:17:30,554  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T05:17:30,554  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:30,554  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c): drop table if exists acidTblPart
2024-04-24T05:17:30,554  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:30,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:30,562  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,562  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:30,570  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,570  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:30,611  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,611  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=49, getTable_(GetTableRequest)=8}
2024-04-24T05:17:30,611  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c); Time taken: 0.057 seconds
2024-04-24T05:17:30,612  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051730_397d1161-5119-4ca3-93d7-b46f8e06e67c
2024-04-24T05:17:30,615  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T05:17:30,621  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,621  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T05:17:30,622  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:30,622  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051730_d49a6097-b6a4-4904-b087-0e3f4f35a729): drop table if exists acidTbl2
2024-04-24T05:17:30,624  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T05:17:30,624  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T05:17:30,625  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:30,625  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:30,625  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:30,626  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, flushCache_()=0}
2024-04-24T05:17:30,626  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051730_d49a6097-b6a4-4904-b087-0e3f4f35a729); Time taken: 0.003 seconds
2024-04-24T05:17:30,626  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424051730_d49a6097-b6a4-4904-b087-0e3f4f35a729
2024-04-24T05:17:30,626  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:30,626  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051730_d49a6097-b6a4-4904-b087-0e3f4f35a729): drop table if exists acidTbl2
2024-04-24T05:17:30,626  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:30,627  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T05:17:30,627  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,627  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=1, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-24T05:17:30,628  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051730_d49a6097-b6a4-4904-b087-0e3f4f35a729); Time taken: 0.001 seconds
2024-04-24T05:17:30,628  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051730_d49a6097-b6a4-4904-b087-0e3f4f35a729
2024-04-24T05:17:30,633  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T05:17:30,638  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,639  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T05:17:30,639  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:30,639  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:30,642  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T05:17:30,643  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T05:17:30,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:30,664  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,664  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:30,664  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:30,664  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:30,664  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=21, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0}
2024-04-24T05:17:30,664  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1); Time taken: 0.025 seconds
2024-04-24T05:17:30,665  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1
2024-04-24T05:17:30,665  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1
2024-04-24T05:17:30,679  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1 LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T05:17:30,679  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:30,679  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:30,679  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:30,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:30,688  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:30,697  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:30,743  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,743  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=54, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-24T05:17:30,743  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1); Time taken: 0.064 seconds
2024-04-24T05:17:30,743  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051730_ebc6ba82-10b3-49f3-b4bc-e6aa38ac8bd1
2024-04-24T05:17:30,747  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T05:17:30,753  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,753  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T05:17:30,754  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:30,754  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:30,756  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-24T05:17:30,757  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T05:17:30,757  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:30,766  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,766  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:30,766  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:30,767  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:30,767  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0}
2024-04-24T05:17:30,767  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e); Time taken: 0.012 seconds
2024-04-24T05:17:30,767  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e
2024-04-24T05:17:30,768  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e
2024-04-24T05:17:30,782  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e LockResponse(lockid:23, state:ACQUIRED)
2024-04-24T05:17:30,782  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:30,782  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:30,782  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:30,782  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:30,792  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,792  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:30,801  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,801  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:30,833  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,834  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=41, getTable_(GetTableRequest)=10}
2024-04-24T05:17:30,834  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e); Time taken: 0.051 seconds
2024-04-24T05:17:30,834  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051730_5462af76-d7a9-47c5-b262-1a6e9125542e
2024-04-24T05:17:30,838  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T05:17:30,845  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,845  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T05:17:30,846  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:30,846  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e): drop table if exists nonAcidNonBucket
2024-04-24T05:17:30,848  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-24T05:17:30,849  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T05:17:30,849  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:30,859  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,859  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:30,859  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:30,859  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:30,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10}
2024-04-24T05:17:30,860  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e); Time taken: 0.013 seconds
2024-04-24T05:17:30,860  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e
2024-04-24T05:17:30,860  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e
2024-04-24T05:17:30,875  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e LockResponse(lockid:24, state:ACQUIRED)
2024-04-24T05:17:30,875  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:30,875  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e): drop table if exists nonAcidNonBucket
2024-04-24T05:17:30,875  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:30,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:30,884  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:30,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:30,894  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:30,928  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:30,928  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=43}
2024-04-24T05:17:30,928  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e); Time taken: 0.053 seconds
2024-04-24T05:17:30,929  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051730_72d7f56d-2dc4-4513-9f9d-6f049c69185e
2024-04-24T05:17:30,933  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T05:17:30,938  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:30,938  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T05:17:30,939  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T05:17:31,001  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T05:17:31,006  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T05:17:31,006  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T05:17:31,006  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T05:17:31,007  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T05:17:31,007  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T05:17:31,007  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T05:17:31,007  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T05:17:31,007  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T05:17:31,007  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T05:17:31,007  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T05:17:31,009  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = c6b4db2a-2af0-42a7-a6a8-74e4a55542b3
2024-04-24T05:17:31,011  INFO [main] SessionState: Hive Session ID = c6b4db2a-2af0-42a7-a6a8-74e4a55542b3
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:31,011  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:31,017  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3
2024-04-24T05:17:31,019  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3
2024-04-24T05:17:31,021  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/_tmp_space.db
2024-04-24T05:17:31,021  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=c6b4db2a-2af0-42a7-a6a8-74e4a55542b3, clientType=HIVECLI]
2024-04-24T05:17:31,022  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:31,022  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_fa9062fb-05b1-4b7d-b24f-1c8697a6e483): drop table if exists acidTbl
2024-04-24T05:17:31,030  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T05:17:31,030  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T05:17:31,032  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:31,035  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,035  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,035  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,035  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=2, flushCache_()=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=7}
2024-04-24T05:17:31,036  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_fa9062fb-05b1-4b7d-b24f-1c8697a6e483); Time taken: 0.013 seconds
2024-04-24T05:17:31,036  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424051731_fa9062fb-05b1-4b7d-b24f-1c8697a6e483
2024-04-24T05:17:31,036  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:31,036  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_fa9062fb-05b1-4b7d-b24f-1c8697a6e483): drop table if exists acidTbl
2024-04-24T05:17:31,036  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,036  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:31,039  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,040  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,040  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_fa9062fb-05b1-4b7d-b24f-1c8697a6e483); Time taken: 0.003 seconds
2024-04-24T05:17:31,040  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_fa9062fb-05b1-4b7d-b24f-1c8697a6e483
2024-04-24T05:17:31,045  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T05:17:31,051  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,051  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T05:17:31,051  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:31,052  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_4b7af613-db8a-4861-a5aa-5b119c0fca50): drop table if exists acidTblPart
2024-04-24T05:17:31,054  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T05:17:31,054  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T05:17:31,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:31,057  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,057  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,058  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,058  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-24T05:17:31,058  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_4b7af613-db8a-4861-a5aa-5b119c0fca50); Time taken: 0.005 seconds
2024-04-24T05:17:31,058  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424051731_4b7af613-db8a-4861-a5aa-5b119c0fca50
2024-04-24T05:17:31,058  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:31,058  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_4b7af613-db8a-4861-a5aa-5b119c0fca50): drop table if exists acidTblPart
2024-04-24T05:17:31,058  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,059  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:31,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,062  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_4b7af613-db8a-4861-a5aa-5b119c0fca50); Time taken: 0.003 seconds
2024-04-24T05:17:31,062  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_4b7af613-db8a-4861-a5aa-5b119c0fca50
2024-04-24T05:17:31,067  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T05:17:31,073  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,073  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T05:17:31,074  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:31,074  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_54db8b85-8d04-48a1-95a6-4e64bacf5e72): drop table if exists acidTbl2
2024-04-24T05:17:31,076  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T05:17:31,076  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T05:17:31,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:31,080  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,080  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2}
2024-04-24T05:17:31,080  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_54db8b85-8d04-48a1-95a6-4e64bacf5e72); Time taken: 0.006 seconds
2024-04-24T05:17:31,081  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424051731_54db8b85-8d04-48a1-95a6-4e64bacf5e72
2024-04-24T05:17:31,081  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:31,081  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_54db8b85-8d04-48a1-95a6-4e64bacf5e72): drop table if exists acidTbl2
2024-04-24T05:17:31,081  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:31,084  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,084  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,085  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_54db8b85-8d04-48a1-95a6-4e64bacf5e72); Time taken: 0.003 seconds
2024-04-24T05:17:31,085  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_54db8b85-8d04-48a1-95a6-4e64bacf5e72
2024-04-24T05:17:31,090  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T05:17:31,095  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,095  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T05:17:31,096  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:31,096  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_6d830004-a16b-4bc0-8522-f7e6fe0dfed8): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:31,098  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T05:17:31,098  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T05:17:31,099  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:31,102  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,102  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,102  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=1}
2024-04-24T05:17:31,102  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_6d830004-a16b-4bc0-8522-f7e6fe0dfed8); Time taken: 0.006 seconds
2024-04-24T05:17:31,102  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424051731_6d830004-a16b-4bc0-8522-f7e6fe0dfed8
2024-04-24T05:17:31,102  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:31,102  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_6d830004-a16b-4bc0-8522-f7e6fe0dfed8): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:31,103  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:31,106  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,106  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,106  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_6d830004-a16b-4bc0-8522-f7e6fe0dfed8); Time taken: 0.004 seconds
2024-04-24T05:17:31,106  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_6d830004-a16b-4bc0-8522-f7e6fe0dfed8
2024-04-24T05:17:31,112  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T05:17:31,117  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,117  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T05:17:31,118  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:31,118  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_d159b216-7993-4bcb-9275-8c3772475c14): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:31,120  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T05:17:31,121  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T05:17:31,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:31,124  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,124  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,124  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,124  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0}
2024-04-24T05:17:31,125  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_d159b216-7993-4bcb-9275-8c3772475c14); Time taken: 0.006 seconds
2024-04-24T05:17:31,125  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424051731_d159b216-7993-4bcb-9275-8c3772475c14
2024-04-24T05:17:31,125  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:31,125  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_d159b216-7993-4bcb-9275-8c3772475c14): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:31,125  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:31,128  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,128  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,129  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_d159b216-7993-4bcb-9275-8c3772475c14); Time taken: 0.003 seconds
2024-04-24T05:17:31,129  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_d159b216-7993-4bcb-9275-8c3772475c14
2024-04-24T05:17:31,134  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T05:17:31,139  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,139  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T05:17:31,139  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:31,140  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_c1282ceb-e753-48d5-962d-0d097d64fefb): drop table if exists nonAcidNonBucket
2024-04-24T05:17:31,142  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T05:17:31,142  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T05:17:31,143  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:31,146  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,146  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,146  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,146  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-24T05:17:31,146  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_c1282ceb-e753-48d5-962d-0d097d64fefb); Time taken: 0.006 seconds
2024-04-24T05:17:31,146  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424051731_c1282ceb-e753-48d5-962d-0d097d64fefb
2024-04-24T05:17:31,146  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:31,146  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_c1282ceb-e753-48d5-962d-0d097d64fefb): drop table if exists nonAcidNonBucket
2024-04-24T05:17:31,146  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,147  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:31,150  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,150  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,150  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_c1282ceb-e753-48d5-962d-0d097d64fefb); Time taken: 0.003 seconds
2024-04-24T05:17:31,150  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_c1282ceb-e753-48d5-962d-0d097d64fefb
2024-04-24T05:17:31,155  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T05:17:31,161  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,161  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T05:17:31,162  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,162  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,165  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T05:17:31,165  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T05:17:31,166  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,166  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,172  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T05:17:31,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,174  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,174  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,174  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,174  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,174  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, getValidWriteIds_(List, String)=6}
2024-04-24T05:17:31,174  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3); Time taken: 0.012 seconds
2024-04-24T05:17:31,174  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3
2024-04-24T05:17:31,175  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3
2024-04-24T05:17:31,192  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T05:17:31,192  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,193  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,193  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713961051, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, rawDataSize=0, bucketing_version=2, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:31,200  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtbl
2024-04-24T05:17:31,238  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,238  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,238  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3); Time taken: 0.045 seconds
2024-04-24T05:17:31,238  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_b6338bf1-cadd-45b7-afe0-acb07dd4b0e3
2024-04-24T05:17:31,242  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T05:17:31,247  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,247  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T05:17:31,248  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,248  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,250  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T05:17:31,251  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T05:17:31,251  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,251  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,253  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T05:17:31,254  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,255  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,255  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,255  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,255  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,255  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0}
2024-04-24T05:17:31,256  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa); Time taken: 0.007 seconds
2024-04-24T05:17:31,256  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa
2024-04-24T05:17:31,256  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa
2024-04-24T05:17:31,269  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T05:17:31,269  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,270  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,270  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,271  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713961051, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:31,277  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtblpart
2024-04-24T05:17:31,293  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,293  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-24T05:17:31,294  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa); Time taken: 0.023 seconds
2024-04-24T05:17:31,294  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_55e2fb65-c341-4265-b04c-77c1dc2c6cfa
2024-04-24T05:17:31,297  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T05:17:31,303  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,303  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T05:17:31,303  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,304  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,306  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T05:17:31,306  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T05:17:31,306  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,306  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,309  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T05:17:31,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,311  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,311  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,311  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,311  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,311  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getDatabase_(String)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:31,311  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4); Time taken: 0.007 seconds
2024-04-24T05:17:31,311  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4
2024-04-24T05:17:31,312  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4
2024-04-24T05:17:31,326  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4 LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T05:17:31,326  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,326  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,326  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,327  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713961051, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, numFiles=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:31,332  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl
2024-04-24T05:17:31,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,348  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,348  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4); Time taken: 0.022 seconds
2024-04-24T05:17:31,348  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_93f71779-7e3a-4149-ad56-1cbcfbe59cc4
2024-04-24T05:17:31,352  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T05:17:31,357  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,357  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T05:17:31,358  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,358  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,361  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T05:17:31,361  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T05:17:31,361  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,361  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,364  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T05:17:31,364  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,366  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,366  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,366  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,366  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,366  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T05:17:31,367  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b); Time taken: 0.008 seconds
2024-04-24T05:17:31,367  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b
2024-04-24T05:17:31,367  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b
2024-04-24T05:17:31,383  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T05:17:31,383  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,383  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,383  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,384  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713961051, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numRows=0, totalSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:31,391  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl2
2024-04-24T05:17:31,406  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,406  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,407  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b); Time taken: 0.023 seconds
2024-04-24T05:17:31,407  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_565a8633-8447-42eb-a20c-e8dc204e7b7b
2024-04-24T05:17:31,411  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T05:17:31,418  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,419  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T05:17:31,419  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,419  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,422  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T05:17:31,422  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T05:17:31,423  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,423  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,426  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T05:17:31,426  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,428  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,428  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,428  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,428  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,428  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=12, flushCache_()=0}
2024-04-24T05:17:31,428  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f); Time taken: 0.009 seconds
2024-04-24T05:17:31,429  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f
2024-04-24T05:17:31,429  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f
2024-04-24T05:17:31,444  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T05:17:31,444  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,444  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:31,444  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,446  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/_tmp_space.db/528c1e94-5b4f-4948-96a2-6dca83345a2c
2024-04-24T05:17:31,449  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,449  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=4}
2024-04-24T05:17:31,450  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f); Time taken: 0.005 seconds
2024-04-24T05:17:31,450  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_1a593e35-9d15-45f1-9764-d3269edeed7f
2024-04-24T05:17:31,454  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T05:17:31,460  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,460  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T05:17:31,461  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,461  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,463  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T05:17:31,464  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T05:17:31,464  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,464  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,467  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T05:17:31,467  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,469  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,469  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,469  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,469  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,469  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=3}
2024-04-24T05:17:31,469  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee); Time taken: 0.008 seconds
2024-04-24T05:17:31,469  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee
2024-04-24T05:17:31,470  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee
2024-04-24T05:17:31,485  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T05:17:31,485  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,485  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:31,485  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713961051, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numRows=0, numFiles=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, bucketing_version=2, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:31,492  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidnonbucket
2024-04-24T05:17:31,510  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,510  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,510  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee); Time taken: 0.025 seconds
2024-04-24T05:17:31,510  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_bc1fa37c-4231-48e0-ac45-1f70e1ad14ee
2024-04-24T05:17:31,514  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T05:17:31,521  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,521  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T05:17:31,522  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T05:17:31,522  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034): drop table if exists T
2024-04-24T05:17:31,525  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T05:17:31,525  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T05:17:31,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:31,546  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:31,546  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,546  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,547  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=21, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:31,547  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034); Time taken: 0.024 seconds
2024-04-24T05:17:31,547  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034
2024-04-24T05:17:31,548  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034
2024-04-24T05:17:31,567  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T05:17:31,567  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:31,567  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034): drop table if exists T
2024-04-24T05:17:31,568  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,568  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:31,574  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:31,575  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:31,581  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:31,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T05:17:31,729  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t does not exist; Force to delete it.
2024-04-24T05:17:31,729 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:31,729  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,729  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=154, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-24T05:17:31,729  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034); Time taken: 0.162 seconds
2024-04-24T05:17:31,729  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_710c72bc-aad1-40d3-81dd-a803001d5034
2024-04-24T05:17:31,733  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T05:17:31,739  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,741  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T05:17:31,741  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T05:17:31,741  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc): drop table if exists Tstage
2024-04-24T05:17:31,749  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T05:17:31,749  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T05:17:31,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:31,772  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:31,772  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,772  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,773  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,773  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=21, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=7}
2024-04-24T05:17:31,773  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc); Time taken: 0.031 seconds
2024-04-24T05:17:31,773  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc
2024-04-24T05:17:31,774  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc
2024-04-24T05:17:31,788  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T05:17:31,788  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:31,788  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc): drop table if exists Tstage
2024-04-24T05:17:31,788  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,788  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:31,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:31,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:31,807  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:31,807  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T05:17:31,838  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage does not exist; Force to delete it.
2024-04-24T05:17:31,839 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:31,839  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,839  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=41}
2024-04-24T05:17:31,839  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc); Time taken: 0.051 seconds
2024-04-24T05:17:31,839  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_aced406d-e445-44e9-819c-ee55fb840dfc
2024-04-24T05:17:31,843  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T05:17:31,849  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,850  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T05:17:31,850  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:31,851  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:31,853  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T05:17:31,853  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T05:17:31,853  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,854  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,858  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T05:17:31,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,860  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,860  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,860  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-24T05:17:31,861  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57); Time taken: 0.01 seconds
2024-04-24T05:17:31,861  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57
2024-04-24T05:17:31,861  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57
2024-04-24T05:17:31,878  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T05:17:31,878  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,879  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-24T05:17:31,879  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713961051, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:31,885  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:31,922  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,922  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=42}
2024-04-24T05:17:31,923  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57); Time taken: 0.043 seconds
2024-04-24T05:17:31,923  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_332082d4-0f9b-4005-a47f-aaa745ec6a57
2024-04-24T05:17:31,926  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T05:17:31,932  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,932  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T05:17:31,932  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:31,933  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:31,935  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T05:17:31,935  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T05:17:31,936  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,936  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,938  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T05:17:31,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:31,940  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:31,940  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:31,940  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:31,940  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:31,940  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=9, getValidWriteIds_(List, String)=2, flushCache_()=0, getDatabase_(String)=1}
2024-04-24T05:17:31,940  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d); Time taken: 0.007 seconds
2024-04-24T05:17:31,940  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d
2024-04-24T05:17:31,941  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d
2024-04-24T05:17:31,953  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T05:17:31,954  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:31,954  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:31,954  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:31,955  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713961051, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, transactional=false, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:31,960  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:31,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:31,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:31,976  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d); Time taken: 0.022 seconds
2024-04-24T05:17:31,976  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_d05f0620-3083-4924-b789-0367fe87513d
2024-04-24T05:17:31,980  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T05:17:31,985  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:31,985  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T05:17:31,986  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-24T05:17:31,986  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70): insert into Tstage values(0,2),(1,4)
2024-04-24T05:17:31,989  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-24T05:17:31,989  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T05:17:31,990  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:31,990  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:31,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:32,002  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:32,002  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:32,002  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:32,002  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:32,002  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:32,002  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:32,012  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:32,012  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:32,012  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T05:17:32,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:32,107  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:32,107  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:32,107  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:32,108  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:32,110  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:32,110  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:32,110  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:32,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:32,120  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:32,121  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1
2024-04-24T05:17:32,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:32,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:32,127  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:32,131  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-24T05:17:32,131  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T05:17:32,132  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:32,132  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:32,141  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:32,152  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:32,152  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:32,153  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:32,153  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:32,153  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:32,153  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T05:17:32,153  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:32,153  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=40, getAllTableConstraints_(AllTableConstraintsRequest)=25, flushCache_()=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:32,153  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70); Time taken: 0.167 seconds
2024-04-24T05:17:32,153  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70
2024-04-24T05:17:32,153  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70
2024-04-24T05:17:32,179  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70 LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T05:17:32,179  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:32,179  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70): insert into Tstage values(0,2),(1,4)
2024-04-24T05:17:32,179  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70
2024-04-24T05:17:32,179  INFO [main] ql.Driver: Query ID = alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70
Total jobs = 1
2024-04-24T05:17:32,179  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:32,179  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:32,325  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-24T05:17:32,325  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:32,325  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:32,325  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:32,325  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:32,325  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:32,325  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:32,325  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:32,327  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:32,327  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T05:17:32,328  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-31_986_8348221303221193210-1/dummy_path
2024-04-24T05:17:32,337  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:32,337  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:32,342  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:32,343  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T05:17:32,344  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:32,347  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-31_986_8348221303221193210-1/-mr-10001
2024-04-24T05:17:32,352  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:32,359  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:32,363  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:32,364  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T05:17:32,364  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T05:17:32,364  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-31_986_8348221303221193210-1/dummy_path
2024-04-24T05:17:32,365  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:32,382  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:32,400  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local748442334_0013
2024-04-24T05:17:32,400  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:32,462  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:32,462  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:32,463  INFO [Thread-1202] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:32,463  INFO [Thread-1202] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:32,465  INFO [Thread-1202] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:32,465  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local748442334_0013_m_000000_0
2024-04-24T05:17:32,468  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:32,468  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-31_986_8348221303221193210-1/dummy_path/null:0+1
2024-04-24T05:17:32,470  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:32,471  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:32,472  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-24T05:17:32,476  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:32,476  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:32,476  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:32,476  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:32,476  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:32,476  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:32,476  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:32,477  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:32,477  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:32,477  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:32,477  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T05:17:32,478  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T05:17:32,478  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:32,478  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T05:17:32,478  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-24T05:17:32,478  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:32,478  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:32,479  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-24T05:17:32,480  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-24T05:17:32,480  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-24T05:17:32,482  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:32,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:32,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:32,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-24T05:17:32,482  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:32,492  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:32,496  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local748442334_0013_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:32,497  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:32,497  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local748442334_0013_m_000000_0' done.
2024-04-24T05:17:32,497  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local748442334_0013_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=304274
		FILE: Number of bytes written=15466818
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1174929408
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-24T05:17:32,497  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local748442334_0013_m_000000_0
2024-04-24T05:17:32,497  INFO [Thread-1202] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:32,499  INFO [Thread-1202] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:32,499  INFO [pool-65-thread-1] mapred.LocalJobRunner: Starting task: attempt_local748442334_0013_r_000000_0
2024-04-24T05:17:32,501  INFO [pool-65-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:32,501  INFO [pool-65-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6d5d26ff
2024-04-24T05:17:32,501  WARN [pool-65-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:32,502  INFO [pool-65-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:32,502  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local748442334_0013_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:32,505  INFO [localfetcher#12] reduce.LocalFetcher: localfetcher#12 about to shuffle output of map attempt_local748442334_0013_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-24T05:17:32,505  INFO [localfetcher#12] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local748442334_0013_m_000000_0
2024-04-24T05:17:32,505  INFO [localfetcher#12] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-24T05:17:32,505  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:32,506  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:32,506  INFO [pool-65-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:32,512  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:32,512  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T05:17:32,514  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:32,514  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-24T05:17:32,514  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:32,514  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:32,514  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-24T05:17:32,515  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:32,515  INFO [pool-65-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:32,516  INFO [pool-65-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T05:17:32,516  INFO [pool-65-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:32,516  INFO [pool-65-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local748442334_0013/job_local748442334_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3afd529d
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_tmp.-ext-10000/000000_0
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-24T05:17:32,517  INFO [pool-65-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_tmp.-ext-10000/000000_0
2024-04-24T05:17:32,529  INFO [pool-65-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_1_default.tstage:0, 
2024-04-24T05:17:32,529  INFO [pool-65-thread-1] mapred.Task: Task:attempt_local748442334_0013_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:32,530  INFO [pool-65-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:32,530  INFO [pool-65-thread-1] mapred.Task: Task 'attempt_local748442334_0013_r_000000_0' done.
2024-04-24T05:17:32,530  INFO [pool-65-thread-1] mapred.Task: Final Counters for attempt_local748442334_0013_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=310740
		FILE: Number of bytes written=15466884
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1174929408
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:32,530  INFO [pool-65-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local748442334_0013_r_000000_0
2024-04-24T05:17:32,530  INFO [pool-65-thread-1] mapred.LocalJobRunner: Starting task: attempt_local748442334_0013_r_000001_0
2024-04-24T05:17:32,530  INFO [pool-65-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:32,531  INFO [pool-65-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6a798ca3
2024-04-24T05:17:32,531  WARN [pool-65-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:32,532  INFO [pool-65-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:32,532  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local748442334_0013_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:32,535  INFO [localfetcher#13] reduce.LocalFetcher: localfetcher#13 about to shuffle output of map attempt_local748442334_0013_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-24T05:17:32,535  INFO [localfetcher#13] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local748442334_0013_m_000000_0
2024-04-24T05:17:32,535  INFO [localfetcher#13] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-24T05:17:32,536  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:32,536  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:32,536  INFO [pool-65-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:32,542  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:32,542  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T05:17:32,545  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:32,545  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-24T05:17:32,545  INFO [pool-65-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:32,545  INFO [pool-65-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:32,545  INFO [pool-65-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-24T05:17:32,545  INFO [pool-65-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:32,546  INFO [pool-65-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:32,546  INFO [pool-65-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-24T05:17:32,547  INFO [pool-65-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:32,547  INFO [pool-65-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-24T05:17:32,547  INFO [pool-65-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-24T05:17:32,547  INFO [pool-65-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-24T05:17:32,547  INFO [pool-65-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local748442334_0013/job_local748442334_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@58fe5b9b
2024-04-24T05:17:32,547  INFO [pool-65-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_tmp.-ext-10000/000001_0
2024-04-24T05:17:32,547  INFO [pool-65-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-24T05:17:32,548  INFO [pool-65-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_tmp.-ext-10000/000001_0
2024-04-24T05:17:32,548  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-24T05:17:32,548  INFO [pool-65-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T05:17:32,552  INFO [pool-65-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T05:17:32,553  INFO [pool-65-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-24T05:17:32,553  INFO [pool-65-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:32,553  INFO [pool-65-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-24T05:17:32,553  INFO [pool-65-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-24T05:17:32,559  INFO [pool-65-thread-1] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_6:2, 
2024-04-24T05:17:32,559  INFO [pool-65-thread-1] mapred.Task: Task:attempt_local748442334_0013_r_000001_0 is done. And is in the process of committing
2024-04-24T05:17:32,560  INFO [pool-65-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:32,560  INFO [pool-65-thread-1] mapred.Task: Task 'attempt_local748442334_0013_r_000001_0' done.
2024-04-24T05:17:32,560  INFO [pool-65-thread-1] mapred.Task: Final Counters for attempt_local748442334_0013_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=317236
		FILE: Number of bytes written=15467272
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1174929408
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:32,560  INFO [pool-65-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local748442334_0013_r_000001_0
2024-04-24T05:17:32,560  INFO [Thread-1202] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:33,467 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:33,467  INFO [main] exec.Task: 2024-04-24 05:17:33,467 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local748442334_0013
2024-04-24T05:17:33,468  INFO [main] exec.Task: Ended Job = job_local748442334_0013
2024-04-24T05:17:33,470  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T05:17:33,470  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1/-ext-10000
2024-04-24T05:17:33,470  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:33,480  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,481  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:33,491  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,493  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:33,493  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:33,522  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T05:17:33,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:33,531  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,531  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T05:17:33,531  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-31_986_8348221303221193210-1/-mr-10001
2024-04-24T05:17:33,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:33,541  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,542  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T05:17:33,542  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T05:17:33,542  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:33,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:33,568  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T05:17:33,569  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:33,569  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=55, getTable_(GetTableRequest)=38}
MapReduce Jobs Launched: 
2024-04-24T05:17:33,569  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:33,569  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:33,569  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:33,569  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70); Time taken: 1.39 seconds
2024-04-24T05:17:33,569  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051731_301b4ef0-1ce0-43fc-8234-7e5fbeb6ec70
2024-04-24T05:17:33,574  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T05:17:33,580  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:33,580  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T05:17:33,581  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:33,581  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1
2024-04-24T05:17:33,581  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-31_986_8348221303221193210-1 on fs with scheme file
2024-04-24T05:17:33,581  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-31_986_8348221303221193210-1
2024-04-24T05:17:33,582  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-31_986_8348221303221193210-1 on fs with scheme file
2024-04-24T05:17:33,582  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:33,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:33,592  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,594  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T05:17:33,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T05:17:33,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:33,607  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,607  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,607  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,607  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,607  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,607  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:33,607  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:33,607  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:33,608  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCurrentNotificationEventId_()=3, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=18, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-24T05:17:33,608  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb); Time taken: 0.025 seconds
2024-04-24T05:17:33,608  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb
2024-04-24T05:17:33,609  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb
2024-04-24T05:17:33,623  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T05:17:33,623  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:33,623  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:33,623  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:33,623  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,623  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,623  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,623  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:33,634  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:33,644  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:33,644  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:33,644  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb); Time taken: 0.021 seconds
2024-04-24T05:17:33,644  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051733_c52b4eb4-f2b4-4b33-9c1c-65768d74c0bb
2024-04-24T05:17:33,649  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T05:17:33,655  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:33,655  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T05:17:33,656  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data'
2024-04-24T05:17:33,656  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data'
2024-04-24T05:17:33,659  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T05:17:33,659  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T05:17:33,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:33,667  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,675  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-24T05:17:33,675  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-24T05:17:33,676  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:33,676  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:33,676  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:33,676  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, allocateTableWriteId_(long, String, String)=7, getTable_(GetTableRequest)=7, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-24T05:17:33,676  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110); Time taken: 0.02 seconds
2024-04-24T05:17:33,676  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110
2024-04-24T05:17:33,677  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110
2024-04-24T05:17:33,690  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T05:17:33,690  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:33,693  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data'
2024-04-24T05:17:33,694  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:33,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:33,701  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,701  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:33,711  INFO [HMSHandler #13] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:33,731  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T05:17:33,731  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data
2024-04-24T05:17:33,731  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:33,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:33,753  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T05:17:33,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:33,754  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:33,760  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,761  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:33,770  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T05:17:33,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:33,775  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T05:17:33,809  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:33,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:33,840  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:33,840  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {add_partitions_(List, boolean, boolean)=30, getTable_(GetTableRequest)=21, getValidWriteIds_(List, String)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=34, validatePartitionNameCharacters_(List)=1, isCompatibleWith_(Configuration)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=56}
2024-04-24T05:17:33,841  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110); Time taken: 0.147 seconds
2024-04-24T05:17:33,841  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051733_74fd62cc-0b77-4596-8d91-7016c5946110
2024-04-24T05:17:33,845  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T05:17:33,850  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:33,850  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T05:17:33,851  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:33,851  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:33,853  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T05:17:33,854  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T05:17:33,854  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:33,854  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:33,860  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:33,860  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:33,861  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:33,868  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,868  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:33,868  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:33,868  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:33,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:33,918  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:33,918  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:33,938  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:33,947  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:33,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:33,962  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:33,962  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:34,009  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:34,009  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:34,009  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:34,010  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-33_851_6055965605405070352-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-33_851_6055965605405070352-1
2024-04-24T05:17:34,018  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:34,021  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1]}
2024-04-24T05:17:34,021  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4], VALUE._col0=Column[_col2]}
2024-04-24T05:17:34,022  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:34,023  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:34,032  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:34,032  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:34,032  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:34,032  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:34,032  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T05:17:34,033  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T05:17:34,034  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:34,034  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, commitTxn_(CommitTxnRequest)=9, listPartitions_(String, String, short)=11, getValidWriteIds_(List, String)=8, getAllTableConstraints_(AllTableConstraintsRequest)=31, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=24}
2024-04-24T05:17:34,034  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205); Time taken: 0.183 seconds
2024-04-24T05:17:34,034  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205
2024-04-24T05:17:34,035  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205
2024-04-24T05:17:34,050  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T05:17:34,051  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:34,051  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-24T05:17:34,052  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205
2024-04-24T05:17:34,052  INFO [main] ql.Driver: Query ID = alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205
Total jobs = 1
2024-04-24T05:17:34,052  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:34,052  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:34,206  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:34,206  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:34,206  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:34,206  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:34,206  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:34,206  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:34,206  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:34,206  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:34,209  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:34,209  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:34,209  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:34,219  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:34,220  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:34,225  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:34,226  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:34,227  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:34,233  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:34,240  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:34,245  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:34,246  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:34,246  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:34,246  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:34,246  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:34,246  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-24T05:17:34,246  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:34,255  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T05:17:34,255  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 9 ms
2024-04-24T05:17:34,256  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:34,274  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:34,292  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1549187955_0014
2024-04-24T05:17:34,292  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:34,351  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:34,352  INFO [Thread-1283] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:34,352  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:34,352  INFO [Thread-1283] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:34,353  INFO [Thread-1283] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:34,353  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1549187955_0014_m_000000_0
2024-04-24T05:17:34,354  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:34,355  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:34,355  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:34,356  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-24T05:17:34,357  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-24T05:17:34,357  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:34,363  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-24T05:17:34,364  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:34,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:34,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:34,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:34,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:34,368  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:34,369  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:34,369  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:34,370  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:34,371  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:34,371  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:34,371  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-24T05:17:34,371  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:34,371  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:34,371  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:34,372  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T05:17:34,373  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:34,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:34,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:34,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-24T05:17:34,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:34,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:34,386  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1549187955_0014_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:34,387  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:34,387  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1549187955_0014_m_000000_0' done.
2024-04-24T05:17:34,387  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1549187955_0014_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=325187
		FILE: Number of bytes written=16656588
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1174929408
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6405
2024-04-24T05:17:34,387  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1549187955_0014_m_000000_0
2024-04-24T05:17:34,387  INFO [Thread-1283] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:34,388  INFO [Thread-1283] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:34,388  INFO [pool-71-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1549187955_0014_r_000000_0
2024-04-24T05:17:34,389  INFO [pool-71-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:34,389  INFO [pool-71-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@7447a57d
2024-04-24T05:17:34,389  WARN [pool-71-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:34,390  INFO [pool-71-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:34,390  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1549187955_0014_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:34,391  INFO [localfetcher#14] reduce.LocalFetcher: localfetcher#14 about to shuffle output of map attempt_local1549187955_0014_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-24T05:17:34,391  INFO [localfetcher#14] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1549187955_0014_m_000000_0
2024-04-24T05:17:34,391  INFO [localfetcher#14] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-24T05:17:34,392  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:34,392  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:34,392  INFO [pool-71-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:34,398  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:34,398  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T05:17:34,401  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:34,401  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-24T05:17:34,401  INFO [pool-71-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:34,401  INFO [pool-71-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:34,401  INFO [pool-71-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-24T05:17:34,401  INFO [pool-71-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-24T05:17:34,402  INFO [pool-71-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:34,402  INFO [pool-71-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-24T05:17:34,403  INFO [pool-71-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:34,403  INFO [pool-71-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:34,403  INFO [pool-71-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-24T05:17:34,403  INFO [pool-71-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:34,404  INFO [pool-71-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@11872033, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@3d352fb4>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@4b8eeca7>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@5fdc0fca, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@178e9b6f
2024-04-24T05:17:34,404  INFO [pool-71-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-33_851_6055965605405070352-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-33_851_6055965605405070352-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:34,404  INFO [pool-71-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-33_851_6055965605405070352-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-33_851_6055965605405070352-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:34,404  INFO [pool-71-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-33_851_6055965605405070352-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-33_851_6055965605405070352-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:34,412  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:34,412  INFO [pool-71-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:34,412  INFO [pool-71-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-24T05:17:34,412  INFO [pool-71-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:34,412  INFO [pool-71-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T05:17:34,412  INFO [pool-71-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:34,412  INFO [pool-71-thread-1] mapred.Task: Task:attempt_local1549187955_0014_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:34,413  INFO [pool-71-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:34,413  INFO [pool-71-thread-1] mapred.Task: Task 'attempt_local1549187955_0014_r_000000_0' done.
2024-04-24T05:17:34,413  INFO [pool-71-thread-1] mapred.Task: Final Counters for attempt_local1549187955_0014_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=332330
		FILE: Number of bytes written=16657489
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1174929408
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:34,413  INFO [pool-71-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1549187955_0014_r_000000_0
2024-04-24T05:17:34,413  INFO [Thread-1283] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:35,354 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:35,355  INFO [main] exec.Task: 2024-04-24 05:17:35,354 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1549187955_0014
2024-04-24T05:17:35,357  INFO [main] exec.Task: Ended Job = job_local1549187955_0014
2024-04-24T05:17:35,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:35,362  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:35,362  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:35,362  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:35,362  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:35,362  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205); Time taken: 1.31 seconds
2024-04-24T05:17:35,362  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051733_e924f40a-9a11-49e7-bcc6-d0832a912205
2024-04-24T05:17:35,367  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T05:17:35,373  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:35,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T05:17:35,377  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:35,378  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T05:17:35,378  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-24T05:17:35,378  WARN [main] ql.TestTxnAddPartition: addPartitionRename: read data(add partition (p=0)): 
2024-04-24T05:17:35,378  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-24T05:17:35,378  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:35,379  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-33_851_6055965605405070352-1
2024-04-24T05:17:35,379  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c6b4db2a-2af0-42a7-a6a8-74e4a55542b3/hive_2024-04-24_05-17-33_851_6055965605405070352-1 on fs with scheme file
2024-04-24T05:17:35,379  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271): drop table if exists acidTbl
2024-04-24T05:17:35,382  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-24T05:17:35,382  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T05:17:35,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:35,389  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,390  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:35,390  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:35,390  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:35,390  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=8, flushCache_()=0}
2024-04-24T05:17:35,390  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271); Time taken: 0.011 seconds
2024-04-24T05:17:35,390  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271
2024-04-24T05:17:35,391  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271
2024-04-24T05:17:35,405  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271 LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T05:17:35,405  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:35,405  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271): drop table if exists acidTbl
2024-04-24T05:17:35,406  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:35,406  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:35,413  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,413  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:35,420  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,420  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:35,515  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:35,515  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=102, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:35,515  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271); Time taken: 0.11 seconds
2024-04-24T05:17:35,515  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051735_6ae51d89-8a69-4d59-a838-72461c69f271
2024-04-24T05:17:35,519  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T05:17:35,525  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:35,525  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T05:17:35,526  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:35,526  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79): drop table if exists acidTblPart
2024-04-24T05:17:35,528  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-24T05:17:35,528  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T05:17:35,529  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:35,536  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,536  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:35,536  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:35,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:35,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=7, getValidTxns_(long)=0, openTxn_(String, TxnType)=1}
2024-04-24T05:17:35,536  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79); Time taken: 0.01 seconds
2024-04-24T05:17:35,537  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79
2024-04-24T05:17:35,537  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79
2024-04-24T05:17:35,551  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79 LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T05:17:35,551  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:35,552  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79): drop table if exists acidTblPart
2024-04-24T05:17:35,552  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:35,552  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:35,558  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:35,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:35,606  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:35,606  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=6, dropTable_(String, String, boolean, boolean, boolean)=47, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:35,606  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79); Time taken: 0.054 seconds
2024-04-24T05:17:35,606  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051735_61f52c32-84f2-4260-a1c1-28b749156e79
2024-04-24T05:17:35,610  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T05:17:35,615  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:35,615  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T05:17:35,616  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:35,616  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051735_e8e8b835-a28e-417c-9b46-3548d3d95f85): drop table if exists acidTbl2
2024-04-24T05:17:35,618  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-24T05:17:35,619  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T05:17:35,619  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:35,620  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:35,620  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:35,620  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:35,620  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051735_e8e8b835-a28e-417c-9b46-3548d3d95f85); Time taken: 0.004 seconds
2024-04-24T05:17:35,620  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424051735_e8e8b835-a28e-417c-9b46-3548d3d95f85
2024-04-24T05:17:35,620  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:35,620  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051735_e8e8b835-a28e-417c-9b46-3548d3d95f85): drop table if exists acidTbl2
2024-04-24T05:17:35,621  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:35,621  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T05:17:35,621  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:35,621  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:35,622  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051735_e8e8b835-a28e-417c-9b46-3548d3d95f85); Time taken: 0.001 seconds
2024-04-24T05:17:35,622  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051735_e8e8b835-a28e-417c-9b46-3548d3d95f85
2024-04-24T05:17:35,627  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T05:17:35,633  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:35,633  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T05:17:35,634  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:35,634  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:35,636  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-24T05:17:35,637  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T05:17:35,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:35,658  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,659  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:35,659  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:35,659  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:35,659  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=22, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T05:17:35,659  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2); Time taken: 0.025 seconds
2024-04-24T05:17:35,659  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2
2024-04-24T05:17:35,660  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2
2024-04-24T05:17:35,673  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2 LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T05:17:35,673  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:35,673  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:35,673  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:35,674  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:35,682  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,682  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:35,691  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,691  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:35,774  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:35,774  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=92, getTable_(GetTableRequest)=8, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:35,775  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2); Time taken: 0.101 seconds
2024-04-24T05:17:35,775  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051735_ff9daf5e-13fa-4acf-81fa-cf2532da41c2
2024-04-24T05:17:35,778  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-24T05:17:35,784  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:35,784  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-24T05:17:35,785  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:35,785  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:35,787  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-24T05:17:35,788  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T05:17:35,788  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:35,797  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,797  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:35,797  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:35,797  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:35,797  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, getTable_(GetTableRequest)=9, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:35,798  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144); Time taken: 0.012 seconds
2024-04-24T05:17:35,798  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144
2024-04-24T05:17:35,798  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144
2024-04-24T05:17:35,812  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144 LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T05:17:35,812  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:35,812  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:35,813  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:35,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:35,821  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,822  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:35,830  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,830  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:35,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:35,862  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=8}
2024-04-24T05:17:35,862  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144); Time taken: 0.049 seconds
2024-04-24T05:17:35,862  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051735_ff8d37d6-9a1a-4750-ad2d-a6ddac0ae144
2024-04-24T05:17:35,866  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T05:17:35,872  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:35,872  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T05:17:35,872  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:35,872  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7): drop table if exists nonAcidNonBucket
2024-04-24T05:17:35,875  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-24T05:17:35,875  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T05:17:35,876  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:35,886  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,886  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:35,886  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:35,886  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:35,886  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getTable_(GetTableRequest)=10, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:35,886  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7); Time taken: 0.014 seconds
2024-04-24T05:17:35,886  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7
2024-04-24T05:17:35,887  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7
2024-04-24T05:17:35,903  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T05:17:35,903  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:35,903  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7): drop table if exists nonAcidNonBucket
2024-04-24T05:17:35,903  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:35,903  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:35,912  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,912  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:35,922  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:35,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:35,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:35,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40}
2024-04-24T05:17:35,952  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7); Time taken: 0.049 seconds
2024-04-24T05:17:35,952  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051735_46a1592c-f18c-4874-806e-3cc59f346cf7
2024-04-24T05:17:35,956  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T05:17:35,962  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:35,962  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T05:17:35,962  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T05:17:36,054  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-24T05:17:36,054  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-24T05:17:36,054  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-24T05:17:36,054  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-24T05:17:36,055  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-24T05:17:36,055  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-24T05:17:36,055  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-24T05:17:36,055  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-24T05:17:36,055  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-24T05:17:36,055  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-24T05:17:36,055  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-24T05:17:36,058  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = a7f658ac-5d4c-4f82-8dc9-2f095425154d
2024-04-24T05:17:36,060  INFO [main] SessionState: Hive Session ID = a7f658ac-5d4c-4f82-8dc9-2f095425154d
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:36,061  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-24T05:17:36,066  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/a7f658ac-5d4c-4f82-8dc9-2f095425154d
2024-04-24T05:17:36,069  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d
2024-04-24T05:17:36,071  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/a7f658ac-5d4c-4f82-8dc9-2f095425154d/_tmp_space.db
2024-04-24T05:17:36,072  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=a7f658ac-5d4c-4f82-8dc9-2f095425154d, clientType=HIVECLI]
2024-04-24T05:17:36,072  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:36,072  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_d6b4275c-dc4c-471d-bf1c-f6612e5df166): drop table if exists acidTbl
2024-04-24T05:17:36,083  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-24T05:17:36,083  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-24T05:17:36,086  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:36,094  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,094  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,095  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,095  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=3, openTxn_(String, TxnType)=10, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-24T05:17:36,095  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_d6b4275c-dc4c-471d-bf1c-f6612e5df166); Time taken: 0.023 seconds
2024-04-24T05:17:36,095  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240424051736_d6b4275c-dc4c-471d-bf1c-f6612e5df166
2024-04-24T05:17:36,095  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:36,096  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_d6b4275c-dc4c-471d-bf1c-f6612e5df166): drop table if exists acidTbl
2024-04-24T05:17:36,096  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,096  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:36,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,101  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,101  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_d6b4275c-dc4c-471d-bf1c-f6612e5df166); Time taken: 0.005 seconds
2024-04-24T05:17:36,101  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_d6b4275c-dc4c-471d-bf1c-f6612e5df166
2024-04-24T05:17:36,109  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-24T05:17:36,117  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,117  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-24T05:17:36,118  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:36,118  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_2539474a-42c1-4019-9842-7df1cb045738): drop table if exists acidTblPart
2024-04-24T05:17:36,121  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-24T05:17:36,121  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-24T05:17:36,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:36,127  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,127  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,127  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,127  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=17, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:36,127  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_2539474a-42c1-4019-9842-7df1cb045738); Time taken: 0.009 seconds
2024-04-24T05:17:36,128  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240424051736_2539474a-42c1-4019-9842-7df1cb045738
2024-04-24T05:17:36,128  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:36,128  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_2539474a-42c1-4019-9842-7df1cb045738): drop table if exists acidTblPart
2024-04-24T05:17:36,128  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,128  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:36,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,133  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_2539474a-42c1-4019-9842-7df1cb045738); Time taken: 0.005 seconds
2024-04-24T05:17:36,133  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_2539474a-42c1-4019-9842-7df1cb045738
2024-04-24T05:17:36,139  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-24T05:17:36,144  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,144  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-24T05:17:36,145  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:36,145  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_3e1c781f-3d7f-4af0-86c4-abe0f0232f91): drop table if exists acidTbl2
2024-04-24T05:17:36,148  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-24T05:17:36,148  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-24T05:17:36,148  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:36,151  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,151  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,151  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,152  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-24T05:17:36,152  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_3e1c781f-3d7f-4af0-86c4-abe0f0232f91); Time taken: 0.006 seconds
2024-04-24T05:17:36,152  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240424051736_3e1c781f-3d7f-4af0-86c4-abe0f0232f91
2024-04-24T05:17:36,152  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:36,152  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_3e1c781f-3d7f-4af0-86c4-abe0f0232f91): drop table if exists acidTbl2
2024-04-24T05:17:36,152  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,152  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-24T05:17:36,155  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,155  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,156  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_3e1c781f-3d7f-4af0-86c4-abe0f0232f91); Time taken: 0.003 seconds
2024-04-24T05:17:36,156  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_3e1c781f-3d7f-4af0-86c4-abe0f0232f91
2024-04-24T05:17:36,160  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-24T05:17:36,166  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,166  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-24T05:17:36,167  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:36,167  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_102912ce-ad55-4d3f-ad18-1ce696de268d): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:36,169  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-24T05:17:36,169  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-24T05:17:36,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:36,172  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,172  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,172  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,173  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:36,173  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_102912ce-ad55-4d3f-ad18-1ce696de268d); Time taken: 0.005 seconds
2024-04-24T05:17:36,173  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240424051736_102912ce-ad55-4d3f-ad18-1ce696de268d
2024-04-24T05:17:36,173  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:36,173  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_102912ce-ad55-4d3f-ad18-1ce696de268d): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:36,173  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,173  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:36,176  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,176  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,176  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_102912ce-ad55-4d3f-ad18-1ce696de268d); Time taken: 0.003 seconds
2024-04-24T05:17:36,177  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_102912ce-ad55-4d3f-ad18-1ce696de268d
2024-04-24T05:17:36,181  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-24T05:17:36,187  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,187  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-24T05:17:36,187  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:36,188  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_b9f8e0c4-f05b-4f24-9a7a-d9288725dca7): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:36,190  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-24T05:17:36,190  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-24T05:17:36,191  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:36,193  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,193  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,193  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,193  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-24T05:17:36,194  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_b9f8e0c4-f05b-4f24-9a7a-d9288725dca7); Time taken: 0.005 seconds
2024-04-24T05:17:36,194  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240424051736_b9f8e0c4-f05b-4f24-9a7a-d9288725dca7
2024-04-24T05:17:36,194  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:36,194  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_b9f8e0c4-f05b-4f24-9a7a-d9288725dca7): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:36,194  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:36,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,198  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_b9f8e0c4-f05b-4f24-9a7a-d9288725dca7); Time taken: 0.003 seconds
2024-04-24T05:17:36,198  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_b9f8e0c4-f05b-4f24-9a7a-d9288725dca7
2024-04-24T05:17:36,203  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-24T05:17:36,208  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,208  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-24T05:17:36,209  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:36,209  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_7ac88b95-8034-40b3-a979-14eaef11a990): drop table if exists nonAcidNonBucket
2024-04-24T05:17:36,211  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-24T05:17:36,211  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-24T05:17:36,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:36,214  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,214  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,215  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-24T05:17:36,215  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_7ac88b95-8034-40b3-a979-14eaef11a990); Time taken: 0.006 seconds
2024-04-24T05:17:36,215  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240424051736_7ac88b95-8034-40b3-a979-14eaef11a990
2024-04-24T05:17:36,215  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:36,215  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_7ac88b95-8034-40b3-a979-14eaef11a990): drop table if exists nonAcidNonBucket
2024-04-24T05:17:36,215  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:36,218  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,218  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:36,219  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_7ac88b95-8034-40b3-a979-14eaef11a990); Time taken: 0.003 seconds
2024-04-24T05:17:36,219  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_7ac88b95-8034-40b3-a979-14eaef11a990
2024-04-24T05:17:36,224  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-24T05:17:36,230  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,231  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-24T05:17:36,231  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,231  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,233  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-24T05:17:36,234  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-24T05:17:36,234  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:36,234  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:36,239  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-24T05:17:36,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:36,241  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:36,241  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,241  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,242  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getDatabase_(String)=1}
2024-04-24T05:17:36,242  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272); Time taken: 0.01 seconds
2024-04-24T05:17:36,242  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272
2024-04-24T05:17:36,242  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272
2024-04-24T05:17:36,260  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272 LockResponse(lockid:1, state:ACQUIRED)
2024-04-24T05:17:36,260  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:36,261  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,261  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713961056, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, transactional=true, rawDataSize=0, numFilesErasureCoded=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:36,268  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtbl
2024-04-24T05:17:36,304  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,304  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=41}
2024-04-24T05:17:36,304  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272); Time taken: 0.043 seconds
2024-04-24T05:17:36,304  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_1062f5f0-3f3b-41c3-bc86-0bf056d6c272
2024-04-24T05:17:36,308  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-24T05:17:36,313  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,313  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-24T05:17:36,314  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,314  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,316  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-24T05:17:36,317  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-24T05:17:36,317  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:36,317  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:36,319  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-24T05:17:36,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:36,321  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:36,321  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,321  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,322  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,322  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, flushCache_()=0, getValidWriteIds_(List, String)=2, getDatabase_(String)=1, openTxn_(String, TxnType)=2}
2024-04-24T05:17:36,322  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3); Time taken: 0.007 seconds
2024-04-24T05:17:36,322  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3
2024-04-24T05:17:36,322  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3
2024-04-24T05:17:36,336  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3 LockResponse(lockid:2, state:ACQUIRED)
2024-04-24T05:17:36,336  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:36,337  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,337  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713961056, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:36,343  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/acidtblpart
2024-04-24T05:17:36,359  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,359  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-24T05:17:36,359  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3); Time taken: 0.022 seconds
2024-04-24T05:17:36,359  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_9383540d-e66e-4328-b607-301b023482c3
2024-04-24T05:17:36,363  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-24T05:17:36,369  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,369  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-24T05:17:36,370  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,370  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,373  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-24T05:17:36,373  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-24T05:17:36,374  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:36,374  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:36,376  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-24T05:17:36,376  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:36,378  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:36,378  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,378  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,378  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,378  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=2}
2024-04-24T05:17:36,378  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b); Time taken: 0.008 seconds
2024-04-24T05:17:36,379  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b
2024-04-24T05:17:36,379  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b
2024-04-24T05:17:36,393  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b LockResponse(lockid:3, state:ACQUIRED)
2024-04-24T05:17:36,393  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:36,393  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,393  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,394  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713961056, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, rawDataSize=0, transactional=false, bucketing_version=2, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:36,400  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl
2024-04-24T05:17:36,415  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,416  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b); Time taken: 0.022 seconds
2024-04-24T05:17:36,416  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_68074613-479f-4d91-88bb-80fc583f682b
2024-04-24T05:17:36,420  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-24T05:17:36,426  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,426  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-24T05:17:36,427  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,427  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,429  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-24T05:17:36,429  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-24T05:17:36,430  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:36,430  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:36,432  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-24T05:17:36,433  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:36,434  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:36,434  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,434  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,434  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,434  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=1, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-24T05:17:36,435  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5); Time taken: 0.007 seconds
2024-04-24T05:17:36,435  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5
2024-04-24T05:17:36,435  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5
2024-04-24T05:17:36,449  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5 LockResponse(lockid:4, state:ACQUIRED)
2024-04-24T05:17:36,450  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:36,450  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,450  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,451  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713961056, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFiles=0, numFilesErasureCoded=0, numRows=0, totalSize=0, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:36,456  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidorctbl2
2024-04-24T05:17:36,473  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,473  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,473  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5); Time taken: 0.023 seconds
2024-04-24T05:17:36,473  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_05f2ab06-d558-4ddb-981f-945b99d5c2c5
2024-04-24T05:17:36,477  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-24T05:17:36,483  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,483  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-24T05:17:36,484  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,484  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,486  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-24T05:17:36,487  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-24T05:17:36,487  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:36,487  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:36,489  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-24T05:17:36,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:36,491  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:36,491  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,491  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,492  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=1, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=1}
2024-04-24T05:17:36,492  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7); Time taken: 0.008 seconds
2024-04-24T05:17:36,492  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7
2024-04-24T05:17:36,492  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7
2024-04-24T05:17:36,513  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7 LockResponse(lockid:5, state:ACQUIRED)
2024-04-24T05:17:36,513  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:36,514  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-24T05:17:36,514  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,515  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/a7f658ac-5d4c-4f82-8dc9-2f095425154d/_tmp_space.db/57e1f65a-fb2c-4c70-ad36-c8d4f72fc6e2
2024-04-24T05:17:36,518  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,518  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-24T05:17:36,518  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7); Time taken: 0.004 seconds
2024-04-24T05:17:36,518  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_c8567fb0-e1ae-4b5f-826b-afe7bdaaccf7
2024-04-24T05:17:36,523  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-24T05:17:36,530  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,530  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-24T05:17:36,530  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,531  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,533  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-24T05:17:36,533  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-24T05:17:36,534  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:36,534  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:36,536  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-24T05:17:36,537  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:36,538  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:36,538  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,539  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,539  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,539  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1, getDatabase_(String)=1, commitTxn_(CommitTxnRequest)=12}
2024-04-24T05:17:36,539  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c); Time taken: 0.009 seconds
2024-04-24T05:17:36,539  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c
2024-04-24T05:17:36,539  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c
2024-04-24T05:17:36,555  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c LockResponse(lockid:6, state:ACQUIRED)
2024-04-24T05:17:36,555  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:36,555  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-24T05:17:36,555  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713961056, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, totalSize=0, bucketing_version=2, rawDataSize=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:36,561  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/nonacidnonbucket
2024-04-24T05:17:36,579  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,579  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-24T05:17:36,579  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c); Time taken: 0.024 seconds
2024-04-24T05:17:36,579  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_4d3af0fc-adca-4318-9a82-bf543ebca22c
2024-04-24T05:17:36,585  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-24T05:17:36,595  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,595  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-24T05:17:36,596  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-24T05:17:36,596  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1): drop table if exists T
2024-04-24T05:17:36,599  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-24T05:17:36,599  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-24T05:17:36,600  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:36,629  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:36,630  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,630  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,630  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,630  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getTable_(GetTableRequest)=30, commitTxn_(CommitTxnRequest)=16, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:36,630  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1); Time taken: 0.034 seconds
2024-04-24T05:17:36,630  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1
2024-04-24T05:17:36,631  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1
2024-04-24T05:17:36,651  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1 LockResponse(lockid:7, state:ACQUIRED)
2024-04-24T05:17:36,651  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:36,651  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1): drop table if exists T
2024-04-24T05:17:36,651  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:36,659  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:36,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:36,668  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:36,668  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-24T05:17:36,848  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t does not exist; Force to delete it.
2024-04-24T05:17:36,848 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:36,848  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,848  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=189, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=7}
2024-04-24T05:17:36,848  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1); Time taken: 0.197 seconds
2024-04-24T05:17:36,848  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_463c3ce0-c8b7-42e7-b496-b01ab084a2d1
2024-04-24T05:17:36,853  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-24T05:17:36,861  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,861  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-24T05:17:36,863  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-24T05:17:36,863  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee): drop table if exists Tstage
2024-04-24T05:17:36,866  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-24T05:17:36,866  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-24T05:17:36,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:36,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:36,894  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,894  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,894  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,894  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=27}
2024-04-24T05:17:36,895  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee); Time taken: 0.031 seconds
2024-04-24T05:17:36,895  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee
2024-04-24T05:17:36,895  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee
2024-04-24T05:17:36,913  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee LockResponse(lockid:8, state:ACQUIRED)
2024-04-24T05:17:36,913  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:36,913  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee): drop table if exists Tstage
2024-04-24T05:17:36,913  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:36,913  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:36,923  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:36,924  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:36,933  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:36,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-24T05:17:36,969  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage does not exist; Force to delete it.
2024-04-24T05:17:36,969 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:36,970  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:36,970  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:36,970  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee); Time taken: 0.057 seconds
2024-04-24T05:17:36,970  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_c503d6d8-3c5b-4432-b127-71dfa7750bee
2024-04-24T05:17:36,975  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-24T05:17:36,982  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:36,982  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-24T05:17:36,983  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T05:17:36,983  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T05:17:36,986  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-24T05:17:36,986  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-24T05:17:36,986  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:36,986  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:36,993  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-24T05:17:36,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:36,995  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:36,995  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:36,995  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:36,995  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:36,995  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-24T05:17:36,995  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6); Time taken: 0.012 seconds
2024-04-24T05:17:36,996  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6
2024-04-24T05:17:36,996  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6
2024-04-24T05:17:37,012  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6 LockResponse(lockid:9, state:ACQUIRED)
2024-04-24T05:17:37,012  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:37,013  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-24T05:17:37,013  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:37,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713961057, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional_properties=insert_only, transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-24T05:17:37,020  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t
2024-04-24T05:17:37,057  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:37,057  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:37,057  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6); Time taken: 0.044 seconds
2024-04-24T05:17:37,058  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051736_598b28ce-31b0-4576-83b8-df75bb6065e6
2024-04-24T05:17:37,062  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-24T05:17:37,068  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:37,068  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-24T05:17:37,069  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:37,069  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:37,072  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-24T05:17:37,073  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-24T05:17:37,073  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:37,073  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:37,076  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-24T05:17:37,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-24T05:17:37,078  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:37,078  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:37,078  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:37,078  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:37,078  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2}
2024-04-24T05:17:37,078  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987); Time taken: 0.009 seconds
2024-04-24T05:17:37,079  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987
2024-04-24T05:17:37,079  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987
2024-04-24T05:17:37,093  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987 LockResponse(lockid:10, state:ACQUIRED)
2024-04-24T05:17:37,094  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-24T05:17:37,094  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-24T05:17:37,094  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:37,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713961057, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0, numRows=0, transactional=false, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-24T05:17:37,100  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage
2024-04-24T05:17:37,115  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:37,115  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:37,116  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987); Time taken: 0.021 seconds
2024-04-24T05:17:37,116  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051737_ac8c9350-d3b1-4b73-adcb-8daaa0883987
2024-04-24T05:17:37,120  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-24T05:17:37,128  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:37,128  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-24T05:17:37,128  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:37,129  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b): insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:37,132  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 3
2024-04-24T05:17:37,132  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-24T05:17:37,133  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:37,133  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:37,136  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:37,174  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:37,175  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:37,175  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:37,175  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:37,175  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:37,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:37,184  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:37,184  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:37,184  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-24T05:17:37,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:37,288  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:37,288  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:37,288  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:37,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-24T05:17:37,291  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:37,291  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:37,291  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:37,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:37,301  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:37,303  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1
2024-04-24T05:17:37,306  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:37,307  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-24T05:17:37,309  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:37,312  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:37,313  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:37,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:37,333  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:37,333  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-24T05:17:37,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:37,345  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:37,347  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:37,347  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-24T05:17:37,347  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:37,347  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:37,347  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:37,347  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-24T05:17:37,347  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-24T05:17:37,348  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:37,348  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:37,348  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:37,348  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-24T05:17:37,348  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:37,348  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getCheckConstraints_(CheckConstraintsRequest)=1, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=3, getNotNullConstraints_(NotNullConstraintsRequest)=1, getAllTableConstraints_(AllTableConstraintsRequest)=28, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=79}
2024-04-24T05:17:37,348  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b); Time taken: 0.219 seconds
2024-04-24T05:17:37,348  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b
2024-04-24T05:17:37,349  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b
2024-04-24T05:17:37,365  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b LockResponse(lockid:11, state:ACQUIRED)
2024-04-24T05:17:37,365  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:37,365  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b): insert into Tstage values(0,2),(0,4)
2024-04-24T05:17:37,366  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b
2024-04-24T05:17:37,366  INFO [main] ql.Driver: Query ID = alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b
Total jobs = 1
2024-04-24T05:17:37,366  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:37,366  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:37,522  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:17:37,522  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-24T05:17:37,525  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:37,525  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-24T05:17:37,525  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-37_129_4309760981783918145-1/dummy_path
2024-04-24T05:17:37,535  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:37,536  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,09KB
2024-04-24T05:17:37,537  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:37,542  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-37_129_4309760981783918145-1/-mr-10001
2024-04-24T05:17:37,546  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:37,554  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:37,558  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:37,559  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-24T05:17:37,559  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-24T05:17:37,559  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-37_129_4309760981783918145-1/dummy_path
2024-04-24T05:17:37,560  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-24T05:17:37,578  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-24T05:17:37,597  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local572400953_0015
2024-04-24T05:17:37,597  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:37,657  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:37,657  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:37,658  INFO [Thread-1370] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:37,658  INFO [Thread-1370] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:37,659  INFO [Thread-1370] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:37,659  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local572400953_0015_m_000000_0
2024-04-24T05:17:37,663  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:37,663  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-37_129_4309760981783918145-1/dummy_path/null:0+1
2024-04-24T05:17:37,666  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:37,667  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,09KB
2024-04-24T05:17:37,667  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-24T05:17:37,669  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:37,669  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:37,670  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:37,670  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:37,670  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-24T05:17:37,670  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-24T05:17:37,671  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:37,671  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-24T05:17:37,671  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:37,671  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@369f0027, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local572400953_0015/job_local572400953_0015.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@a07e115
2024-04-24T05:17:37,671  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:37,671  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:37,671  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:37,673  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:37,673  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-24T05:17:37,680  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-24T05:17:37,680  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, DESERIALIZE_ERRORS:0, 
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:37,681  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-24T05:17:37,688  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_4:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-24T05:17:37,688  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:37,690  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local572400953_0015_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:37,690  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:37,691  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local572400953_0015_m_000000_0' done.
2024-04-24T05:17:37,691  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local572400953_0015_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=339368
		FILE: Number of bytes written=17835381
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1174929408
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6148
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:37,691  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local572400953_0015_m_000000_0
2024-04-24T05:17:37,691  INFO [Thread-1370] mapred.LocalJobRunner: map task executor complete.
2024-04-24 05:17:38,660 Stage-1 map = 100%,  reduce = 0%
2024-04-24T05:17:38,660  INFO [main] exec.Task: 2024-04-24 05:17:38,660 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local572400953_0015
2024-04-24T05:17:38,662  INFO [main] exec.Task: Ended Job = job_local572400953_0015
2024-04-24T05:17:38,664  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-24T05:17:38,665  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-24T05:17:38,665  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-24T05:17:38,665  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-24T05:17:38,665  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/-ext-10000
2024-04-24T05:17:38,665  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/-ext-10002
2024-04-24T05:17:38,666  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-24T05:17:38,666  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1/-ext-10000
2024-04-24T05:17:38,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:38,675  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:38,685  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,686  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:38,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:38,713  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-24T05:17:38,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:38,723  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,723  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-24T05:17:38,723  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-37_129_4309760981783918145-1/-mr-10001
2024-04-24T05:17:38,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-24T05:17:38,733  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,734  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-24T05:17:38,734  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-24T05:17:38,734  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-24T05:17:38,734  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-24T05:17:38,760  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-24T05:17:38,761  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:38,761  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=53, getTable_(GetTableRequest)=37}
MapReduce Jobs Launched: 
2024-04-24T05:17:38,761  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:38,761  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:38,761  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:38,761  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b); Time taken: 1.396 seconds
2024-04-24T05:17:38,762  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051737_79d3a47c-394a-4675-9237-c6d7ace3229b
2024-04-24T05:17:38,766  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-24T05:17:38,771  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:38,772  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-24T05:17:38,772  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:38,772  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1
2024-04-24T05:17:38,773  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/tstage/.hive-staging_hive_2024-04-24_05-17-37_129_4309760981783918145-1 on fs with scheme file
2024-04-24T05:17:38,773  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-37_129_4309760981783918145-1
2024-04-24T05:17:38,773  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-37_129_4309760981783918145-1 on fs with scheme file
2024-04-24T05:17:38,774  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:38,774  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:38,782  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,784  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-24T05:17:38,785  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-24T05:17:38,787  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:38,796  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,796  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,796  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,796  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,796  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,796  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:38,796  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:38,796  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:38,796  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=18, getCurrentNotificationEventId_()=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2}
2024-04-24T05:17:38,797  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3); Time taken: 0.022 seconds
2024-04-24T05:17:38,797  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3
2024-04-24T05:17:38,797  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3
2024-04-24T05:17:38,813  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3 LockResponse(lockid:12, state:ACQUIRED)
2024-04-24T05:17:38,813  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:38,813  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1'
2024-04-24T05:17:38,813  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:38,813  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,813  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,813  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,813  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1
2024-04-24T05:17:38,823  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:38,828  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:38,828  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:38,828  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3); Time taken: 0.015 seconds
2024-04-24T05:17:38,829  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051738_be53964f-9940-46bd-8877-27fc1db170d3
2024-04-24T05:17:38,832  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-24T05:17:38,838  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:38,838  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-24T05:17:38,839  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:38,839  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:38,839  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:38,851  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,853  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-24T05:17:38,854  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-24T05:17:38,855  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:38,866  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,866  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,866  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,866  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,866  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,866  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:38,866  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:38,866  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:38,866  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=23, getValidTxns_(long)=0, getCurrentNotificationEventId_()=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=9}
2024-04-24T05:17:38,867  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60); Time taken: 0.027 seconds
2024-04-24T05:17:38,867  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60
2024-04-24T05:17:38,867  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60
2024-04-24T05:17:38,881  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60 LockResponse(lockid:13, state:ACQUIRED)
2024-04-24T05:17:38,882  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:38,882  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2'
2024-04-24T05:17:38,882  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:38,882  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,882  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,882  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,882  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2
2024-04-24T05:17:38,892  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:38,896  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:38,896  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:38,897  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60); Time taken: 0.014 seconds
2024-04-24T05:17:38,897  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051738_2c77d0bb-b77b-41f9-a27e-f5d224108d60
2024-04-24T05:17:38,901  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-24T05:17:38,906  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:38,906  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-24T05:17:38,907  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:38,907  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:38,910  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-24T05:17:38,910  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-24T05:17:38,911  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:38,921  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,930  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-24T05:17:38,930  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-24T05:17:38,932  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:38,932  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:38,932  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:38,932  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, allocateTableWriteId_(long, String, String)=7}
2024-04-24T05:17:38,933  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4); Time taken: 0.025 seconds
2024-04-24T05:17:38,933  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4
2024-04-24T05:17:38,933  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4
2024-04-24T05:17:38,947  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4 LockResponse(lockid:14, state:ACQUIRED)
2024-04-24T05:17:38,947  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:38,951  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data' PARTITION (p=2)
2024-04-24T05:17:38,951  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:38,951  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:38,960  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:38,960  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:38,974  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2
2024-04-24T05:17:38,974  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1
2024-04-24T05:17:38,974  INFO [HMSHandler #14] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:39,006  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-24T05:17:39,006  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/1/data
2024-04-24T05:17:39,006  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:39,014  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:39,015  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:39,031  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-24T05:17:39,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:39,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:39,040  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:39,040  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:39,051  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-24T05:17:39,055  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:39,055  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-24T05:17:39,091  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:39,117  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:39,126  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-24T05:17:39,126  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/2/data
2024-04-24T05:17:39,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:39,134  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:39,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:39,145  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-24T05:17:39,145  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:39,145  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:39,154  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:39,154  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:39,164  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-24T05:17:39,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:39,168  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-24T05:17:39,199  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:39,214  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-24T05:17:39,223  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:39,223  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=63, validatePartitionNameCharacters_(List)=0, add_partitions_(List, boolean, boolean)=45, getTable_(GetTableRequest)=44, getValidWriteIds_(List, String)=1, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=108, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:39,224  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4); Time taken: 0.272 seconds
2024-04-24T05:17:39,224  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051738_9715b6a0-60c9-47be-8261-30055bd058a4
2024-04-24T05:17:39,228  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-24T05:17:39,233  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:39,233  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-24T05:17:39,234  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:39,234  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:39,237  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-24T05:17:39,238  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-24T05:17:39,238  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:39,238  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:39,243  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:39,243  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:39,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:39,252  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:39,253  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:39,253  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:39,253  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:39,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:39,298  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:39,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:39,336  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:39,347  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:39,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:39,363  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-24T05:17:39,363  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-24T05:17:39,406  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:39,406  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:39,406  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:39,408  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-39_234_7102571870113503495-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-39_234_7102571870113503495-1
2024-04-24T05:17:39,415  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:39,418  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col3]}
2024-04-24T05:17:39,418  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], VALUE._col0=Column[_col3]}
2024-04-24T05:17:39,419  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:39,419  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:39,428  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:39,428  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:39,429  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:39,429  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:39,429  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:39,429  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:39,429  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T05:17:39,430  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T05:17:39,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:39,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=8, getAllTableConstraints_(AllTableConstraintsRequest)=26, isCompatibleWith_(Configuration)=0, flushCache_()=0, listPartitions_(String, String, short)=25, getAggrColStatsFor_(String, String, List, List, String, String)=26, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=6, getValidTxns_(long)=0}
2024-04-24T05:17:39,430  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a); Time taken: 0.196 seconds
2024-04-24T05:17:39,431  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a
2024-04-24T05:17:39,432  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a
2024-04-24T05:17:39,450  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a LockResponse(lockid:15, state:ACQUIRED)
2024-04-24T05:17:39,450  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:39,450  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:39,451  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a
2024-04-24T05:17:39,451  INFO [main] ql.Driver: Query ID = alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a
Total jobs = 1
2024-04-24T05:17:39,451  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:39,451  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:39,598  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:39,598  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:39,598  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:39,598  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:39,598  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:39,598  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:39,598  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:39,598  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:39,601  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:39,601  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:39,601  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:39,608  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-39_234_7102571870113503495-1/-mr-10004/712664b4-0326-47af-a952-00150a4dbd04 (false)
2024-04-24T05:17:39,617  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:39,618  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,90KB
2024-04-24T05:17:39,622  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:39,623  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T05:17:39,624  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:39,630  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:39,638  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:39,642  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:39,643  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:39,643  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:39,643  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:39,653  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:39,653  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-24T05:17:39,653  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:39,658  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-24T05:17:39,658  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 5 ms
2024-04-24T05:17:39,658  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-24T05:17:39,676  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-24T05:17:39,693  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1862996370_0016
2024-04-24T05:17:39,693  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:39,751  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:39,751  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:39,751  INFO [Thread-1446] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:39,751  INFO [Thread-1446] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:39,753  INFO [Thread-1446] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:39,753  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1862996370_0016_m_000000_0
2024-04-24T05:17:39,754  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:39,755  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:39,755  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:39,756  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-24T05:17:39,757  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:39,758  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:39,762  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:39,762  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:39,762  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:39,762  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:39,762  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:39,762  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:39,763  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:39,764  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:39,765  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:39,765  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:39,765  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T05:17:39,765  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:39,765  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:39,766  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:39,766  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:39,766  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:39,766  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:39,766  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:39,766  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, 
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T05:17:39,767  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:39,778  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:39,781  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1862996370_0016_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:39,782  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:39,782  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1862996370_0016_m_000000_0' done.
2024-04-24T05:17:39,782  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1862996370_0016_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=350377
		FILE: Number of bytes written=19027787
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1174929408
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-24T05:17:39,782  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1862996370_0016_m_000000_0
2024-04-24T05:17:39,782  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1862996370_0016_m_000001_0
2024-04-24T05:17:39,782  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:39,783  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:39,783  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:39,784  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-24T05:17:39,785  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:39,785  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:39,800  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:39,801  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:39,801  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:39,801  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:39,801  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:39,801  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:39,801  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:39,803  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:39,804  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T05:17:39,805  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:39,813  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:39,816  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1862996370_0016_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:39,817  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:39,817  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1862996370_0016_m_000001_0' done.
2024-04-24T05:17:39,817  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1862996370_0016_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=357966
		FILE: Number of bytes written=19028203
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=9
		Total committed heap usage (bytes)=1177550848
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-24T05:17:39,817  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1862996370_0016_m_000001_0
2024-04-24T05:17:39,817  INFO [Thread-1446] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:39,818  INFO [Thread-1446] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:39,818  INFO [pool-81-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1862996370_0016_r_000000_0
2024-04-24T05:17:39,818  INFO [pool-81-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:39,818  INFO [pool-81-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@d383544
2024-04-24T05:17:39,819  WARN [pool-81-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:39,820  INFO [pool-81-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:39,820  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1862996370_0016_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:39,825  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local1862996370_0016_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-24T05:17:39,825  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local1862996370_0016_m_000000_0
2024-04-24T05:17:39,825  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-24T05:17:39,827  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local1862996370_0016_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-24T05:17:39,828  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local1862996370_0016_m_000001_0
2024-04-24T05:17:39,828  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-24T05:17:39,828  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:39,828  INFO [pool-81-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:39,828  INFO [pool-81-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:39,836  INFO [pool-81-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-24T05:17:39,836  INFO [pool-81-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 714 bytes
2024-04-24T05:17:39,839  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 760 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:39,839  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merging 1 files, 762 bytes from disk
2024-04-24T05:17:39,839  INFO [pool-81-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:39,839  INFO [pool-81-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:39,839  INFO [pool-81-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 735 bytes
2024-04-24T05:17:39,839  INFO [pool-81-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-24T05:17:39,840  INFO [pool-81-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:39,840  INFO [pool-81-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T05:17:39,841  INFO [pool-81-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:39,841  INFO [pool-81-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:39,841  INFO [pool-81-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-24T05:17:39,841  INFO [pool-81-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:39,842  INFO [pool-81-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@26a361a3, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@4b8eeca7>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@68671256, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@ad4f26a
2024-04-24T05:17:39,842  INFO [pool-81-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-39_234_7102571870113503495-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-39_234_7102571870113503495-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:39,842  INFO [pool-81-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-39_234_7102571870113503495-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-39_234_7102571870113503495-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:39,842  INFO [pool-81-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-39_234_7102571870113503495-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-39_234_7102571870113503495-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:39,849  INFO [pool-81-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:39,849  INFO [pool-81-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:39,849  INFO [pool-81-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:39,849  INFO [pool-81-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:39,849  INFO [pool-81-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-24T05:17:39,849  INFO [pool-81-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-24T05:17:39,850  INFO [pool-81-thread-1] mapred.Task: Task:attempt_local1862996370_0016_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:39,850  INFO [pool-81-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:39,850  INFO [pool-81-thread-1] mapred.Task: Task 'attempt_local1862996370_0016_r_000000_0' done.
2024-04-24T05:17:39,850  INFO [pool-81-thread-1] mapred.Task: Final Counters for attempt_local1862996370_0016_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=365509
		FILE: Number of bytes written=19029784
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=768
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1177550848
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:39,850  INFO [pool-81-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1862996370_0016_r_000000_0
2024-04-24T05:17:39,850  INFO [Thread-1446] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:40,754 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:40,754  INFO [main] exec.Task: 2024-04-24 05:17:40,754 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1862996370_0016
2024-04-24T05:17:40,756  INFO [main] exec.Task: Ended Job = job_local1862996370_0016
2024-04-24T05:17:40,757  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:40,757  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:40,758  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:40,758  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:40,758  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:40,758  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a); Time taken: 1.307 seconds
2024-04-24T05:17:40,758  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051739_2d82acb8-f273-4ab7-8429-4168996da61a
2024-04-24T05:17:40,762  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-24T05:17:40,769  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:40,769  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-24T05:17:40,773  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:40,774  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T05:17:40,774  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:4, 
2024-04-24T05:17:40,774  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 parts w/data and 1 empty): 
2024-04-24T05:17:40,774  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-24T05:17:40,774  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:40,775  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-39_234_7102571870113503495-1
2024-04-24T05:17:40,776  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-39_234_7102571870113503495-1 on fs with scheme file
2024-04-24T05:17:40,776  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051740_00ab6f53-e98e-4bb0-beff-08d681f36e19): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:40,779  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-24T05:17:40,779  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-24T05:17:40,780  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:40,783  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:40,783  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:40,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:40,794  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:40,794  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:40,794  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:40,795  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:40,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:40,818  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:40,820  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:40,841  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:40,853  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:40,854  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:40,867  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:40,867  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:40,915  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:40,915  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:40,915  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:40,917  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:40,920  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T05:17:40,920  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], VALUE._col0=Column[_col3], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T05:17:40,921  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:40,937  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:40,947  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:40,948  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:40,948  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:40,949  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:40,949  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:40,949  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:40,949  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getAggrColStatsFor_(String, String, List, List, String, String)=25, listPartitions_(String, String, short)=11, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=5, commitTxn_(CommitTxnRequest)=11, getValidWriteIds_(List, String)=4}
2024-04-24T05:17:40,949  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051740_00ab6f53-e98e-4bb0-beff-08d681f36e19); Time taken: 0.173 seconds
2024-04-24T05:17:40,950  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051740_00ab6f53-e98e-4bb0-beff-08d681f36e19): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:40,950  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:40,960  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:40,960  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:40,960  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051740_00ab6f53-e98e-4bb0-beff-08d681f36e19); Time taken: 0.01 seconds
2024-04-24T05:17:40,960  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:40,966  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-24T05:17:40,973  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:40,974  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-24T05:17:40,974  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:40,975  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-40_776_4427842921238777933-1
2024-04-24T05:17:40,975  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-40_776_4427842921238777933-1 on fs with scheme file
2024-04-24T05:17:40,975  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:40,976  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:40,985  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:40,989  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-24T05:17:40,989  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-24T05:17:40,992  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-24T05:17:41,002  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,002  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,002  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,002  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,002  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,003  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:41,003  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:41,003  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:41,003  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=20, getCurrentNotificationEventId_()=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, flushCache_()=0}
2024-04-24T05:17:41,003  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e); Time taken: 0.028 seconds
2024-04-24T05:17:41,003  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e
2024-04-24T05:17:41,004  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e
2024-04-24T05:17:41,020  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e LockResponse(lockid:16, state:ACQUIRED)
2024-04-24T05:17:41,020  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-24T05:17:41,020  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3'
2024-04-24T05:17:41,020  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-24T05:17:41,020  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,020  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,020  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,020  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3
2024-04-24T05:17:41,031  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-24T05:17:41,036  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:41,036  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:41,037  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e); Time taken: 0.016 seconds
2024-04-24T05:17:41,037  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051740_49f44de7-eea9-4f79-bf0a-be78e036d38e
2024-04-24T05:17:41,041  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-24T05:17:41,049  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:41,049  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-24T05:17:41,050  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:41,053  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-24T05:17:41,053  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-24T05:17:41,054  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:41,064  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,074  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-24T05:17:41,075  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-24T05:17:41,075  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:41,075  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:41,075  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:41,076  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, allocateTableWriteId_(long, String, String)=10, getTable_(GetTableRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-24T05:17:41,076  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017); Time taken: 0.025 seconds
2024-04-24T05:17:41,076  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017
2024-04-24T05:17:41,076  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017
2024-04-24T05:17:41,093  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017 LockResponse(lockid:17, state:ACQUIRED)
2024-04-24T05:17:41,093  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:41,098  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:41,098  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:41,098  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:41,108  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,108  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:41,130 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-24T05:17:41,130 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-24T05:17:41,131 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-24T05:17:41,132 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:41,133 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-24T05:17:41,133  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:41,133  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-24T05:17:41,133  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017); Time taken: 0.035 seconds
2024-04-24T05:17:41,133  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051741_53e9f11e-bf0e-451c-8883-2debee0fd017
2024-04-24T05:17:41,136  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:41,144  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:41,144  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:41,147  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-24T05:17:41,147  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-24T05:17:41,148  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-24T05:17:41,158  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,159  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-24T05:17:41,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-24T05:17:41,182  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:41,194  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-24T05:17:41,194  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-24T05:17:41,195  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:41,195  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:41,195  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:41,195  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {rollbackTxn_(long)=10, getValidTxns_(long)=1, allocateTableWriteId_(long, String, String)=7, isCompatibleWith_(Configuration)=0, flushCache_()=0, getPartitionWithAuthInfo_(String, String, List, String, List)=21, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=10}
2024-04-24T05:17:41,195  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d); Time taken: 0.051 seconds
2024-04-24T05:17:41,195  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d
2024-04-24T05:17:41,195  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d
2024-04-24T05:17:41,210  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d LockResponse(lockid:18, state:ACQUIRED)
2024-04-24T05:17:41,210  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-24T05:17:41,218  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data'
2024-04-24T05:17:41,218  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:41,219  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:41,228  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-24T05:17:41,238  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:41,241  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-24T05:17:41,242  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3
2024-04-24T05:17:41,267  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-24T05:17:41,268  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/3/data
2024-04-24T05:17:41,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:41,277  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,278  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:41,289  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-24T05:17:41,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-24T05:17:41,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:41,299  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:41,309  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-24T05:17:41,313  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-24T05:17:41,313  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-24T05:17:41,502  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-24T05:17:41,526  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-24T05:17:41,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:41,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {add_partitions_(List, boolean, boolean)=39, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=213, getPartitionWithAuthInfo_(String, String, List, String, List)=30, validatePartitionNameCharacters_(List)=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=0, getTable_(GetTableRequest)=28}
2024-04-24T05:17:41,536  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d); Time taken: 0.318 seconds
2024-04-24T05:17:41,536  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051741_235c00c9-9372-4172-95ae-42d41c2ea41d
2024-04-24T05:17:41,540  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-24T05:17:41,544  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:41,545  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-24T05:17:41,545  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:41,546  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:41,548  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-24T05:17:41,549  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-24T05:17:41,549  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-24T05:17:41,549  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:41,555  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:41,555  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:41,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:41,565  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,565  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:41,565  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:41,565  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:41,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:41,609  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:41,609  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:41,652  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:41,663  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:41,663  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:41,681  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:41,681  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:41,724  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:41,724  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:41,724  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:41,725  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-41_546_3319816582442783980-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-41_546_3319816582442783980-1
2024-04-24T05:17:41,732  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:41,735  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-24T05:17:41,735  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2]}
2024-04-24T05:17:41,736  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:41,737  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:41,746  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:41,747  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:41,747  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:41,747  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-24T05:17:41,748  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:41,748  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-24T05:17:41,749  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-24T05:17:41,749  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:41,749  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAggrColStatsFor_(String, String, List, List, String, String)=29, getValidWriteIds_(List, String)=4, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=10, flushCache_()=0, listPartitions_(String, String, short)=25, openTxn_(String, TxnType)=2, getAllTableConstraints_(AllTableConstraintsRequest)=24, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:41,749  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102); Time taken: 0.203 seconds
2024-04-24T05:17:41,749  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102
2024-04-24T05:17:41,750  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102
2024-04-24T05:17:41,770  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102 LockResponse(lockid:19, state:ACQUIRED)
2024-04-24T05:17:41,770  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-24T05:17:41,771  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:41,772  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102
2024-04-24T05:17:41,772  INFO [main] ql.Driver: Query ID = alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102
Total jobs = 1
2024-04-24T05:17:41,772  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-24T05:17:41,772  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-24T05:17:41,922  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-24T05:17:41,922  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-24T05:17:41,922  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-24T05:17:41,922  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-24T05:17:41,922  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-24T05:17:41,922  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-24T05:17:41,922  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-24T05:17:41,922  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-24T05:17:41,925  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-24T05:17:41,925  INFO [main] exec.Utilities: Processing alias t
2024-04-24T05:17:41,925  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:41,932  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-41_546_3319816582442783980-1/-mr-10004/ca47139a-9ecd-4da0-af7f-41f9b93eb7bc (false)
2024-04-24T05:17:41,940  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-24T05:17:41,941  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T05:17:41,946  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-24T05:17:41,947  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T05:17:41,948  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:41,954  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:41,961  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-24T05:17:41,965  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-24T05:17:41,966  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-24T05:17:41,966  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-24T05:17:41,966  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0
2024-04-24T05:17:41,976  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-24T05:17:41,976  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-24T05:17:41,976  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-24T05:17:41,982  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-24T05:17:41,982  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 6 ms
2024-04-24T05:17:41,982  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-24T05:17:42,000  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-24T05:17:42,018  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local833314728_0017
2024-04-24T05:17:42,018  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-24T05:17:42,077  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-24T05:17:42,077  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-24T05:17:42,077  INFO [Thread-1540] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:42,077  INFO [Thread-1540] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-24T05:17:42,079  INFO [Thread-1540] mapred.LocalJobRunner: Waiting for map tasks
2024-04-24T05:17:42,080  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local833314728_0017_m_000000_0
2024-04-24T05:17:42,080  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:42,081  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:42,081  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:42,082  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T05:17:42,083  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:42,083  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:42,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:42,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:42,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:42,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:42,087  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:42,088  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:42,088  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:42,090  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:42,090  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:42,090  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:42,090  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T05:17:42,090  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:42,090  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:42,091  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T05:17:42,092  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:42,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:42,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:42,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T05:17:42,092  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:42,106  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:42,113  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local833314728_0017_m_000000_0 is done. And is in the process of committing
2024-04-24T05:17:42,114  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:42,115  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local833314728_0017_m_000000_0' done.
2024-04-24T05:17:42,115  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local833314728_0017_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=380645
		FILE: Number of bytes written=20219263
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1294467072
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-24T05:17:42,115  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local833314728_0017_m_000000_0
2024-04-24T05:17:42,115  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local833314728_0017_m_000001_0
2024-04-24T05:17:42,116  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:42,117  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:42,118  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:42,119  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T05:17:42,122  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:42,124  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:42,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:42,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:42,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:42,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:42,136  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:42,137  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:42,138  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:42,141  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:42,142  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:42,142  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:42,142  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T05:17:42,142  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:42,142  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:42,142  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:42,142  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:42,143  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-24T05:17:42,144  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:42,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:42,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:42,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T05:17:42,144  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:42,153  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:42,156  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local833314728_0017_m_000001_0 is done. And is in the process of committing
2024-04-24T05:17:42,157  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:42,157  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local833314728_0017_m_000001_0' done.
2024-04-24T05:17:42,157  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local833314728_0017_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=389116
		FILE: Number of bytes written=20219679
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1294467072
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-24T05:17:42,157  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local833314728_0017_m_000001_0
2024-04-24T05:17:42,157  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local833314728_0017_m_000002_0
2024-04-24T05:17:42,157  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:42,158  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-24T05:17:42,158  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-24T05:17:42,158  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-24T05:17:42,160  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-24T05:17:42,160  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-24T05:17:42,164  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-24T05:17:42,164  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-24T05:17:42,164  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-24T05:17:42,164  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-24T05:17:42,164  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-24T05:17:42,165  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-24T05:17:42,165  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-24T05:17:42,167  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-24T05:17:42,168  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-24T05:17:42,169  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-24T05:17:42,177  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-24T05:17:42,180  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local833314728_0017_m_000002_0 is done. And is in the process of committing
2024-04-24T05:17:42,181  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-24T05:17:42,181  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local833314728_0017_m_000002_0' done.
2024-04-24T05:17:42,181  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local833314728_0017_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=397075
		FILE: Number of bytes written=20220095
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1294467072
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-24T05:17:42,181  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local833314728_0017_m_000002_0
2024-04-24T05:17:42,181  INFO [Thread-1540] mapred.LocalJobRunner: map task executor complete.
2024-04-24T05:17:42,182  INFO [Thread-1540] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-24T05:17:42,182  INFO [pool-86-thread-1] mapred.LocalJobRunner: Starting task: attempt_local833314728_0017_r_000000_0
2024-04-24T05:17:42,182  INFO [pool-86-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-24T05:17:42,183  INFO [pool-86-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@56dd7887
2024-04-24T05:17:42,183  WARN [pool-86-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-24T05:17:42,183  INFO [pool-86-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-24T05:17:42,184  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local833314728_0017_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-24T05:17:42,187  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local833314728_0017_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-24T05:17:42,187  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local833314728_0017_m_000000_0
2024-04-24T05:17:42,187  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-24T05:17:42,190  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local833314728_0017_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-24T05:17:42,191  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local833314728_0017_m_000001_0
2024-04-24T05:17:42,191  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-24T05:17:42,194  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local833314728_0017_m_000002_0 decomp: 380 len: 384 to MEMORY
2024-04-24T05:17:42,195  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local833314728_0017_m_000002_0
2024-04-24T05:17:42,195  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 3, commitMemory -> 760, usedMemory ->1140
2024-04-24T05:17:42,196  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-24T05:17:42,196  INFO [pool-86-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:42,196  INFO [pool-86-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-24T05:17:42,209  INFO [pool-86-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-24T05:17:42,209  INFO [pool-86-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1071 bytes
2024-04-24T05:17:42,216  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1140 bytes to disk to satisfy reduce memory limit
2024-04-24T05:17:42,216  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1140 bytes from disk
2024-04-24T05:17:42,216  INFO [pool-86-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-24T05:17:42,216  INFO [pool-86-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-24T05:17:42,216  INFO [pool-86-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1113 bytes
2024-04-24T05:17:42,217  INFO [pool-86-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-24T05:17:42,218  INFO [pool-86-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-24T05:17:42,219  INFO [pool-86-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-24T05:17:42,222  INFO [pool-86-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-24T05:17:42,222  INFO [pool-86-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-24T05:17:42,222  INFO [pool-86-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-24T05:17:42,222  INFO [pool-86-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-24T05:17:42,223  INFO [pool-86-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@53928d20, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@62243a7a,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@4b8eeca7>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@33303942, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@1a50fa4e
2024-04-24T05:17:42,224  INFO [pool-86-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-41_546_3319816582442783980-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-41_546_3319816582442783980-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:42,224  INFO [pool-86-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-41_546_3319816582442783980-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-41_546_3319816582442783980-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-24T05:17:42,224  INFO [pool-86-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-41_546_3319816582442783980-1/-mr-10001/.hive-staging_hive_2024-04-24_05-17-41_546_3319816582442783980-1/_tmp.-ext-10002/000000_0
2024-04-24T05:17:42,244  INFO [pool-86-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-24T05:17:42,245  INFO [pool-86-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-24T05:17:42,246  INFO [pool-86-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:42,246  INFO [pool-86-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-24T05:17:42,246  INFO [pool-86-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-24T05:17:42,247  INFO [pool-86-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_0:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:42,248  INFO [pool-86-thread-1] mapred.Task: Task:attempt_local833314728_0017_r_000000_0 is done. And is in the process of committing
2024-04-24T05:17:42,249  INFO [pool-86-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-24T05:17:42,249  INFO [pool-86-thread-1] mapred.Task: Task 'attempt_local833314728_0017_r_000000_0' done.
2024-04-24T05:17:42,249  INFO [pool-86-thread-1] mapred.Task: Final Counters for attempt_local833314728_0017_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=405412
		FILE: Number of bytes written=20222416
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1152
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1294467072
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-24T05:17:42,249  INFO [pool-86-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local833314728_0017_r_000000_0
2024-04-24T05:17:42,249  INFO [Thread-1540] mapred.LocalJobRunner: reduce task executor complete.
2024-04-24 05:17:43,081 Stage-1 map = 100%,  reduce = 100%
2024-04-24T05:17:43,081  INFO [main] exec.Task: 2024-04-24 05:17:43,081 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local833314728_0017
2024-04-24T05:17:43,083  INFO [main] exec.Task: Ended Job = job_local833314728_0017
2024-04-24T05:17:43,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-24T05:17:43,085  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-24T05:17:43,085  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:43,085  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-24T05:17:43,085  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102); Time taken: 1.314 seconds
2024-04-24T05:17:43,085  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051741_5de7b75c-0035-4560-903c-03b1b23a2102
2024-04-24T05:17:43,089  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-24T05:17:43,094  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,096  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-24T05:17:43,100  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-24T05:17:43,100  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-24T05:17:43,101  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-24T05:17:43,101  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 existing parts and 1 empty): 
2024-04-24T05:17:43,101  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713961005720/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-24T05:17:43,101  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:43,101  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-41_546_3319816582442783980-1
2024-04-24T05:17:43,102  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-41_546_3319816582442783980-1 on fs with scheme file
2024-04-24T05:17:43,102  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051743_2f8dd5fd-0028-4647-b7f1-baa7ab1668cd): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:43,111  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-24T05:17:43,111  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-24T05:17:43,113  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-24T05:17:43,116  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-24T05:17:43,116  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:43,116  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:43,126  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,126  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:43,126  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:43,126  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-24T05:17:43,140  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-24T05:17:43,149  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-24T05:17:43,149  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-24T05:17:43,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-24T05:17:43,189  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,189  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-24T05:17:43,202  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-24T05:17:43,202  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-24T05:17:43,247  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-24T05:17:43,247  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-24T05:17:43,247  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-24T05:17:43,249  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-24T05:17:43,252  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col3], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T05:17:43,252  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1]}
2024-04-24T05:17:43,253  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-24T05:17:43,273  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-24T05:17:43,282  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-24T05:17:43,282  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:43,282  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-24T05:17:43,282  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-24T05:17:43,282  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-24T05:17:43,282  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-24T05:17:43,283  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-24T05:17:43,283  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-24T05:17:43,283  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:43,283  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-24T05:17:43,283  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:43,283  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, getValidWriteIds_(List, String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, getAllTableConstraints_(AllTableConstraintsRequest)=5, getAggrColStatsFor_(String, String, List, List, String, String)=24, getValidTxns_(long)=2, commitTxn_(CommitTxnRequest)=10, listPartitions_(String, String, short)=9}
2024-04-24T05:17:43,284  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051743_2f8dd5fd-0028-4647-b7f1-baa7ab1668cd); Time taken: 0.181 seconds
2024-04-24T05:17:43,284  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051743_2f8dd5fd-0028-4647-b7f1-baa7ab1668cd): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-24T05:17:43,284  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-24T05:17:43,294  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,294  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-24T05:17:43,295  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051743_2f8dd5fd-0028-4647-b7f1-baa7ab1668cd); Time taken: 0.01 seconds
2024-04-24T05:17:43,295  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-24T05:17:43,299  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-24T05:17:43,303  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,303  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-24T05:17:43,304  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-24T05:17:43,305  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-43_102_3626816750213652680-1
2024-04-24T05:17:43,305  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/a7f658ac-5d4c-4f82-8dc9-2f095425154d/hive_2024-04-24_05-17-43_102_3626816750213652680-1 on fs with scheme file
2024-04-24T05:17:43,305  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523): drop table if exists acidTbl
2024-04-24T05:17:43,307  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-24T05:17:43,307  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-24T05:17:43,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:43,314  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,314  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:43,314  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:43,314  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:43,314  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=6, flushCache_()=0, openTxn_(String, TxnType)=1}
2024-04-24T05:17:43,315  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523); Time taken: 0.009 seconds
2024-04-24T05:17:43,315  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523
2024-04-24T05:17:43,315  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523
2024-04-24T05:17:43,327  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523 LockResponse(lockid:20, state:ACQUIRED)
2024-04-24T05:17:43,327  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:43,328  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523): drop table if exists acidTbl
2024-04-24T05:17:43,328  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:43,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:43,334  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:43,341  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-24T05:17:43,423  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,423  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=89, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=6}
2024-04-24T05:17:43,424  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523); Time taken: 0.096 seconds
2024-04-24T05:17:43,424  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051743_340573e9-8190-43e5-8a51-53c658daf523
2024-04-24T05:17:43,427  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-24T05:17:43,431  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,431  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-24T05:17:43,432  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-24T05:17:43,432  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa): drop table if exists acidTblPart
2024-04-24T05:17:43,434  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-24T05:17:43,434  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-24T05:17:43,435  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:43,441  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,441  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:43,441  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:43,441  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:43,442  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=8, getValidTxns_(long)=1, getTable_(GetTableRequest)=6, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2}
2024-04-24T05:17:43,442  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa); Time taken: 0.009 seconds
2024-04-24T05:17:43,442  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa
2024-04-24T05:17:43,443  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa
2024-04-24T05:17:43,457  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa LockResponse(lockid:21, state:ACQUIRED)
2024-04-24T05:17:43,457  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:43,457  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa): drop table if exists acidTblPart
2024-04-24T05:17:43,457  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:43,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:43,464  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:43,471  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-24T05:17:43,509  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,509  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=45, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-24T05:17:43,509  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa); Time taken: 0.052 seconds
2024-04-24T05:17:43,509  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051743_6eb37c3a-6815-4a38-9d23-a8adbb565baa
2024-04-24T05:17:43,512  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-24T05:17:43,516  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,517  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-24T05:17:43,517  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-24T05:17:43,517  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051743_38e6ecdf-878c-47f7-9ad8-48737ca76411): drop table if exists acidTbl2
2024-04-24T05:17:43,519  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-24T05:17:43,520  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-24T05:17:43,520  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:43,520  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:43,520  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:43,520  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=8, getTable_(GetTableRequest)=0, openTxn_(String, TxnType)=1, getValidTxns_(long)=0, flushCache_()=0}
2024-04-24T05:17:43,521  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051743_38e6ecdf-878c-47f7-9ad8-48737ca76411); Time taken: 0.003 seconds
2024-04-24T05:17:43,521  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240424051743_38e6ecdf-878c-47f7-9ad8-48737ca76411
2024-04-24T05:17:43,521  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-24T05:17:43,521  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051743_38e6ecdf-878c-47f7-9ad8-48737ca76411): drop table if exists acidTbl2
2024-04-24T05:17:43,521  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:43,522  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-24T05:17:43,522  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,522  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-24T05:17:43,522  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051743_38e6ecdf-878c-47f7-9ad8-48737ca76411); Time taken: 0.001 seconds
2024-04-24T05:17:43,522  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051743_38e6ecdf-878c-47f7-9ad8-48737ca76411
2024-04-24T05:17:43,526  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-24T05:17:43,530  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,530  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-24T05:17:43,531  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-24T05:17:43,531  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:43,533  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-24T05:17:43,533  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-24T05:17:43,534  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:43,553  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,553  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:43,553  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:43,553  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:43,553  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=19, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=8, openTxn_(String, TxnType)=1}
2024-04-24T05:17:43,554  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681); Time taken: 0.022 seconds
2024-04-24T05:17:43,554  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681
2024-04-24T05:17:43,554  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681
2024-04-24T05:17:43,568  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681 LockResponse(lockid:22, state:ACQUIRED)
2024-04-24T05:17:43,568  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:43,569  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681): drop table if exists nonAcidOrcTbl
2024-04-24T05:17:43,569  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:43,569  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:43,578  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:43,587  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-24T05:17:43,657  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,657  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=79, getTable_(GetTableRequest)=9}
2024-04-24T05:17:43,657  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681); Time taken: 0.089 seconds
2024-04-24T05:17:43,657  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051743_0b0619d1-3534-4d28-b5ae-4a2505475681
2024-04-24T05:17:43,661  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-24T05:17:43,668  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,668  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-24T05:17:43,669  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:43,669  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:43,671  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-24T05:17:43,671  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-24T05:17:43,672  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:43,681  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,681  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:43,681  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:43,682  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:43,682  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-24T05:17:43,682  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f); Time taken: 0.013 seconds
2024-04-24T05:17:43,682  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f
2024-04-24T05:17:43,683  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f
2024-04-24T05:17:43,697  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f LockResponse(lockid:23, state:ACQUIRED)
2024-04-24T05:17:43,697  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:43,697  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f): drop table if exists nonAcidOrcTbl2
2024-04-24T05:17:43,697  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:43,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:43,707  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:43,716  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,716  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-24T05:17:43,750  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,750  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=43, getTable_(GetTableRequest)=10}
2024-04-24T05:17:43,750  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f); Time taken: 0.053 seconds
2024-04-24T05:17:43,750  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051743_df831e15-9e84-4735-8caf-36eb116eb81f
2024-04-24T05:17:43,754  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-24T05:17:43,760  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,760  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-24T05:17:43,761  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-24T05:17:43,761  INFO [main] ql.Driver: Compiling command(queryId=alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae): drop table if exists nonAcidNonBucket
2024-04-24T05:17:43,763  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-24T05:17:43,764  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-24T05:17:43,764  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:43,774  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,774  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-24T05:17:43,774  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-24T05:17:43,774  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-24T05:17:43,774  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-24T05:17:43,774  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae); Time taken: 0.013 seconds
2024-04-24T05:17:43,774  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae
2024-04-24T05:17:43,775  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae
2024-04-24T05:17:43,789  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae LockResponse(lockid:24, state:ACQUIRED)
2024-04-24T05:17:43,789  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-24T05:17:43,789  INFO [main] ql.Driver: Executing command(queryId=alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae): drop table if exists nonAcidNonBucket
2024-04-24T05:17:43,789  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-24T05:17:43,789  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:43,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:43,807  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-24T05:17:43,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-24T05:17:43,844  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-24T05:17:43,845  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=46, getTable_(GetTableRequest)=9}
2024-04-24T05:17:43,845  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae); Time taken: 0.055 seconds
2024-04-24T05:17:43,845  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240424051743_d42ca0b8-810b-462d-afd9-31d1a2fa95ae
2024-04-24T05:17:43,849  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-24T05:17:43,855  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-24T05:17:43,855  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-24T05:17:43,856  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-24T05:17:43,895  INFO [pool-2-thread-1] lockmgr.DbTxnManager: Shutting down Heartbeater thread pool.
