[DEBUG] 2024-04-23 22:53:59.264 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.289 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 22:53:59.290 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 22:53:59.290 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 22:53:59.291 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 22:53:59.292 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 22:53:59.293 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 22:53:59.293 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 22:53:59.295 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 22:53:59.295 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:59.295 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 22:53:59.296 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 22:53:59.296 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 22:53:59.297 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 22:53:59.298 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 22:53:59.299 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 22:53:59.300 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 22:53:59.300 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 22:53:59.301 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 22:53:59.302 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1941639991 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:59.302 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 22:53:59.302 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.305 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:59.305 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.306 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:53:59.310 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:53:59.315 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:53:59.315 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:53:59.322 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:53:59.323 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:53:59.332 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:53:59.334 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.334 [main] PerfLogger - </PERFLOG method=open_txns start=1713909239264 end=1713909239334 duration=70 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.336 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.342 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:53:59.346 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 22:53:59.346 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 22:53:59.346 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 22:53:59.346 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 22:53:59.346 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:53:59.358 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:53:59.358 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:53:59.361 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:53:59.361 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 10 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 22:53:59.364 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
[DEBUG] 2024-04-23 22:53:59.367 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:59.367 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 22:53:59.368 [main] RetryingHMSHandler - java.lang.IllegalStateException: Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1773)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyValueNoTableId(TestHiveMetaStoreTxns.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 22:53:59.368 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909239336 end=1713909239368 duration=32 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:53:59.368 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.369 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:53:59.372 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 22:53:59.373 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:59.373 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.376 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909239368 end=1713909239376 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:53:59.377 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:53:59.381 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:53:59.383 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:53:59.386 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:53:59.388 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:53:59.390 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:53:59.392 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:53:59.394 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:53:59.396 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 22:53:59.396 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:53:59.397 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@856914852 (XID = 1615), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.399 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1915646367 (XID = 1617), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.400 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:53:59.400 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1133953751 (XID = 1622), (SESSIONID = 35), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.401 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@302091984 (XID = 1625), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.402 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 22:53:59.402 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@239051128 (XID = 1627), (SESSIONID = 39), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.403 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:53:59.404 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@374337632 (XID = 1632), (SESSIONID = 43), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.404 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1605200882 (XID = 1631), (SESSIONID = 42), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.406 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@512778697 (XID = 1636), (SESSIONID = 47), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.406 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1280211801 (XID = 1637), (SESSIONID = 46), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.407 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@792991802 (XID = 1639), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.408 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@422902704 (XID = 1641), (SESSIONID = 51), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.408 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:53:59.409 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1353562012 (XID = 1647), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.409 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2126487174 (XID = 1646), (SESSIONID = 54), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.409 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 22:53:59.410 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2058242254 (XID = 1649), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.411 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:53:59.412 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2062648472 (XID = 1653), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.413 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@666660232 (XID = 1655), (SESSIONID = 61), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.414 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:53:59.414 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1793683531 (XID = 1658), (SESSIONID = 63), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.416 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1689197729 (XID = 1661), (SESSIONID = 65), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.416 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 22:53:59.417 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:53:59.419 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:53:59.433 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.433 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:53:59.436 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:53:59.438 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:53:59.438 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:53:59.443 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:53:59.443 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:53:59.443 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:53:59.443 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.443 [main] PerfLogger - </PERFLOG method=open_txns start=1713909239433 end=1713909239443 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.444 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.444 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:53:59.447 [main] TxnHandler - Going to execute query <SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE" FROM "TXNS" WHERE "TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:53:59.450 [main] TxnHandler - Going to execute query <SELECT "CTC_TXNID" FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_TXNID" in (1)>
[ERROR] 2024-04-23 22:53:59.452 [main] TxnHandler - Write ID allocation on db.tbl failed for input txns: {1,read-only}
[DEBUG] 2024-04-23 22:53:59.452 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:59.452 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 22:53:59.452 [main] RetryingHMSHandler - java.lang.IllegalStateException: Write ID allocation failed on db.tbl as not all input txns in open state or read-only
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.allocateTableWriteIds(TxnHandler.java:2140)
	at org.apache.hadoop.hive.metastore.HMSHandler.allocate_table_write_ids(HMSHandler.java:8821)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.allocate_table_write_ids(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatchIntr(HiveMetaStoreClient.java:4033)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatch(HiveMetaStoreClient.java:4020)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteId(HiveMetaStoreClient.java:4012)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testAllocateTableWriteIdForReadOnlyTxn(TestHiveMetaStoreTxns.java:360)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 22:53:59.453 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713909239444 end=1713909239453 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[INFO ] 2024-04-23 22:53:59.453 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:53:59.456 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:53:59.456 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:53:59.458 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:53:59.459 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:53:59.459 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:53:59.459 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:53:59.459 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:53:59.459 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:53:59.460 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:53:59.460 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:53:59.460 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:53:59.460 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:53:59.461 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:53:59.461 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:53:59.461 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:53:59.470 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.471 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:53:59.473 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:53:59.476 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:53:59.477 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:53:59.479 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:53:59.480 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:53:59.480 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:53:59.480 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.480 [main] PerfLogger - </PERFLOG method=open_txns start=1713909239470 end=1713909239480 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.482 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.482 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 22:53:59.482 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 22:53:59.482 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.483 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.483 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.483 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.484 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.153589ms
[DEBUG] 2024-04-23 22:53:59.484 [main] ObjectStore - Failed to get database hive.mydbKeyValueWrongPrefix, returning NoSuchObjectException
[DEBUG] 2024-04-23 22:53:59.484 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 22:53:59.485 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.485 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.486 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.487 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 22:53:59.489 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 22:53:59.491 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 22:53:59.529 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 22:53:59.529 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.529 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.532 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.532 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.533 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.533 [main] PerfLogger - </PERFLOG method=create_database start=1713909239482 end=1713909239533 duration=51 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.539 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.539 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713909239, lastAccessTime:1713909239, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 22:53:59.540 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713909239, lastAccessTime:1713909239, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 22:53:59.540 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.550 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.550 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.550 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.550 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.550 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 10.408008ms
[DEBUG] 2024-04-23 22:53:59.551 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.551 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.551 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 22:53:59.561 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.561 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.561 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.563 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.563 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.564 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.564 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.564 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.564 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.324247ms
[DEBUG] 2024-04-23 22:53:59.564 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.564 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.564 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 22:53:59.565 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.565 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 22:53:59.566 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[DEBUG] 2024-04-23 22:53:59.571 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.571 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.577 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.584 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.592 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.598 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.603 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.622 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.622 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.625 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.626 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909239539 end=1713909239626 duration=87 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.627 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.628 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 22:53:59.628 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 22:53:59.628 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.629 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.629 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.629 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.629 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.629 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.130678ms
[DEBUG] 2024-04-23 22:53:59.629 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.629 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.629 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 22:53:59.646 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.689 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.690 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:59.691 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 22:53:59.692 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909239627 end=1713909239692 duration=65 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.693 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=66, comments=HMS client
[DEBUG] 2024-04-23 22:53:59.693 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.695 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:53:59.696 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 22:53:59.696 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 22:53:59.696 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 22:53:59.696 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 22:53:59.696 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:53:59.698 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:53:59.699 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:53:59.699 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 22:53:59.699 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
[DEBUG] 2024-04-23 22:53:59.699 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:59.699 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 22:53:59.700 [main] RetryingHMSHandler - java.lang.IllegalArgumentException: Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1756)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyWrongPrefix(TestHiveMetaStoreTxns.java:206)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 22:53:59.700 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909239693 end=1713909239700 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:53:59.700 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.700 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 22:53:59.700 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 22:53:59.700 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.701 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.701 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.701 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.702 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.702 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.348644ms
[DEBUG] 2024-04-23 22:53:59.702 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.702 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.702 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 22:53:59.705 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.709 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.710 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:59.711 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 22:53:59.712 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909239700 end=1713909239712 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.712 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[DEBUG] 2024-04-23 22:53:59.712 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.712 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 22:53:59.712 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 22:53:59.712 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.712 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.713 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.713 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.713 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.714 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.269588ms
[DEBUG] 2024-04-23 22:53:59.714 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.715 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.715 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.715 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.715 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.133221ms
[DEBUG] 2024-04-23 22:53:59.715 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.715 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.715 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 22:53:59.718 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.723 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.723 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.727 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.728 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.728 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:53:59.738 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:53:59.738 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.738 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.753 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.753 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.753 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.753 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 22:53:59.754 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.754 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:53:59.754 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.776 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.783 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:53:59.783 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.783 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:53:59.783 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:59.783 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.793 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.799 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:59.799 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:59.799 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.800 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:53:59.800 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:59.800 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:59.800 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.812 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.812 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:59.812 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:59.812 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.822 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.822 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:59.822 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.822 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:59.822 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 22:53:59.823 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:59.829 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.831 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:59.831 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.831 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:53:59.852 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:59.852 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.893 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.894 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.895 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.896 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 22:53:59.896 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 22:53:59.897 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[INFO ] 2024-04-23 22:53:59.900 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 22:53:59.901 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909239712 end=1713909239901 duration=189 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.902 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.902 [main] HMSHandler - 0: get_database: mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 22:53:59.902 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 22:53:59.902 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.903 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.903 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.903 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:59.903 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.903 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.38455ms
[DEBUG] 2024-04-23 22:53:59.903 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909239901 end=1713909239903 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:59.903 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 22:53:59.903 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:59.903 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 22:53:59.904 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 22:53:59.904 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:59.904 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.905 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.905 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.905 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.905 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.133263ms
[DEBUG] 2024-04-23 22:53:59.905 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 22:53:59.905 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 22:53:59.906 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.909 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.909 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.909 [main] ObjectStore - 0 entries retrieved using SQL in 3.388786ms
[DEBUG] 2024-04-23 22:53:59.909 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*
[INFO ] 2024-04-23 22:53:59.909 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*	
[DEBUG] 2024-04-23 22:53:59.909 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.920 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.927 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.928 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 22:53:59.928 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 22:53:59.928 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.932 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.936 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.936 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 22:53:59.937 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 22:53:59.937 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.959 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.963 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.963 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:53:59.963 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:53:59.964 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.964 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:53:59.964 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.964 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.964 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 0.808885ms
[DEBUG] 2024-04-23 22:53:59.964 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.969 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:59.969 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:59.969 [main] ObjectStore - 0 entries retrieved using SQL in 4.530752ms
[INFO ] 2024-04-23 22:53:59.969 [main] ObjectStore - Dropping database hive.mydbKeyValueWrongPrefix along with all tables
[DEBUG] 2024-04-23 22:53:59.969 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:59.969 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:59.973 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:59.973 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 22:53:59.991 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@451543075 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:59.995 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 22:54:00.000 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.002 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.002 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.002 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 22:54:00.004 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 22:54:00.006 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 22:54:00.009 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 22:54:00.011 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 22:54:00.014 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 22:54:00.016 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.016 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.016 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.017 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.017 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 22:54:00.017 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 22:54:00.018 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 22:54:00.018 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 22:54:00.019 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 22:54:00.019 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 22:54:00.019 [main] PerfLogger - </PERFLOG method=drop_database start=1713909239903 end=1713909240019 duration=116 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.019 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.019 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:00.022 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 22:54:00.022 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.022 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.022 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909240019 end=1713909240022 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.023 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.026 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.028 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.030 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.031 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.033 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.035 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.036 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.038 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.040 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.041 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.043 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.045 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.046 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.048 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.050 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.061 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.071 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.072 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 22:54:00.074 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = 1704557870313819187>
[DEBUG] 2024-04-23 22:54:00.082 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 22:54:00.084 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.084 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 22:54:00.105 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.109 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.109 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.109 [main] PerfLogger - </PERFLOG method=lock start=1713909240061 end=1713909240109 duration=48 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.109 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.110 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 22:54:00.110 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:0
[DEBUG] 2024-04-23 22:54:00.110 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.113 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 22:54:00.113 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 22:54:00.114 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.114 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 22:54:00.114 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.115 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.115 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.115 [main] PerfLogger - </PERFLOG method=check_lock start=1713909240109 end=1713909240115 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.115 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.115 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.116 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 22:54:00.116 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.116 [main] PerfLogger - </PERFLOG method=heartbeat start=1713909240115 end=1713909240116 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.116 [main] PerfLogger - <PERFLOG method=unlock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.116 [main] TxnHandler - Going to execute update <DELETE FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1 AND ("HL_TXNID" = 0 OR ("HL_TXNID" <> 0 AND "HL_LOCK_STATE" = 'w'))>
[DEBUG] 2024-04-23 22:54:00.119 [main] TxnHandler - Successfully unlocked at least 1 lock with extLockId=1
[DEBUG] 2024-04-23 22:54:00.119 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.120 [main] PerfLogger - </PERFLOG method=unlock start=1713909240116 end=1713909240120 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.120 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.123 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.123 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.125 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.126 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.126 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.126 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.126 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.126 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.127 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.127 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.127 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.127 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.127 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.127 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.128 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.132 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.133 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.135 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.138 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.138 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.145 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 22:54:00.147 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.147 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.147 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.148 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240132 end=1713909240148 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.148 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.150 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.150 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.152 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.152 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:54:00.154 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 22:54:00.154 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.154 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:54:00.154 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.163 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.163 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.163 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909240148 end=1713909240163 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.163 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.167 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:54:00.170 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 22:54:00.170 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 22:54:00.170 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 22:54:00.170 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 22:54:00.170 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.176 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 22:54:00.176 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.178 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 22:54:00.180 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 22:54:00.180 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.180 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.180 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.180 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.181 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909240163 end=1713909240181 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.181 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.181 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:00.183 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 22:54:00.183 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.183 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.183 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909240181 end=1713909240183 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.183 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.186 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.186 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.188 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.188 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.188 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.189 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.189 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.189 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.189 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.189 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.190 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.190 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.190 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.190 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.190 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.196 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.196 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.199 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.202 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.202 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.207 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:54:00.209 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.209 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.209 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.209 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240196 end=1713909240209 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.209 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.217 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 22:54:00.218 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 22:54:00.218 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_COMPONENTS" ("TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_OPERATION_TYPE", "TC_WRITEID") VALUES (?, ?, ?, ?, ?, ?)> queries. Batch size: 2
[DEBUG] 2024-04-23 22:54:00.221 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.222 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 22:54:00.222 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = 4301649334248793871>
[DEBUG] 2024-04-23 22:54:00.225 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 22:54:00.226 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.226 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 22:54:00.226 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.230 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.231 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.231 [main] PerfLogger - </PERFLOG method=lock start=1713909240209 end=1713909240231 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.231 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.231 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 22:54:00.231 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:1
[DEBUG] 2024-04-23 22:54:00.231 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 22:54:00.235 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 22:54:00.235 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 22:54:00.235 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.235 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 22:54:00.236 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.237 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 22:54:00.237 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.237 [main] PerfLogger - </PERFLOG method=check_lock start=1713909240231 end=1713909240237 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.237 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.237 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.238 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 22:54:00.238 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 22:54:00.238 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 22:54:00.238 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.238 [main] PerfLogger - </PERFLOG method=heartbeat start=1713909240237 end=1713909240238 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.238 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.246 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode false
[DEBUG] 2024-04-23 22:54:00.246 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS">
[DEBUG] 2024-04-23 22:54:00.248 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'Y' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[DEBUG] 2024-04-23 22:54:00.252 [main] TxnUtils - Adding query to batch: <UPDATE "WRITE_SET" SET "WS_COMMIT_ID" = 1 WHERE "WS_COMMIT_ID" = 6517778219276650369 AND "WS_TXNID" = 1>
[DEBUG] 2024-04-23 22:54:00.252 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 22:54:00.252 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 22:54:00.252 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.252 [main] TxnUtils - Going to execute queries in batch. Batch size: 4
[DEBUG] 2024-04-23 22:54:00.262 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.262 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.262 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 22:54:00.263 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 22:54:00.263 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.263 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.263 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.263 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.264 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909240238 end=1713909240264 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.264 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.282 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.283 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.311 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.311 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.312 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.312 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.312 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.312 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.312 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.313 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.313 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.313 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.313 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.314 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.314 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.327 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.328 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.330 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.335 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.336 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.343 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 22:54:00.343 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.343 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.343 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.343 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240327 end=1713909240343 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.344 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.344 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1,2,3)>
[DEBUG] 2024-04-23 22:54:00.350 [main] TxnHandler - Going to execute query <SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' AND "T2W_TXNID" in (1,2,3)>
[DEBUG] 2024-04-23 22:54:00.352 [main] TxnHandler - Going to execute query <SELECT "NWI_NEXT" FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE" = 'db' AND "NWI_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 22:54:00.354 [main] TxnHandler - Going to execute insert <INSERT INTO "NEXT_WRITE_ID" ("NWI_DATABASE", "NWI_TABLE", "NWI_NEXT") VALUES ('db', 'tbl', 4)>
[INFO ] 2024-04-23 22:54:00.357 [main] TxnHandler - Allocated writeId: 1 for txnId: 1
[INFO ] 2024-04-23 22:54:00.357 [main] TxnHandler - Allocated writeId: 2 for txnId: 2
[INFO ] 2024-04-23 22:54:00.357 [main] TxnHandler - Allocated writeId: 3 for txnId: 3
[DEBUG] 2024-04-23 22:54:00.357 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_TO_WRITE_ID" ("T2W_TXNID", "T2W_DATABASE", "T2W_TABLE", "T2W_WRITEID") VALUES (?, ?, ?, ?)> queries. Batch size: 3
[INFO ] 2024-04-23 22:54:00.358 [main] TxnHandler - Allocated write ids for dbName=db, tblName=tbl (txnIds: [1, 2, 3])
[DEBUG] 2024-04-23 22:54:00.360 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.360 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713909240344 end=1713909240360 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.360 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.363 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.363 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.364 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.364 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:54:00.364 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 22:54:00.364 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.364 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:54:00.364 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.368 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.368 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.368 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909240360 end=1713909240368 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.368 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.368 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:00.379 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 3.
[DEBUG] 2024-04-23 22:54:00.379 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.379 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.379 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909240368 end=1713909240379 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.379 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.382 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 22:54:00.385 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 22:54:00.389 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.389 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.389 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713909240379 end=1713909240389 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.390 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.396 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:54:00.399 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 22:54:00.399 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 22:54:00.399 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 22:54:00.399 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 22:54:00.399 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.407 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 22:54:00.407 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.410 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 22:54:00.410 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 22:54:00.410 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.410 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.410 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.410 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.410 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909240390 end=1713909240410 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.411 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.411 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:00.411 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 22:54:00.411 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.411 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.411 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909240411 end=1713909240411 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.412 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.412 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 22:54:00.412 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 22:54:00.412 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.412 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.412 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713909240412 end=1713909240412 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.413 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.416 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.416 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.418 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.418 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.419 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.419 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.419 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.420 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.420 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.420 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.420 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.421 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.421 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.421 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.422 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.427 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.427 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.429 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.431 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.432 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.440 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 22:54:00.440 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.440 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.441 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.441 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240426 end=1713909240441 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.441 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.443 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.443 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.444 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.444 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:54:00.444 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 22:54:00.444 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.444 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 22:54:00.444 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.447 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.448 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.448 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909240441 end=1713909240448 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.448 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.450 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:54:00.450 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 22:54:00.450 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 22:54:00.450 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 22:54:00.450 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 22:54:00.450 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.452 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 22:54:00.452 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.452 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 22:54:00.452 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 22:54:00.452 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.452 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.453 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.453 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.453 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909240448 end=1713909240453 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.453 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.453 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:00.455 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 22:54:00.455 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.455 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.455 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909240453 end=1713909240455 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.456 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.458 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.458 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.460 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.460 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.460 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.461 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.461 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.461 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.461 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.461 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.461 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.461 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.462 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.462 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.462 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.466 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.466 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 22:54:00.466 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 22:54:00.466 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.467 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.467 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.467 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.467 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 0.891009ms
[DEBUG] 2024-04-23 22:54:00.467 [main] ObjectStore - Failed to get database hive.mydbKeyValue, returning NoSuchObjectException
[DEBUG] 2024-04-23 22:54:00.468 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 22:54:00.468 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.470 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.471 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.471 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 22:54:00.472 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 22:54:00.472 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 22:54:00.475 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 22:54:00.475 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.475 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.478 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.478 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.479 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.479 [main] PerfLogger - </PERFLOG method=create_database start=1713909240466 end=1713909240479 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.479 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.479 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713909240, lastAccessTime:1713909240, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 22:54:00.479 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713909240, lastAccessTime:1713909240, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 22:54:00.479 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.482 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.482 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.482 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.482 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.482 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 3.154529ms
[DEBUG] 2024-04-23 22:54:00.482 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.483 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.483 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 22:54:00.486 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.487 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.487 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.487 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.487 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.488 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.488 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.488 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.488 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.032054ms
[DEBUG] 2024-04-23 22:54:00.488 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.488 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.488 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 22:54:00.489 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.489 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 22:54:00.489 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 22:54:00.495 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.495 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.499 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.513 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.514 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.515 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.516 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909240479 end=1713909240516 duration=37 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.516 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.516 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 22:54:00.516 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 22:54:00.516 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.517 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.517 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.517 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.517 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.517 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 0.956778ms
[DEBUG] 2024-04-23 22:54:00.517 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.517 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.518 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 22:54:00.529 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.560 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.561 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:54:00.562 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 22:54:00.562 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909240516 end=1713909240562 duration=46 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.562 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=46, comments=HMS client
[DEBUG] 2024-04-23 22:54:00.564 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.564 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.566 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.568 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.568 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.572 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:54:00.573 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.573 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.573 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.573 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240564 end=1713909240573 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.573 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.575 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:54:00.578 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 22:54:00.578 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 22:54:00.578 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 22:54:00.578 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.578 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.580 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.580 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.580 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.580 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 2 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 22:54:00.582 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 22:54:00.582 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.583 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.583 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.583 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.583 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909240573 end=1713909240583 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.583 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.583 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:00.585 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 22:54:00.585 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.585 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.585 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909240583 end=1713909240585 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.587 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.587 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 22:54:00.587 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 22:54:00.587 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.589 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.589 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.589 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.589 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.589 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.486056ms
[DEBUG] 2024-04-23 22:54:00.589 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.589 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.589 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 22:54:00.591 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.595 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.596 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:54:00.597 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 22:54:00.597 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909240587 end=1713909240597 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.597 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 22:54:00.597 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.597 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 22:54:00.597 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 22:54:00.597 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.597 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.598 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.598 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.598 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.598 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.021817ms
[DEBUG] 2024-04-23 22:54:00.598 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.599 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.599 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.599 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.599 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.029128ms
[DEBUG] 2024-04-23 22:54:00.600 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.600 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.600 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 22:54:00.602 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.606 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.606 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.608 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.608 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.608 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:54:00.613 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:54:00.613 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.613 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.621 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.622 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.622 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.622 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 22:54:00.623 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.623 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:54:00.623 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.629 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:54:00.629 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.629 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:54:00.629 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:54:00.629 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.635 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:54:00.635 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:54:00.635 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.635 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:54:00.635 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:54:00.635 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:54:00.635 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.644 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.644 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:54:00.644 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:54:00.644 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.652 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.652 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:54:00.652 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.652 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:54:00.652 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 22:54:00.653 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:54:00.657 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.659 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:54:00.659 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.659 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:54:00.671 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:54:00.672 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.706 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.706 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.707 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.707 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 22:54:00.707 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 22:54:00.708 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 22:54:00.708 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909240597 end=1713909240708 duration=111 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.708 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.708 [main] HMSHandler - 0: get_database: mydbKeyValue
[INFO ] 2024-04-23 22:54:00.708 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValue	
[DEBUG] 2024-04-23 22:54:00.708 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.709 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.709 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.709 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.709 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.709 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.213653ms
[DEBUG] 2024-04-23 22:54:00.709 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909240708 end=1713909240709 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.710 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 22:54:00.710 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.710 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValue
[INFO ] 2024-04-23 22:54:00.710 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValue	
[DEBUG] 2024-04-23 22:54:00.710 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.710 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.711 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.711 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.711 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.711 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.041779ms
[DEBUG] 2024-04-23 22:54:00.711 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValue
[INFO ] 2024-04-23 22:54:00.711 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValue	
[DEBUG] 2024-04-23 22:54:00.711 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.714 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.714 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.714 [main] ObjectStore - 0 entries retrieved using SQL in 3.352863ms
[DEBUG] 2024-04-23 22:54:00.714 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValue pat=*
[INFO ] 2024-04-23 22:54:00.715 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValue pat=*	
[DEBUG] 2024-04-23 22:54:00.715 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.719 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.719 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 22:54:00.719 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 22:54:00.719 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.722 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.723 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 22:54:00.723 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 22:54:00.723 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.726 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.727 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:54:00.727 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:54:00.727 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.727 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.728 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.728 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.728 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 0.763327ms
[DEBUG] 2024-04-23 22:54:00.728 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.731 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.731 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.731 [main] ObjectStore - 0 entries retrieved using SQL in 3.764923ms
[INFO ] 2024-04-23 22:54:00.731 [main] ObjectStore - Dropping database hive.mydbKeyValue along with all tables
[DEBUG] 2024-04-23 22:54:00.732 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.732 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.735 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.735 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 22:54:00.738 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 22:54:00.743 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.744 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.744 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.744 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 22:54:00.746 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 22:54:00.749 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 22:54:00.750 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 22:54:00.753 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 22:54:00.754 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 22:54:00.756 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.756 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.756 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.757 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.758 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 22:54:00.758 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 22:54:00.758 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db
[DEBUG] 2024-04-23 22:54:00.758 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 22:54:00.759 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 22:54:00.759 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 22:54:00.759 [main] PerfLogger - </PERFLOG method=drop_database start=1713909240710 end=1713909240759 duration=49 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.761 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.765 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.767 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.769 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.770 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.771 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.773 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.775 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.776 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.778 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.779 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.781 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.782 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.784 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.785 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.787 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.794 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.794 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.797 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.800 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.800 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.803 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:54:00.803 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.803 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.803 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.803 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240794 end=1713909240803 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.803 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.808 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:54:00.809 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 22:54:00.809 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 22:54:00.809 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 22:54:00.809 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 22:54:00.809 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:00.814 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 22:54:00.814 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.814 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 22:54:00.815 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 22:54:00.815 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.815 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.815 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.815 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.815 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909240803 end=1713909240815 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.815 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.815 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:00.817 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 22:54:00.817 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.818 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.818 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909240815 end=1713909240818 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.818 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.820 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.820 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.822 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.822 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.822 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.822 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.822 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.823 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.823 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.823 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.823 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.823 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.824 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.824 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.824 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.829 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.829 [main] HMSHandler - 0: create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 22:54:00.829 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 22:54:00.829 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.830 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.830 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.830 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.830 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.044817ms
[DEBUG] 2024-04-23 22:54:00.830 [main] ObjectStore - Failed to get database hive.mydb, returning NoSuchObjectException
[DEBUG] 2024-04-23 22:54:00.830 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 22:54:00.830 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.834 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.834 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.834 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 22:54:00.835 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db
[INFO ] 2024-04-23 22:54:00.835 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db
[INFO ] 2024-04-23 22:54:00.838 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db
[DEBUG] 2024-04-23 22:54:00.838 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.838 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.840 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.840 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.841 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.841 [main] PerfLogger - </PERFLOG method=create_database start=1713909240829 end=1713909240841 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.842 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.842 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713909240, lastAccessTime:1713909240, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 22:54:00.842 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713909240, lastAccessTime:1713909240, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 22:54:00.842 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.843 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.843 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.843 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.843 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.843 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.529091ms
[DEBUG] 2024-04-23 22:54:00.844 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.844 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.844 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 22:54:00.847 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.847 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.847 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.847 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.847 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.848 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.848 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.848 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.848 [main] ObjectStore - db details for db mydb retrieved using SQL in 0.691348ms
[DEBUG] 2024-04-23 22:54:00.848 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.848 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.848 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 22:54:00.848 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.849 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 22:54:00.849 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydb.db/mytable
[DEBUG] 2024-04-23 22:54:00.855 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.855 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:54:00.856 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:54:00.872 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.872 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.873 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.875 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909240842 end=1713909240875 duration=33 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.875 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.875 [main] HMSHandler - 0: get_table : tbl=hive.mydb.mytable
[INFO ] 2024-04-23 22:54:00.875 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydb.mytable	
[DEBUG] 2024-04-23 22:54:00.875 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.876 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:54:00.876 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:54:00.876 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.876 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.876 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.189507ms
[DEBUG] 2024-04-23 22:54:00.876 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:54:00.876 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:54:00.876 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 22:54:00.885 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:54:00.912 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:54:00.914 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1871259950 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:54:00.915 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 22:54:00.915 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909240875 end=1713909240915 duration=40 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.915 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=40, comments=HMS client
[DEBUG] 2024-04-23 22:54:00.915 [main] PerfLogger - <PERFLOG method=compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.915 [main] TxnHandler - About to execute SQL: SELECT "MT_COMMENT" FROM "AUX_TABLE" WHERE "MT_KEY1"='CompactionScheduler' and "MT_KEY2"=0
[DEBUG] 2024-04-23 22:54:00.918 [main] TxnHandler - 'CompactionScheduler' locked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 22:54:00.919 [main] TxnHandler - going to execute query <SELECT "NCQ_NEXT" FROM "NEXT_COMPACTION_QUEUE_ID">
[DEBUG] 2024-04-23 22:54:00.920 [main] TxnHandler - Going to execute update <UPDATE "NEXT_COMPACTION_QUEUE_ID" SET "NCQ_NEXT" = 2>
[DEBUG] 2024-04-23 22:54:00.924 [main] TxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_STATE" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" IN('i','w') AND "CQ_DATABASE"=? AND "CQ_TABLE"=? AND "CQ_PARTITION" is null>
[DEBUG] 2024-04-23 22:54:00.927 [main] TxnHandler - Going to execute update <INSERT INTO "COMPACTION_QUEUE" ("CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_STATE", "CQ_TYPE", "CQ_ENQUEUE_TIME", "CQ_TBLPROPERTIES", "CQ_INITIATOR_ID") values (1, ?, ?, 'i', 'i',{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?)>
[DEBUG] 2024-04-23 22:54:00.927 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.928 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.929 [main] PoolBase - HikariPool-3 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1941639991 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.929 [main] TxnHandler - 'CompactionScheduler' unlocked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 22:54:00.929 [main] PerfLogger - </PERFLOG method=compact2 start=1713909240915 end=1713909240929 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.929 [main] PerfLogger - <PERFLOG method=find_next_compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.929 [main] CompactionTxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", "CQ_TYPE", "CQ_TBLPROPERTIES" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" = 'i'>
[DEBUG] 2024-04-23 22:54:00.931 [main] TxnHandler - Going to execute query <values current_timestamp>
[DEBUG] 2024-04-23 22:54:00.932 [main] CompactionTxnHandler - Going to execute update <UPDATE   "COMPACTION_QUEUE" SET  "CQ_WORKER_ID" = 'myworker',  "CQ_WORKER_VERSION" = 'null',  "CQ_START" = 1713909240932,  "CQ_STATE" = 'w' WHERE "CQ_ID" = 1  AND "CQ_STATE"='i'>
[DEBUG] 2024-04-23 22:54:00.935 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.937 [main] PerfLogger - </PERFLOG method=find_next_compact2 start=1713909240929 end=1713909240937 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.937 [main] PerfLogger - <PERFLOG method=mark_cleaned from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.937 [main] CompactionTxnHandler - Running markCleaned with CompactionInfo: id:1,dbname:mydb,tableName:mytable,partName:null,state: ,type:MINOR,enqueueTime:0,start:0,properties:0:,runAs:null,tooManyAborts:false,hasOldAbort:false,highestWriteId:0,errorMessage:null,workerId: null,initiatorId: null
[DEBUG] 2024-04-23 22:54:00.940 [main] CompactionTxnHandler - Going to execute update <INSERT INTO "COMPLETED_COMPACTIONS"("CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_STATE", "CC_TYPE", "CC_TBLPROPERTIES", "CC_WORKER_ID", "CC_START", "CC_END", "CC_RUN_AS", "CC_HIGHEST_WRITE_ID", "CC_META_INFO", "CC_HADOOP_JOB_ID", "CC_ERROR_MESSAGE", "CC_ENQUEUE_TIME", "CC_WORKER_VERSION", "CC_INITIATOR_ID", "CC_INITIATOR_VERSION") SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", 's', "CQ_TYPE", "CQ_TBLPROPERTIES", "CQ_WORKER_ID", "CQ_START", { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, "CQ_RUN_AS", "CQ_HIGHEST_WRITE_ID", "CQ_META_INFO", "CQ_HADOOP_JOB_ID", "CQ_ERROR_MESSAGE", "CQ_ENQUEUE_TIME", "CQ_WORKER_VERSION", "CQ_INITIATOR_ID", "CQ_INITIATOR_VERSION"FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?> for CQ_ID=1
[DEBUG] 2024-04-23 22:54:00.941 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?>
[DEBUG] 2024-04-23 22:54:00.943 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE" = ? AND "CTC_TABLE" = ?>
[WARN ] 2024-04-23 22:54:00.944 [main] CompactionTxnHandler - Expected to remove at least one row from completed_txn_components when marking compaction entry as clean!
[DEBUG] 2024-04-23 22:54:00.944 [main] CompactionTxnHandler - Removed 0 records from completed_txn_components
[DEBUG] 2024-04-23 22:54:00.944 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" IN ( SELECT "TXN_ID" FROM "TXNS" WHERE "TXN_STATE" = 'a') AND "TC_DATABASE" = ? AND "TC_TABLE" = ? AND "TC_PARTITION" IS NULL>
[DEBUG] 2024-04-23 22:54:00.947 [main] CompactionTxnHandler - Removed 0 records from txn_components
[DEBUG] 2024-04-23 22:54:00.947 [main] CompactionTxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.947 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.947 [main] PerfLogger - </PERFLOG method=mark_cleaned start=1713909240937 end=1713909240947 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.948 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[ERROR] 2024-04-23 22:54:00.949 [main] RetryingHMSHandler - MetaException(message:Database name and table name cannot be null.)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_latest_committed_compaction_info(HMSHandler.java:8811)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.get_latest_committed_compaction_info(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getLatestCommittedCompactionInfo(HiveMetaStoreClient.java:4155)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.lambda$testGetLatestCommittedCompactionInfo$0(TestHiveMetaStoreTxns.java:432)
	at org.junit.Assert.assertThrows(Assert.java:1001)
	at org.junit.Assert.assertThrows(Assert.java:981)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testGetLatestCommittedCompactionInfo(TestHiveMetaStoreTxns.java:432)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 22:54:00.949 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713909240948 end=1713909240949 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:54:00.949 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.955 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 22:54:00.955 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.955 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.955 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713909240949 end=1713909240955 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.955 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.955 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 22:54:00.956 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:00.956 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.956 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713909240955 end=1713909240956 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:00.956 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:00.958 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.958 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:00.960 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:00.961 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.961 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:00.962 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:00.962 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:00.962 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:00.962 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:00.963 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:00.963 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:00.963 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:00.963 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:00.963 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:00.963 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.968 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.968 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.970 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.973 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.974 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.976 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:54:00.977 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.977 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.977 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.977 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240968 end=1713909240977 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.977 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.977 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:00.977 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:00.978 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 1, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:00.978 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:00.983 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(2, 1),(3, 1),(4, 1)>
[INFO ] 2024-04-23 22:54:00.985 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([2, 3, 4]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:00.985 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:00.985 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:00.985 [main] PerfLogger - </PERFLOG method=open_txns start=1713909240977 end=1713909240985 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:00.985 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:00.988 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 22:54:00.988 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:00.990 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:00.990 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 22:54:00.993 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (2))>
[DEBUG] 2024-04-23 22:54:00.993 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (2)>
[DEBUG] 2024-04-23 22:54:00.993 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 22:54:00.993 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:01.000 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:01.001 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:01.001 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909240985 end=1713909241001 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:01.001 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:01.005 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 22:54:01.008 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 22:54:01.008 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 22:54:01.008 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 22:54:01.008 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 22:54:01.008 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 22:54:01.014 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 22:54:01.014 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 22:54:01.016 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 22:54:01.016 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 22:54:01.016 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:01.016 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:01.017 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:01.017 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:01.017 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909241001 end=1713909241017 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:54:01.017 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:01.017 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 22:54:01.020 [main] TxnHandler - Got OpenTxnList with hwm: 4 and openTxnList size 3.
[DEBUG] 2024-04-23 22:54:01.020 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:54:01.020 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:01.020 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909241017 end=1713909241020 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:01.021 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:01.023 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:01.023 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:01.025 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:01.025 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:01.025 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:01.025 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:01.025 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:01.026 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:01.026 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:01.026 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:01.026 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:01.026 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:01.026 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:01.026 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:01.027 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:01.031 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:54:01.031 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 22:54:01.033 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 22:54:01.035 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 22:54:01.035 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 22:54:01.038 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 22:54:01.038 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 22:54:01.039 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 22:54:01.039 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@503365602 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:54:01.039 [main] PerfLogger - </PERFLOG method=open_txns start=1713909241031 end=1713909241039 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:54:01.040 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:01.042 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:01.043 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:01.044 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:01.044 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:01.045 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:01.045 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:01.045 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:01.045 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:01.045 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:01.045 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:01.046 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:01.046 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:01.046 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:01.046 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:01.046 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[INFO ] 2024-04-23 22:54:01.051 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 22:54:01.053 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:01.053 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 22:54:01.055 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 22:54:01.055 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 22:54:01.055 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 22:54:01.055 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 22:54:01.055 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 22:54:01.056 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 22:54:01.056 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 22:54:01.056 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 22:54:01.056 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 22:54:01.056 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 22:54:01.056 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 22:54:01.056 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 22:54:01.057 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 22:54:01.080 [Thread-14] ShutdownHookManager - ShutdownHookManger complete shutdown.
