[DEBUG] 2024-04-23 22:53:43.856 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:43.856 [main] HMSHandler - 0: create_table_req: Table(tableName:tableDropDatabase, dbName:db, owner:alex, createTime:1713909223, lastAccessTime:1713909223, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional_properties=insert_only, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 22:53:43.856 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tableDropDatabase, dbName:db, owner:alex, createTime:1713909223, lastAccessTime:1713909223, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional_properties=insert_only, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 22:53:43.856 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:43.856 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:43.856 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:43.858 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:43.858 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:43.955 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:43.955 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:43.955 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:43.956 [main] ObjectStore - db details for db db retrieved using ORM in 99.45675ms
[DEBUG] 2024-04-23 22:53:43.956 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:43.956 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:43.956 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:44.296 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.306 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.306 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.306 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:44.307 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on table tableDropDatabase
[DEBUG] 2024-04-23 22:53:44.307 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.307 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.307 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.311 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.311 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.311 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.311 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.311 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.312 [main] ObjectStore - db details for db db retrieved using ORM in 4.842557ms
[DEBUG] 2024-04-23 22:53:44.312 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[DEBUG] 2024-04-23 22:53:44.312 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.312 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.312 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.313 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.313 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.313 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.313 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.314 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.314 [main] ObjectStore - db details for db db retrieved using ORM in 1.986698ms
[DEBUG] 2024-04-23 22:53:44.314 [main] MetastoreDefaultTransformer - Processor has required capabilities to be able to create INSERT-only tables
[WARN ] 2024-04-23 22:53:44.315 [main] TransactionalValidationListener - Could not verify InputFormat=org.apache.hadoop.hive.ql.io.HiveInputFormat or OutputFormat=org.apache.hadoop.hive.ql.io.HiveOutputFormat  for db.tableDropDatabase
[DEBUG] 2024-04-23 22:53:44.317 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.317 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.317 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.317 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.318 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.319 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.319 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.319 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.319 [main] ObjectStore - db details for db db retrieved using ORM in 1.890125ms
[DEBUG] 2024-04-23 22:53:44.319 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.319 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.319 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:44.320 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.320 [main] ObjectStore - Commit transaction: count = 1, isactive true
[WARN ] 2024-04-23 22:53:44.320 [main] HMSHandler - Location: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase specified for non-external table:tableDropDatabase
[INFO ] 2024-04-23 22:53:44.320 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase
[DEBUG] 2024-04-23 22:53:44.326 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.326 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.327 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.333 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.341 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.347 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.352 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.373 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.373 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.376 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.378 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909223856 end=1713909224378 duration=522 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:44.391 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:44.391 [main] HMSHandler - 0: get_database: db
[INFO ] 2024-04-23 22:53:44.391 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db	
[DEBUG] 2024-04-23 22:53:44.391 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.391 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.391 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.392 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.393 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.393 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.393 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.393 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.393 [main] ObjectStore - db details for db db retrieved using ORM in 2.328304ms
[INFO ] 2024-04-23 22:53:44.393 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on database db locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db managedLocationUri=null
[DEBUG] 2024-04-23 22:53:44.394 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db
[INFO ] 2024-04-23 22:53:44.394 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713909223, type:NATIVE)
[DEBUG] 2024-04-23 22:53:44.394 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909224390 end=1713909224394 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:44.395 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=5, comments=HMS client
[DEBUG] 2024-04-23 22:53:44.395 [main] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:44.395 [main] HMSHandler - 0: get_tables_by_type: db=@hive#db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:53:44.395 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:53:44.395 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:53:44.396 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:53:44.396 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.396 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.396 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.397 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.397 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.398 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.398 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.398 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.398 [main] ObjectStore - db details for db db retrieved using ORM in 2.671104ms
[DEBUG] 2024-04-23 22:53:44.399 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.399 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.416 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.416 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.416 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.416 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.416 [main] ObjectStore - 0 entries retrieved using ORM in 17.437113ms
[DEBUG] 2024-04-23 22:53:44.417 [main] PerfLogger - </PERFLOG method=get_tables_by_type start=1713909224395 end=1713909224417 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:44.417 [main] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:44.417 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 22:53:44.417 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 22:53:44.417 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.417 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.425 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.425 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.425 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.425 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.426 [main] ObjectStore - 1 entries retrieved using ORM in 8.553729ms
[DEBUG] 2024-04-23 22:53:44.426 [main] PerfLogger - </PERFLOG method=get_all_tables start=1713909224417 end=1713909224426 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:44.426 [main] HiveMetaStoreClient - Selecting dropDatabase method for db (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 22:53:44.426 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 22:53:44.426 [main] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:44.426 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.426 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.426 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.427 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.427 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.428 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.428 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.428 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.428 [main] ObjectStore - db details for db db retrieved using ORM in 2.04585ms
[DEBUG] 2024-04-23 22:53:44.429 [main] HMSHandler - 0: get_multi_table : db=db tbls=tabledropdatabase
[INFO ] 2024-04-23 22:53:44.429 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=db tbls=tabledropdatabase	
[DEBUG] 2024-04-23 22:53:44.430 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.516 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:44.517 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.519 [main] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713909224426 end=1713909224519 duration=93 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:44.519 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:44.519 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 22:53:44.519 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 22:53:44.519 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:44.519 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.519 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.519 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.521 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.521 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.521 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.521 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.521 [main] ObjectStore - db details for db db retrieved using ORM in 1.870383ms
[DEBUG] 2024-04-23 22:53:44.521 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:44.521 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 22:53:44.521 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 22:53:44.521 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.521 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.523 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.523 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.523 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.523 [main] ObjectStore - 1 entries retrieved using ORM in 2.051283ms
[DEBUG] 2024-04-23 22:53:44.524 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 22:53:44.524 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 22:53:44.524 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.558 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.564 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.565 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 22:53:44.565 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 22:53:44.565 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.588 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.594 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.594 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 22:53:44.594 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 22:53:44.594 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.612 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.618 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.618 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:53:44.618 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:53:44.618 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.618 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.618 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.621 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.621 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.621 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.621 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.621 [main] ObjectStore - db details for db db retrieved using ORM in 2.993405ms
[DEBUG] 2024-04-23 22:53:44.621 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.621 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.630 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.630 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.630 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.630 [main] ObjectStore - 0 entries retrieved using ORM in 8.745179ms
[DEBUG] 2024-04-23 22:53:44.630 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.652 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.652 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.652 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:53:44.706 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.716 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:53:44.716 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:44.716 [main] HMSHandler - 0: drop_table : tbl=hive.db.tabledropdatabase
[INFO ] 2024-04-23 22:53:44.717 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tabledropdatabase	
[DEBUG] 2024-04-23 22:53:44.717 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:44.717 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.717 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.717 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 22:53:44.717 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 22:53:44.717 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.718 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.718 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.718 [main] ObjectStore - db details for db db retrieved using ORM in 0.926372ms
[DEBUG] 2024-04-23 22:53:44.718 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.718 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.718 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - db details for db db retrieved using ORM in 0.992789ms
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.719 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:44.724 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.724 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.724 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.762 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.764 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.765 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.799 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.813 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:44.814 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:44.814 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.814 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:44.818 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.818 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:53:44.818 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.836 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.843 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:53:44.843 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.843 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:53:44.844 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:44.844 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.861 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.869 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:44.869 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:44.869 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.869 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:53:44.869 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:44.869 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:44.869 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.886 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.897 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.897 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:44.897 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:44.897 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.916 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.926 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.926 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:44.926 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.926 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 22:53:44.926 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:44.930 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 22:53:44.950 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:44.955 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:44.965 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:44.965 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:44.965 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:53:44.997 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:44.997 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.056 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.056 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 22:53:45.057 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 22:53:45.057 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 22:53:45.058 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 22:53:45.058 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 22:53:45.058 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 22:53:45.059 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 22:53:45.060 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 22:53:45.061 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 22:53:45.061 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 22:53:45.061 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 22:53:45.061 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 22:53:45.061 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 22:53:45.061 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 22:53:45.061 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 22:53:45.063 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 22:53:45.063 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.063 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 22:53:45.064 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 22:53:45.064 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 22:53:45.065 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 22:53:45.065 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 22:53:45.066 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 22:53:45.067 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 22:53:45.068 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 22:53:45.068 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 22:53:45.070 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 22:53:45.070 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1484994456 (XID = 927), (SESSIONID = 23), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.070 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 22:53:45.071 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.072 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1773) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 70 more
[DEBUG] 2024-04-23 22:53:45.073 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:45.073 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.073 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 22:53:45.080 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.082 [main] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 22:53:45.084 [main] RetryingHMSHandler - MetaException(message:java.lang.RuntimeException: during transactional cleanup)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.newMetaException(ExceptionHandler.java:152)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.defaultMetaException(ExceptionHandler.java:168)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3260)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1773)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.lang.RuntimeException: during transactional cleanup
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:39)
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256)
	... 55 more

[DEBUG] 2024-04-23 22:53:45.084 [main] PerfLogger - </PERFLOG method=drop_database start=1713909224519 end=1713909225084 duration=565 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:53:45.085 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.086 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 22:53:45.086 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 22:53:45.086 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.086 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.086 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.088 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.088 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.088 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.088 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.089 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.089 [main] ObjectStore - db details for db db retrieved using ORM in 2.71523ms
[DEBUG] 2024-04-23 22:53:45.089 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.089 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.089 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:45.102 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.111 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.113 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.115 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 22:53:45.115 [main] MetastoreDefaultTransformer - Table tabledropdatabase,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 22:53:45.115 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 22:53:45.116 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 22:53:45.116 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 22:53:45.117 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 22:53:45.118 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909225085 end=1713909225118 duration=33 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.118 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=33, comments=HMS client
[DEBUG] 2024-04-23 22:53:45.119 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.119 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 22:53:45.119 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 22:53:45.120 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.120 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.120 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.122 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.122 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.122 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.122 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.122 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.122 [main] ObjectStore - db details for db db retrieved using ORM in 2.729897ms
[DEBUG] 2024-04-23 22:53:45.122 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.123 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.123 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:45.126 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.132 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.133 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.134 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 22:53:45.135 [main] MetastoreDefaultTransformer - Table tabledropdatabase,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 22:53:45.135 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 22:53:45.135 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 22:53:45.135 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 22:53:45.135 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 22:53:45.135 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909225119 end=1713909225135 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.135 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=16, comments=HMS client
[DEBUG] 2024-04-23 22:53:45.135 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.135 [main] HMSHandler - 0: drop_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 22:53:45.135 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 22:53:45.135 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.135 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.135 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.135 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.136 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - db details for db db retrieved using ORM in 1.31442ms
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.137 [main] ObjectStore - db details for db db retrieved using ORM in 0.707585ms
[DEBUG] 2024-04-23 22:53:45.138 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.138 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.138 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:45.141 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.146 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.146 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.147 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.147 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.147 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:53:45.152 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:53:45.152 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.152 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.154 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.155 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.155 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.155 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:45.156 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.156 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.156 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.162 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.162 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.162 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.162 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:45.162 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.163 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 22:53:45.165 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1737552464 (XID = 940), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.167 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@648935531 (XID = 942), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.168 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@398531635 (XID = 944), (SESSIONID = 29), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.169 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1182926628 (XID = 946), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.170 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:45.170 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@895832103 (XID = 948), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.179 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 22:53:45.180 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:45.181 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.181 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:53:45.181 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:45.182 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:45.182 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.183 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1120713991 (XID = 950), (SESSIONID = 35), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.184 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@337387925 (XID = 952), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.184 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@547246991 (XID = 955), (SESSIONID = 39), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.185 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1428237230 (XID = 957), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.186 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1681799343 (XID = 961), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.186 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@440233882 (XID = 960), (SESSIONID = 44), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.188 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@890164449 (XID = 965), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.188 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1498962076 (XID = 964), (SESSIONID = 48), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.188 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 22:53:45.189 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1827361508 (XID = 967), (SESSIONID = 51), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.190 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@826281302 (XID = 969), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.191 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1365803929 (XID = 971), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.192 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1103695229 (XID = 973), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.193 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@670484726 (XID = 975), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.193 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 22:53:45.197 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.198 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:45.198 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:45.198 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.208 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.208 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:45.208 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.208 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.208 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 22:53:45.209 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.210 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.212 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:45.212 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.212 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:53:45.215 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:45.215 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.220 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.221 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 69 more
[DEBUG] 2024-04-23 22:53:45.222 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:45.222 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.223 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db' AND "TC_TABLE"='tabledropdatabase'>
[DEBUG] 2024-04-23 22:53:45.224 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:41) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[INFO ] 2024-04-23 22:53:45.225 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 22:53:45.225 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 22:53:45.225 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.225 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.227 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.228 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:45.228 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:45.228 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase
[INFO ] 2024-04-23 22:53:45.231 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 22:53:45.233 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909225135 end=1713909225232 duration=97 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.234 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.234 [main] HMSHandler - 0: create_table_req: Table(tableName:tableDropTable, dbName:db, owner:alex, createTime:1713909225, lastAccessTime:1713909225, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional_properties=insert_only, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 22:53:45.234 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tableDropTable, dbName:db, owner:alex, createTime:1713909225, lastAccessTime:1713909225, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional_properties=insert_only, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 22:53:45.234 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.234 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.234 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.235 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.236 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.236 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.236 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.236 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.236 [main] ObjectStore - db details for db db retrieved using ORM in 1.834834ms
[DEBUG] 2024-04-23 22:53:45.236 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.236 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.236 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.237 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.237 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.237 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.237 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on table tableDropTable
[DEBUG] 2024-04-23 22:53:45.237 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.237 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.237 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.238 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.238 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.238 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.238 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.239 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.239 [main] ObjectStore - db details for db db retrieved using ORM in 1.495499ms
[DEBUG] 2024-04-23 22:53:45.239 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[DEBUG] 2024-04-23 22:53:45.239 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.239 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.239 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.240 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.240 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.240 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.240 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.240 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.240 [main] ObjectStore - db details for db db retrieved using ORM in 1.538885ms
[DEBUG] 2024-04-23 22:53:45.241 [main] MetastoreDefaultTransformer - Processor has required capabilities to be able to create INSERT-only tables
[WARN ] 2024-04-23 22:53:45.241 [main] TransactionalValidationListener - Could not verify InputFormat=org.apache.hadoop.hive.ql.io.HiveInputFormat or OutputFormat=org.apache.hadoop.hive.ql.io.HiveOutputFormat  for db.tableDropTable
[DEBUG] 2024-04-23 22:53:45.241 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.241 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.241 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.241 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - db details for db db retrieved using ORM in 1.582171ms
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.243 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.244 [main] ObjectStore - Commit transaction: count = 1, isactive true
[WARN ] 2024-04-23 22:53:45.244 [main] HMSHandler - Location: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledroptable specified for non-external table:tableDropTable
[INFO ] 2024-04-23 22:53:45.244 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledroptable
[DEBUG] 2024-04-23 22:53:45.246 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.246 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.247 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.259 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.259 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.261 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.262 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909225234 end=1713909225262 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.262 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.262 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 22:53:45.262 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 22:53:45.262 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.262 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.262 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.263 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.263 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.263 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.263 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.263 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.264 [main] ObjectStore - db details for db db retrieved using ORM in 1.641864ms
[DEBUG] 2024-04-23 22:53:45.264 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.264 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.264 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.266 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.270 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.271 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.272 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 22:53:45.272 [main] MetastoreDefaultTransformer - Table tabledroptable,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 22:53:45.272 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 22:53:45.272 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 22:53:45.272 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 22:53:45.273 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 22:53:45.273 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909225262 end=1713909225273 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.273 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 22:53:45.273 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.273 [main] HMSHandler - 0: drop_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 22:53:45.273 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 22:53:45.273 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.273 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.273 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.273 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - db details for db db retrieved using ORM in 1.148797ms
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.274 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - db details for db db retrieved using ORM in 0.666891ms
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.275 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.277 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.281 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.281 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.282 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.282 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.282 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:53:45.283 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:53:45.283 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.283 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.284 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.284 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.284 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.285 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.285 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.285 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.285 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.286 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.286 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.286 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.286 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:45.286 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.287 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:45.288 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:45.288 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.288 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.288 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:45.288 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.288 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.288 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.289 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.290 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.291 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:45.291 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.291 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:53:45.293 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:45.294 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.298 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.299 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropTableShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:93) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 69 more
[DEBUG] 2024-04-23 22:53:45.300 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:45.300 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.300 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 22:53:45.302 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 22:53:45.303 [main] RetryingHMSHandler - MetaException(message:java.lang.RuntimeException: during transactional cleanup)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.newMetaException(ExceptionHandler.java:152)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.defaultMetaException(ExceptionHandler.java:168)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3260)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_table_with_environment_context(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropTableShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:93)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.lang.RuntimeException: during transactional cleanup
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:39)
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256)
	... 54 more

[DEBUG] 2024-04-23 22:53:45.303 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909225273 end=1713909225303 duration=30 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:53:45.303 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.303 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 22:53:45.303 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 22:53:45.303 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.303 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.303 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.304 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.304 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.304 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.305 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.305 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.305 [main] ObjectStore - db details for db db retrieved using ORM in 1.845045ms
[DEBUG] 2024-04-23 22:53:45.305 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.305 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.305 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.307 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.311 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.312 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.313 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 22:53:45.313 [main] MetastoreDefaultTransformer - Table tabledroptable,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 22:53:45.313 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 22:53:45.313 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 22:53:45.313 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 22:53:45.313 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 22:53:45.313 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909225303 end=1713909225313 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.313 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 22:53:45.313 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.313 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 22:53:45.313 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 22:53:45.313 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.313 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.313 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.314 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.314 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.314 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.314 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.315 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.315 [main] ObjectStore - db details for db db retrieved using ORM in 1.529865ms
[DEBUG] 2024-04-23 22:53:45.315 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.315 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.315 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.317 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.322 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.322 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:53:45.323 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 22:53:45.323 [main] MetastoreDefaultTransformer - Table tabledroptable,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 22:53:45.323 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 22:53:45.323 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 22:53:45.323 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 22:53:45.323 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 22:53:45.324 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909225313 end=1713909225324 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.324 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 22:53:45.324 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.324 [main] HMSHandler - 0: drop_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 22:53:45.324 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 22:53:45.324 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.324 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.324 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.324 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - db details for db db retrieved using ORM in 1.095965ms
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.325 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.326 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.326 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.326 [main] ObjectStore - db details for db db retrieved using ORM in 0.560693ms
[DEBUG] 2024-04-23 22:53:45.326 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.326 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.326 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.328 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.332 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.332 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.332 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.332 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.332 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:53:45.333 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:53:45.333 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.333 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.334 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.334 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.334 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.335 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.335 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.335 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.335 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.336 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.336 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.336 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:53:45.336 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:45.336 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:45.337 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.338 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.338 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:53:45.338 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.338 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.338 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 22:53:45.339 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.340 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.342 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:45.342 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.342 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:53:45.344 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:53:45.344 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.349 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.349 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 69 more
[DEBUG] 2024-04-23 22:53:45.350 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:45.350 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.350 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db' AND "TC_TABLE"='tabledroptable'>
[DEBUG] 2024-04-23 22:53:45.351 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:41) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[INFO ] 2024-04-23 22:53:45.351 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 22:53:45.351 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 22:53:45.351 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.351 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.352 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.353 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:45.353 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:45.353 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledroptable
[DEBUG] 2024-04-23 22:53:45.354 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909225324 end=1713909225354 duration=30 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.354 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.354 [main] HMSHandler - 0: get_database: db
[INFO ] 2024-04-23 22:53:45.354 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db	
[DEBUG] 2024-04-23 22:53:45.354 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.354 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.354 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.355 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.355 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.355 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.355 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.356 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.356 [main] ObjectStore - db details for db db retrieved using ORM in 1.772843ms
[INFO ] 2024-04-23 22:53:45.356 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on database db locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db managedLocationUri=null
[DEBUG] 2024-04-23 22:53:45.356 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db
[INFO ] 2024-04-23 22:53:45.356 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713909223, type:NATIVE)
[DEBUG] 2024-04-23 22:53:45.356 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909225354 end=1713909225356 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.356 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 22:53:45.356 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.356 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 22:53:45.356 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 22:53:45.356 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:53:45.356 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.356 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.356 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.358 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.358 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.358 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.358 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.358 [main] ObjectStore - db details for db db retrieved using ORM in 1.268762ms
[DEBUG] 2024-04-23 22:53:45.358 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:45.358 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 22:53:45.358 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 22:53:45.358 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.358 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.363 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.363 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.363 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.363 [main] ObjectStore - 0 entries retrieved using ORM in 5.388704ms
[DEBUG] 2024-04-23 22:53:45.363 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 22:53:45.363 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 22:53:45.364 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.369 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.369 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 22:53:45.369 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 22:53:45.369 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.372 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.372 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 22:53:45.372 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 22:53:45.372 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.373 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.373 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:53:45.373 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:53:45.373 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.373 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.373 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:53:45.374 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:53:45.374 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.374 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.374 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.374 [main] ObjectStore - db details for db db retrieved using ORM in 0.718201ms
[DEBUG] 2024-04-23 22:53:45.374 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.374 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.378 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.378 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 22:53:45.378 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.378 [main] ObjectStore - 0 entries retrieved using ORM in 4.214545ms
[INFO ] 2024-04-23 22:53:45.378 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 22:53:45.378 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:53:45.378 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:53:45.379 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:53:45.379 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 22:53:45.395 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2102959143 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.399 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 22:53:45.404 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:53:45.405 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1536) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1473) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.tearDown(TestMetaStoreAcidCleanup.java:70) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 22:53:45.405 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:53:45.405 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.405 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db'>
[DEBUG] 2024-04-23 22:53:45.406 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:41) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1536) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1473) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.tearDown(TestMetaStoreAcidCleanup.java:70) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 22:53:45.406 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 22:53:45.406 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 22:53:45.407 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2005537360 (XID = 925), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.407 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:53:45.407 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1416415959 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:53:45.408 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 22:53:45.408 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:45.408 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db
[DEBUG] 2024-04-23 22:53:45.409 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 22:53:45.409 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 22:53:45.409 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db
[DEBUG] 2024-04-23 22:53:45.410 [main] PerfLogger - </PERFLOG method=drop_database start=1713909225356 end=1713909225410 duration=54 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:53:45.410 [main] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:53:45.410 [main] HMSHandler - 0: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 22:53:45.410 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 22:53:45.410 [main] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@f2c488, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@31ff1390 will be shutdown
[DEBUG] 2024-04-23 22:53:45.411 [main] HMSHandler - 0: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 22:53:45.411 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 22:53:45.411 [main] PerfLogger - </PERFLOG method=shutdown start=1713909225410 end=1713909225411 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:53:45.411 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: -1
[DEBUG] 2024-04-23 22:53:45.419 [Thread-14] ShutdownHookManager - ShutdownHookManger complete shutdown.
