[DEBUG] 2024-04-23 22:46:04.529 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.533 [main] HMSHandler - 0: get_database: db_test_get_fields_1
[INFO ] 2024-04-23 22:46:04.534 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_1	
[DEBUG] 2024-04-23 22:46:04.535 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.535 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.535 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.536 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.536 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.252111ms
[DEBUG] 2024-04-23 22:46:04.536 [main] ObjectStore - Failed to get database hive.db_test_get_fields_1, returning NoSuchObjectException
[DEBUG] 2024-04-23 22:46:04.537 [main] HMSHandler - get_databasetime taken(ns): 2104092
[DEBUG] 2024-04-23 22:46:04.538 [main] PerfLogger - </PERFLOG method=get_database_req start=1713908764529 end=1713908764538 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:46:04.538 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=9, comments=HMS client
[DEBUG] 2024-04-23 22:46:04.538 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.538 [main] HMSHandler - 0: get_database: db_test_get_fields_2
[INFO ] 2024-04-23 22:46:04.538 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_2	
[DEBUG] 2024-04-23 22:46:04.539 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.539 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.540 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.540 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.540 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.533995ms
[DEBUG] 2024-04-23 22:46:04.540 [main] ObjectStore - Failed to get database hive.db_test_get_fields_2, returning NoSuchObjectException
[DEBUG] 2024-04-23 22:46:04.540 [main] HMSHandler - get_databasetime taken(ns): 1842793
[DEBUG] 2024-04-23 22:46:04.541 [main] PerfLogger - </PERFLOG method=get_database_req start=1713908764538 end=1713908764541 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:46:04.541 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 22:46:04.541 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.542 [main] HMSHandler - 0: create_database: Database(name:db_test_get_fields_1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 22:46:04.542 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:db_test_get_fields_1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 22:46:04.542 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.543 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.543 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.543 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.543 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.176698ms
[DEBUG] 2024-04-23 22:46:04.544 [main] ObjectStore - Failed to get database hive.db_test_get_fields_1, returning NoSuchObjectException
[DEBUG] 2024-04-23 22:46:04.544 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 22:46:04.544 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.545 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.545 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.547 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 22:46:04.549 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db
[INFO ] 2024-04-23 22:46:04.551 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db
[INFO ] 2024-04-23 22:46:04.601 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db
[DEBUG] 2024-04-23 22:46:04.602 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.602 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.604 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.613 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.614 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.615 [main] HMSHandler - create_databasetime taken(ns): 72398058
[DEBUG] 2024-04-23 22:46:04.615 [main] PerfLogger - </PERFLOG method=create_database start=1713908764541 end=1713908764615 duration=74 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.615 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.615 [main] HMSHandler - 0: create_database: Database(name:db_test_get_fields_2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 22:46:04.615 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:db_test_get_fields_2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 22:46:04.615 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.616 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.616 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.616 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.616 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.186445ms
[DEBUG] 2024-04-23 22:46:04.617 [main] ObjectStore - Failed to get database hive.db_test_get_fields_2, returning NoSuchObjectException
[DEBUG] 2024-04-23 22:46:04.617 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 22:46:04.617 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.618 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.618 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.619 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 22:46:04.620 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db
[INFO ] 2024-04-23 22:46:04.620 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db
[INFO ] 2024-04-23 22:46:04.622 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db
[DEBUG] 2024-04-23 22:46:04.623 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.623 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.623 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.624 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.624 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.625 [main] HMSHandler - create_databasetime taken(ns): 9327775
[DEBUG] 2024-04-23 22:46:04.625 [main] PerfLogger - </PERFLOG method=create_database start=1713908764615 end=1713908764625 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.645 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.645 [main] HMSHandler - 0: create_table_req: Table(tableName:tab1, dbName:db_test_get_fields_1, owner:alex, createTime:1713908764, lastAccessTime:1713908764, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 22:46:04.645 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tab1, dbName:db_test_get_fields_1, owner:alex, createTime:1713908764, lastAccessTime:1713908764, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 22:46:04.646 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.657 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.657 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.657 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.657 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.658 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 11.677299ms
[DEBUG] 2024-04-23 22:46:04.658 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.658 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.658 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 22:46:04.670 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.670 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.670 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:46:04.671 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor null with null on table tab1
[DEBUG] 2024-04-23 22:46:04.671 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.672 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.672 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.672 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.672 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.673 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.785824ms
[DEBUG] 2024-04-23 22:46:04.673 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[INFO ] 2024-04-23 22:46:04.673 [main] MetastoreDefaultTransformer - Converting tab1 to EXTERNAL tableType for null
[INFO ] 2024-04-23 22:46:04.673 [main] MetastoreDefaultTransformer - Modified table params are:{external.table.purge=TRUE, EXTERNAL=TRUE, TRANSLATED_TO_EXTERNAL=TRUE}
[INFO ] 2024-04-23 22:46:04.675 [main] MetastoreDefaultTransformer - Using location file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab1 for table tab1
[INFO ] 2024-04-23 22:46:04.675 [main] MetastoreDefaultTransformer - Transformer returning table:Table(tableName:tab1, dbName:db_test_get_fields_1, owner:alex, createTime:1713908764, lastAccessTime:1713908764, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab1, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{external.table.purge=TRUE, EXTERNAL=TRUE, TRANSLATED_TO_EXTERNAL=TRUE}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, catName:hive, ownerType:USER)
[DEBUG] 2024-04-23 22:46:04.676 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.676 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.677 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.677 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.678 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.678 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.189147ms
[DEBUG] 2024-04-23 22:46:04.678 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.678 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.678 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 22:46:04.678 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.678 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 22:46:04.679 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab1
[DEBUG] 2024-04-23 22:46:04.682 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.682 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.688 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.695 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.705 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.713 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.719 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.742 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.742 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.746 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.748 [main] HMSHandler - create_table_reqtime taken(ns): 102895850
[DEBUG] 2024-04-23 22:46:04.749 [main] PerfLogger - </PERFLOG method=create_table_req start=1713908764645 end=1713908764749 duration=104 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.749 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.749 [main] HMSHandler - 0: create_table_req: Table(tableName:tab2, dbName:db_test_get_fields_1, owner:alex, createTime:1713908764, lastAccessTime:1713908764, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:name, type:string, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 22:46:04.749 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tab2, dbName:db_test_get_fields_1, owner:alex, createTime:1713908764, lastAccessTime:1713908764, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:name, type:string, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 22:46:04.749 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.750 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.750 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.750 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.750 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.751 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.351116ms
[DEBUG] 2024-04-23 22:46:04.751 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.751 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.751 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:04.752 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.752 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.752 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:46:04.752 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor null with null on table tab2
[DEBUG] 2024-04-23 22:46:04.752 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.753 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.753 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.754 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.754 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.754 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.745935ms
[DEBUG] 2024-04-23 22:46:04.754 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[INFO ] 2024-04-23 22:46:04.754 [main] MetastoreDefaultTransformer - Converting tab2 to EXTERNAL tableType for null
[INFO ] 2024-04-23 22:46:04.754 [main] MetastoreDefaultTransformer - Modified table params are:{external.table.purge=TRUE, EXTERNAL=TRUE, TRANSLATED_TO_EXTERNAL=TRUE}
[INFO ] 2024-04-23 22:46:04.755 [main] MetastoreDefaultTransformer - Using location file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2 for table tab2
[INFO ] 2024-04-23 22:46:04.755 [main] MetastoreDefaultTransformer - Transformer returning table:Table(tableName:tab2, dbName:db_test_get_fields_1, owner:alex, createTime:1713908764, lastAccessTime:1713908764, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:)], location:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:name, type:string, comment:)], parameters:{external.table.purge=TRUE, EXTERNAL=TRUE, TRANSLATED_TO_EXTERNAL=TRUE}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, catName:hive, ownerType:USER)
[DEBUG] 2024-04-23 22:46:04.755 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.755 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.756 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.756 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.756 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.756 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.0913ms
[DEBUG] 2024-04-23 22:46:04.756 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.756 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.756 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:04.757 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.757 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 22:46:04.758 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2
[DEBUG] 2024-04-23 22:46:04.760 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.760 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.762 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.770 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.770 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.771 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.773 [main] HMSHandler - create_table_reqtime taken(ns): 23975645
[DEBUG] 2024-04-23 22:46:04.773 [main] PerfLogger - </PERFLOG method=create_table_req start=1713908764749 end=1713908764773 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.774 [main] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.774 [main] HMSHandler - 0: add_partition : tbl=hive.db_test_get_fields_1.tab2
[INFO ] 2024-04-23 22:46:04.774 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.db_test_get_fields_1.tab2	
[DEBUG] 2024-04-23 22:46:04.775 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.775 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.775 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.775 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:04.797 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.855 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.856 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.875 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 22:46:04.875 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2/name=value1
[DEBUG] 2024-04-23 22:46:04.880 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.880 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.880 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:04.881 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.886 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.900 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.900 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.904 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.907 [main] HMSHandler - add_partitiontime taken(ns): 132559908
[DEBUG] 2024-04-23 22:46:04.907 [main] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713908764774 end=1713908764907 duration=133 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.908 [main] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.908 [main] HMSHandler - 0: add_partition : tbl=hive.db_test_get_fields_1.tab2
[INFO ] 2024-04-23 22:46:04.908 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.db_test_get_fields_1.tab2	
[DEBUG] 2024-04-23 22:46:04.908 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.908 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.908 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.908 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:04.913 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.918 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.918 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.919 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 22:46:04.919 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2/name=value2
[DEBUG] 2024-04-23 22:46:04.922 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.922 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:04.923 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:04.923 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:04.927 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.927 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.929 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.931 [main] HMSHandler - add_partitiontime taken(ns): 22776332
[DEBUG] 2024-04-23 22:46:04.931 [main] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713908764908 end=1713908764931 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.931 [main] PerfLogger - <PERFLOG method=get_fields from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.931 [main] HMSHandler - 0: get_fields_with_environment_context: db=@hive#db_test_get_fields_1tbl=tab1
[INFO ] 2024-04-23 22:46:04.931 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_fields_with_environment_context: db=@hive#db_test_get_fields_1tbl=tab1	
[DEBUG] 2024-04-23 22:46:04.932 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.933 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.933 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.933 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.933 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.933 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.575488ms
[DEBUG] 2024-04-23 22:46:04.933 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.934 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:04.934 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 22:46:04.937 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:04.943 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.944 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.948 [main] HMSHandler - get_fields_with_environment_contexttime taken(ns): 15965598
[ERROR] 2024-04-23 22:46:04.949 [main] RetryingHMSHandler - MetaException(message:Authorization fails)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization$DummyAuthorizationListenerImpl.onEvent(TestHmsServerAuthorization.java:67)
	at org.apache.hadoop.hive.metastore.HMSHandler.firePreEvent(HMSHandler.java:4033)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_fields_with_environment_context(HMSHandler.java:6292)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_fields(HMSHandler.java:6273)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.get_fields(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getFields(HiveMetaStoreClient.java:3053)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getFields(HiveMetaStoreClient.java:3047)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.testGetFields(TestHmsServerAuthorization.java:186)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 22:46:04.950 [main] PerfLogger - </PERFLOG method=get_fields start=1713908764931 end=1713908764949 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 22:46:04.950 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.950 [main] HMSHandler - 0: get_database: db_test_get_fields_1
[INFO ] 2024-04-23 22:46:04.951 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_1	
[DEBUG] 2024-04-23 22:46:04.951 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.952 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.952 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.952 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.952 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.952 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.734628ms
[INFO ] 2024-04-23 22:46:04.953 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor null with null on database db_test_get_fields_1 locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db managedLocationUri=null
[DEBUG] 2024-04-23 22:46:04.953 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db
[INFO ] 2024-04-23 22:46:04.953 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db_test_get_fields_1, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713908764, type:NATIVE)
[DEBUG] 2024-04-23 22:46:04.953 [main] HMSHandler - get_databasetime taken(ns): 2298877
[DEBUG] 2024-04-23 22:46:04.953 [main] PerfLogger - </PERFLOG method=get_database_req start=1713908764950 end=1713908764953 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.954 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=4, comments=HMS client
[DEBUG] 2024-04-23 22:46:04.954 [main] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.955 [main] HMSHandler - 0: get_tables_by_type: db=@hive#db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:46:04.955 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:46:04.955 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:46:04.955 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:46:04.955 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.956 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.957 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.957 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.957 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.957 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.682269ms
[DEBUG] 2024-04-23 22:46:04.959 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.965 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.965 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.965 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.965 [main] ObjectStore - 0 entries retrieved using SQL in 6.92868ms
[DEBUG] 2024-04-23 22:46:04.966 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 10131763
[DEBUG] 2024-04-23 22:46:04.966 [main] HMSHandler - get_tables_by_typetime taken(ns): 10754409
[DEBUG] 2024-04-23 22:46:04.966 [main] PerfLogger - </PERFLOG method=get_tables_by_type start=1713908764954 end=1713908764966 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.966 [main] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.966 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 22:46:04.966 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 22:46:04.966 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.971 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.971 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.971 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.971 [main] ObjectStore - 2 entries retrieved using SQL in 4.772168ms
[DEBUG] 2024-04-23 22:46:04.971 [main] HMSHandler - get_all_tablestime taken(ns): 5211412
[DEBUG] 2024-04-23 22:46:04.971 [main] PerfLogger - </PERFLOG method=get_all_tables start=1713908764966 end=1713908764971 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:04.972 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_test_get_fields_1 (2 tables), metastore.batch.retrieve.max=2
[DEBUG] 2024-04-23 22:46:04.972 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 22:46:04.972 [main] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:04.972 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:04.973 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:04.973 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:04.973 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:04.973 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:04.973 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.330581ms
[DEBUG] 2024-04-23 22:46:04.975 [main] HMSHandler - 0: get_multi_table : db=db_test_get_fields_1 tbls=tab1,tab2
[INFO ] 2024-04-23 22:46:04.975 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=db_test_get_fields_1 tbls=tab1,tab2	
[DEBUG] 2024-04-23 22:46:04.976 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.016 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.018 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.021 [main] HMSHandler - get_multi_tabletime taken(ns): 45247231
[DEBUG] 2024-04-23 22:46:05.021 [main] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713908764972 end=1713908765021 duration=49 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:05.021 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:05.022 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 22:46:05.022 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 22:46:05.022 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.022 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.024 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.024 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.024 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.024 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.389789ms
[DEBUG] 2024-04-23 22:46:05.024 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 22:46:05.024 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 22:46:05.024 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.025 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.025 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.025 [main] ObjectStore - 2 entries retrieved using SQL in 0.647437ms
[DEBUG] 2024-04-23 22:46:05.025 [main] HMSHandler - get_all_tablestime taken(ns): 763114
[DEBUG] 2024-04-23 22:46:05.025 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 22:46:05.025 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 22:46:05.025 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.062 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.074 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.074 [main] HMSHandler - get_functionstime taken(ns): 48551205
[DEBUG] 2024-04-23 22:46:05.074 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 22:46:05.074 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 22:46:05.075 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.098 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.103 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.104 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 29300761
[DEBUG] 2024-04-23 22:46:05.104 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 22:46:05.104 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 22:46:05.104 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.125 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.129 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.130 [main] HMSHandler - get_all_packagestime taken(ns): 25347284
[DEBUG] 2024-04-23 22:46:05.130 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:46:05.130 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:46:05.130 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.132 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.133 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.133 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.133 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.43479ms
[DEBUG] 2024-04-23 22:46:05.133 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.137 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.137 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.138 [main] ObjectStore - 0 entries retrieved using SQL in 4.74091ms
[DEBUG] 2024-04-23 22:46:05.138 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 7525660
[DEBUG] 2024-04-23 22:46:05.138 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.164 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.165 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.165 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:46:05.180 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:46:05.180 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.180 [main] HMSHandler - 0: drop_table : tbl=hive.db_test_get_fields_1.tab1
[INFO ] 2024-04-23 22:46:05.180 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db_test_get_fields_1.tab1	
[DEBUG] 2024-04-23 22:46:05.180 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.180 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.181 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.182 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.182 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.182 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.232362ms
[DEBUG] 2024-04-23 22:46:05.182 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.183 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.183 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.183 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.183 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.127552ms
[DEBUG] 2024-04-23 22:46:05.183 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.183 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.183 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 22:46:05.189 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.190 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.190 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.193 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.194 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.210 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.210 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.210 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.210 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 22:46:05.211 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.211 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:46:05.211 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.233 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.244 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:46:05.244 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.244 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:46:05.244 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:46:05.244 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.263 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.273 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:46:05.273 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:46:05.273 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.273 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:46:05.273 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:46:05.273 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:46:05.273 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.290 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.290 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:46:05.290 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:46:05.290 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.304 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.304 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:46:05.304 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.304 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 22:46:05.304 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 22:46:05.308 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 22:46:05.314 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.323 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:46:05.323 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.323 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:46:05.354 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:46:05.355 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.398 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.398 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.398 [main] HMSHandler - drop_tabletime taken(ns): 217857953
[DEBUG] 2024-04-23 22:46:05.399 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.399 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:46:05.405 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:46:05.405 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.405 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.411 [main] MetastoreDirectSqlUtils - Direct SQL query in 5.048925ms + 0.041409ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?)]
[DEBUG] 2024-04-23 22:46:05.417 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.179087ms + 0.015175ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 22:46:05.420 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.023902ms + 0.013772ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 22:46:05.422 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.298426ms + 0.014852ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 22:46:05.425 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.678146ms + 0.017364ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 22:46:05.427 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.199673ms + 0.015714ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 22:46:05.430 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.372087ms + 0.016308ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 22:46:05.434 [main] MetastoreDirectSqlUtils - Direct SQL query in 1.801431ms + 0.015751ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 22:46:05.436 [main] MetastoreDirectSqlUtils - Direct SQL query in 1.731928ms + 0.015853ms, the query is [delete from "SORT_COLS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 22:46:05.437 [main] MetastoreDirectSqlUtils - Direct SQL query in 1.659738ms + 0.015585ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 22:46:05.440 [main] MetastoreDirectSqlUtils - Direct SQL query in 1.927689ms + 0.234555ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 22:46:05.442 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.12955ms + 0.016138ms, the query is [delete from "SDS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 22:46:05.444 [main] MetastoreDirectSqlUtils - Direct SQL query in 1.666648ms + 0.013745ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (3,4)]
[DEBUG] 2024-04-23 22:46:05.446 [main] MetastoreDirectSqlUtils - Direct SQL query in 1.78435ms + 0.014254ms, the query is [delete from "SERDES" where "SERDE_ID" in (3,4)]
[DEBUG] 2024-04-23 22:46:05.450 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.450 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.450 [main] ObjectStore - 0 entries retrieved using SQL in 44.90617ms
[DEBUG] 2024-04-23 22:46:05.450 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.450 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 22:46:05.451 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 22:46:05.451 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.451 [main] HMSHandler - 0: drop_table : tbl=hive.db_test_get_fields_1.tab2
[INFO ] 2024-04-23 22:46:05.451 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db_test_get_fields_1.tab2	
[DEBUG] 2024-04-23 22:46:05.451 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.451 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.454 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.454 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.454 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.454 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 3.113272ms
[DEBUG] 2024-04-23 22:46:05.455 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.456 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.456 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.456 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.456 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.334893ms
[DEBUG] 2024-04-23 22:46:05.456 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.456 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.456 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:05.457 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.457 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.457 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.458 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.458 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.460 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.460 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.460 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.460 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:05.461 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.461 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 22:46:05.461 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.468 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 22:46:05.468 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.468 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 22:46:05.468 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 22:46:05.468 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.469 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:46:05.469 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 22:46:05.469 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.469 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 22:46:05.469 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 22:46:05.469 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:46:05.469 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.470 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.470 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 22:46:05.470 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:46:05.470 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.471 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.471 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 22:46:05.471 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.471 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 22:46:05.471 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 22:46:05.472 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 22:46:05.473 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.476 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:46:05.476 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 22:46:05.476 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 22:46:05.479 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 22:46:05.479 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 22:46:05.487 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.487 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.487 [main] HMSHandler - drop_tabletime taken(ns): 35546470
[INFO ] 2024-04-23 22:46:05.487 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 22:46:05.487 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.487 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.494 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.494 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 22:46:05.514 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@486514097 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.517 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 22:46:05.523 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.540 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 22:46:05.541 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 22:46:05.541 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 22:46:05.542 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - metricRegistry..................com.codahale.metrics.MetricRegistry@34c76167
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 22:46:05.543 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 22:46:05.543 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 22:46:05.544 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 22:46:05.545 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:46:05.548 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 22:46:05.548 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 22:46:05.549 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 22:46:05.549 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 22:46:05.549 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 22:46:05.549 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 22:46:05.549 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 22:46:05.549 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 22:46:05.549 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 22:46:05.549 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - metricRegistry..................com.codahale.metrics.MetricRegistry@34c76167
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 22:46:05.550 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 22:46:05.551 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 22:46:05.551 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 22:46:05.552 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 22:46:05.553 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1271515799 (XID = 1121), (SESSIONID = 23), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 22:46:05.553 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 22:46:05.554 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.556 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 22:46:05.557 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:46:05.557 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.558 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 22:46:05.559 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 22:46:05.560 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 22:46:05.560 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 22:46:05.560 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.560 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.561 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.563 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 22:46:05.563 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab1
[INFO ] 2024-04-23 22:46:05.567 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 22:46:05.569 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 22:46:05.569 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2
[DEBUG] 2024-04-23 22:46:05.571 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 22:46:05.571 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 22:46:05.571 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_1.db
[WARN ] 2024-04-23 22:46:05.571 [main] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_1.db does not exist; Force to delete it.
[ERROR] 2024-04-23 22:46:05.571 [main] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_1.db
[DEBUG] 2024-04-23 22:46:05.572 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 22:46:05.572 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 22:46:05.572 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db
[DEBUG] 2024-04-23 22:46:05.573 [main] HMSHandler - drop_databasetime taken(ns): 551053976
[DEBUG] 2024-04-23 22:46:05.573 [main] PerfLogger - </PERFLOG method=drop_database start=1713908765021 end=1713908765573 duration=552 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:05.573 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:05.573 [main] HMSHandler - 0: get_database: db_test_get_fields_2
[INFO ] 2024-04-23 22:46:05.573 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_2	
[DEBUG] 2024-04-23 22:46:05.574 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.577 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.577 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.577 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.578 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.578 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 4.11679ms
[INFO ] 2024-04-23 22:46:05.578 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor null with null on database db_test_get_fields_2 locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db managedLocationUri=null
[DEBUG] 2024-04-23 22:46:05.578 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db
[INFO ] 2024-04-23 22:46:05.578 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db_test_get_fields_2, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713908764, type:NATIVE)
[DEBUG] 2024-04-23 22:46:05.578 [main] HMSHandler - get_databasetime taken(ns): 4444985
[DEBUG] 2024-04-23 22:46:05.578 [main] PerfLogger - </PERFLOG method=get_database_req start=1713908765573 end=1713908765578 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:05.578 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=5, comments=HMS client
[DEBUG] 2024-04-23 22:46:05.578 [main] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:05.578 [main] HMSHandler - 0: get_tables_by_type: db=@hive#db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:46:05.578 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:46:05.579 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:46:05.579 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:46:05.579 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.580 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.580 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.580 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.580 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.580 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.472459ms
[DEBUG] 2024-04-23 22:46:05.580 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.584 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.585 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.585 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.585 [main] ObjectStore - 0 entries retrieved using SQL in 4.584113ms
[DEBUG] 2024-04-23 22:46:05.585 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 6249038
[DEBUG] 2024-04-23 22:46:05.585 [main] HMSHandler - get_tables_by_typetime taken(ns): 6534919
[DEBUG] 2024-04-23 22:46:05.585 [main] PerfLogger - </PERFLOG method=get_tables_by_type start=1713908765578 end=1713908765585 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:05.585 [main] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:05.585 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_2
[INFO ] 2024-04-23 22:46:05.585 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_2	
[DEBUG] 2024-04-23 22:46:05.585 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.589 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.589 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.590 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.590 [main] ObjectStore - 0 entries retrieved using SQL in 4.327321ms
[DEBUG] 2024-04-23 22:46:05.590 [main] HMSHandler - get_all_tablestime taken(ns): 4433757
[DEBUG] 2024-04-23 22:46:05.590 [main] PerfLogger - </PERFLOG method=get_all_tables start=1713908765585 end=1713908765590 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:05.590 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_test_get_fields_2 (0 tables), metastore.batch.retrieve.max=2
[DEBUG] 2024-04-23 22:46:05.590 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 22:46:05.590 [main] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:05.590 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.591 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.591 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.591 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.592 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.592 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.627368ms
[DEBUG] 2024-04-23 22:46:05.592 [main] HMSHandler - 0: get_multi_table : db=db_test_get_fields_2 tbls=
[INFO ] 2024-04-23 22:46:05.592 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=db_test_get_fields_2 tbls=	
[DEBUG] 2024-04-23 22:46:05.592 [main] HMSHandler - get_multi_tabletime taken(ns): 38787
[DEBUG] 2024-04-23 22:46:05.592 [main] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713908765590 end=1713908765592 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:05.592 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:05.592 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_2
[INFO ] 2024-04-23 22:46:05.592 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_2	
[DEBUG] 2024-04-23 22:46:05.593 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 22:46:05.593 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.594 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.594 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.594 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.594 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.21612ms
[DEBUG] 2024-04-23 22:46:05.594 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_2
[INFO ] 2024-04-23 22:46:05.594 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_2	
[DEBUG] 2024-04-23 22:46:05.594 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.595 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.595 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.595 [main] ObjectStore - 0 entries retrieved using SQL in 0.699332ms
[DEBUG] 2024-04-23 22:46:05.595 [main] HMSHandler - get_all_tablestime taken(ns): 823307
[DEBUG] 2024-04-23 22:46:05.595 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_2 pat=*
[INFO ] 2024-04-23 22:46:05.595 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_2 pat=*	
[DEBUG] 2024-04-23 22:46:05.595 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.600 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.601 [main] HMSHandler - get_functionstime taken(ns): 5365408
[DEBUG] 2024-04-23 22:46:05.601 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 22:46:05.601 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 22:46:05.601 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.604 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.605 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 3833831
[DEBUG] 2024-04-23 22:46:05.605 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 22:46:05.605 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 22:46:05.605 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.609 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.609 [main] HMSHandler - get_all_packagestime taken(ns): 4237601
[DEBUG] 2024-04-23 22:46:05.610 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 22:46:05.610 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 22:46:05.610 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.611 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 22:46:05.611 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.611 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.611 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.220296ms
[DEBUG] 2024-04-23 22:46:05.611 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.612 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 22:46:05.612 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.612 [main] ObjectStore - 0 entries retrieved using SQL in 0.619058ms
[DEBUG] 2024-04-23 22:46:05.612 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 2035197
[INFO ] 2024-04-23 22:46:05.612 [main] ObjectStore - Dropping database hive.db_test_get_fields_2 along with all tables
[DEBUG] 2024-04-23 22:46:05.612 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 22:46:05.612 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 22:46:05.615 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 22:46:05.615 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 22:46:05.616 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 22:46:05.617 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 22:46:05.617 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:130) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 22:46:05.619 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 22:46:05.619 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.619 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_2'>
[DEBUG] 2024-04-23 22:46:05.619 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:130) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 22:46:05.620 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 22:46:05.620 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 22:46:05.620 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1641418296 (XID = 1119), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.620 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 22:46:05.621 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2023917549 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 22:46:05.622 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 22:46:05.622 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_2
[DEBUG] 2024-04-23 22:46:05.622 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_2.db
[WARN ] 2024-04-23 22:46:05.622 [main] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_2.db does not exist; Force to delete it.
[ERROR] 2024-04-23 22:46:05.622 [main] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_2.db
[DEBUG] 2024-04-23 22:46:05.623 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 22:46:05.623 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_2
[DEBUG] 2024-04-23 22:46:05.623 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db
[DEBUG] 2024-04-23 22:46:05.624 [main] HMSHandler - drop_databasetime taken(ns): 31041135
[DEBUG] 2024-04-23 22:46:05.624 [main] PerfLogger - </PERFLOG method=drop_database start=1713908765592 end=1713908765624 duration=32 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 22:46:05.624 [main] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 22:46:05.624 [main] HMSHandler - 0: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 22:46:05.624 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 22:46:05.624 [main] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@77bb0ab5, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@22101c80 will be shutdown
[DEBUG] 2024-04-23 22:46:05.624 [main] HMSHandler - 0: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 22:46:05.625 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 22:46:05.625 [main] PerfLogger - </PERFLOG method=shutdown start=1713908765624 end=1713908765625 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 22:46:05.625 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: -1
[DEBUG] 2024-04-23 22:46:05.634 [Thread-14] ShutdownHookManager - ShutdownHookManger complete shutdown.
